/*
 * client.js - v5.0.2
 * Compiled Tue May 21 2024 15:09:39 GMT+0800 (China Standard Time)
 * Copyright (c) 2024 www.hightopo.com
 */

var hteditor=function(){"use strict";function M(M){if(M){return new Function("return "+M.trim())()}}function q(M){var q=new RegExp("(^|&)"+M+"=([^&]*)(&|$)"),N=window.location.search.substr(1).match(q);return null!=N?decodeURIComponent(N[2]):null}function N(M){return parseFloat(M.toFixed(ht.Default.numberDigits))}function e(M,q){if(null!=M)return q||!oN.config.traceMissingI18n||oN.customStrings[M]||oN.strings[M]||console.log("i18n missing:["+M+"]"),q?oN.customStrings[M]||oN.strings[M]:oN.customStrings[M]||oN.strings[M]||M}function X(M,q){return M&&M.rowHeight?M.rowHeight:q&&q.rowHeight?q.rowHeight:void 0}function w(M,q){return M&&M.widths?M.widths:q&&q.widths?q.widths:void 0}function t(M,q){return q?q.map(function(M){return e(M)}):M}function E(M,q){var N=M.indexOf(q);N>=0&&M.splice(N,1)}function J(M){return ht.Default.isEmptyObject(M)}function u(M){return M?kN(M)?M:M.__ht__||M.toString():""}function g(M){var q=u(M),N=q.indexOf("{")+1,e=q.lastIndexOf("}");for(q=q.substring(N,e);q.startsWith("\n");)q=q.substr(1);for(;q.endsWith("\n");)q=q.substring(0,q.length-1);return q}function S(M){var q=M.indexOf("function");if(M&&!(q<0)){var N=void 0,e=M.indexOf("{")+1,X=M.lastIndexOf("}"),w=M.indexOf("(")+1,$=M.indexOf(")");return e&&X&&w&&$&&(N=new Function(M.substring(w,$),M.substring(e,X)),N.__ht__=M.substr(q)),N}}function b(M,q,N){if(N)return N;if("s"===M)return function(M){return M.s(q)};if("a"===M)return function(M){return M.a(q)};if("p"===M){var e=ht.Default.getter(q);return function(M){if(M[e])return M[e]()}}}function h(M,q,N){if(void 0!==N)return N;if("s"===M)return function(M,N){return M.s(q,N)};if("a"===M)return function(M,N){return M.a(q,N)};if("p"===M){var e=ht.Default.setter(q);return function(M,q){if(M[e])return M[e](q)}}}function y(M){return 37===M.keyCode}function P(M){return 38===M.keyCode}function f(M){return 39===M.keyCode}function x(M){return 40===M.keyCode}function n(M){return 13===M.keyCode}function R(M){return 27===M.keyCode}function G(M){return ht.Default.isDelete(M)}function j(M){return ht.Default.isLeftButton(M)}function K(M){return ht.Default.isDoubleClick(M)}function p(M,q){ht.Default.startDragging(M,q)}function C(M){return ht.Default.getClientPoint(M)}function m(M){return ht.Default.getTargetElement(M)}function O(M){return ht.Default.getPagePoint(M)}function Q(){return ht.Default.getWindowInfo()}function s(M,q){return ht.Default.getDistance.apply(this,arguments)}function l(){return ht.Default.unionPoint.apply(this,arguments)}function Y(M){return ht.Default.getImageMap()[M]?(delete ht.Default.getImageMap()[M],!0):ht.Default.getCompTypeMap()[M]?(delete ht.Default.getCompTypeMap()[M],!0):!!ht.Default.getShape3dModelMap()[M]&&(delete ht.Default.getShape3dModelMap()[M],!0)}function I(M,q){ht.Default.setImage(M,q)}function r(M,q,N){return ht.Default.getPosition(M,q,N)}function d(M,q){var N=arguments.length>2&&void 0!==arguments[2]?arguments[2]:KN.encodeJSON;return ht.Default.stringify(M,q,N)}function a(M,q){return ht.Default.parse(M,q)}function D(M){if(!M)return"";var q=M.lastIndexOf(".");return-1===q?M:M.substr(0,q)}function W(M){return M=M.replace(/^.*[\\\/]/,""),D(M)}function v(M){if(!M)return"";var q=M.lastIndexOf(".");return-1===q?"":M.substr(q,M.length)}function o(M){return v(M).substr(1)}function H(M,q,N,e,X){ht.Default.layout(M,q,N,e,X)}function U(M,q,N,e){ht.Default.setCanvas(M,q,N,e)}function V(M){ht.Default.removeHTML(M)}function T(M,q,N){ht.Default.xhrLoad(M,q,N)}function _(M){return ht.Default.isShiftDown(M)}function k(M){return ht.Default.isCtrlDown(M)}function Z(M,q){return ht.Default.createView(M,q)}function z(M){return ht.Default.createCanvas(M)}function A(M,q){return ht.Default.createDiv(q,M)}function c(M,q){return ht.Default.unionRect(M,q)}function B(M,q,N,e,X,w,$,t,E,J){return ht.Default.drawText(M,q,N,e,X,w,$,t,E,J)}function L(M,q,N,e,X,w,$,t,E,J){ht.Default.drawStretchImage(M,q,N,e,X,w,$,t,E,J)}function i(M,q,N,e,X,w,$){ht.Default.drawBorder(M,q,N,e,X,w,$)}function F(M,q,N,e,X,w){var $=M.getContext("2d");return $.save(),q=q||0,N=N||0,e=e||1,w=w||ht.Default.devicePixelRatio,$.translate(q*w,N*w),e*=w,1!==e&&$.scale(e,e),X&&($.beginPath(),$.rect(X.x,X.y,X.width,X.height),$.clip(),$.clearRect(X.x,X.y,X.width,X.height)),$}function MM(M,q){ht.Default.extendClass(M,q)}function qM(M,q){q[M._id]=M,M.eachChild(function(M){q[M._id]=M,qM(M,q)})}function NM(M){ht.Default.preventDefault(M)}function eM(M){return/^displays/.test(M)}function XM(M){return/^symbols/.test(M)}function wM(M){return/^components/.test(M)}function $M(M){return/^scenes/.test(M)}function tM(M){return/^models/.test(M)}function EM(M){return/^uis/.test(M)}function JM(M){return/^assets/.test(M)}function uM(M){return/\.(png|jpg|gif|jpeg|bmp|svg)$/i.test(M)}function gM(M){return/\.json$/i.test(M)}function SM(M){return/\.htb$/i.test(M)}function bM(M){return/\.wexbim$/i.test(M)}function hM(M){return/\.mp3$/i.test(M)}function yM(M){return/\.mp4$/i.test(M)}function PM(M){return/\.svg$/i.test(M)}function fM(M){return/\.dxf$/i.test(M)}function xM(M){return/\.obj$/i.test(M)}function nM(M){return/\.mtl$/i.test(M)}function RM(M){return/\.ttf$/i.test(M)}function GM(M){return/\.otf$/i.test(M)}function jM(M){return/\.js$/i.test(M)}function KM(M){return M.substring(0,M.length-5)+".png"}function pM(M){return M.substring(0,M.length-4)+".png"}function CM(M){return"number"==typeof M}function mM(M){return M&&"object"==typeof M}function OM(M){return"function"==typeof M}function QM(M,q){var N=M.getPosition().x,e=M.getPosition().y,X=M.getWidth(),w=M.getHeight(),$=[N-X*M.getAnchor().x,e-w*M.getAnchor().y,X,w];WM(q,"rect",M.a("rect"),$,void 0)}function sM(M,q){var N=M.getRotation();WM(q,"rotation",M.a("rotation"),N,0)}function lM(M,q){var N=M.getAnchor().x,e=M.a("anchorX");WM(q,"anchorX",e,N,.5),N=M.getAnchor().y,e=M.a("anchorY"),WM(q,"anchorY",e,N,.5)}function YM(M,q){var N=M.getScale().x,e=M.a("scaleX");WM(q,"scaleX",e,N,1),N=M.getScale().y,e=M.a("scaleY"),WM(q,"scaleY",e,N,1)}function IM(M,q){var N=M.isClosePath();WM(q,"closePath",M.a("closePath"),N,!1)}function rM(M,q,N,e,X){4===arguments.length&&(X=ht.Style[N]);var w=VN(M.s(N)),$=M.getAttrObject();WM(q,e,$&&$[N],w,X)}function dM(M,q){var N=M.getDisplayName();WM(q,"displayName",M.a("displayName"),N,void 0)}function aM(M,q){if(_N(M)&&_N(q)){if(M.length===q.length){for(var N=0;N<M.length;N++)if(!aM(M[N],q[N]))return!1;return!0}return!1}if(mM(M)&&mM(q)){var e=Object.keys(M);if(e.length===Object.keys(q).length){for(var X=0;X<e.length;X++){var w=e[X];if(!aM(M[w],q[w]))return!1}return!0}return!1}return M===q}function DM(M){return M instanceof ht.DataModel?AN+M.serialize(0):M}function WM(M,q,N,e,X){var w=aM(e,X);if(N){var $=M[q]={func:N};w||($.value=DM(e))}else w||void 0===e||(M[q]=DM(e))}function vM(M,q,N,e){HM(M,"2d.visible",q.visible),HM(M,"2d.selectable",q.selectable),HM(M,"2d.movable",q.movable),HM(M,"2d.editable",q.editable),HM(M,"pixelPerfect",q.pixelPerfect,!1),HM(M,"opacity",q.opacity,1),HM(M,"clip.percentage",q.clipPercentage,ht.Style["clip.percentage"]),HM(M,"clip.direction",q.clipDirection,"top"),HM(M,"layout.h",q.layoutH),HM(M,"layout.v",q.layoutV),HM(M,"prefix",q.prefix),HM(M,"state",q.state),HM(M,"2d.gray",q.gray),HM(M,"shadow2",q.shadow,!1),HM(M,"shadow2.color",q.shadowColor,ht.Color.highlight),HM(M,"shadow2.blur",q.shadowBlur,6),HM(M,"shadow2.offset.x",q.shadowOffsetX,3),HM(M,"shadow2.offset.y",q.shadowOffsetY,3),HM(M,"composite",q.composite),UM(M,q),TM(M,q),_M(M,q),VM(M,q),M instanceof ht.Shape||(q.rect?ZM(M,q,N,e):"x"in q&&(M.p(q.x,q.y),M.setSize(q.width,q.height)));var X=KN.customProperties.comp;X&&X.length&&X.forEach(function(N){HM(M,N.property,q[N.property],N.defaultValue)}),zN.forEach(function(N){M.a(N,q[N])}),M.a("renderHTML",q.renderHTML),M instanceof ht.Node&&M.setRenderLayer(q.renderLayer)}function oM(M,q){rM(M,q,"2d.visible","visible"),rM(M,q,"2d.selectable","selectable"),rM(M,q,"2d.movable","movable"),rM(M,q,"2d.editable","editable"),rM(M,q,"pixelPerfect","pixelPerfect",!1),rM(M,q,"opacity","opacity",1),rM(M,q,"clip.percentage","clipPercentage",ht.Style["clip.percentage"]),rM(M,q,"clip.direction","clipDirection","top"),rM(M,q,"layout.h","layoutH"),rM(M,q,"layout.v","layoutV"),rM(M,q,"prefix","prefix"),rM(M,q,"state","state"),rM(M,q,"2d.gray","gray"),rM(M,q,"shadow2","shadow",!1),rM(M,q,"shadow2.color","shadowColor",ht.Color.highlight),rM(M,q,"shadow2.blur","shadowBlur",6),rM(M,q,"shadow2.offset.x","shadowOffsetX",3),rM(M,q,"shadow2.offset.y","shadowOffsetY",3),rM(M,q,"composite","composite"),dM(M,q),lM(M,q),YM(M,q),sM(M,q),M instanceof ht.Shape&&!M.a("rect")||QM(M,q);var N=KN.customProperties.comp,e=!!KN.saveCompCustomPropertyDefaultValue;N&&N.length&&N.forEach(function(N){e?rM(M,q,N.property,N.property):rM(M,q,N.property,N.property,N.defaultValue)}),zN.forEach(function(N){M.a(N)&&(q[N]=M.a(N))}),M.a("renderHTML")&&(q.renderHTML=M.a("renderHTML")),M instanceof ht.Node&&(q.renderLayer=M.getRenderLayer())}function HM(M,q,N,e){3===arguments.length&&(e=ht.Style[q]);var X=zM(N,e);if(kN(X)&&X.substring(0,15)===AN){var w=new ht.DataModel;w.deserialize(a(X.substr(15))),X=w}M.s(q,VN(X)),M.a(q,AM(N))}function UM(M,q){M.setDisplayName(zM(q.displayName),void 0),M.a("displayName",AM(q.displayName))}function VM(M,q){M.setRotation(zM(q.rotation,0)),M.a("rotation",AM(q.rotation))}function TM(M,q){var N=zM(q.anchorX,.5),e=zM(q.anchorY,.5);.5===N&&.5===e||M.setAnchor(N,e),M.a("anchorX",AM(q.anchorX)),M.a("anchorY",AM(q.anchorY))}function _M(M,q){var N=zM(q.scaleX,1),e=zM(q.scaleY,1);M.setScale(N,e),M.a("scaleX",AM(q.scaleX)),M.a("scaleY",AM(q.scaleY))}function kM(M,q){M.setClosePath(zM(q.closePath,!1)),M.a("closePath",AM(q.closePath))}function ZM(M,q,N,e){var X=zM(q.rect),w=zM(q.relative);X||(X=[0,0,N,e],w=!1);var $=X.length;if(4===$)X={x:X[0],y:X[1],width:X[2],height:X[3]},w&&(X.x*=N,X.y*=e,X.width*=N,X.height*=e);else if(3===$){var t=X[0];X={width:X[1],height:X[2]},w&&(X.width*=N,X.height*=e),"object"==typeof t?t.length&&(t={x:t[0],y:t[1]}):t=r(t,{x:0,y:0,width:N,height:e},X),X.x=t.x-X.width*M.getAnchor().x,X.y=t.y-X.height*M.getAnchor().y}var E=zM(q.offsetX);E&&(X.x+=E),E=zM(q.offsetY),E&&(X.y+=E),X.width<0||X.height<0?M.p(X.x,X.y):M.setRect(X),M.a("rect",AM(q.rect))}function zM(M,q){var N=void 0;return N=mM(M)&&M.func?M.value:M,void 0===N&&(N=q),N}function AM(M){if(mM(M)&&M.func)return M.func}function cM(M){if(_N(M)){for(var q=new ht.List,N=M.length,e=0;e<N;e+=2)q.add({x:M[e],y:M[e+1]});M=q}return M}function BM(M){if(M instanceof ht.List&&(M=M.toArray()),_N(M)){for(var q=[],N=0;N<M.length;N++){var e=M[N];q.push(e.x,e.y)}M=q}return M}function LM(M){return{width:16,height:16,comps:[{type:function(q,N,e,X,w){var $=M.graphView,t=ht.Default.getImage($.getImage(X));if(ht.Default.checkLoadingImage($),ht.Default.checkLoadingImage(M),t&&t.snapshotURL)(t=ht.Default.getImage(t.snapshotURL))&&L(q,t,"uniform",N.x,N.y,N.width,N.height,X,w);else{var E=ht.Default.clone(t&&t.boundExtend?X.getRect():$.getDataUIBounds(X));if(E&&E.width&&E.height){q.save();var J=Math.min(1,16/Math.max(E.width,E.height));q.translate(-E.x*J+(16-E.width*J)/2,-E.y*J+(16-E.height*J)/2),q.scale(J,J);var u=$._zoom;$._zoom=J,$.__listDraw__=!0,$.drawData(q,X),delete $.__listDraw__,$._zoom=u,q.restore()}}}}]}}function iM(M,q){var N=M.graphView.getEdgeInfo(q);if(!N)return FN;var e=N.edgeTypeInfo,X=void 0,w=void 0;if(!N.type||N.points){N.sourcePoint.x,N.sourcePoint.y,N.targetPoint.x,N.targetPoint.y;N.type?(X=new ht.List(N.sourcePoint),X.addAll(N.points),X.add(N.targetPoint),w=N.segments):N.looped?(X=qe,w=Ne):X=N.center?[N.c1,N.sourcePoint,N.targetPoint,N.c2]:[N.sourcePoint,N.targetPoint]}else e&&(X=e.points,w=e.segments);var $=l(X);if($&&($.width||$.height)){var t=Math.max(1,Math.max($.width,$.height)/16),E=[],J=(16-$.width/t)/2,u=(16-$.height/t)/2;X instanceof ht.List&&(X=X.toArray()),X.forEach(function(M){E.push((M.x-$.x)/t+J,(M.y-$.y)/t+u)});var g=w?w.toArray():null;return{width:16,height:16,comps:[{type:"shape",points:E,segments:g,borderWidth:1,borderColor:N.color,borderCap:N.cap,borderJoin:N.join}]}}return FN}function FM(M){var q=l(M.getPoints());if(q&&(q.width||q.height)){var N=Math.max(1,Math.max(q.width,q.height)/16),e=[],X=(16-q.width/N)/2,w=(16-q.height/N)/2;M.getPoints().each(function(M){e.push((M.x-q.x)/N+X,(M.y-q.y)/N+w)});var $=M.getSegments()?M.getSegments().toArray():null;return{width:16,height:16,comps:[{type:"shape",points:e,segments:$,rotation:M.getRotation(),background:M.s("shape.background"),repeatImage:M.s("shape.repeat.image"),repeatImageStretch:M.s("shape.repeat.image.stretch"),repeatImageRotation:M.s("shape.repeat.image.rotation"),borderWidth:M.s("shape.border.width")?1:0,borderColor:M.s("shape.border.color"),borderCap:M.s("shape.border.cap"),borderJoin:M.s("shape.border.join"),gradient:M.s("shape.gradient"),gradientColor:M.s("shape.gradient.color"),closePath:M.isClosePath()}]}}return FN}function Mq(M){return ht.Default.isInput(M)}function qq(M,q){var N=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},X=N.nullable,w=void 0===X||X,$=N.trim,t=void 0!==$&&$,E=N.cancellable,J=void 0===E||E,u=N.width,g=void 0===u?300:u,S=N.height,b=N.maxLength,h=void 0===b?-1:b,y=N.checkFunc,P=void 0===y?void 0:y,f=N.$38$,x=void 0===f?void 0:f,n=N.path,R=void 0===n?"":n,G=N.editor,j=void 0===G?void 0:G,K=arguments[3],p=new WN,C=Jq(null,e("editor.changepath"),"editor.changepath",function(){if(j){var M=p.v("path"),q=M.split("/")[0];j.chooseDirectoryDialog.show(j[q],M,function(M){p.v("path",M.url+"/")})}});if(C.getIconColor=function(){return this.isPressed()?oN.config.color_select:oN.config.color_dark},p.addRow([e("editor.path"),{id:"path",element:R},C],[40,.1,20]),p.addRow([e("editor.name"),{id:"input",textField:{text:q}}],[40,.1]),S)S+=10;else{var m=p.getVPadding(),O=p.getVGap(),Q=p.getRows().length;S=2*m+O*(Q-1)+p.getRowHeight()*Q,p.setHeight(S),S=null}var s=new DN,l=[],Y=null,I=null;Y=function(){var M=p.v("input");return t&&M&&M.trim(),!1!==w||M?h>0&&M&&M.length>h?void eq(null,e("editor.inputmax"),function(){}):P&&!(M=P(M))?void eq(null,e("editor.invalidinput"),function(){}):(K(M,"ok",p.v("path")),void s.hide()):void eq(null,e("editor.inputempty"),function(){})},l.push({label:e("editor.ok"),action:Y}),J&&(I=function(){K(q,"cancel"),s.hide()},l.push({label:e("editor.cancel"),action:I})),s.setConfig({title:M,draggable:!0,width:g,height:S,contentPadding:10,content:p,buttons:l,buttonsAlign:"right"}),s.$48$=I,s.$47$=Y,s.show(x),p.getViewById("input").getElement()._ignore=!0,p.getViewById("input").setFocus()}function Nq(M,q,N,X){var w={title:e("editor.prompt"),contentPadding:20,draggable:!0,width:300};if(mM(X)?Object.assign(w,X):CM(X)&&(w.width=X),kN(q)){var $=Xq();$.innerHTML=q,q=$}M&&(w.title=M),w.content=q,w.buttons=N;var t=new DN(w);return t.setModal(!0),t.show(),t}function eq(M,q,N,X,w){var $=[],t=void 0,E=void 0;N&&(t=function(){J.hide(),N()},$.push({label:e("editor.ok"),action:t})),X&&(E=function(){J.hide(),X()},$.push({label:e("editor.cancel"),action:E}));var J=Nq(M,q,$,w);return J.$48$=E||t,J.$47$=t,J}function Xq(){var M=document.createElement("p");return M.style.color=ht.Default.labelColor,M.style.marginBlockStart="0px",M.style.marginBlockEnd="0px",M.style.maxHeight="600px",M}function wq(M,q,N,e){var X={unfocusable:!0,id:M,toolTip:q},w=ht.Default.getImage(N),$=w?w.width:16,t=w?w.height:16;return X.icon={width:$+8,height:t+8,fitSize:!!w&&w.fitSize,comps:[{type:"rect",background:{func:function(M,q){return q.getCurrentItem()===X?oN.config.color_hover:null}},rect:[0,0,$+8,t+8]},{type:"image",name:N,color:{func:function(M,q){return e&&e()?oN.config.color_select:oN.config.color_dark}},rect:[4,4,$,t]}]},X}function $q(M,q,N){N||(N=ht.Default.labelFont);var e=ht.Default.textExtraWidth/2,X=ht.Default.formPaneLabelHPadding+e,w=ht.Default.formPaneLabelVPadding,$=ht.Default.createDiv(!0);return $.style.font=N,$.style.color=ht.Default.labelColor,$.style.padding=w+"px "+X+"px",$.style.whiteSpace="nowrap",$.style.verticalAlign="middle",$.innerHTML=M,q&&($.style.textAlign=q),$.onLayouted=function(M,q,N,e){$.style.lineHeight=e+"px"},$.requestPointerLock=$.requestPointerLock||$.mozRequestPointerLock||$.webkitRequestPointerLock||$.msRequestPointerLock||void 0,$}function tq(M){ee||(ee=document.createElement("canvas"),ee.style.position="absolute");var q=ht.Default.getImage("editor.cursor."+M);if(q){var N=ht.Default.devicePixelRatio,e=q.width,X=q.height;ee.width=e*N,ee.height=X*N,ee.style.width=e+"px",ee.style.height=X+"px",Eq(q)}else ht.Default.callLater(function(){return tq(M)});return ee}function Eq(M){var q=M.width,N=M.height,e=ee.getContext("2d");e.save(),e.scale(ht.Default.devicePixelRatio,ht.Default.devicePixelRatio),e.clearRect(0,0,q,N),ht.Default.drawImage(e,M,0,0,q,N),e.restore()}function Jq(M,q,N,e){var X=new ht.widget.Button;return X.setLabel(M),X.setLabelColor(ht.Default.labelColor),X.setLabelSelectColor(oN.config.color_select),X.setIcon(N),X.setBackground(null),X.setBorderColor(null),e&&(X.onClicked=e),q&&(X.setToolTip(q),X.enableToolTip()),X.getCurrentBackground=function(){return this._hover||this.isPressed()?oN.config.color_hover:null},X.getCurrentBorderColor=function(){return this.isSelected()?oN.config.color_select:null},X.getView().addEventListener("mouseenter",function(){X.isDisabled()||(X._hover=!0,X.iv())},!1),X.getView().addEventListener("mouseleave",function(){X.isDisabled()||(X._hover=!1,X.iv())},!1),X}function uq(M,q){var N=ht.Default.getImage(M);if(!N)throw M;var e={width:N.width,height:N.height,fitSize:N.fitSize,comps:[{type:"image",name:M,color:{func:function(){return q&&q()?oN.config.color_select:oN.config.color_dark}}}]},X=M+".state";return ht.Default.setImage(X,e),X}function gq(M,q,N){var e=new FileReader;e.onloadend=function(M){q(M.target.result)},N?e.readAsDataURL(M):e.readAsText(M)}function Sq(M,q){if(q){q===document.body&&(document.title=e("editor.title"),document.body.style.overflow="hidden"),q.appendChild(M.getView());var N=M.getView().style;N.left="0px",N.top="0px",setInterval(function(){if(M.getView()!==(document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement||document.msFullscreenElement)){var e=void 0,X=void 0;q===document.body?(e=document.documentElement.clientWidth,window.innerWidth&&window.innerWidth<e&&(e=window.innerWidth),X=document.documentElement.clientHeight,window.innerHeight&&window.innerHeight<X&&(X=window.innerHeight)):(e=q.clientWidth,X=q.clientHeight),e===M._oldWidth&&X===M._oldHeight||(M._oldWidth=e,M._oldHeight=X,N.width=e+"px",N.height=X+"px",M.iv())}},500)}}function bq(M){if(M)for(var q=0;q<M.length;q++)null==M[q]&&(M[q]=0)}function hq(M){if(M)for(var q=ht.Color.chart,N=0;N<M.length;N++)null==M[N]&&(M[N]=q[N%q.length])}function yq(M,q){q=void 0===q?M?M.length:0:q;for(var N=new Array(q),e=0;e<q;e++)N[e]=M?M[e]:void 0;return N}function Pq(M){if(M instanceof ht.graph.GraphView){var q=M.getContentRect(),N=Math.max(q.width,q.height),e=Math.min(q.width,q.height),X=Math.max(1/e,oN.config.imageSize/N);return M.toDataURL(void 0,void 0,X)}if(M instanceof ht.graph3d.Graph3dView){var w=M.getWidth(),$=M.getHeight(),t=Math.max(w,$),E=Math.min(1,oN.config.imageSize/t);t<3&&(E=oN.config.imageSize/t),w=Math.floor(w*E),$=Math.floor($*E);return M.toCanvas(M.dm().getBackground(),w,$).toDataURL("image/png",1)}if(!(ht.ui&&M instanceof ht.ui.ContextMenu)){if(ht.ui&&M&&M.getStyle&&M.getLayoutParams){var J=M.getWidth(),u=M.getHeight(),g=ht.Default.devicePixelRatio,S=J,b=u,h=Math.max(S,b),y=Math.min(1,oN.config.imageSize/h);h<3&&(y=oN.config.imageSize/h),S=Math.floor(S*y),b=Math.floor(b*y);var P=M.getRootCanvas&&M.getRootCanvas(),f=(P||M.getView()).getBoundingClientRect(),x=document.createElement("canvas");x.width=S,x.height=b;var n=x.getContext("2d"),R=function(q){for(var N=0;N<q.size();N++){var e=q.get(N);if(e===M)P&&n.drawImage(P,0,0,P.width,P.height,0,0,S,b);else{var X=e.getRootCanvas&&e.getRootCanvas();if(X&&X.width>0&&X.height>0){var w=X.getBoundingClientRect();n.drawImage(X,0,0,X.width,X.height,(w.left-f.left)*y,(w.top-f.top)*y,X.width*y/g,X.height*y/g)}}if(e instanceof ht.ui.UIGraphView||e instanceof ht.ui.UIGraph3dView||e instanceof ht.ui.UIVectorView){var $=e.getContent(),t=$.toCanvas();if(t&&t.width>0&&t.height>0){var E=$._canvas.getBoundingClientRect();n.drawImage(t,0,0,t.width,t.height,(E.left-f.left)*y,(E.top-f.top)*y,t.width*y/g,t.height*y/g)}}e.getChildren&&e.getChildren().size()>0&&R(e.getChildren())}},G=new ht.List;return G.add(M),R(G),x.toDataURL("image/png",1)}var j=ht.Default.getImage(M),K=Math.max(j.width,j.height),p=Math.min(1,oN.config.imageSize/K);return ht.Default.toCanvas(M,j.width*p,j.height*p).toDataURL("image/png",1)}var x=M.getView().children[0];if(x&&x instanceof HTMLCanvasElement){var C=x.width,m=x.height,O=Math.max(C,m),Q=Math.min(1,oN.config.imageSize/O);O<3&&(Q=oN.config.imageSize/O),C=Math.floor(C*Q),m=Math.floor(m*Q);var s=document.createElement("canvas");s.width=C,s.height=m;var n=s.getContext("2d");return n.drawImage(x,0,0,x.width,x.height,0,0,C,m),s.toDataURL("image/png",1)}}function fq(M,q,N){if(M instanceof Array)for(var e=0,X=M.length;e<X;e++)fq(M[e],q,N);else if(M instanceof Object&&!(M instanceof ht.DataModel))for(var w in M)if(M.hasOwnProperty(w)){var $=M[w];if(!mM($))continue;if(kN($.func)&&BN.test($.func)){var t=$.func.slice(5);M.prefix&&(t=M.prefix+"."+t),q&&void 0===q[t]&&(q[t]=w),N&&void 0===N[t]&&(N[t]=$.value)}else fq($,q,N)}}function xq(M){return new(ht.Default.getClass(oN.config.codeEditorClass)||vN)(M)}function nq(){var M=arguments[0];if(!M)return"";for(var q=1;q<arguments.length;q++)M=M.replace("{"+(q-1)+"}",arguments[q]);return M}function Rq(M,q,N){var e=new ht.Math.Matrix2d,X=M.getPosition(),w=M.getScale(),$=M.getRotation();return e.translate(-X.x,-X.y).scale(w.x,w.y).rotate($).translate(X.x,X.y),e.apply({x:q,y:N})}function Gq(M){M.forEach(function(M){var q=void 0,N=M.getSegments();if(N){var e=[],X=N.size();q=0;var w=void 0,$=0,t=void 0;for(w=X-1;w>=0;w--)t=N.get(w),$?1===t?(e.push($),$=0):5===$?e.push(t):(e.push($),$=t):(e.push(1),$=t),5!==t&&(q+=t-1||1);M.setSegments(e)}var E=M.toPoints();CM(q)&&(E=E.slice(0,q)),E.reverse(),M.setPoints(E)})}function jq(M,q){for(var N=0,e=M.length;N<e;N++){var X=M.get(N);if(!(X instanceof ht.Shape))return!1;if(!q&&X instanceof ht.CSGShape)return!1}return!0}function Kq(M,q){var N=void 0,e=void 0,X=void 0,w=void 0,$=void 0,t=void 0,E=[],J=[],u=void 0;if(M.forEach(function(M){u||(u=M.getClass());var g=M.getPoints().toArray().map(function(q){return Rq(M,q.x,q.y)});E=E.concat(g);var S=M.getSegments();if(S)S=S.toArray();else{S=[1];for(var b=1,h=M.getPoints().size();b<h;b++)S.push(2)}M.isClosePath()&&S.push(5),q&&J.length>0&&5!=J[J.length-1]&&(S[0]=2),J=J.concat(S),N||(N=M.dm(),e=M.getThickness(),X=M.getElevation(),w=M.getTall(),$=VN(M.getStyleMap()),t=VN(M.getAnchor3d())),M.removeFromDataModel()}),u){var g=new u;g.setPoints(E),g.setSegments(J),g.setThickness(e),g.setElevation(X),g.setTall(w),g.setAnchor3d(t),g.s($),N.add(g),N.sm().ss(g)}}function pq(M){var q=M.dm(),N=M.getSegments();if(N){var e=[],X=M.getPoints(),w=M.getPointsMatrix2d(),$=void 0,t=void 0,E=0;N.forEach(function(M){switch(M){case 1:$=[M],t=[w.apply(X.get(E++))],e.push({segments:$,points:t});break;case 2:$.push(M),t.push(w.apply(X.get(E++)));break;case 3:$.push(M),t.push(w.apply(X.get(E++))),t.push(w.apply(X.get(E++)));break;case 4:$.push(M),t.push(w.apply(X.get(E++))),t.push(w.apply(X.get(E++))),t.push(w.apply(X.get(E++)));break;case 5:$.push(M)}});var J=M.getThickness(),u=M.getElevation(),g=M.getTall(),S=VN(M.getStyleMap()),b=VN(M.getAnchor3d()),h=[];e.forEach(function(N){var e=new(M.getClass());e.setPoints(N.points),e.setSegments(N.segments),e.setThickness(J),e.setElevation(u),e.setTall(g),e.setAnchor3d(b),e.s(S),q.add(e),h.push(e)}),q.sm().ss(h),M.removeFromDataModel()}}function Cq(M){var q=this,N=function(){return!!q.editable&&(!q.g3d||!q.currentView.isShadowBoundingEditing())};M.push({separator:!0,visible:function(){return N()&&q.ld instanceof ht.Shape}}),M.push({id:"combined",label:e("editor.combineshapes"),action:function(){q.beginTransaction(),$e(q.sm.getSelection().toArray(),!1,!!q.g3d),q.endTransaction()},visible:function(){return N()&&q.sm.size()>1&&jq(q.sm.getSelection())}}),M.push({id:"combineIntoContinuous",label:e("editor.combineintocontinuousshape"),action:function(){q.beginTransaction(),$e(q.sm.getSelection().toArray(),!0,!!q.g3d),q.endTransaction()},visible:function(){return N()&&q.sm.size()>1&&jq(q.sm.getSelection())}}),M.push({id:"splitShape",label:e("editor.splitshape"),action:function(){q.beginTransaction(),te(q.ld,!!q.g3d),q.endTransaction()},visible:function(){return N()&&1===q.sm.size()&&q.ld instanceof ht.Shape&&!(q.ld instanceof ht.CSGShape)}}),M.push({id:"reverse",label:e("editor.reverseshapes"),action:function(){q.beginTransaction(),Gq(q.sm.getSelection().toArray()),q.endTransaction()},visible:function(){return N()&&q.sm.size()>0&&jq(q.sm.getSelection(),!0)}})}function mq(M,q,N,e){var X=M.getRowIndex(q),w=M.tx(),$=M.ty(),t=M.getRowHeight(),E={x:w,y:t*X+$,width:N.getWidth(),height:t};M.beginEditing({column:N,data:q,view:M,editorRect:E,value:e})}function Oq(M,q){M.vectorDataBindingDisabled=!0,M.enableToolTip(),M.getToolTip=function(){var M=ht.Default.getImage(this.getIcon()),q=ht.Default.getInternal().getImageWidth(M),N=ht.Default.getInternal().getImageHeight(M);return q&&N?q+", "+N:void 0},M.setExtraInfo=function(q){var N=q&&q.url||q;M.actionURL=q&&q.actionURL||q,M.setIconColor(q&&q.iconColor||void 0);var e=ht.Default.getImage(N);e&&e.snapshotURL?M.setIcon(e.snapshotURL):e&&e.texture?M.setIcon(e.image):M.setIcon(N)};var N=M.getView();N.style.cursor="pointer";var e=function(N){N.preventDefault(),K(N)?q.open(M.actionURL):q.selectFileNode(M.actionURL)};N.addEventListener("mousedown",e,!1),N.addEventListener("touchstart",e,!1)}function Qq(M,q,N){var e=M.getElement?M.getElement():M.getView?M.getView():M,X=void 0;M.isDroppable=q,M.handleCrossDrag=function(q,w,$){"enter"===w?(X=e.style.border,e.style.border="solid "+oN.config.color_select_dark+" 2px"):"exit"===w||"cancel"===w?e.style.border=X:"over"===w||"drop"===w&&(N($.view.draggingData),e.style.border=X,M.setFocus&&M.setFocus())}}function sq(M,q){for(var N=q.getParent();N;)q=N,N=q.getParent();return M.getRoots().indexOf(q)}function lq(M,q){return M.indexOf(q)>=0}function Yq(M,q){var N=q.getWidth(),e=q.getHeight(),X=Math.min(N,e),w=new ht.Math.Vector2(q.getAnchor()),$=(new ht.Math.Matrix2d).scale(-N,-e).apply(w);$.add(q.p());var t=q.getScale(),E=new ht.Math.Matrix2d(q.getRotation(),$.x,$.y,t.x*N,t.y*e),J=M[0];if("L"===J){var u=(new ht.Math.Matrix2d).fromArray(M.slice(5,11)),g=u.tf(M[1],M[2]),S=u.tf(M[3],M[4]);g=E.tfi(g),S=E.tfi(S);var b=["linear",g.x,g.y,S.x,S.y];return b.push.apply(b,M.slice(11)),b}if("R"===J){var h=(new ht.Math.Matrix2d).fromArray(M.slice(7,13)),y=h.tf(M[1],M[2]),P=h.tf(M[4],M[5]);if((new ht.Math.Vector2).subVectors(y,P).length()>1e-5)return M;var f=h.clone().translate(-h.tx,-h.ty),x=M[3]/X;y=E.tfi(y);var n=M[6]/X;P=E.tfi(P);var R=["radial",y.x,y.y,x,P.x,P.y,n];return R.push.apply(R,f.toArray()),R.push.apply(R,M.slice(13)),R}return M}function Iq(M,q,N){if(M.save(),kN(q)&&"["===q[0]&&(q=JSON.parse(q)),_N(q)){var e=N.x,X=N.y,w=N.width,$=N.height,t="linear"===q[0],E=q.length,J=void 0,u=t?5:4;if(t)J=M.createLinearGradient(e+w*q[1],X+$*q[2],e+w*q[3],X+$*q[4]);else{var g=e+w*q[1],S=X+$*q[2],b=Math.min(w,$),h=b*q[3];if(kN(q[5]))J=M.createRadialGradient(g,S,0,g,S,h),u=4;else{var y=(new ht.Math.Matrix2d).fromArray(q.slice(7,13));y.translate(g,S),M.transform.apply(M,y.toArray());var P=q[4]*w+e-g,f=q[5]*$+X-S,x=q[6]*b;J=M.createRadialGradient(0,0,h,P,f,x),u=13}}for(;u<E;)J.addColorStop(q[u++],q[u++]);return J}return q}function rq(M,q){var N=arguments.length>2&&void 0!==arguments[2]?arguments[2]:4,e=arguments.length>3&&void 0!==arguments[3]&&arguments[3],X=q.x,w=q.y,$=q.width,t=q.height;e&&(M.save(),M.beginPath(),M.rect(X,w,$,t),M.clip());var E=X+$,J=w+t,u=X,g=w;M.beginPath();for(var S=0;g<J;g+=N){for(u=S%2?X+N:X;u<E;u+=2*N)M.rect(u,g,N,N);S++}M.fillStyle="rgb(204,204,204)",M.fill(),e&&M.restore()}function dq(M){if(CM(M))return[M,M,M,M];if(!M||!M.length)return[0,0,0,0];var q=void 0,N=void 0,e=void 0,X=void 0;return 1===M.length?q=N=e=X=M[0]:2===M.length?(q=e=M[0],N=X=M[1]):3===M.length?(q=M[0],N=X=M[1],e=M[2]):(q=M[0],N=M[1],e=M[2],X=M[3]),[q,N,e,X]}function aq(M){if(!_N(M))return!1;var q=M[0];return!!q&&(1===q.length||"linear"===q||"radial"===q)}function Dq(M){var q={clazz:this.getClass(),name:this.getName(),displayName:this.getDisplayName(),toolTip:this.getToolTip(),tag:this.getTag(),icon:this.getIcon(),layer:this.getLayer(),parent:M.$57$(this.getParent()),a:{},s:{},dataBindings:this.getDataBindings()?d(this.getDataBindings(),null,!1):null},N=this.getStyleMap();for(var e in N)q.s[e]=VN(this.s(e));var X=this.getAttrObject();for(var w in X)q.a[w]=VN(this.a(w));return q}function Wq(M,q){var N=new M.clazz,e=q.dm();if(oN.config.cloneName&&N.setName(M.name),oN.config.cloneDisplayName&&N.setDisplayName(M.displayName),oN.config.cloneToolTip&&N.setToolTip(M.toolTip),oN.config.cloneTag&&!e.getDataByTag(M.tag)&&N.setTag(M.tag),oN.config.cloneIcon&&N.setIcon(M.icon),oN.config.cloneLayer&&N.setLayer(M.layer),oN.config.cloneStyle)for(var X in M.s)N.s(X,VN(M.s[X]));if(oN.config.cloneAttr)for(var w in M.a)N.a(w,VN(M.a[w]));return oN.config.cloneDataBindings&&M.dataBindings&&N.setDataBindings(a(M.dataBindings)),N}function vq(M,q,N){var e=oN.config.cloneParent?q.$49$(M.parent,N):void 0;this.setParent(e||q.getCurrentSubGraph())}function oq(M){var q=Dq.call(this,M);return q.r3=this.r3(),q.rotationMode=this.getRotationMode(),q.p3=this.p3(),q.s3=this.s3(),q.scale3d=this.getScale3d(),q.anchor3d=this.getAnchor3d(),q.image=this.getImage(),q.host=M.$57$(this.getHost()),q.renderLayer=this.getRenderLayer(),q}function Hq(M,q){var N=Wq(M,q);return N.setRenderLayer(M.renderLayer),oN.config.cloneRotation&&(N.r3(M.r3),N.setRotationMode(M.rotationMode)),oN.config.clonePosition&&N.p3(M.p3),oN.config.cloneSize&&N.s3(M.s3),oN.config.cloneScale&&N.setScale3d(M.scale3d),oN.config.cloneAnchor&&N.setAnchor3d(M.anchor3d),oN.config.cloneImage&&N.setImage(M.image),N}function Uq(M,q,N){vq.call(this,M,q,N),oN.config.cloneHost&&this.setHost(q.$49$(M.host,N))}function Vq(M){var q=Dq.call(this,M);return q.source=M.$57$(this.getSource()),q.target=M.$57$(this.getTarget()),q}function Tq(M,q){return Wq(M,q)}function _q(M,q,N){vq.call(this,M,q,N),oN.config.cloneSource&&this.setSource(q.$49$(M.source,N)),oN.config.cloneTarget&&this.setTarget(q.$49$(M.target,N))}function kq(M){var q=oq.call(this,M);return q.expanded=this.isExpanded(),q}function Zq(M,q){var N=Hq(M,q);return oN.config.cloneExpanded&&N.setExpanded(M.expanded),N}function zq(M){var q=oq.call(this,M);return q.points=VN(this.getPoints()),q.segments=VN(this.getSegments()),q.thickness=this.getThickness(),q.closePath=this.isClosePath(),q}function Aq(M,q){var N=Hq(M,q);return oN.config.clonePoints&&N.setPoints(VN(M.points)),oN.config.cloneSegments&&N.setSegments(VN(M.segments)),oN.config.cloneThickness&&N.setThickness(M.thickness),oN.config.cloneClosePath&&N.setClosePath(M.closePath),N}function cq(M){var q=oq.call(this,M);return q.clickThroughEnabled=this.isClickThroughEnabled(),q.syncSize=this.isSyncSize(),q.scaleMode=this.getScaleMode(),q}function Bq(M,q){var N=Hq(M,q);return oN.config.cloneClickThroughEnabled&&N.setClickThroughEnabled(M.clickThroughEnabled),oN.config.cloneSyncSize&&N.setSyncSize(M.syncSize),q.editView.sceneView&&N.setScaleMode(M.scaleMode),N}function Lq(M){var q=cq.call(this,M);return q.ref=this.getRef(),q}function iq(M,q){var N=Bq(M,q);return oN.config.cloneRef&&N.setRef(M.ref),N}function Fq(M){var q=oq.call(this,M);return q.points=VN(this.getPoints()),q.colors=VN(this.getColors()),q.sizes=VN(this.getSizes()),q.uvoffsets=VN(this.getUvoffsets()),q}function MN(M,q){var N=Hq(M,q);if(N instanceof ht.Points)M.points&&N.setPoints(VN(M.points)),M.colors&&N.setColors(VN(M.colors)),M.sizes&&N.setSizes(VN(M.sizes)),M.uvoffsets&&N.setUvoffsets(VN(M.uvoffsets));else{var e=N.getStyleMap()
;for(var X in e)0===X.indexOf("points")&&N.s(X,void 0)}return N}function qN(M){if(!(M instanceof ht.Node))return null;if(M instanceof ht.Group||M instanceof ht.Grid||M instanceof ht.Block)return null;var q=void 0;if(M instanceof ye)q=ye.prototype.toJSON.call(M),q.type="clip";else if(M instanceof Pe)q=Pe.prototype.toJSON.call(M),q.type="restore";else if(M instanceof ht.Shape)q=Se.prototype.toJSON.call(M),q.type="shape";else if(M instanceof ht.Text)q=he.prototype.toJSON.call(M),q.type="text";else if(M instanceof ht.Node){var N=M.s("shape");N?(q=ge.prototype.toJSON.call(M),q.shape=q.type,q.type="node_shape"):M.getImage()&&(q=be.prototype.toJSON.call(M),q.type="node_image",q.image=M.getImage())}return q}function NN(M,q,N){var e=void 0;if("clip"===M.type)q&&(e=new ye(M));else if("restore"===M.type)q&&(e=new Pe(M));else if("shape"===M.type)e=q?new Se:new ht.Shape,Se.prototype.parse.call(e,M);else if("node_shape"===M.type)e=q?new ge:new ht.Node,M.type=M.shape,ge.prototype.parse.call(e,M),M.type="node_shape";else if("node_image"===M.type)if(q&&kN(M.image)&&M.image.startsWith(cN)){e=new fe;var X=M.image,w=X.replace(cN+".",""),$=["lineChart","areaChart","barChart","bubbleChart","columnChart","dotChart","stackedAreaChart","stackedBarChart","stackedColumnChart","stackedLineChart","waterFallChart"];$.indexOf(w)>=0?X=cN+".chart":"rose"===w&&(X=cN+".pie"),e.parse(Object.assign({},M,{type:X},N));var t=ht.Default.getCompType(X);if(t.events)for(var E in t.events)e.a(E,t.events[E])}else e=q?new be:new ht.Node,M.type="image",be.prototype.parse.call(e,M),M.type="node_image",e.s("image",M.image),e.setImage(M.image);else"text"===M.type&&(e=q?new he:new ht.Text,he.prototype.parse.call(e,M));return e}function eN(M){return NN(qN(M),!0)}function XN(M,q,N){N.style.cursor="ew-resize";var e=N.innerHTML.charAt(0),X=q.querySelector("input.color_"+e),w=function(q){q.preventDefault();var N=("A"===e?parseFloat(X.value):parseInt(X.value))||0,w=ht.Default.getClientPoint(q).x,$=function(q){q.preventDefault();var $=ht.Default.getClientPoint(q).x-w,t=void 0;"A"===e?(t=N+.01*$,t>1&&(t=1),t<0&&(t=0),X.value=t.toFixed(2)):(t=N+1*$,t>255&&(t=255),t<0&&(t=0),X.value=t),M.updateInputChange()};window.addEventListener("mousemove",$,!1),window.addEventListener("touchmove",$,!1);var t=function(M){M.preventDefault(),window.removeEventListener("mousemove",$,!1),window.removeEventListener("touchmove",$,!1),window.removeEventListener("mouseup",t,!1),window.removeEventListener("touchend",t,!1)};window.addEventListener("mouseup",t,!1),window.addEventListener("touchend",t,!1)};N.addEventListener("mousedown",w,!1),N.addEventListener("touchstart",w,!1)}function wN(M,q,N,e){for(var X=M.getDataUI(q),w=X.interactiveInfo.bodyInfo.compInfos,$=void 0,t=0;t<w.length;t++)if(w[t].comp===N){$=w[t].rect;break}return{x:e.x+$.x,y:e.y+$.y}}function $N(M){if(!_N(M))return[];for(var q=[],N=M.length,e=M[0]===We?5:4;e<N;)q.push({stop:M[e++],color:M[e++]});return q}function tN(M,q,N){var e,X,w;if(0==N)e=0,X=0,w=0;else{var $=Math.floor(6*M),t=6*M-$,E=N*(1-q),J=N*(1-q*t),u=N*(1-q*(1-t));switch($){case 1:e=J,X=N,w=E;break;case 2:e=E,X=N,w=u;break;case 3:e=E,X=J,w=N;break;case 4:e=u,X=E,w=N;break;case 5:e=N,X=E,w=J;break;case 6:case 0:e=N,X=u,w=E}}return[Math.round(255*e),Math.round(255*X),Math.round(255*w)]}function EN(M,q,N){M/=255,q/=255,N/=255;var e,X,w=Math.max(Math.max(M,q),N),$=Math.min(Math.min(M,q),N),t=w;if($==w)e=0,X=0;else{var E=w-$;X=E/w,e=M==w?(q-N)/E:q==w?2+(N-M)/E:4+(M-q)/E,e/=6,e<0&&(e+=1),e>1&&(e-=1)}return[e,X,t]}function JN(M,q){var N=Ve(M),e=EN(N[0],N[1],N[2]);return e[0]=q/360,"rgba("+tN.apply(void 0,e).join(",")+", "+(N[3]/255).toFixed(2)+")"}function uN(M,q,N){var e=Ve(M),X=EN(e[0],e[1],e[2]);return X[1]=q/100,X[2]=N/100,"rgba("+tN.apply(void 0,X).join(",")+", "+(e[3]/255).toFixed(2)+")"}function gN(M,q,N){var e=M.x,X=M.y;return{x:e+q*M.width,y:X+N*M.height}}function SN(M,q,N,e,X){var w=q.x,$=q.y,t=q.width,E=q.height,J=12,u=12,g=w+t*e,S=2*Math.PI;if(null!=N){var b=null!=wX.hover&&wX.hover.index===N||wX.isActive(N);b&&(J=u=14);var h={x:g-J/2,y:$+(E-u)/2,width:J,height:u};M.save(),M.shadowColor="rgba(0,0,0,0.45)",M.shadowBlur=2,M.beginPath(),M.arc(h.x+J/2,$+E/2,u/2,0,S),M.fillStyle="#fff",M.fill(),M.strokeStyle="#999999",M.stroke(),M.restore(),M.save(),M.beginPath(),M.arc(h.x+J/2,E/2+$,(u-2)/2,0,S),M.clip(),M.lineWidth=1,M.beginPath(),M.arc(h.x+J/2,E/2+$,(u-2)/2,0,S),M.fillStyle="#fff",M.fill(),rq(M,h),M.fillStyle=X,M.fillRect(h.x,h.y,h.width,h.height),M.restore(),M.beginPath(),M.moveTo(g,h.y+h.height+2),M.lineTo(g+3,h.y+h.height+8),M.lineTo(g-3,h.y+h.height+8),M.closePath(),M.fillStyle=b?Ae:"#ccc",M.fill(),(null!=wX.hover&&wX.hover.index===N||wX.isActive(N))&&(M.beginPath(),M.arc(h.x+J/2,E/2+$,(u+1)/2,0,S),M.lineWidth=1,M.strokeStyle=Ae,M.stroke());var y=MX(h);return qX(y,3),y}var P={x:g-8-2,y:$-2-8,width:8,height:8};M.save(),M.beginPath(),M.arc(g-4-2,$-4-2,4,0,S),M.clip(),M.lineWidth=1,M.beginPath(),rq(M,P),M.fillStyle=X,M.fillRect(P.x,P.y,P.width,P.height),M.restore(),M.beginPath(),M.arc(g-4-2,$-4-2,4,0,S),M.strokeStyle="#999999",M.stroke()}function bN(M){for(var q=wX.sliders.length,N=q-1;N>=0;N--){var e=wX.sliders[N];if(NX(e.rect,M))return e}}function hN(M){if(wX.hasActive()){var q=M.a("gradient"),N=$N(q);if(N.length<3)return;var e=wX.activeIndexs.slice(0);e.sort();for(var X=e[0],w=e.length-1;w>=0&&(N.splice(e[w],1),!(N.length<3));w--);-1===w&&(X=Math.max(0,X-1)),wX.setActive(X),q=q.slice(0,q[0]===We?5:4),N.forEach(function(M){q.push(M.stop),q.push(M.color)}),M.a("gradient",q)}}function yN(M,q){if(wX.hasActive()){var N=M.a("gradient"),e=$N(N);e[wX.getLastActive()].color=q,N=N.slice(0,N[0]===We?5:4),e.forEach(function(M){N.push(M.stop),N.push(M.color)}),M.a("gradient",N)}}function PN(M,q){var N=void 0,e=q?q.dm:null,X=e?e.a("width"):100,w=e?e.a("height"):100,$=zM(M.type);if(kN($)){var t=FX[$],E=ht.Default.getCompTypeMap();t?N=new t(M,X,w):(gM($)||E[$])&&(N=new fe(M,X,w))}else N=new AX(M,X,w);return N&&q&&q.addData(N,!0),N}function fN(M,q){M.s("chart.series")||M.s("chart.series",[]);var N=M.s("chart.series");N[0]||(N[0]={});var e=N[0];return e.values||(e.values=[]),e.colors||(e.colors=[]),e[q]}function xN(M,q){return zM(fN(M,q))}function nN(M,q){return AM(fN(M,q))}function RN(){var M=oN.config.customProperties.display;M&&M.length&&M.forEach(function(M){var q=(M.accessType||"a")+":"+M.property;Me.display[q]=!0}),M=oN.config.customProperties.data,M&&M.length&&M.forEach(function(M){var q=(M.accessType||"a")+":"+M.property;Me.data[q]=!0}),M=oN.config.customProperties.symbol,M&&M.length&&M.forEach(function(M){Me.symbol[M.property]=!0}),M=oN.config.customProperties.comp,M&&M.length&&M.forEach(function(M){Me.comp[M.property]=!0}),M=oN.config.customProperties.scene,M&&M.length&&M.forEach(function(M){var q=(M.accessType||"a")+":"+M.property;Me.scene[q]=!0}),(M=oN.config.customProperties.data3d)&&M.length&&M.forEach(function(M){var q=(M.accessType||"a")+":"+M.property;Me.data3d[q]=!0})}function GN(){var M=oN.config,q=oN.consts,N=function(q,N){void 0===M.valueTypes[q]&&(N.name="editor.valuetype."+q.toLowerCase(),M.valueTypes[q]=N)};N("String",{type:"string"}),N("Image",{type:"image"}),N("URL",{type:"url"}),N("Multiline",{type:"multiline"}),N("Font",{type:"font"}),N("Angle",{type:"number",angle:!0}),N("Int",{type:"int",step:1}),N("PositiveNumber",{type:"number",step:1,min:0}),N("Number",{type:"number",step:1}),N("Color",{type:"color"}),N("GradientPack",{type:"gradientPack"}),oN.SceneView&&N("DataModel",{type:"dataModel"}),N("Boolean",{type:"boolean"}),N("Function",{type:"function"}),N("Object",{type:"object"}),N("ObjectArray",{type:"objectArray",rowHeight:60}),N("StringArray",{type:"stringArray",rowHeight:60}),N("NumberArray",{type:"numberArray",rowHeight:60}),N("DashPattern",{type:"numberArray"}),N("CornerRadius",{type:"numberArray",step:1}),N("ColorArray",{type:"colorArray",rowHeight:60}),N("GradientPackArray",{type:"gradientPackArray",rowHeight:60}),N("Opacity",{type:"number",min:0,max:1,step:.01}),N("Percentage",{type:"number",min:0,max:1,step:.01}),N("Gradient",{type:"enum",values:M.gradients,icons:M.gradientIcons,dropDownWidth:140}),N("FillRule",{type:"enum",values:q.fillRules,labels:q.fillRuleLabels}),N("ClipDirection",{type:"enum",values:q.clipDirections,labels:q.clipDirectionLabels}),N("CapStyle",{type:"enum",values:q.caps,labels:q.capLabels}),N("JoinStyle",{type:"enum",values:q.joins,labels:q.joinLabels}),N("Align",{type:"enum",values:q.aligns,labels:q.alignLabels}),N("VAlign",{type:"enum",values:q.vAligns,labels:q.vAlignLabels}),N("Stretch",{type:"enum",values:q.stretchs,labels:q.stretchLabels}),N("Direction",{type:"enum",values:q.directions,labels:q.directionLabels}),N("Orientation",{type:"enum",values:q.orientations,labels:q.orientationLabels}),N("ColumnChart",{type:"enum",values:q.columnChartTypes,labels:q.columnChartTypeLabels}),q.valueTypes=[],q.valueTypeLabels=[];for(var X in oN.config.valueTypes)!function(M){var N=oN.config.valueTypes[M];N.type&&(q.valueTypes.push(M),q.valueTypeLabels.push(e(N.name)||e(M)),"enum"===N.type&&N.i18nLabels&&!N.labels&&(N.labels=[],N.i18nLabels.forEach(function(M){N.labels.push(e(M))})))}(X)}function jN(){var M=oN.consts={};M.edgeTypes=oN.config.edgeTypes,M.edgeTypeLabels=oN.config.edgeTypes.map(function(M){var q=e("edgeType."+M,!0);return q||M}),M.aligns=["left","center","right"],M.alignLabels=[e("editor.align.left"),e("editor.align.center"),e("editor.align.right")],M.vAligns=["top","middle","bottom"],M.vAlignLabels=[e("editor.valign.top"),e("editor.valign.middle"),e("editor.valign.bottom")],M.stretchs=["fill","uniform","centerUniform"],M.stretchLabels=[e("editor.stretch.fill"),e("editor.stretch.uniform"),e("editor.stretch.centeruniform")],M.fillRules=["nonzero","evenodd"],M.fillRuleLabels=[e("editor.nonzero"),e("editor.evenodd")],M.clipDirections=["top","bottom","left","right"],M.clipDirectionLabels=[e("editor.clipdirection.top"),e("editor.clipdirection.bottom"),e("editor.clipdirection.left"),e("editor.clipdirection.right")],M.caps=["butt","round","square"],M.capLabels=[e("editor.cap.butt"),e("editor.cap.round"),e("editor.cap.square")],M.joins=["bevel","round","miter"],M.joinLabels=[e("editor.join.bevel"),e("editor.join.round"),e("editor.join.miter")],M.directions=["h","v"],M.directionLabels=[e("editor.direction.h"),e("editor.direction.v")],M.orientations=["top","right","bottom","left"],M.orientationLabels=[e("editor.orientation.top"),e("editor.orientation.right"),e("editor.orientation.bottom"),e("editor.orientation.left")],M.columnChartTypes=["columnChart","stackedColumnChart","percentageColumnChart"],M.columnChartTypeLabels=[e("editor.columncharttype.columnchart"),e("editor.columncharttype.stackedcolumnchart"),e("editor.columncharttype.percentagecolumnchart")],M.gradients=oN.config.gradients,M.shapes=[void 0,"rect","circle","oval","roundRect","star","nStar","pentagram","triangle","hexagon","pentagon","diamond","rightTriangle","parallelogram","trapezoid","polygon","arc"],M.shapeLabels=[],M.shapeIcons=[],M.shapes.forEach(function(q){q?(M.shapeLabels.push(e("editor.comptype."+q.toLowerCase())),M.shapeIcons.push({width:16,height:16,comps:[{type:q,rect:[2,4,12,8],borderWidth:1,borderColor:oN.config.color_dark}]})):(M.shapeLabels.push(""),M.shapeIcons.push({width:16,height:16,comps:[]}))}),M.selectTypes=["shadow","rect","circle","oval","roundRect"],M.selectTypeLabels=[],M.selectTypeIcons=[],M.selectTypes.forEach(function(q){"shadow"===q?(M.selectTypeLabels.push(e("editor.shadow")),M.selectTypeIcons.push({width:16,height:16,comps:[]})):(M.selectTypeLabels.push(e("editor.comptype."+q.toLowerCase())),M.selectTypeIcons.push({width:16,height:16,comps:[{type:q,rect:[2,4,12,8],borderWidth:1,borderColor:oN.config.color_dark}]}))}),M.displayConnectActionTypes=oN.config.displayConnectActionTypes,M.displayConnectActionTypeLabels=[],M.displayConnectActionTypes.forEach(function(q){var N=q?q.toLowerCase():"none";M.displayConnectActionTypeLabels.push(e("editor.connectactiontype."+N,!0)||e(q))}),M.symbolConnectActionTypes=oN.config.symbolConnectActionTypes,M.symbolConnectActionTypeLabels=[],M.symbolConnectActionTypes.forEach(function(q){var N=q?q.toLowerCase():"none";M.symbolConnectActionTypeLabels.push(e("editor.connectactiontype."+N,!0)||e(q))}),M.vLayoutValues=[void 0,"top","bottom","topbottom","center","scale"],M.vLayoutLabels=[e("editor.layout.none"),e("editor.layout.top"),e("editor.layout.bottom"),e("editor.layout.topbottom"),e("editor.layout.center"),e("editor.layout.scale")],M.hLayoutValues=[void 0,"left","right","leftright","center","scale"],M.hLayoutLabels=[e("editor.layout.none"),e("editor.layout.left"),e("editor.layout.right"),e("editor.layout.leftright"),e("editor.layout.center"),e("editor.layout.scale")],M.fullscreenValues=[void 0,"fill","uniform"],M.fullscreenLabels=[e("editor.layout.none"),e("editor.stretch.fill"),e("editor.stretch.uniform")],M.fullscreenLockValues=[!1,"h","v"],M.fullscreenLockLabels=[e("editor.layout.none"),e("editor.direction.h"),e("editor.direction.v")],M.textDecorationValues=[void 0,"overline","strikethrough","underline"],M.textDecorationLabels=[e("editor.none"),e("editor.overline"),e("editor.line.through"),e("editor.underline")]}String.prototype.startsWith||(String.prototype.startsWith=function(M,q){return q=q||0,this.substr(q,M.length)===M}),String.prototype.endsWith||(String.prototype.endsWith=function(M,q){var N=this.toString();("number"!=typeof q||!isFinite(q)||Math.floor(q)!==q||q>N.length)&&(q=N.length),q-=M.length;var e=N.lastIndexOf(M,q);return-1!==e&&e===q});var KN=window.hteditor_config||{},pN=function(M,q){void 0===KN[M]&&(KN[M]=q)};pN("color_select","#45C4F9"),pN("color_select_dark","#39B0E4"),pN("color_pane","#FFFFFF"),pN("color_pane_dark","#F7F7F7"),pN("color_line","#E4E4E4"),pN("color_dark","#2C2C2C"),pN("color_light","white"),pN("color_data_border","#979797"),pN("color_data_background","#D8D8D8"),pN("color_transparent","rgba(156,156,156,0.4)"),pN("color_disabled","#8C8C8C"),pN("color_guide","red"),pN("color_hover","rgba(184,184,184,0.18)"),pN("color_mask","rgba(84,110,125,0.30)");var CN=function(){var M=navigator.userAgent;return M.indexOf("compatible")>-1&&M.indexOf("MSIE")>-1||M.indexOf("Trident")>-1&&M.indexOf("rv:11.0")>-1}();if(pN("logEditorInfo",!0),pN("host",window.location.hostname),pN("port",window.location.port),pN("locale","en"),pN("serviceClass",void 0),pN("maxUndoRedoSteps",200),pN("inspectorTitleHeight",void 0),pN("inspectorTitleBackground",void 0),pN("smallFont","10px arial, sans-serif"),pN("boldFont","bold 12px arial, sans-serif"),pN("leftSplitViewPosition",240),pN("rightSplitViewPosition",-300),pN("mainSplitViewPosition",-360),pN("explorerSplitViewPosition",.4),pN("requestDelay",100),pN("imageSize",256),pN("fileSize",50),pN("maxFileSize",200),pN("dragImageSize",50),pN("dragImageOpacity",.7),pN("animate",!0),pN("fitPadding",20),pN("fitContentForDisplayView",!0),pN("fitContentForSymbolView",!0),pN("rulerSize",16),pN("edgeLoop",!0),pN("pasteOffset",0),pN("pasteToLastSelectedIndex",!1),pN("continuousLayout",!0),pN("maxZoom",50),pN("minZoom",.01),pN("detailFilter",{}),pN("compactFilter",{}),pN("customProperties",{}),pN("displayRulerEnabled",!0),pN("displayGridEnabled",!1),pN("displayGridBlockSize",40),pN("displayGridThickLinesEvery",10),pN("displayGridThickColor","rgb(191, 191, 191)"),pN("displayGridLightColor","rgba(191, 191, 191, 0.4)"),pN("displayGridAngle",Math.PI/2),pN("displayGridRotation",0),pN("displayGridZoomThreshold",.25),pN("displayGridAlignmentGuideColor",KN.color_guide),pN("displayGridAlignmentGuideEnabled",!0),pN("displayAnchorEnabled",!0),pN("displayGuideLineEnabled",!0),pN("displayHighlightEnabled",!0),pN("displayHighlightColor",KN.color_select),pN("displayHighlightBorderWidth",1),pN("displayHighlightBorderPattern",[1,4]),pN("symbolRulerEnabled",!0),pN("symbolGridEnabled",!1),pN("symbolGridBlockSize",1),pN("symbolGridThickLinesEvery",20),pN("symbolGridThickColor","rgb(191, 191, 191)"),pN("symbolGridLightColor","rgba(191, 191, 191, 0.2)"),pN("symbolGridAngle",Math.PI/2),pN("symbolGridRotation",0),pN("symbolGridZoomThreshold",.25),pN("symbolGridAlignmentGuideColor",KN.color_guide),pN("symbolGridAlignmentGuideEnabled",!0),pN("symbolAnchorEnabled",!0),pN("symbolGuideLineEnabled",!0),pN("symbolHighlightEnabled",!0),pN("symbolHighlightColor",KN.color_select),pN("symbolHighlightBorderWidth",1),pN("symbolHighlightBorderPattern",[1,4]),pN("maxStringLength",1e6),pN("maxFileNameLength",100),pN("traceMissingI18n",!1),pN("container",void 0),pN("continuousCreating",!1),pN("valueTypes",{}),pN("indent",94),pN("indent2",68),pN("clearDataBindingsBeforeImporting",!0),pN("insertDisplayViewAsRefGraph",!1),pN("displayPreviewURL","display.html"),pN("symbolPreviewURL","symbol.html"),pN("removeFileByKeyboardEnabled",!1),pN("locateFileEnabled",!0),pN("promptBeforeClosing",!0),pN("displaysVisible",!0),pN("symbolsVisible",!0),pN("componentsVisible",!0),pN("scenesVisible",!1),pN("modelsVisible",!1),pN("uisVisible",!1),pN("assetsVisible",!0),pN("displaysEditable",!0),pN("symbolsEditable",!0),pN("componentsEditable",!0),pN("scenesEditable",!0),pN("modelsEditable",!0),pN("assetsEditable",!0),pN("settingDefaultValueBeforeSaving",!1),pN("svgSegments",20),pN("svgMinimumFontSize",12),pN("svgGatherTextSize",!1),pN("svgWaitingTime",600),pN("importConfirm",!0),pN("newIfFailToOpen",!0),pN("dataBindings",{}),pN("dataBindingsForSymbol",{}),pN("useCodeEditor",!CN),pN("codeEditorClass",void 0),pN("convertCodeEditorOption",void 0),pN("fontPreview","Hightopo"),pN("checkForFileChanges",!0),pN("checkForFileChangesInterval",3e3),pN("cloneAttr",!0),pN("cloneStyle",!0),pN("cloneName",!0),pN("cloneDisplayName",!0),pN("cloneToolTip",!0),pN("cloneTag",!0),pN("cloneIcon",!0),pN("cloneLayer",!0),pN("cloneParent",!0),pN("cloneDataBindings",!0),pN("cloneSource",!0),pN("cloneTarget",!0),pN("cloneExpanded",!0),pN("cloneClickThroughEnabled",!0),pN("cloneSyncSize",!0),pN("cloneRef",!0),pN("clonePoints",!0),pN("cloneSegments",!0),pN("cloneThickness",!0),pN("cloneClosePath",!0),pN("cloneRotation",!0),pN("clonePosition",!0),pN("cloneSize",!0),pN("cloneScale",!0),pN("cloneAnchor",!0),pN("cloneImage",!0),pN("cloneHost",!0),pN("isOpenable",null),pN("dialogTitleBackground",null),pN("componentViewSize",{width:900,height:600}),pN("eventViewSize",{width:600,height:600}),pN("fontViewSize",{width:500,height:400}),pN("functionViewSize",{width:700,height:600}),pN("objectViewSize",{width:500,height:400}),pN("textViewSize",{width:500,height:400}),pN("attachPointsViewSize",{width:700,height:500}),pN("drawAccordionTitle",null),pN("accordionMutex",!1),pN("importDataBindingsButtonVisible",!0),pN("saveSymbolCustomPropertyDefaultValue",!1),pN("saveCompCustomPropertyDefaultValue",!1),pN("deleteFileConfirm",!0),pN("mixMaskAndBackground",!0),pN("moveDummyThreshold",32),pN("smartGuideThreshold",8),pN("cadToDisplayBoundingType","Standard"),pN("cadToSymbolBoundingType","Reset"),pN("promptForMovingFile",!1),pN("displayTreeVisibleFunc",null),pN("symbolListVisibleFunc",null),pN("onElementCreated",null),pN("commonAndAdvancedFilterMode",!1),pN("edgeTypes",[void 0,"points","boundary","flex2","ortho2","h.v2","v.h2","extend.north2","extend.south2","extend.west2","extend.east2"]),pN("fileOpeners",{}),pN("paramHandlers",{}),pN("getToolTip",function(M,q){return null}),pN("createFileTreeSortFunc",function(M){var q=M.explorer.rootDir,N=q+"/ht",e=q+"/htdesign";return function(q,X){var w=q.url,$=X.url;return w===$?0:w===N?-1:$===N?1:w===e?-1:$===e?1:ht.Default.sortFunc(M.getLabel(q),M.getLabel(X))}}),pN("explorerMode","treeList"),pN("filterDisplayViewEnabled",!1),pN("filterSymbolViewEnabled",!1),pN("customAttachPointsColumns",null),pN("isCopyCompsWhenNewState",!0),pN("codeEditorTheme",null),pN("accordionListIndent",0),pN("copyFileByServer",!0),pN("isDataBound",function(M,q,N){var e=M.getDataBindings();return e&&e[q]&&e[q][N]}),pN("checkFileName",function(M,q){return!!M&&(!!(M=M.trim())&&(!/[!@?#$%^&*/|\\:"<>]/.test(M)&&M))}),pN("handleDefaultVauleColumnEdit",null),pN("paletteColors",[["rgb(51,153,255)","#60ACFC","#32D3EB","rgb(93,217,174)","rgb(125,195,125)","rgb(255,235,195)","rgb(226,250,87)"],["#FEB64D","#FF7C7C","rgb(241,125,164)","rgb(204,104,166)","rgb(135,144,204)","rgb(145,115,205)","rgb(124,145,155)"],["rgb(48,242,120)","rgb(0,199,7)","rgb(242,83,75)","rgb(212,0,0)","rgb(240,225,19)","rgb(247,247,247)","rgb(61,61,61)"]]),pN("customPaletteColorEnabled",!0),pN("linearPaletteColors",null),pN("radialPaletteColors",null),pN("gradients",[null,"linear.southwest","linear.southeast","linear.northwest","linear.northeast","linear.north","linear.south","linear.west","linear.east","radial.center","radial.southwest","radial.southeast","radial.northwest","radial.northeast","radial.north","radial.south","radial.west","radial.east","spread.horizontal","spread.vertical","spread.diagonal","spread.antidiagonal","spread.north","spread.south","spread.west","spread.east"]),KN.gradientIcons||(KN.gradientIcons=[],KN.gradients.forEach(function(M){M?KN.gradientIcons.push({width:20,height:14,comps:[{type:"rect",rect:[0,0,20,14],gradient:M,gradientColor:KN.color_line,background:KN.color_dark}]}):KN.gradientIcons.push({width:20,height:14,comps:[]})})),pN("fontList",["SimSun","NSimSun","FangSong","KaiTi","FangSong_GB2312","Microsoft YaHei","cursive","monospace","serif","sans-serif","fantasy","Arial","Arial Black","Arial Narrow","Arial Rounded MT Bold","Bookman Old Style","Bradley Hand ITC","Century","Century Gothic","Comic Sans MS","Courier","Courier New","Georgia","Gentium","Impact","King","Lucida Console","Lalit","Modena","Monotype Corsiva","Papyrus","Tahoma","TeX","Times","Times New Roman","Trebuchet MS","Verdana","Verona","PingFangSC-Thin"]),pN("ignoreFontDetection",!1),pN("symbolStateEnabled",!1),pN("layerEnabled",!0),pN("layoutEnabled",!0),pN("overviewEnabled",!0),pN("dataViewEnabled",!0),pN("gridAlignmentGuideEnabled",!1),pN("lineDashPatterns",[[16,16],[32,32],[16,16,4,16]]),pN("actionLabelDataBindingEnabled",!1),pN("filterDelay",500),pN("maxSafeInt",Math.pow(2,30)),pN("uploadFileMode","ws"),pN("checkTagConflicts",!0),pN("closeColorPickerWhenSelectPaletteColor",!0),pN("jsonTooLargeThreshold",2),pN("renderHTMLPreviewEnabled",!0),pN("enterToRenameNext",!0),pN("reloadConfirm",!0),pN("expandedTitles",{}),["TitleBasic","TitleCustom","TitleBackground","TitleBorder","TitleText","TitleImage","TitleGroupBasic","TitleEdgeBasic","TitleArc","TitleDataBinding","TitleComponent","TitleShapeBackground","TitleShapeBorder","TitleGroupTitle","TitleEditingPoint","TitleChart"].forEach(function(M){null==KN.expandedTitles[M]&&(KN.expandedTitles[M]=!0)}),ht.Default.handleUnfoundImage=function(M,q){return ht.Default.getImage("editor.unknown")},pN("displayConnectActionType",null),pN("symbolConnectActionType",null),pN("displayConnectActionTypes",[null,"copyStyle","host","parent"]),pN("symbolConnectActionTypes",[null,"copyStyle"]),pN("appendDisplayConnectActionTypes",null),pN("appendSymbolConnectActionTypes",null),pN("appendConnectActions",null),pN("connectActions",{copyStyle:{action:function(M,q,N){if(N){var e=N.getStyleMap();for(var X in e)"shape"!==X&&"label"!==X&&"label2"!==X&&"note"!==X&&"note2"!==X&&"text"!==X&&q.s(X,VN(e[X]))}},extraInfo:{visible:function(M){return!0}}},host:{action:function(M,q,N){q instanceof ht.Node&&N instanceof ht.Node&&!q.s("fullscreen")&&q.setHost(N)},extraInfo:{delete:{visible:function(M){return M.sm().ld()instanceof ht.Node&&M.sm().ld().getHost()},action:function(M,q){q instanceof ht.Node&&q.setHost(void 0)}},visible:function(M){return M.sm().ld()instanceof ht.Node}}},parent:{action:function(M,q,N){N&&q.setParent(N)},extraInfo:{delete:{visible:function(M){return M.sm().ld().getParent()},action:function(M,q){q.setParent(void 0)}},visible:function(M){return!0}}}}),KN.appendDisplayConnectActionTypes&&KN.appendDisplayConnectActionTypes.forEach(function(M){KN.displayConnectActionTypes.push(M)}),KN.appendSymbolConnectActionTypes&&KN.appendSymbolConnectActionTypes.forEach(function(M){KN.symbolConnectActionTypes.push(M)}),KN.appendConnectActions)for(var mN in KN.appendConnectActions)KN.connectActions[mN]=KN.appendConnectActions[mN];for(var ON in KN.connectActions){var QN=KN.connectActions[ON];ht.Default.setConnectAction(ON,QN.action,QN.extraInfo)}var sN=ht.Default.getToolTipDiv();sN.style.color=KN.color_dark,sN.style.background=KN.color_pane,ht.graph.GraphView.prototype._scrollBarColor=KN.color_transparent,ht.graph.GraphView.prototype._rectSelectBackground=KN.color_transparent,ht.graph.GraphView.prototype._rectSelectBorderColor=KN.color_select,ht.graph.GraphView.prototype.isLabelVisible=function(){return!0},ht.widget.ListView.prototype._scrollBarColor=KN.color_transparent,ht.widget.TreeView.prototype._scrollBarColor=KN.color_transparent,ht.widget.TableView.prototype._scrollBarColor=KN.color_transparent,ht.widget.TreeTableView.prototype._scrollBarColor=KN.color_transparent,ht.widget.PropertyView.prototype._scrollBarColor=KN.color_transparent,ht.widget.FormPane.prototype._scrollBarColor=KN.color_transparent,ht.widget.SplitView.prototype._dividerBackground=KN.color_line,ht.widget.SplitView.prototype._continuousLayout=KN.continuousLayout,ht.widget.ListView.prototype._selectBackground=KN.color_select,ht.widget.TreeView.prototype._selectBackground=KN.color_select,ht.widget.TableView.prototype._selectBackground=KN.color_select,ht.widget.TreeTableView.prototype._selectBackground=KN.color_select,ht.widget.TableHeader.prototype._columnLineColor=KN.color_line,ht.widget.TableHeader.prototype._insertColor=KN.color_select_dark,ht.widget.TableView.prototype._columnLineColor=KN.color_line,ht.widget.Toolbar.prototype._separatorColor=KN.color_line,ht.widget.Toolbar.prototype._itemGap=4,ht.widget.Button.prototype._labelColor=KN.color_light,ht.widget.Button.prototype._borderColor=null,ht.widget.Button.prototype._background=KN.color_select,ht.widget.Button.prototype._selectBackground=KN.color_select_dark,ht.widget.CheckBox.prototype._pressBackground=KN.color_pane_dark,ht.widget.ComboBox.prototype._selectBackground=KN.color_select,ht.widget.TabView.prototype._insertColor=KN.color_select_dark,ht.widget.TabView.prototype._selectWidth=0,ht.widget.TabView.prototype._selectBackground=KN.color_select,ht.widget.TabView.prototype._tabBackground=KN.color_dark,ht.widget.TabView.prototype.getTabBackground=function(M){return M===this.getCurrentTab()?KN.color_select:KN.color_dark},ht.widget.FormPane.prototype._hPadding=4,ht.widget.FormPane.prototype._vPadding=4,ht.widget.FormPane.prototype._hGap=4,ht.widget.FormPane.prototype._vGap=4,ht.widget.Slider.prototype._background=KN.color_dark,ht.widget.Slider.prototype._leftBackground=KN.color_select,ht.widget.Slider.prototype._button={width:14,height:14,comps:[{type:"circle",rect:[0,0,14,14],borderWidth:1,borderColor:KN.color_dark,background:KN.color_pane_dark}]},ht.widget.ComboBox.prototype._dropDownIcon=ht.widget.MultiComboBox.prototype._dropDownIcon={width:16,height:16,comps:[{type:"shape",points:[13,6,8,12,3,6],segments:[1,2,2],borderWidth:1,borderColor:KN.color_dark}]},ht.Default.comboBoxBorderColor=KN.color_line,ht.Default.textFieldBorderColor=KN.color_line,ht.Default.contextMenuHoverBackground=KN.color_select,ht.Default.contextMenuSeparatorColor=KN.color_line,ht.Default.dialogTitleBackground=KN.dialogTitleBackground||KN.color_dark,ht.Default.dialogButtonBackground=KN.color_select,ht.Default.dialogButtonSelectBackground=KN.color_select_dark,ht.Default.dialogHeaderBackground=KN.color_pane_dark,ht.Default.toolbarBackground=KN.color_pane_dark,ht.Default.tableHeaderBackground=KN.color_pane_dark,ht.Default.contextMenuLabelFont=ht.Default.labelFont,ht.Default.contextMenuBorderRadius=0,ht.Default.contextMenuBorderColor=KN.color_line,ht.Default.contextMenuSubmenuMark=">&nbsp;",ht.Default.contextMenuCheckIcon={width:16,height:16,comps:[{type:"shape",points:[13,3,7,12,4,8],borderWidth:1,borderColor:KN.color_dark}]},ht.Default.setImage("radioOn",{width:16,height:16,comps:[{type:"circle",rect:[2,2,12,12],borderWidth:1,borderColor:ht.Color.widgetIconBorder,background:"#FFF"},{type:"circle",rect:[4,4,8,8],background:KN.color_select}]}),ht.Default.setImage("expandIcon",{width:16,height:16,comps:[{type:"shape",points:[13,6,8,12,3,6],segments:[1,2,2],borderWidth:1,borderColor:KN.color_dark}]}),ht.Default.setImage("collapseIcon",{width:16,height:16,comps:[{type:"shape",points:[6,3,12,8,6,13],segments:[1,2,2],borderWidth:1,borderColor:KN.color_dark}]}),ht.widget.TreeView.prototype._expandIcon="expandIcon",ht.widget.TreeView.prototype._collapseIcon="collapseIcon",ht.widget.TreeTableView.prototype._expandIcon="expandIcon",ht.widget.TreeTableView.prototype._collapseIcon="collapseIcon";var lN=ht.widget.TextArea.prototype.setEditable;ht.widget.TextField.prototype.setEditable=ht.widget.TextArea.prototype.setEditable=function(M){lN.call(this,M);var q=this._element;q.style.color=M?ht.Default.labelColor:KN.color_disabled},ht.Default.onElementCreated=function(M){("INPUT"===M.tagName&&"button"!==M.type||"TEXTAREA"===M.tagName)&&(M.oldBorder=M.style.border=KN.color_line+" solid 1px",M.style.outline=0,M.style.padding="2px","TEXTAREA"===M.tagName&&(M.style.whiteSpace="pre",M.setAttribute("spellcheck","false")),M.addEventListener("focus",function(q){M.readOnly||(M.style.border=KN.color_select+" solid 1px"),"INPUT"===M.tagName&&requestAnimationFrame(function(){M.select()}),"TEXTAREA"===M.tagName&&(M.style.zIndex="1")},!1),M.addEventListener("blur",function(q){M.style.border=M.oldBorder,"TEXTAREA"===M.tagName&&(M.style.zIndex="")},!1),M.addEventListener("mousedown",function(M){M.stopPropagation()}),M.addEventListener("touchstart",function(M){M.stopPropagation()}),KN.onElementCreated&&KN.onElementCreated(M))},ht.Default.handleUnfoundImage=function(M,q){return ht.Default.getImage("editor.unknown")},KN.configStudio&&KN.configStudio();var YN=(function(){function M(M){this.value=M}function q(q){function N(M,q){return new Promise(function(N,X){var t={key:M,arg:q,resolve:N,reject:X,next:null};$?$=$.next=t:(w=$=t,e(M,q))})}function e(N,w){try{var $=q[N](w),t=$.value;t instanceof M?Promise.resolve(t.value).then(function(M){e("next",M)},function(M){e("throw",M)}):X($.done?"return":"normal",$.value)}catch(M){X("throw",M)}}function X(M,q){switch(M){case"return":w.resolve({value:q,done:!0});break;case"throw":w.reject(q);break;default:w.resolve({value:q,done:!1})}w=w.next,w?e(w.key,w.arg):$=null}var w,$;this._invoke=N,"function"!=typeof q.return&&(this.return=void 0)}"function"==typeof Symbol&&Symbol.asyncIterator&&(q.prototype[Symbol.asyncIterator]=function(){return this}),q.prototype.next=function(M){return this._invoke("next",M)},q.prototype.throw=function(M){return this._invoke("throw",M)},q.prototype.return=function(M){return this._invoke("return",M)}}(),function(M,q){if(!(M instanceof q))throw new TypeError("Cannot call a class as a function")}),IN=function(){function M(M,q){for(var N=0;N<q.length;N++){var e=q[N];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(M,e.key,e)}}return function(q,N,e){return N&&M(q.prototype,N),e&&M(q,e),q}}(),rN=function(M,q){if("function"!=typeof q&&null!==q)throw new TypeError("Super expression must either be null or a function, not "+typeof q);M.prototype=Object.create(q&&q.prototype,{constructor:{value:M,enumerable:!1,writable:!0,configurable:!0}}),q&&(Object.setPrototypeOf?Object.setPrototypeOf(M,q):M.__proto__=q)},dN=function(M,q){if(!M)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!q||"object"!=typeof q&&"function"!=typeof q?M:q},aN={closable:!0,draggable:!0,titleHeight:38,titleBackground:ht.Default.dialogHeaderBackground,titleColor:"#303033",titleIconGap:16,borderWidth:0,contentPadding:0,buttonsHeight:38},DN=function(M){function q(N){YN(this,q);var e=dN(this,M.call(this,N));e.callback=void 0;var X=e.getView();return X.addEventListener("focus",function(M){if(X.parentNode&&!X.contains(M.relatedTarget)){var q=X.parentNode.lastChild
;q!==X&&q!==ht.Default.getToolTipDiv()&&(X.parentNode.appendChild(X),e.onFocus&&e.onFocus(M))}},!0),e}return rN(q,M),q.prototype.setConfig=function(q){var N=this._adjustConfig(q);M.prototype.setConfig.call(this,N)},q.prototype._adjustConfig=function(M){var q=VN(aN);return Object.assign(q,M),q.title&&(q.title='<span style="margin-left: 20px">'+q.title+"</span>"),q},q.prototype.setTitle=function(q){q&&(q='<span style="margin-left: 20px">'+q+"</span>"),M.prototype.setTitle.call(this,q)},q.prototype.onShown=function(){iN.indexOf(this)>=0||iN.push(this)},q.prototype.onHidden=function(){E(iN,this)},q.prototype.hide=function(){M.prototype.hide.call(this),this.callback&&this.callback()},q.prototype.show=function(q){var N=this.getConfig();q||(q=N.$38$);var e=void 0;e=q&&q!==document.body?q.getBoundingClientRect():ht.Default.getWindowInfo();var X=this.$21d,w=N.width,$=N.height;e.width<w&&(X.style.left=e.left+"px",X.style.width=e.width+"px",N.width=e.width),e.height<$&&(X.style.top=e.top+"px",X.style.height=e.height+"px",N.height=e.height),M.prototype.show.call(this,q)},q}(ht.widget.Dialog),WN=function(M){function q(N){YN(this,q);var e=dN(this,M.call(this,N));return e.getView().style.background=oN.config.color_pane,e}return rN(q,M),q.prototype.addLine=function(){this.addRow([],[.1],1.01,{background:oN.config.color_line})},q.prototype.addTitle=function(M){var q=[{element:M,font:oN.config.boldFont}],N={background:oN.config.color_pane_dark};this.addRow(q,[.1],null,N)},q.prototype.getRowIndex=function(M){return this.getRows().indexOf(M)},q}(ht.widget.FormPane),vN=function(){function M(q){if(YN(this,M),this.config=q,this._editable=!0,oN.config.useCodeEditor){(this._view=document.createElement("div")).style.position="absolute"}else this._monacoEditor=new ht.widget.TextArea,this._view=this._monacoEditor.getView(),q&&q.value&&this._monacoEditor.setValue(q.value)}return M.prototype.getView=function(){return this._view},M.prototype.setValue=function(M){void 0!==M&&null!==M||(M=""),this.monacoEditor&&this.monacoEditor.setValue(M)},M.prototype.getValue=function(){return this.monacoEditor&&this.monacoEditor.getValue()},M.prototype.layout=function(){this.monacoEditor&&(this.monacoEditor.layout(),this.isEditable()||this._monacoEditor instanceof ht.widget.TextArea||this.getView().appendChild(this._editableLayer))},M.prototype.invalidate=function(){this.layoutLater()},M.prototype.iv=function(){this.invalidate()},M.prototype.layoutLater=function(M){var q=this;setTimeout(function(){q.layout()},M||300)},M.prototype.setEditable=function(M){var q=this;if(this._monacoEditor instanceof ht.widget.TextArea)return void this._monacoEditor.setEditable(M);if(this._editable!==M){this._timer&&(clearTimeout(this._timer),delete this._timer);var N=this._editableLayer;M?N.parentNode&&N.parentNode.removeChild(N):this._timer=setTimeout(function(){delete q._timer,q.getView().appendChild(N)},10),this._editable=M,this._monacoEditor&&this._monacoEditor.updateOptions({readOnly:!M})}},M.prototype.isEditable=function(){return this._monacoEditor instanceof ht.widget.TextArea?this._monacoEditor.isEditable():this._editable},M.prototype.hasTextFocus=function(){var M=this._monacoEditor;if(M)return M instanceof ht.widget.TextArea?document.activeElement===M.getElement():!(!M.hasTextFocus||!M.hasTextFocus())||void 0},IN(M,[{key:"monacoEditor",get:function(){if(!this._monacoEditor&&window.monaco){var M=oN.config.convertCodeEditorOption,q=this.config||{value:"",language:"javascript",theme:oN.config.codeEditorTheme,readOnly:!this._editable,minimap:{enabled:!1}};M&&M(q),this._monacoEditor=monaco.editor.create(this._view,q)}return this._monacoEditor}},{key:"_editableLayer",get:function(){if(this.__editableLayer)return this.__editableLayer;var M=this.__editableLayer=document.createElement("div"),q=M.style;return q.backgroundColor=ht.Default.disabledBackground||"rgba( 255, 255, 255, 0.3)",q.position="absolute",q.cursor="not-allow",q.top=0,q.right=0,q.bottom=0,q.left=0,q.pointerEvents="none",M}}]),M}(),oN={strings:{},customStrings:{},config:KN},HN=ht.Default,UN=HN.createObject,VN=HN.clone,TN=HN.drawRoundRect,_N=HN.isArray,kN=HN.isString,ZN=HN.getCompType,zN=["onClick","onDoubleClick","onContextMenu","onDown","onUp","onMove","onEnter","onHover","onLeave","onBeginDrag","onDrag","onEndDrag","onScroll"],AN="__ht__dataModel",cN="ht.drawing",BN=/^attr@/,LN=/firefox/.test(window.navigator.userAgent.toLowerCase()),iN=[],FN={width:16,height:16,comps:[]},Me={display:{},symbol:{},data:{},comp:{},scene:{},data3d:{}},qe=new ht.List([{x:50,y:75},{x:25,y:75},{x:25,y:25},{x:75,y:25},{x:75,y:75},{x:65,y:60},{x:75,y:75},{x:85,y:60}]),Ne=new ht.List([1,2,2,2,2,2,1,2]);document.exitPointerLock=document.exitPointerLock||document.mozExitPointerLock||document.webkitExitPointerLock||document.msExitPointerLock||void 0;var ee=void 0,Xe=function(){var M=new ht.Math.Vector3,q=new ht.Math.Box3;return function(N,e){var X=N[N.length-1],w=X.getPointsMatrix3d(),$=w.clone().invert(),t=[],E=[],J=X instanceof ht.Polyline;q.makeEmpty();var u=void 0,g=void 0,S=void 0,b=void 0,h=void 0;N.forEach(function(N){if(b=N.getPointsMatrix3d(),u=N.getPoints(),g=u.length,h=N.getElevation(),u.forEach(function(N){M.set(N.x,J?N.e:h,N.y).applyMatrix4(b).applyMatrix4($),q.expandByPoint(M),J?t.push({x:M.x,e:M.y,y:M.z}):t.push({x:M.x,y:M.z})}),(u=N.getSegments())&&u.length)u=u.toArray();else for(u=[1],S=1;S<g;S++)u.push(2);N.isClosePath()&&u.push(5),e&&E.length>0&&5!==E[E.length-1]&&(u[0]=2),E.push.apply(E,u),N!==X&&N.removeFromDataModel()}),X.setPoints(t),X.setSegments(E);var y=M.clone().copy(q.max).sub(q.min),P=M.copy(X.getAnchor3d()).multiply(y).add(q.min);X.p3(P.applyMatrix4(w).toArray())}}(),we=function(){var M=new ht.DataModel,q=new ht.JSONSerializer(M),N=new ht.Math.Box3,e=new ht.Math.Vector3;return function(M){var X=M.getSegments();if(X){var w=M.dm();M.removeFromDataModel();var $=q.json={d:[]};q.serializeData(M);var t=$.d[0];delete t.p.position,delete t.p.elevation,delete t.p.width,delete t.p.height;var E=M.getElevation(),J=M.getPointsMatrix3d(),u=[],g=M.getPoints().toArray(),S=void 0,b=void 0,h=0,y=void 0;X.forEach(function(M){switch(M){case 1:S=[M],b=[g[h++]],u.push({segments:S,points:b});break;case 2:case 3:case 4:for(S.push(M),y=1;y<M;y++)b.push(g[h++]);break;case 5:S.push(M)}});var P=M instanceof ht.Polyline,f=M.getClass();u.forEach(function(M){t.p.points=M.points,t.p.segments=M.segments;var X=new f;q.deserializeData(X,t),N.makeEmpty(),M.points.forEach(function(M){e.set(M.x,P?M.e:E,M.y),N.expandByPoint(e)}),X.p3(N.getCenter(e).applyMatrix4(J).toArray()),w.add(X)})}}}(),$e=function(M,q){arguments.length>2&&void 0!==arguments[2]&&arguments[2]?Xe(M,q):Kq(M,q)},te=function(M){arguments.length>1&&void 0!==arguments[1]&&arguments[1]?we(M):pq(M)},Ee=function(){var M=document.createElement("canvas");return function(q){if(null==q)return!0;try{if(kN(q)&&"["===q[0]&&(q=JSON.parse(q)),kN(q))return Je(q);var N=M.getContext("2d");return 0===q.indexOf("L")||0===q.indexOf("R")||(Iq(N,q,{x:0,y:0,width:2,height:2}),!0)}catch(M){return!1}}}(),Je=function(){var M=document.createElement("canvas");return function(q){var N=M.getContext("2d"),e=N.createLinearGradient(0,0,0,1);try{return e.addColorStop(0,q),!0}catch(M){return!1}}}();ht.Default.setImage("check",{width:16,height:16,comps:[{type:"border",rect:[1,1,14,14],width:1,color:oN.config.color_line},{type:"shape",points:[13,3,7,12,4,8],borderWidth:2,borderColor:{func:function(M,q){if(M&&q&&q.getRowSize&&q.isSelected){var N=q.isSelected(M);if(q.isCheckMode&&q.getFocusData){var e=q.isCheckMode();N=N&&!e||M===q.getFocusData()&&e}if(N)return oN.config.color_line}return oN.config.color_select}}}]}),ht.Default.setImage("uncheck",{width:16,height:16,comps:[{type:"border",rect:[1,1,14,14],width:1,color:oN.config.color_line}]}),ht.Default.setImage("text_icon",{width:16,height:16,comps:[{type:"shape",points:[3,14,8,2,13,14,5,9,11,9],segments:[1,2,2,1,2],borderColor:oN.config.color_dark,borderWidth:1}]}),ht.Default.setImage("refGraph_icon",{width:16,height:16,comps:[{type:"shape",borderWidth:1,borderColor:oN.config.color_dark,rotation:.7854,points:[12.90381,7.59615,12.90381,7.59615,12.90381,4.61619,12.90381,3.59619,12.90381,2.57619,11.72047,1.59619,10.40381,1.59619,9.08714,1.59619,7.90381,2.61619,7.90381,3.59619,7.90381,4.35799,7.90381,7.59615,7.90381,7.59615,7.90381,7.59615,7.90381,9.59619,10.40381,9.59619],segments:[1,4,4,4,4,4]},{type:"shape",borderWidth:1,borderColor:oN.config.color_dark,rotation:-2.35619,points:[8.21091,12.28904,8.21091,12.28904,8.21091,9.30909,8.21091,8.28909,8.21091,7.26909,7.02758,6.28909,5.71091,6.28909,4.39425,6.28909,3.21091,7.30909,3.21091,8.28909,3.21091,9.05088,3.21091,12.28904,3.21091,12.28904,3.21091,12.28904,3.21091,14.28909,5.71091,14.28909],segments:[1,4,4,4,4,4]}]}),ht.Default.setImage("editor.unknown",{width:200,height:200,textureCache:!0,comps:[{type:"roundRect",background:"rgb(247,247,247)",borderColor:"#979797",cornerRadius:20,selectable:!1,rect:[0,0,200,200]},{type:"shape",background:"rgba(255,170,79,0.63)",borderColor:"rgb(124,145,155)",points:[35.92101,125.8927,70.22338,97.87611,96.05685,117.16025,108.79166,106.08902,115.70485,111.45559,92.40971,145.02116,35.92101,145.02116,35.92101,130.19911]},{type:"shape",background:"rgba(255,170,79,0.63)",borderColor:"rgb(124,145,155)",points:[143.94195,74.95345,121.52647,95.32915,136.08054,112.06633,115.341,146.63224,166.86461,146.63224,166.86461,103.69774]},{type:"shape",borderWidth:4,borderColor:"rgb(124,145,155)",displayName:"\u4e0d\u89c4\u5219\u56fe\u5f62",closePath:!0,points:[86.52393,81.40417,110.5868,43.51795,35.32634,43.51795,35.32634,146.93709,93.17962,146.93709,117.24248,111.09877,86.52393,81.40417]},{type:"shape",borderWidth:4,borderColor:"rgb(124,145,155)",closePath:!0,points:[105.77896,81.40417,129.84183,43.51795,168.08039,43.51795,168.08039,146.93709,112.43465,146.93709,136.49752,111.09877,105.77896,81.40417]},{type:"shape",borderWidth:4,borderColor:"rgb(124,145,155)",points:[35.92101,126.00861,70.52846,96.60621,95.13328,116.95012,108.45973,104.311]},{type:"shape",borderWidth:4,borderColor:"rgb(124,145,155)",points:[122.25418,94.2376,144.08528,74.22575,168.32002,106.08902]},{type:"oval",background:"#FF7C7C",borderWidth:4,borderColor:"rgb(124,145,155)",rect:[56.57448,66.67972,14,14]}]}),ht.Default.setImage("editor.root",{width:30,height:30,fitSize:!0,comps:[{type:"shape",points:[23,8,8,23],segments:[1,2],borderWidth:1,borderColor:"white"}]}),ht.Default.setImage("editor.display",{background:"rgb(179,179,179)",width:16,height:16,blendMode:"override",comps:[{type:"circle",borderWidth:1,borderColor:oN.config.color_light,rect:[6,1,4,4.00837]},{type:"circle",borderWidth:1,borderColor:oN.config.color_light,rect:[11,10.99163,4,4.00837]},{type:"shape",borderWidth:1,borderColor:oN.config.color_light,points:[2.98235,11.0795,2.98235,8,7.89475,8,7.89475,5.00837,7.89475,8,13,8,13,11]},{type:"circle",borderWidth:1,borderColor:oN.config.color_light,rect:[1,10.99163,4,4.00837]}]}),ht.Default.setImage("editor.symbol",{background:"rgb(179,179,179)",width:16,height:16,blendMode:"override",comps:[{type:"circle",borderWidth:1,borderColor:oN.config.color_light,rect:[0,2,10,8]},{type:"rect",borderWidth:1,borderColor:oN.config.color_light,rect:[5,6,10,8]}]}),ht.Default.setImage("editor.symbol3d",{width:16,height:16,comps:[{type:"shape",background:"#ffffff",displayName:"",points:[11.45833,6.82417,11.45833,3.8675,11.45842,3.837,11.44175,3.8088,11.415,3.79417,8.03917,1.96083,8.01471,1.94781,7.98529,1.94781,7.96083,1.96083,4.58333,3.79417,4.55658,3.8088,4.53992,3.837,4.54,3.8675,4.54,6.82417,4.53978,6.85437,4.52316,6.88217,4.49667,6.89667,1.71,8.40833,1.68325,8.42297,1.66658,8.45117,1.66667,8.48167,1.66667,12.1325,1.66658,12.163,1.68325,12.1912,1.71,12.20583,5.08583,14.03917,5.11029,14.05219,5.13971,14.05219,5.16417,14.03917,7.96083,12.52333,7.98529,12.51031,8.01471,12.51031,8.03917,12.52333,10.83333,14.03583,10.85779,14.04886,10.88721,14.04886,10.91167,14.03583,14.2875,12.2025,14.31425,12.18786,14.33092,12.15966,14.33083,12.12917,14.33083,8.48167,14.33092,8.45117,14.31425,8.42297,14.2875,8.40833,11.5,6.89667,11.47415,6.88174,11.45821,6.85402,11.45833,6.82417,10.25,6.89667,8.7075,7.73,8.68174,7.74372,8.65057,7.74294,8.62553,7.72795,8.60049,7.71295,8.58508,7.68586,8.585,7.65667,8.585,6.14583,8.58492,6.11534,8.60158,6.08714,8.62833,6.0725,10.17083,5.23917,10.19647,5.22551,10.22746,5.22621,10.25245,5.241,10.27744,5.2558,10.29297,5.28263,10.29333,5.31167,10.29333,6.82417,10.29311,6.85437,10.27649,6.88217,10.25,6.89667,8.03917,3.29167,9.53917,4.105,9.56566,4.11966,9.58216,4.14764,9.58216,4.17792,9.58216,4.20819,9.56566,4.23618,9.53917,4.25083,8.03917,5.06417,8.01471,5.07719,7.98529,5.07719,7.96083,5.06417,6.46,4.25,6.43351,4.23534,6.41701,4.20736,6.41701,4.17708,6.41701,4.14681,6.43351,4.11882,6.46,4.10417,7.96,3.29083,7.98482,3.27777,8.01463,3.27808,8.03917,3.29167,3.58333,8.71917,5.08333,7.90583,5.10779,7.89281,5.13721,7.89281,5.16167,7.90583,6.66167,8.71917,6.68816,8.73382,6.70466,8.76181,6.70466,8.79208,6.70466,8.82236,6.68816,8.85034,6.66167,8.865,5.16167,9.67833,5.13721,9.69136,5.10779,9.69136,5.08333,9.67833,3.58333,8.865,3.55684,8.85034,3.54034,8.82236,3.54034,8.79208,3.54034,8.76181,3.55684,8.73382,3.58333,8.71917,5.75,10.68667,7.2925,9.85333,7.31813,9.83968,7.34912,9.84038,7.37412,9.85517,7.39911,9.86996,7.41463,9.89679,7.415,9.92583,7.415,11.44083,7.41478,11.47103,7.39816,11.49884,7.37167,11.51333,5.83333,12.3475,5.80757,12.36122,5.77641,12.36044,5.75136,12.34545,5.72632,12.33045,5.71091,12.30336,5.71083,12.27417,5.71083,10.76,5.70989,10.73036,5.72484,10.70237,5.75,10.68667,9.33333,8.71917,10.83333,7.90583,10.85779,7.89281,10.88721,7.89281,10.91167,7.90583,12.41167,8.71917,12.43816,8.73382,12.45466,8.76181,12.45466,8.79208,12.45466,8.82236,12.43816,8.85034,12.41167,8.865,10.91167,9.67833,10.88721,9.69136,10.85779,9.69136,10.83333,9.67833,9.33333,8.865,9.30684,8.85034,9.29034,8.82236,9.29034,8.79208,9.29034,8.76181,9.30684,8.73382,9.33333,8.71917,13.12167,11.51083,11.57917,12.34417,11.5534,12.35789,11.52224,12.3571,11.4972,12.34211,11.47215,12.32712,11.45674,12.30002,11.45667,12.27083,11.45667,10.76,11.45658,10.7295,11.47325,10.7013,11.5,10.68667,13.0425,9.85333,13.06813,9.83968,13.09912,9.84038,13.12412,9.85517,13.14911,9.86996,13.16463,9.89679,13.165,9.92583,13.165,11.44083,13.16424,11.4698,13.14843,11.49636,13.12333,11.51083],segments:[1,2,4,2,4,2,4,2,4,2,4,2,4,2,4,2,4,2,4,2,4,2,4,2,4,5,1,2,4,4,2,4,2,4,4,2,4,5,1,2,4,4,2,4,2,4,4,2,4,5,1,2,4,2,4,4,2,4,2,4,4,5,1,2,4,4,2,4,2,4,4,2,4,5,1,2,4,2,4,4,2,4,2,4,4,5,1,2,4,4,2,4,2,4,4,2,4,5]}]}),ht.Default.setImage("editor.filter",{background:"rgb(130,130,130)",width:16,height:16,comps:[{type:"shape",borderWidth:1,borderColor:"rgb(255,255,255)",closePath:!0,points:[2,1.5,14,1.5,9.50949,5.5,9.50949,9.5,13,9.5,9.50949,9.5,9.50949,11.5,12,11.5,9.50949,11.5,9.50949,14.5,6.5335,12.5,6.5335,5.5,2,1.5]}]}),ht.Default.setImage("editor.bind",{width:16,height:16,comps:[{type:"shape",borderWidth:1,borderColor:"white",borderCap:"round",rotation:.7854,points:[12.5502,6.7981,12.5502,6.7981,12.5502,4.8181,12.5502,3.7981,12.5502,2.7781,11.36687,1.7981,10.0502,1.7981,8.73354,1.7981,7.5502,2.8181,7.5502,3.7981,7.5502,4.55989,7.5502,7.79805,7.5502,7.79805,7.5502,7.79805,7.5502,9.7981,10.0502,9.7981],segments:[1,4,4,4,4,4]},{type:"shape",borderWidth:1,borderColor:"white",borderCap:"round",rotation:-2.35619,points:[8.4498,11.2019,8.4498,11.2019,8.4498,9.2219,8.4498,8.2019,8.4498,7.1819,7.26646,6.2019,5.9498,6.2019,4.63313,6.2019,3.4498,7.2219,3.4498,8.2019,3.4498,8.9637,3.4498,12.20186,3.4498,12.20186,3.4498,12.20186,3.4498,14.2019,5.9498,14.2019],segments:[1,4,4,4,4,4]}]}),ht.Default.setImage("editor.unbind",{background:"rgb(179,179,179)",width:16,height:16,blendMode:"override",comps:[{type:"shape",borderWidth:1,borderColor:"rgb(138,138,138)",borderCap:"round",shadowColor:"#1ABC9C",rotation:.7854,points:[13.49999,7.03553,13.49999,7.03553,13.49999,5.05554,13.49999,4.03553,13.49999,3.01553,12.31666,2.03553,10.99999,2.03553,9.68333,2.03553,8.49999,3.05553,8.49999,4.03553,8.49999,5.01553,8.49999,7.03553,8.49999,7.03553],segments:[1,4,4,4,4]},{type:"shape",borderWidth:1,borderColor:"rgb(138,138,138)",borderCap:"round",shadowColor:"#1ABC9C",rotation:3.92699,points:[7.28554,13.25761,7.28554,13.25761,7.28554,11.27761,7.28554,10.2576,7.28554,9.23761,6.1022,8.25761,4.78554,8.25761,3.46887,8.25761,2.28554,9.2776,2.28554,10.2576,2.28554,11.2376,2.28554,13.25761,2.28554,13.25761],segments:[1,4,4,4,4]}]}),ht.Default.setImage("editor.dircollapsed",{background:"rgb(179,179,179)",width:16,height:16,cacheRule:!0,comps:[{type:"shape",background:"rgb(255,204,153)",borderWidth:1,borderColor:"rgb(138,138,138)",borderCap:"round",shadowColor:"#1ABC9C",points:[14.5,14.5,.5,14.5,.5,1.50001,6.5,1.50001,7.5,3.50001,14.5,3.50001,14.5,14.5]},{type:"shape",background:"rgb(255,227,199)",borderWidth:1,borderColor:"rgb(138,138,138)",borderCap:"round",shadowColor:"#1ABC9C",points:[.5,5.50001,14.5,5.50001,14.5,14.50001,.5,14.50001,.5,5.50001]}]}),ht.Default.setImage("editor.direxpanded",{background:"rgb(179,179,179)",width:16,height:16,cacheRule:!0,comps:[{type:"shape",background:"rgb(255,255,255)",borderWidth:1,borderColor:"rgb(51,153,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[2.35891,10.47175,3.3125,6.30284,15.5,6.30284,13.625,14.5,.5,14.5,.5,1.5,6.125,1.5,7.0625,3.2289,12.6875,3.2289,12.6875,6.30284]}]}),ht.Default.setImage("editor.dir",{background:"rgb(227,227,227)",width:20,height:20,fitSize:!0,cacheRule:!0,comps:[{type:"shape",background:"#FFCC99",borderWidth:1,borderColor:"rgb(255,255,255)",borderCap:"round",points:[19,4,19,18,1,18,1,2,8.71429,2,10,4,19,4]},{type:"rect",shadow:!0,shadowColor:"rgba(0,0,0,0.4)",shadowBlur:2,shadowOffsetX:0,shadowOffsetY:1,background:"rgb(255,255,255)",borderColor:"#979797",rotation:6.28319,rect:[2.98273,5.998,13.98346,9.99004]},{type:"shape",background:"rgba(255,255,153,0.3)",borderColor:"rgb(255,255,255)",borderCap:"round",points:[18,9,18,17,2,17,2,9,18,9]},{type:"rect",shadowColor:"rgb(0,0,0)",shadowBlur:2,shadowOffsetX:0,shadowOffsetY:1,background:"rgb(232,230,230)",borderColor:"#979797",rotation:6.28319,rect:[4,7,11.98532,1.06039]}]}),ht.Default.setImage("editor.dxf",{width:64,height:64,fitSize:!0,comps:[{type:"shape",shadowColor:"#1ABC9C",background:"#000000",points:[25.13334,60.62742,20.38001,60.62742,20.11302,60.62742,19.89504,60.41688,19.89504,60.15453,19.89504,43.31796,19.89504,43.05561,20.11302,42.84507,20.38001,42.84507,25.13334,42.84507,30.66329,42.84507,33.35167,45.67873,33.35167,51.50916,33.35167,57.47593,30.51009,60.62742,25.13334,60.62742,25.13334,60.62742,23.32783,57.5939,25.03463,57.5939,28.43349,57.5939,29.82018,55.90554,29.82018,51.77117,29.82018,47.64415,28.35946,45.88193,24.93627,45.88193,23.32783,45.88193,23.32783,57.5939,23.32783,57.5939],segments:[1,2,4,2,4,2,4,4,2,1,2,4,4,2,2,2]},{type:"shape",shadowColor:"#1ABC9C",background:"#000000",points:[48.10416,60.62742,45.1488,60.62742,44.97846,60.62742,44.82286,60.54254,44.73581,60.40217,40.95446,54.3465,37.26771,60.39482,37.1786,60.53886,37.01957,60.62776,36.84889,60.62776,34.01657,60.62776,33.84041,60.62776,33.67761,60.53552,33.59227,60.38379,33.50693,60.2324,33.51275,60.04759,33.60735,59.89987,39.05608,51.53522,33.90312,43.56961,33.80853,43.42557,33.8027,43.24076,33.88804,43.08937,33.97338,42.93797,34.13618,42.8454,34.31235,42.8454,37.31706,42.8454,37.4874,42.8454,37.64677,42.93396,37.73382,43.078,41.14399,48.68284,44.48219,43.08168,44.56924,42.93396,44.72861,42.84507,44.90272,42.84507,47.73299,42.84507,47.91121,42.84507,48.074,42.93731,48.15729,43.08903,48.24434,43.24042,48.2368,43.42524,48.14221,43.56928,43.03826,51.48342,48.51339,59.89987,48.60798,60.04759,48.61552,60.2324,48.52847,60.38379,48.44518,60.53485,48.28238,60.62742,48.10416,60.62742,48.10416,60.62742],segments:[1,2,4,2,2,4,2,4,4,2,2,4,4,2,4,2,2,4,2,4,4,2,2,4,4,2]},{type:"shape",shadowColor:"#1ABC9C",background:"#000000",points:[53.17006,60.62742,50.68081,60.62742,50.41177,60.62742,50.19585,60.41688,50.19585,60.15453,50.19585,43.31796,50.19585,43.05561,50.41177,42.84507,50.68081,42.84507,60.09288,42.84507,60.36192,42.84507,60.57784,43.05561,60.57784,43.31796,60.57784,45.40904,60.57784,45.67138,60.36192,45.88193,60.09288,45.88193,53.65537,45.88193,53.65537,50.62587,59.22886,50.62587,59.4979,50.62587,59.71382,50.83642,59.71382,51.09876,59.71382,53.18984,59.71382,53.45219,59.4979,53.66273,59.22886,53.66273,53.65537,53.66273,53.65537,60.1542,53.65537,60.41688,53.43911,60.62742,53.17006,60.62742,53.17006,60.62742],segments:[1,2,4,2,4,2,4,2,4,2,2,2,4,2,4,2,2,4,2]},{type:"shape",shadowColor:"#1ABC9C",background:"#000000",points:[56.21111,19.11398,40.59837,2.34525,40.23096,1.94622,39.70418,1.92216,39.15478,1.92216,8.11505,1.92216,7.04265,1.92216,6.07649,2.35795,6.07649,3.40366,6.07649,60.1542,6.07649,61.1999,7.04299,62.07784,8.11505,62.07784,13.93496,62.07784,15.00736,62.07784,15.87481,61.28546,15.87481,60.23975,15.87481,59.19405,15.00702,58.40166,13.93496,58.40166,9.84618,58.40166,9.84618,5.59867,35.20824,5.59867,35.20824,21.86677,35.20824,22.91248,36.27174,23.64538,37.3438,23.64538,52.6875,23.64538,52.6875,35.56255,52.6875,36.60826,53.67148,37.45412,54.74388,37.45412,55.81629,37.45412,56.80027,36.60793,56.80027,35.56255,56.80027,20.28301,56.80027,19.81747,56.52917,19.46155,56.21111,19.11398,56.21111,19.11398,39.32101,6.67546,51.68947,19.9692,39.32101,19.9692,39.32101,6.67546,39.32101,6.67546],segments:[1,2,4,2,4,2,4,2,4,4,2,2,2,2,4,2,2,4,4,2,4,2,1,2,2,2,2]}]}),ht.Default.setImage("editor.obj",{width:64,height:64,fitSize:!0,attachStyle:"close",comps:[{type:"shape",background:"rgb(0,0,0)",points:[56.21111,19.11398,40.59837,2.34525,40.23096,1.94622,39.70418,1.92216,39.15478,1.92216,8.11505,1.92216,7.04265,1.92216,6.07649,2.35795,6.07649,3.40366,6.07649,60.1542,6.07649,61.1999,7.04299,62.07784,8.11505,62.07784,13.93496,62.07784,15.00736,62.07784,15.87481,61.28546,15.87481,60.23975,15.87481,59.19405,15.00702,58.40166,13.93496,58.40166,9.84618,58.40166,9.84618,5.59867,35.20824,5.59867,35.20824,21.86677,35.20824,22.91248,36.27174,23.64538,37.3438,23.64538,52.6875,23.64538,52.6875,35.56255,52.6875,36.60826,53.67148,37.45412,54.74388,37.45412,55.81629,37.45412,56.80027,36.60793,56.80027,35.56255,56.80027,20.28301,56.80027,19.81747,56.52917,19.46155,56.21111,19.11398,56.21111,19.11398,39.32101,6.67546,51.68947,19.9692,39.32101,19.9692,39.32101,6.67546,39.32101,6.67546],segments:[1,2,4,2,4,2,4,2,4,4,2,2,2,2,4,2,2,4,4,2,4,2,1,2,2,2,2]},{type:"shape",background:"#000000",borderWidth:.5,borderColor:"rgb(0,0,0)",pixelPerfect:!0,points:[31.21904,47.49025,32.38182,48.81914,33.04627,50.64637,33.04627,52.80583,33.04627,54.96528,32.38182,56.79251,31.21904,58.12141,29.89014,59.4503,28.22903,60.28086,26.06957,60.28086,23.91012,60.28086,22.249,59.61642,20.9201,58.12141,19.75732,56.79251,19.09287,54.96528,19.09287,52.80583,19.09287,50.64637,19.59121,48.81914,20.9201,47.49025,22.08289,45.99524,23.91012,45.33079,26.06957,45.33079,28.22903,45.33079,30.05626,45.99524,31.21904,47.49025,22.58122,48.81914,21.75066,49.81582,21.41844,51.14471,21.41844,52.80583,21.41844,54.46695,21.75066,55.79584,22.58122,56.79251,23.41178,57.78919,24.57456,58.28752,26.06957,58.28752,27.56458,58.28752,28.72736,57.78919,29.55792,56.79251,30.38848,55.79584,30.7207,54.46695,30.7207,52.80583,30.7207,51.14471,30.22237,49.81582,29.55792,48.81914,28.72736,47.82247,27.56458,47.32414,26.06957,47.32414,24.57456,47.32414,23.41178,47.82247,22.58122,48.81914],segments:[1,4,4,4,4,4,4,4,4,5,1,4,4,4,4,4,4,4,4,5]},{type:"shape",background:"#000000",borderWidth:.5,borderColor:"rgb(0,0,0)",pixelPerfect:!0,points:[41.68409,45.66302,43.01298,45.66302,44.17577,45.99524,45.00633,46.65969,45.83689,47.32414,46.16911,48.1547,46.16911,49.31748,46.16911,50.14804,46.003,50.81249,45.50466,51.31082,45.17244,51.80916,44.50799,52.30749,43.84354,52.47361,44.84021,52.63972,45.50466,52.97194,46.003,53.63639,46.50133,54.13472,46.66745,54.96528,46.66745,55.96195,46.66745,57.45696,46.16911,58.45363,45.17244,59.11808,44.34188,59.61642,43.1791,59.94864,41.68409,59.94864,35.20573,59.94864,35.20573,45.66302,41.68409,45.66302,37.36518,51.64305,41.18575,51.64305,42.18242,51.64305,42.84687,51.47693,43.34521,51.14471,43.84354,50.81249,44.00966,50.14804,44.00966,49.48359,44.00966,48.81914,43.84354,48.32081,43.34521,47.98858,42.84687,47.65636,42.18242,47.49025,41.18575,47.49025,37.36518,47.49025,37.36518,51.64305,37.36518,58.12141,41.35186,58.12141,42.34854,58.12141,43.01298,57.9553,43.51132,57.62307,44.17577,57.29085,44.50799,56.6264,44.50799,55.79584,44.50799,54.96528,44.17577,54.30084,43.67743,53.96861,43.1791,53.63639,42.34854,53.47028,41.35186,53.47028,37.19907,53.47028,37.19907,58.12141],segments:[1,4,4,4,4,4,4,4,4,2,2,2,5,1,2,4,4,4,4,2,2,5,1,2,4,4,4,4,2,2,5]},{type:"shape",background:"#000000",borderWidth:.5,borderColor:"rgb(0,0,0)",pixelPerfect:!0,points:[56.80027,45.66302,56.80027,55.29751,56.80027,56.95863,56.46805,58.12141,55.8036,58.95197,54.97304,59.78253,53.81026,60.28086,52.14914,60.28086,50.65413,60.28086,49.65746,59.94864,48.99301,59.11808,48.16245,58.28752,47.83023,57.29085,47.83023,55.79584,47.83023,55.29751,49.98968,55.29751,49.98968,55.79584,49.98968,57.45696,50.65413,58.28752,52.14914,58.28752,52.9797,58.28752,53.64414,57.9553,53.97637,57.62307,54.30859,57.12474,54.4747,56.46029,54.4747,55.29751,54.4747,45.66302,56.80027,45.66302],segments:[1,2,4,4,4,4,2,2,2,4,4,4,2,2,5]}]}),ht.Default.setImage("editor.mtl",{width:64,height:64,fitSize:!0,attachStyle:"close",comps:[{type:"shape",background:"rgb(0,0,0)",points:[56.21111,19.11398,40.59837,2.34525,40.23096,1.94622,39.70418,1.92216,39.15478,1.92216,8.11505,1.92216,7.04265,1.92216,6.07649,2.35795,6.07649,3.40366,6.07649,60.1542,6.07649,61.1999,7.04299,62.07784,8.11505,62.07784,13.93496,62.07784,15.00736,62.07784,15.87481,61.28546,15.87481,60.23975,15.87481,59.19405,15.00702,58.40166,13.93496,58.40166,9.84618,58.40166,9.84618,5.59867,35.20824,5.59867,35.20824,21.86677,35.20824,22.91248,36.27174,23.64538,37.3438,23.64538,52.6875,23.64538,52.6875,35.56255,52.6875,36.60826,53.67148,37.45412,54.74388,37.45412,55.81629,37.45412,56.80027,36.60793,56.80027,35.56255,56.80027,20.28301,56.80027,19.81747,56.52917,19.46155,56.21111,19.11398,56.21111,19.11398,39.32101,6.67546,51.68947,19.9692,39.32101,19.9692,39.32101,6.67546,39.32101,6.67546],segments:[1,2,4,2,4,2,4,2,4,4,2,2,2,2,4,2,2,4,4,2,4,2,1,2,2,2,2]},{type:"shape",background:"#000000",borderWidth:.5,borderColor:"rgb(0,0,0)",pixelPerfect:!0,points:[21.55794,45.99697,26.66087,57.7337,26.66087,57.7337,31.7638,45.99697,34.31526,45.99697,34.31526,60.62536,32.10399,60.62536,32.10399,50.24941,32.10399,50.24941,27.68146,60.62536,25.81038,60.62536,21.38785,50.24941,21.38785,50.24941,21.38785,60.62536,19.00648,60.62536,19.00648,45.99697,21.55794,45.99697],segments:[1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,5]},{type:"shape",background:"#000000",borderWidth:.5,borderColor:"rgb(0,0,0)",pixelPerfect:!0,points:[48.09317,45.99697,48.09317,47.86804,43.16034,47.86804,43.16034,60.45527,40.94907,60.45527,40.94907,47.86804,36.01624,47.86804,36.01624,45.99697,48.09317,45.99697],segments:[1,2,2,2,2,2,2,2,2,5]},{type:"shape",background:"#000000",borderWidth:.5,borderColor:"rgb(0,0,0)",pixelPerfect:!0,points:[52.00541,45.99697,52.00541,58.58419,60,58.58419,60,60.45527,49.79414,60.45527,49.79414,45.82687,52.00541,45.82687],segments:[1,2,2,2,2,2,2,5]}]}),ht.Default.setImage("editor.ui",{modified:"Thu Jun 04 2020 09:40:36 GMT+0800 (China Standard Time)",width:16,height:16,fitSize:!0,attachStyle:"close",comps:[{type:"shape",background:"rgb(0,0,0)",points:[14.84148,4.57262,10.64058,.11253,10.54173,.0064,10.39999,0,10.25216,0,1.90035,0,1.61181,0,1.35184,.11591,1.35184,.39404,1.35184,15.48836,1.35184,15.76649,1.6119,16,1.90035,16,6.28421,16,6.57276,16,7.02587,15.76649,7.02587,15.48836,7.02587,15.21023,6.57267,15.02222,6.28421,15.02222,2.36615,15.02222,2.36615,.97787,9.19027,.97787,9.19027,5.3048,9.19027,5.58293,9.47642,5.77787,9.76488,5.77787,13.89338,5.77787,13.89338,8.94755,13.89338,9.22569,14.15814,9.45067,14.44669,9.45067,14.73524,9.45067,15,9.2256,15,8.94755,15,4.88356,15,4.75973,14.92706,4.66507,14.84148,4.57262,14.84148,4.57262,10.29689,1.26427,13.62485,4.80009,10.29689,4.80009,10.29689,1.26427,10.29689,1.26427],segments:[1,2,4,2,4,2,4,2,4,4,2,2,2,2,4,2,2,4,4,2,4,2,1,2,2,2,2]},{type:"shape",background:"#000000",borderWidth:.2,borderColor:"rgb(0,0,0)",pixelPerfect:!0,points:[10.74059,12.112,10.74059,14.67455,10.74059,15.11636,10.6512,15.42564,10.47242,15.64655,10.24894,15.86746,9.93607,16,9.48912,16,9.08686,16,8.81868,15.91164,8.6399,15.69073,8.41643,15.46982,8.32704,15.20473,8.32704,14.80709,8.32704,12.112,8.90807,12.112,8.90807,14.80709,8.90807,15.24891,9.08686,15.46982,9.48912,15.46982,9.71259,15.46982,9.89137,15.38146,9.98077,15.29309,10.07016,15.16055,10.11485,14.98382,10.11485,14.67455,10.11485,12.112,10.74059,12.112,10.74059,12.112],segments:[1,2,4,4,4,4,2,2,2,4,4,4,2,2,2]},{type:"rect",background:"rgb(0,0,0)",borderColor:"#979797",rect:[11.65679,12.112,.82321,3.888]}]}),ht.Default.setImage("editor.ui-tab",{modified:"Wed Feb 09 2022 15:40:49 GMT+0800 (China Standard Time)",background:"rgba(0,0,0,0)",width:16,height:16,comps:[{type:"shape",borderWidth:1.18192,borderColor:"#ffffff",pixelPerfect:!0,points:[1.36611,1.50486,14.63389,1.50486,14.63389,1.50486,14.63389,1.50486,14.63389,14.49514,14.63389,14.49514,14.63389,14.49514,1.36611,14.49514,1.36611,14.49514,1.36611,14.49514,1.36611,1.50486,1.36611,1.50486,1.36611,1.50486],segments:[1,2,3,2,3,2,3,2,3,5]},{type:"shape",borderWidth:1.18192,borderColor:"#ffffff",pixelPerfect:!0,points:[1.36611,1.50486,5.80414,1.50486,5.80414,1.50486,5.80414,1.50486,5.80414,14.49514,5.80414,14.49514,5.80414,14.49514,1.36611,14.49514,1.36611,14.49514,1.36611,14.49514,1.36611,1.50486,1.36611,1.50486,1.36611,1.50486],segments:[1,2,3,2,3,2,3,2,3,5]},{type:"shape",borderWidth:1.18192,borderColor:"#ffffff",pixelPerfect:!0,displayName:"\u4e0d\u89c4\u5219\u56fe\u5f62",points:[5.80414,1.50486,14.63389,1.50486,14.63389,1.50486,14.63389,1.50486,14.63389,4.48955,14.63389,4.48955,14.63389,4.48955,5.80414,4.48955,5.80414,4.48955,5.80414,4.48955,5.80414,1.50486,5.80414,1.50486,5.80414,1.50486],segments:[1,2,3,2,3,2,3,2,3,5]},{type:"shape",borderWidth:1.18192,borderColor:"#ffffff",pixelPerfect:!0,points:[2.98654,4.11748,4.17708,4.11748]},{type:"shape",borderWidth:1.18192,borderColor:"#ffffff",pixelPerfect:!0,points:[2.98654,7.02128,4.17708,7.02128]},{type:"shape",borderWidth:1.18192,borderColor:"#ffffff",pixelPerfect:!0,points:[2.98654,9.93317,4.17708,9.93317]}]}),ht.Default.setImage("editor.ttf",{width:64,height:64,fitSize:!0,comps:[{type:"shape",background:"#000000",points:[53.17006,60.62742,50.68081,60.62742,50.41177,60.62742,50.19585,60.41688,50.19585,60.15453,50.19585,43.31796,50.19585,43.05561,50.41177,42.84507,50.68081,42.84507,60.09288,42.84507,60.36192,42.84507,60.57784,43.05561,60.57784,43.31796,60.57784,45.40904,60.57784,45.67138,60.36192,45.88193,60.09288,45.88193,53.65537,45.88193,53.65537,50.62587,59.22886,50.62587,59.4979,50.62587,59.71382,50.83642,59.71382,51.09876,59.71382,53.18984,59.71382,53.45219,59.4979,53.66273,59.22886,53.66273,53.65537,53.66273,53.65537,60.1542,53.65537,60.41688,53.43911,60.62742,53.17006,60.62742,53.17006,60.62742],segments:[1,2,4,2,4,2,4,2,4,2,2,2,4,2,4,2,2,4,2]},{type:"shape",background:"#000000",
points:[56.21111,19.11398,40.59837,2.34525,40.23096,1.94622,39.70418,1.92216,39.15478,1.92216,8.11505,1.92216,7.04265,1.92216,6.07649,2.35795,6.07649,3.40366,6.07649,60.1542,6.07649,61.1999,7.04299,62.07784,8.11505,62.07784,13.93496,62.07784,15.00736,62.07784,15.87481,61.28546,15.87481,60.23975,15.87481,59.19405,15.00702,58.40166,13.93496,58.40166,9.84618,58.40166,9.84618,5.59867,35.20824,5.59867,35.20824,21.86677,35.20824,22.91248,36.27174,23.64538,37.3438,23.64538,52.6875,23.64538,52.6875,35.56255,52.6875,36.60826,53.67148,37.45412,54.74388,37.45412,55.81629,37.45412,56.80027,36.60793,56.80027,35.56255,56.80027,20.28301,56.80027,19.81747,56.52917,19.46155,56.21111,19.11398,56.21111,19.11398,39.32101,6.67546,51.68947,19.9692,39.32101,19.9692,39.32101,6.67546,39.32101,6.67546],segments:[1,2,4,2,4,2,4,2,4,4,2,2,2,2,4,2,2,4,4,2,4,2,1,2,2,2,2]},{type:"shape",background:"#000000",points:[41.52931,60.62742,39.04006,60.62742,38.77102,60.62742,38.5551,60.41688,38.5551,60.15453,38.5551,42.84507,46.88507,42.84507,47.15411,42.84507,47.37003,43.05561,47.37003,43.31796,47.37003,45.40904,47.37003,45.67138,47.15411,45.88193,46.88507,45.88193,42.01462,45.88193,42.01462,60.1542,42.01462,60.41688,41.79836,60.62742,41.52931,60.62742,41.52931,60.62742],segments:[1,2,4,2,2,4,2,4,2,2,4,2]},{type:"shape",background:"#000000",rotation:3.14159,points:[33.91988,42.84507,39.07014,42.84507,39.33918,42.84507,39.5551,43.05561,39.5551,43.31796,39.5551,45.40904,39.5551,45.67138,39.33918,45.88193,39.07014,45.88193,33.91988,45.88193],segments:[1,2,4,2,4,2]},{type:"shape",background:"#000000",points:[25.11617,60.62742,22.62692,60.62742,22.35788,60.62742,22.14196,60.41688,22.14196,60.15453,22.14196,42.84507,30.47192,42.84507,30.74096,42.84507,30.95688,43.05561,30.95688,43.31796,30.95688,45.40904,30.95688,45.67138,30.74096,45.88193,30.47192,45.88193,25.60148,45.88193,25.60148,60.1542,25.60148,60.41688,25.38522,60.62742,25.11617,60.62742,25.11617,60.62742],segments:[1,2,4,2,2,4,2,4,2,2,4,2]},{type:"shape",background:"#000000",rotation:3.14159,points:[17.50673,42.84507,22.657,42.84507,22.92604,42.84507,23.14196,43.05561,23.14196,43.31796,23.14196,45.40904,23.14196,45.67138,22.92604,45.88193,22.657,45.88193,17.50673,45.88193],segments:[1,2,4,2,4,2]}]}),ht.Default.setImage("editor.otf",{width:64,height:64,fitSize:!0,comps:[{type:"shape",background:"#000000",points:[53.17006,60.62742,50.68081,60.62742,50.41177,60.62742,50.19585,60.41688,50.19585,60.15453,50.19585,43.31796,50.19585,43.05561,50.41177,42.84507,50.68081,42.84507,60.09288,42.84507,60.36192,42.84507,60.57784,43.05561,60.57784,43.31796,60.57784,45.40904,60.57784,45.67138,60.36192,45.88193,60.09288,45.88193,53.65537,45.88193,53.65537,50.62587,59.22886,50.62587,59.4979,50.62587,59.71382,50.83642,59.71382,51.09876,59.71382,53.18984,59.71382,53.45219,59.4979,53.66273,59.22886,53.66273,53.65537,53.66273,53.65537,60.1542,53.65537,60.41688,53.43911,60.62742,53.17006,60.62742,53.17006,60.62742],segments:[1,2,4,2,4,2,4,2,4,2,2,2,4,2,4,2,2,4,2]},{type:"shape",background:"#000000",points:[56.21111,19.11398,40.59837,2.34525,40.23096,1.94622,39.70418,1.92216,39.15478,1.92216,8.11505,1.92216,7.04265,1.92216,6.07649,2.35795,6.07649,3.40366,6.07649,60.1542,6.07649,61.1999,7.04299,62.07784,8.11505,62.07784,13.93496,62.07784,15.00736,62.07784,15.87481,61.28546,15.87481,60.23975,15.87481,59.19405,15.00702,58.40166,13.93496,58.40166,9.84618,58.40166,9.84618,5.59867,35.20824,5.59867,35.20824,21.86677,35.20824,22.91248,36.27174,23.64538,37.3438,23.64538,52.6875,23.64538,52.6875,35.56255,52.6875,36.60826,53.67148,37.45412,54.74388,37.45412,55.81629,37.45412,56.80027,36.60793,56.80027,35.56255,56.80027,20.28301,56.80027,19.81747,56.52917,19.46155,56.21111,19.11398,56.21111,19.11398,39.32101,6.67546,51.68947,19.9692,39.32101,19.9692,39.32101,6.67546,39.32101,6.67546],segments:[1,2,4,2,4,2,4,2,4,4,2,2,2,2,4,2,2,4,4,2,4,2,1,2,2,2,2]},{type:"shape",background:"#000000",points:[41.52931,60.62742,39.04006,60.62742,38.77102,60.62742,38.5551,60.41688,38.5551,60.15453,38.5551,42.84507,46.88507,42.84507,47.15411,42.84507,47.37003,43.05561,47.37003,43.31796,47.37003,45.40904,47.37003,45.67138,47.15411,45.88193,46.88507,45.88193,42.01462,45.88193,42.01462,60.1542,42.01462,60.41688,41.79836,60.62742,41.52931,60.62742,41.52931,60.62742],segments:[1,2,4,2,2,4,2,4,2,2,4,2]},{type:"shape",background:"#000000",rotation:3.14159,points:[33.91988,42.84507,39.07014,42.84507,39.33918,42.84507,39.5551,43.05561,39.5551,43.31796,39.5551,45.40904,39.5551,45.67138,39.33918,45.88193,39.07014,45.88193,33.91988,45.88193],segments:[1,2,4,2,4,2]},{type:"oval",borderWidth:3.3,borderColor:"rgb(0,0,0)",rect:[18.97543,44.76232,11.82189,13.94784]}]}),ht.Default.setImage("editor.js",{width:64,height:64,fitSize:!0,comps:[{type:"shape",background:"#000000",points:[56.21111,19.11398,40.59837,2.34525,40.23096,1.94622,39.70418,1.92216,39.15478,1.92216,8.11505,1.92216,7.04265,1.92216,6.07649,2.35795,6.07649,3.40366,6.07649,60.1542,6.07649,61.1999,7.04299,62.07784,8.11505,62.07784,13.93496,62.07784,15.00736,62.07784,15.87481,61.28546,15.87481,60.23975,15.87481,59.19405,15.00702,58.40166,13.93496,58.40166,9.84618,58.40166,9.84618,5.59867,35.20824,5.59867,35.20824,21.86677,35.20824,22.91248,36.27174,23.64538,37.3438,23.64538,52.6875,23.64538,52.6875,35.56255,52.6875,36.60826,53.67148,37.45412,54.74388,37.45412,55.81629,37.45412,56.80027,36.60793,56.80027,35.56255,56.80027,20.28301,56.80027,19.81747,56.52917,19.46155,56.21111,19.11398,56.21111,19.11398,39.32101,6.67546,51.68947,19.9692,39.32101,19.9692,39.32101,6.67546,39.32101,6.67546],segments:[1,2,4,2,4,2,4,2,4,4,2,2,2,2,4,2,2,4,4,2,4,2,1,2,2,2,2]},{type:"text",text:{func:"attr@name",value:"JS"},align:"center",font:"bold 24px Arial Rounded MT Bold",rect:[17.50673,40.58187,46.49327,23.41813]}]}),ht.Default.setImage("editor.sound",{width:64,height:64,fitSize:!0,comps:[{type:"shape",background:"#000000",points:[56.21111,19.11398,40.59837,2.34525,40.23096,1.94622,39.70418,1.92216,39.15478,1.92216,8.11505,1.92216,7.04265,1.92216,6.07649,2.35795,6.07649,3.40366,6.07649,60.1542,6.07649,61.1999,7.04299,62.07784,8.11505,62.07784,13.93496,62.07784,15.00736,62.07784,15.87481,61.28546,15.87481,60.23975,15.87481,59.19405,15.00702,58.40166,13.93496,58.40166,9.84618,58.40166,9.84618,5.59867,35.20824,5.59867,35.20824,21.86677,35.20824,22.91248,36.27174,23.64538,37.3438,23.64538,52.6875,23.64538,52.6875,35.56255,52.6875,36.60826,53.67148,37.45412,54.74388,37.45412,55.81629,37.45412,56.80027,36.60793,56.80027,35.56255,56.80027,20.28301,56.80027,19.81747,56.52917,19.46155,56.21111,19.11398,56.21111,19.11398,39.32101,6.67546,51.68947,19.9692,39.32101,19.9692,39.32101,6.67546,39.32101,6.67546],segments:[1,2,4,2,4,2,4,2,4,4,2,2,2,2,4,2,2,4,4,2,4,2,1,2,2,2,2]},{type:"shape",background:"#231815",points:[29.93506,40.65719,29.93506,52.11129,29.99768,52.17391,38.01482,58.31199,38.01482,53.06642,38.01482,39.70982,38.01482,34.45641,29.93506,40.65719,29.93506,40.65719,29.93506,40.65719,29.93506,40.65719,44.44257,36.03797,44.44257,36.03797,43.87107,35.70912,43.69881,34.9732,44.02766,34.40163,44.37211,33.84573,45.10803,33.65787,45.66393,33.99448,47.80131,35.26287,49.59417,37.09491,50.81553,39.2714,52.01338,41.37743,52.71019,43.80448,52.71019,46.38028,52.71019,48.95608,52.01338,51.38313,50.81553,53.48924,49.59417,55.65789,47.80131,57.49777,45.66393,58.77392,45.10803,59.1262,44.37211,58.93834,44.02766,58.35901,43.69881,57.79528,43.87107,57.05152,44.44257,56.7305,46.24326,55.65789,47.71518,54.13119,48.7486,52.32266,49.73508,50.57675,50.30665,48.55685,50.30665,46.38812,50.30665,44.23514,49.72724,42.19948,48.7486,40.46141,47.71518,38.63721,46.23542,37.10275,44.44257,36.03797,44.44257,36.03797,44.44257,36.03797,28.49449,40.89991,28.49449,40.89991,23.62472,40.89991,23.62472,51.86073,28.49449,51.86073,28.49449,40.89991,28.49449,40.89991,28.49449,40.89991,28.80767,38.51197,28.80767,38.51197,38.42189,31.14469,38.64118,30.96459,38.91517,30.86286,39.21267,30.86286,39.88597,30.86286,40.41052,31.38741,40.41052,32.05287,40.41052,39.70982,40.41052,39.97605,41.53008,40.43014,42.47745,41.16606,43.21337,42.09776,44.14506,43.28777,44.7088,44.76753,44.7088,46.38812,44.7088,48.00879,44.1529,49.50414,43.21337,50.67856,42.50096,51.61017,41.53008,52.33834,40.41052,52.80027,40.41052,53.07426,40.41052,60.72336,40.41052,60.99743,40.32439,61.24015,40.1678,61.45936,39.76073,61.97607,39.01698,62.07788,38.50019,61.67073,28.82334,54.25651,22.46606,54.25651,22.43471,54.25651,21.77708,54.25651,21.23686,53.72412,21.23686,53.06642,21.23686,39.73333,21.23686,39.70982,21.23686,39.04435,21.76924,38.51197,22.43471,38.51197,28.80767,38.51197,28.80767,38.51197,28.80767,38.51197,40.40269,41.5497,40.40269,41.5497,40.40269,51.21878,41.06823,50.85858,41.62405,50.37322,42.08598,49.79381,42.8219,48.86219,43.26039,47.6721,43.26039,46.38812,43.26039,45.11197,42.81414,43.92196,42.08598,42.98243,41.62405,42.39526,41.06039,41.90982,40.40269,41.5497,40.40269,41.5497,40.40269,41.5497],segments:[1,2,2,2,2,2,2,2,2,2,2,1,2,4,4,4,4,4,4,4,4,4,4,4,4,2,2,1,2,2,2,2,2,2,2,1,2,2,4,4,2,2,4,4,4,4,2,2,4,4,2,2,2,4,2,2,4,2,2,2,1,2,2,4,4,4,4,2,2]}]}),ht.Default.setImage("editor.video",{width:64,height:64,fitSize:!0,comps:[{type:"shape",background:"#000000",points:[56.21111,19.11398,40.59837,2.34525,40.23096,1.94622,39.70418,1.92216,39.15478,1.92216,8.11505,1.92216,7.04265,1.92216,6.07649,2.35795,6.07649,3.40366,6.07649,60.1542,6.07649,61.1999,7.04299,62.07784,8.11505,62.07784,13.93496,62.07784,15.00736,62.07784,15.87481,61.28546,15.87481,60.23975,15.87481,59.19405,15.00702,58.40166,13.93496,58.40166,9.84618,58.40166,9.84618,5.59867,35.20824,5.59867,35.20824,21.86677,35.20824,22.91248,36.27174,23.64538,37.3438,23.64538,52.6875,23.64538,52.6875,35.56255,52.6875,36.60826,53.67148,37.45412,54.74388,37.45412,55.81629,37.45412,56.80027,36.60793,56.80027,35.56255,56.80027,20.28301,56.80027,19.81747,56.52917,19.46155,56.21111,19.11398,56.21111,19.11398,39.32101,6.67546,51.68947,19.9692,39.32101,19.9692,39.32101,6.67546,39.32101,6.67546],segments:[1,2,4,2,4,2,4,2,4,4,2,2,2,2,4,2,2,4,4,2,4,2,1,2,2,2,2]},{type:"shape",background:"#231815",points:[34.79567,39.50193,35.8771,39.50193,36.86394,39.06777,37.56645,38.36518,38.28485,37.63888,38.7269,36.65212,38.7269,35.57851,38.7269,34.497,38.28485,33.51024,37.56645,32.80765,36.86394,32.08933,35.86927,31.6472,34.79567,31.6472,33.70626,31.6472,32.7274,32.08933,32.0169,32.80765,31.30641,33.51024,30.86435,34.497,30.86435,35.57851,30.86435,36.65212,31.30641,37.63888,32.0169,38.36518,32.7274,39.05987,33.71416,39.50193,34.79567,39.50193,34.79567,39.50193,34.79567,39.50193,33.03527,33.81021,33.03527,33.81021,33.47733,33.36816,34.10098,33.08399,34.79567,33.08399,35.48246,33.08399,36.0982,33.36816,36.54816,33.81021,36.99022,34.26807,37.27438,34.88382,37.27438,35.57061,37.27438,36.2574,36.99022,36.87315,36.54816,37.33101,36.0982,37.76524,35.48246,38.0494,34.79567,38.0494,34.10098,38.0494,33.47733,37.76524,33.03527,37.33101,32.59314,36.87315,32.31687,36.2574,32.31687,35.57061,32.31687,34.88382,32.59314,34.27598,33.03527,33.81021,33.03527,33.81021,33.03527,33.81021,38.719,42.35963,38.719,42.35963,39.05848,43.38583,39.77688,44.19107,40.6768,44.64103,42.60298,45.61989,44.97913,44.84625,45.95008,42.92007,46.40794,42.02015,46.53422,40.94655,46.17901,39.92027,45.86323,38.89408,45.14484,38.08884,44.23702,37.63888,43.33711,37.18892,42.2714,37.06264,41.24513,37.40995,40.21894,37.74943,39.39789,38.46775,38.95583,39.35984,38.49007,40.25185,38.3796,41.32546,38.719,42.35963,38.719,42.35963,38.719,42.35963,40.24257,40.02292,40.24257,40.02292,40.53471,39.44669,41.04781,38.99665,41.68726,38.77563,42.33454,38.5704,43.02923,38.64144,43.58184,38.93351,44.15808,39.22558,44.60803,39.72295,44.82124,40.38604,45.03436,41.03339,44.96332,41.70438,44.67907,42.28851,44.06341,43.50428,42.55557,43.98577,41.33198,43.3543,40.77937,43.07005,40.30578,42.56486,40.10048,41.9175,39.87945,41.25442,39.9663,40.58343,40.24257,40.02292,40.24257,40.02292,40.24257,40.02292,40.13209,46.26716,40.13209,46.26716,39.16114,46.10935,38.09543,46.33828,37.21915,46.96976,36.34286,47.61711,35.80606,48.54073,35.65607,49.5354,35.65607,49.5354,35.50608,50.53006,35.71929,51.57996,36.35076,52.46415,36.98231,53.33245,37.89803,53.86926,38.89269,54.02714,38.9243,54.02714,41.04781,54.38235,43.08447,52.8904,43.42395,50.76689,43.42395,50.75899,43.56604,49.76433,43.34501,48.71435,42.71346,47.84604,42.06618,46.96976,41.14256,46.42505,40.13209,46.26716,40.13209,46.26716,40.13209,46.26716,39.14533,52.60623,39.14533,52.60623,39.12953,52.59833,38.49797,52.49568,37.91384,52.1641,37.51912,51.61157,37.1244,51.05896,36.97441,50.38798,37.07706,49.75642,37.17181,49.13278,37.51912,48.54073,38.07172,48.13021,38.62433,47.73549,39.30322,47.60131,39.93469,47.69606,40.55044,47.79081,41.15046,48.13021,41.5451,48.69072,41.94772,49.24333,42.08981,49.91431,41.98724,50.53796,41.77403,51.87993,40.4794,52.81936,39.14533,52.60623,39.14533,52.60623,39.14533,52.60623,49.24984,57.84791,49.24984,57.84791,41.37939,57.84791,46.82629,55.31388,50.46553,49.76433,50.46553,43.63056,50.46553,39.30453,48.70514,35.38909,45.86323,32.54719,43.03714,29.72109,39.12162,27.9607,34.79567,27.9607,26.1594,27.9607,19.12572,34.99437,19.12572,43.63056,19.12572,47.94079,20.88612,51.87993,23.71222,54.69813,26.54622,57.54003,30.46963,59.30043,34.79567,59.30043,35.20611,59.30043,35.29296,59.30043,49.24984,59.30043,49.64456,59.30043,49.96816,58.96893,49.96816,58.57421,49.96816,58.17158,49.64456,57.84791,49.24984,57.84791,49.24984,57.84791,49.24984,57.84791,34.79567,56.88485,34.79567,56.88485,31.13271,56.88485,27.81723,55.39282,25.42528,53.00087,23.01761,50.5853,21.54138,47.28553,21.54138,43.62266,21.54138,36.34425,27.51725,30.36837,34.79567,30.36837,38.45064,30.36837,41.77403,31.8525,44.15808,34.25227,46.56583,36.64422,48.04206,39.96769,48.04206,43.62266,48.04206,47.28553,46.55793,50.6011,44.16598,53.00087,41.68726,55.48757,38.30856,56.88485,34.79567,56.88485,34.79567,56.88485,34.79567,56.88485,28.91446,44.64103,28.91446,44.64103,29.80655,44.18317,30.54067,43.38583,30.86435,42.35173,31.19593,41.32546,31.08538,40.25976,30.63542,39.35984,29.67237,37.44156,27.25672,36.66002,25.35424,37.63888,23.42015,38.62564,22.64651,41.00178,23.62545,42.92007,24.07541,43.81998,24.88057,44.53838,25.90684,44.86206,26.94884,45.20146,28.02245,45.09889,28.91446,44.64103,28.91446,44.64103,28.91446,44.64103,26.3647,43.51211,26.3647,43.51211,25.71735,43.29108,25.20425,42.82532,24.91218,42.28069,24.29643,41.0492,24.79373,39.54136,26.00942,38.92561,27.22519,38.30986,28.73294,38.79143,29.34869,40.02292,29.63286,40.59134,29.7118,41.25442,29.50658,41.90178,29.28555,42.54905,28.81979,43.06215,28.27509,43.34639,27.69877,43.63056,27.01198,43.71741,26.3647,43.51211,26.3647,43.51211,26.3647,43.51211,29.44344,46.26716,29.44344,46.26716,27.31195,46.59874,25.85153,48.61178,26.17521,50.72738,26.17521,50.75899,26.33309,51.75365,26.8778,52.69308,27.73828,53.32455,28.59876,53.9561,29.66447,54.17713,30.62752,54.02714,30.66703,54.01924,32.80634,53.67194,34.25886,51.66681,33.92728,49.52749,33.60361,47.39609,31.58275,45.94356,29.44344,46.26716,29.44344,46.26716,29.44344,46.26716,32.50637,49.75642,32.50637,49.75642,32.7274,51.1063,31.80378,52.39303,30.44593,52.60623,30.4223,52.61413,29.79865,52.7009,29.13557,52.55091,28.59086,52.14837,28.04616,51.75365,27.69877,51.15371,27.5962,50.53006,27.5962,50.50635,27.3909,49.17229,28.33032,47.90128,29.66447,47.69606,31.00644,47.48293,32.29317,48.40655,32.50637,49.75642,32.50637,49.75642,32.50637,49.75642,32.50637,49.75642,37.44808,43.63056,37.44808,43.63056,37.44808,42.89644,37.1481,42.22537,36.67444,41.75171,36.18497,41.27022,35.52189,40.96235,34.79567,40.96235,34.06147,40.96235,33.39048,41.27022,32.90891,41.75171,32.43525,42.23328,32.14318,42.89644,32.14318,43.63056,32.14318,44.36469,32.43525,45.02785,32.90891,45.50933,33.39838,45.983,34.06147,46.28297,34.79567,46.28297,36.25609,46.28297,37.44808,45.08308,37.44808,43.63056,37.44808,43.63056,37.44808,43.63056,34.79567,44.83835,34.79567,44.83835,34.45619,44.83835,34.14831,44.71207,33.93519,44.49104,33.71416,44.28574,33.5878,43.96997,33.5878,43.63846,33.5878,43.31479,33.71416,42.99901,33.93519,42.77798,34.14831,42.56486,34.45619,42.42277,34.79567,42.42277,35.11927,42.42277,35.42714,42.55695,35.64817,42.77798,35.86927,42.99901,36.01136,43.31479,36.01136,43.63846,36.01136,44.30155,35.46665,44.83835,34.79567,44.83835,34.79567,44.83835,34.79567,44.83835],segments:[1,4,4,4,4,4,4,4,4,2,2,1,2,4,4,4,4,4,4,4,4,2,2,1,2,4,4,4,4,4,4,4,2,2,1,2,4,4,4,4,4,4,4,2,2,1,2,4,4,2,4,4,2,4,2,4,4,2,2,1,2,2,4,4,4,4,4,4,4,2,2,1,2,2,4,4,4,4,4,4,2,2,2,4,4,2,2,1,2,4,4,4,4,4,4,4,2,2,1,2,4,4,4,4,4,4,2,2,1,2,4,4,4,4,4,4,2,2,1,2,4,2,4,4,2,4,4,2,2,1,2,4,2,4,4,2,4,4,2,2,2,1,2,4,4,4,4,4,4,4,2,2,1,2,4,4,4,4,4,4,4,2,2]}]}),ht.Default.setImage("editor.file.model.htb",{width:200,height:200,comps:[{type:"image",stretch:"centerUniform",name:{func:function(M){return M._imageURL},value:"editor.unknown"},rect:[0,0,200,200]},{type:"image",color:"rgb(0,0,0)",name:"editor.symbol3d",shadow:!0,shadowColor:"rgb(255,255,255)",shadowBlur:2,shadowOffsetX:1,shadowOffsetY:1,scaleX:4,scaleY:4,rect:[154,154,16,16]}]}),ht.Default.setImage("editor.flipx",{width:16,height:16,comps:[{type:"shape",points:[8,1,8,14],segments:[1,2],borderWidth:1,borderColor:oN.config.color_dark},{type:"shape",points:[6,3,6,13,2,13],background:oN.config.color_dark},{type:"shape",points:[10,3,10,13,14,13],background:oN.config.color_select}]}),ht.Default.setImage("editor.flipy",{width:16,height:16,comps:[{type:"shape",points:[2,8,15,8],segments:[1,2],borderWidth:1,borderColor:oN.config.color_dark},{type:"shape",points:[3,6,13,6,3,2],background:oN.config.color_dark},{type:"shape",points:[3,10,13,10,3,14],background:oN.config.color_select}]}),ht.Default.setImage("editor.resetsize",{width:16,height:16,comps:[{type:"shape",borderWidth:1,borderColor:"white",points:[8,1,8,6,6,3,8,1,10,3,8,10,8,15,6,13,8,15,10,13,1,8,6,8,3,6,1,8,3,10,10,8,15,8,13,6,15,8,13,10],segments:[1,2,1,2,2,1,2,1,2,2,1,2,1,2,2,1,2,1,2,2]}]}),ht.Default.setImage("editor.func",{width:16,height:16,comps:[{type:"border",rect:[0,0,16,16],width:1,color:"#E4E4E4"},{type:"text",rect:[0,0,16,16],text:"F",align:"center",color:"black"}]}),ht.Default.setImage("editor.comp",{fitSize:!0,comps:[{type:{func:function(M){return M.compType},isSafeFunc:!0}}]}),ht.Default.setImage("editor.oops",{width:128,height:128,comps:[{type:"oval",background:"rgb(255,255,255)",borderWidth:2,borderColor:"rgb(61,61,61)",rect:[21.53429,22.96531,88.8981,74.69064]},{type:"shape",background:"rgb(237,237,237)",borderColor:"#979797",points:[34.08079,87.52544,34.08079,87.52544,59.57908,97.75645,77.79215,90.58303,96.00522,83.40961,106.8249,68.87436,109.71641,51.69689,109.71641,51.69689,117.89865,74.48774,101.34821,87.52544,84.79777,100.56314,59.50721,102.27801,46.42474,94.29524],segments:[1,4,4,4,4]},{type:"arc",background:"rgb(196,185,185)",borderColor:"rgb(61,61,61)",arcTo:0,arcOval:!0,rotation:3.14159,rect:[32.3979,36.49467,28.49791,18.12387]},{type:"arc",background:"rgb(196,185,185)",borderColor:"rgb(61,61,61)",arcTo:0,arcOval:!0,rotation:3.14159,rect:[68.95508,36.49467,28.49791,18.12387]},{type:"shape",background:"rgb(149,224,245)",borderColor:"#979797",points:[39.9814,51.13901,39.9814,51.13901,32.00842,57.90113,30.56723,66.4088,29.12604,74.91647,34.21664,85.16969,34.21664,85.16969,39.0516,89.44677,39.0516,89.44677,36.05169,79.68945,37.3999,70.48443,38.74811,61.27941,44.44444,52.62669,44.44444,52.62669,39.9814,51.13901,39.9814,51.13901],segments:[1,4,4,2,4,4,2,2]},{type:"shape",background:"rgb(149,224,245)",borderColor:"#979797",scaleX:-1,points:[97.67259,49.56003,97.67259,49.56003,89.6996,57.90113,88.25841,66.4088,86.81722,74.91647,91.8398,85.99598,91.8398,85.99598,96.74279,89.44677,96.74279,89.44677,93.74288,79.68945,95.09109,70.48443,96.4393,61.27941,102.44264,50.50641,102.44264,50.50641,97.67259,49.56003],segments:[1,4,4,2,4,4,2]},{type:"shape",borderWidth:2,borderColor:"rgb(61,61,61)",borderCap:"round",points:[59.61377,32.055,59.61377,32.055,61.61221,36.91182,59.19747,38.71578,56.78274,40.51974,34.08079,42.18493,34.08079,42.18493],segments:[1,4,4]},{type:"shape",borderWidth:2,borderColor:"rgb(61,61,61)",borderCap:"round",scaleX:-1,points:[94.48806,32.055,94.48806,32.055,96.4865,36.91182,94.07177,38.71578,91.65703,40.51974,68.95508,42.18493,68.95508,42.18493],segments:[1,4,4]},{type:"shape",borderWidth:2,borderColor:"rgb(61,61,61)",borderCap:"round",points:[67.02409,33.58143,67.02409,33.58143,64.9426,37.74441,67.02409,39.68714],segments:[1,4]},{type:"arc",background:"rgb(255,255,255)",borderWidth:2,borderColor:"rgb(61,61,61)",arcTo:0,arcOval:!0,rotation:3.14159,rect:[68.95508,40.07324,28.49791,11.89121]},{type:"arc",background:"rgb(255,255,255)",borderWidth:2,borderColor:"rgb(61,61,61)",arcTo:0,arcOval:!0,rotation:3.14159,rect:[32.3979,40.07323,28.49791,11.89121]},{type:"shape",borderWidth:2,borderColor:"rgb(61,61,61)",borderCap:"round",points:[60.89581,46.6003,56.70566,57.66949,39.6779,55.58118,39.6779,55.58118],segments:[1,4]},{type:"shape",borderWidth:2,borderColor:"rgb(61,61,61)",borderCap:"round",scaleX:-1,points:[90.173,46.6003,85.98284,57.66949,68.95508,55.58118,68.95508,55.58118],segments:[1,4]},{type:"shape",background:"rgb(61,61,61)",borderColor:"#979797",points:[40.88134,45.66533,40.88134,50.44931,49.68823,51.31913,49.03586,45.66533,40.99007,45.5566]},{type:"shape",background:"rgb(61,61,61)",borderColor:"#979797",points:[78.31735,45.66533,78.31735,50.44931,87.12423,51.31913,86.47187,45.66533,78.42607,45.5566]},{type:"shape",borderWidth:2,borderColor:"rgb(61,61,61)",borderCap:"round",points:[36.81151,80.08117,46.71402,84.60188,54.03326,76.42155,61.35251,85.46297,73.83828,76.20628,86.96987,83.95607,93.85858,76.85209,99.24038,80.08117]},{type:"shape",background:"rgb(237,237,237)",borderColor:"rgb(61,61,61)",borderCap:"round",points:[95.58345,31.98512,95.58345,31.98512,104.33563,25.53184,105.97087,18.7394,107.6061,11.94695,113.65647,33.63444,105.97087,42.39888],segments:[1,4,4]},{type:"shape",background:"rgb(237,237,237)",borderColor:"rgb(61,61,61)",borderCap:"round",rotation:.2618,points:[44.41276,23.77714,38.68944,23.77714,33.30496,20.23699,28.88983,14.5401,24.47469,8.84321,22.55729,35.68983,32.04166,40.72938],segments:[1,4,4]},{type:"oval",borderWidth:2,borderColor:"rgb(61,61,61)",rect:[21.53429,22.96531,88.8981,74.69064]},{type:"shape",borderWidth:2,borderColor:"rgb(61,61,61)",borderCap:"round",points:[93.19422,30.5138,93.19422,30.5138,96.32695,28.82985,99.04364,25.51534,100.63358,23.57553,102.08422,21.24706,102.68792,18.7394,104.32316,11.94695,112.13179,31.92062,104.44618,40.68506],segments:[1,4,4,4]},{type:"shape",borderWidth:2,borderColor:"rgb(61,61,61)",borderCap:"round",rotation:.2618,points:[40.62881,26.14647,34.90549,26.14647,32.31798,22.75803,27.90285,17.06114,23.48771,11.36426,18.41848,35.24736,27.90285,40.28692],segments:[1,4,4]},{type:"oval",background:"rgb(255,255,255)",borderColor:"#979797",anchorX:.41176,anchorY:.88889,rect:[91.52207,49.98659,1.67215,3.35736]},{type:"oval",background:"rgb(255,255,255)",borderColor:"#979797",anchorX:.41176,anchorY:.88889,rect:[39.44815,49.46033,2.86639,3.35736]}]}),ht.Default.setImage("editor.block",{background:"rgb(179,179,179)",width:16,height:16,blendMode:"override",comps:[{type:"shape",background:"rgb(255,227,199)",borderWidth:1,borderColor:"rgb(138,138,138)",borderCap:"round",shadowColor:"#1ABC9C",points:[15,14.5,1,14.5,1,1.50001,7,1.50001,8,3.50001,15,3.50001,15,14.5]},{type:"rect",background:"rgb(255,255,255)",borderWidth:1,borderColor:"rgb(138,138,138)",rect:[5.5,7.22625,6,5]},{type:"circle",background:"rgb(255,255,255)",borderWidth:1,borderColor:"rgb(138,138,138)",rect:[2.5,4.72625,6,5]}]}),ht.Default.setImage("editor.group",{background:"rgb(179,179,179)",width:16,height:16,blendMode:"override",comps:[{type:"shape",background:"rgb(255,227,199)",borderWidth:1,borderColor:"rgb(138,138,138)",borderCap:"round",shadowColor:"#1ABC9C",points:[15.5,15.5,.5,15.5,.5,.5,6.92857,.5,8.00001,2.80769,15.5,2.80769,15.5,15.5]},{type:"shape",background:"rgb(255,255,255)",borderWidth:1,borderColor:"rgb(138,138,138)",borderCap:"round",shadowColor:"#1ABC9C",points:[2.82964,11.54111,13.17036,11.54111,13.17036,13.12467,13.17036,5.20688,2.82964,5.20688,2.82964,13.12467,13.17036,13.12467,7.26137,13.12467,5.78413,15.5,10.21588,15.5,8.84426,13.12467,13.17036,13.12467,13.17036,11.54111]}]}),ht.Default.setImage("editor.subgraph",{background:"rgb(179,179,179)",width:16,height:16,blendMode:"override",comps:[{type:"shape",background:"rgb(255,227,199)",borderWidth:1,borderColor:"rgb(138,138,138)",borderCap:"round",shadowColor:"#1ABC9C",points:[15.5,15.5,.5,15.5,.5,.5,6.92857,.5,8.00001,2.80769,15.5,2.80769,15.5,15.5]},{type:"shape",background:"rgb(255,255,255)",borderWidth:1,borderColor:"rgb(138,138,138)",closePath:!0,points:[4.90316,8.05737,4.90316,8.05737,4.30121,6.50546,5.25104,5.82166,6.20086,5.13787,7.09165,5.82166,7.09165,5.82166,7.09165,5.82166,7.76857,4.36921,9.6391,4.91013,11.50964,5.45106,11.09684,8.05737,11.09684,8.05737,11.09684,8.05737,12.482,8.53031,12.482,9.79106,12.482,10.86629,11.67411,11.63079,11.09684,11.63079,4.90316,11.63079,4.31315,11.63079,3.518,10.84732,3.518,9.79106,3.518,8.56402,4.90316,8.05737,4.90316,8.05737],segments:[1,4,4,4,4,4,4,2,4,4]},{type:"shape",borderWidth:1,borderColor:"rgb(138,138,138)",borderJoin:"miter",points:[13,13.5,8.02409,13.5,8,9,8.02409,13.5,3,13.5]}]}),ht.Default.setImage("editor.restore",{background:"rgb(179,179,179)",width:16,height:16,blendMode:"override",comps:[{type:"triangle",background:"rgb(138,138,138)",borderWidth:1,borderColor:"rgb(138,138,138)",shadowColor:"#1ABC9C",rotation:1.5708,rect:[7.5,1.71892,3,2]},{type:"arc",borderWidth:1,borderColor:"rgb(138,138,138)",borderCap:"round",arcFrom:0,arcTo:4.7124,arcClose:!1,shadowColor:"#1ABC9C",rect:[2,2.78108,12,12]}]}),ht.Default.setImage("editor.add",{background:"rgb(150,150,150)",width:16,height:16,comps:[{type:"shape",borderWidth:1,borderColor:"rgb(255,255,255)",rotation:3.14159,points:[9.47991,2.5,13.48953,7.4,9.47991,7.4,9.47991,2.5,2.48953,2.5,2.48953,13.5,13.48953,13.5,13.48953,7.4]}]}),ht.Default.setImage("editor.addColor",{width:16,height:16,comps:[{type:"shape",borderWidth:2,borderColor:"#979797",borderCap:"round",points:[3,8,13,8,8,3,8,13],segments:[1,2,1,2]}]}),ht.Default.setImage("editor.delete",{background:"rgb(89,89,89)",width:16,height:16,comps:[{type:"shape",borderWidth:1,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[5.5,5.57173,5.5,12.45709]},{type:"shape",borderWidth:1,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[8.05685,5.57173,8.05685,12.45709]},{type:"shape",borderWidth:1,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[10.5,5.57173,10.5,12.45709]},{type:"shape",borderWidth:1,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[1,3.18902,15,3.16996,5.32652,3.16021,6.32652,1.16021,9.32652,1.16021,10.32652,3.16021]},{type:"rect",borderWidth:1,borderColor:"rgb(255,255,255)",shadowColor:"#1ABC9C",rect:[3.33333,3.18902,9.33334,11.65078]}]}),ht.Default.setImage("editor.import",{background:"rgb(179,179,179)",width:16,height:16,comps:[{type:"triangle",borderColor:"rgb(255,255,255)",borderWidth:1,rotation:1.5708,rect:[7.5,1.71892,3,2]},{type:"arc",borderWidth:1,borderColor:"rgb(255,255,255)",borderCap:"round",arcFrom:0,arcTo:4.7124,arcClose:!1,rect:[2,2.78108,12,12]}]}),ht.Default.setImage("editor.top",{background:"rgb(145,145,145)",width:16,height:16,comps:[{type:"rightTriangle",borderWidth:1,borderColor:"rgb(255,255,255)",shadowColor:"#1ABC9C",rotation:2.35619,rect:[3.86035,6.44002,8.20153,8.2581]},{type:"shape",borderWidth:1,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",rotation:3.14159,points:[2.14176,4.58061,13.85824,4.51881]}]}),ht.Default.setImage("editor.up",{background:"rgb(145,145,145)",width:16,height:16,comps:[{type:"rightTriangle",borderWidth:1,borderColor:"rgb(255,255,255)",shadowColor:"#1ABC9C",rotation:2.35619,rect:[3.89924,6.05159,8.20153,8.2581]}]}),ht.Default.setImage("editor.down",{background:"rgb(145,145,145)",width:16,height:16,comps:[{type:"rightTriangle",borderWidth:1,borderColor:"rgb(255,255,255)",shadowColor:"#1ABC9C",rotation:5.49779,rect:[3.89924,.69031,8.20153,8.2581]}]}),ht.Default.setImage("editor.bottom",{background:"rgb(145,145,145)",width:16,height:16,comps:[{type:"rightTriangle",borderWidth:1,borderColor:"rgb(255,255,255)",shadowColor:"#1ABC9C",rotation:5.49779,rect:[3.93812,.69031,8.20153,8.2581]},{type:"shape",borderWidth:1,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",rotation:3.14159,points:[2.14176,10.85024,13.85824,10.78844]}]}),ht.Default.setImage("editor.menu",{background:"rgb(179,179,179)",width:16,height:16,blendMode:"override",comps:[{type:"shape",borderWidth:1,borderColor:"rgb(138,138,138)",borderCap:"round",shadowColor:"#1ABC9C",points:[.93729,4,14.93729,4]},{type:"shape",borderWidth:1,borderColor:"rgb(138,138,138)",borderCap:"round",shadowColor:"#1ABC9C",points:[1.06271,8,15.06271,8]},{type:"shape",borderWidth:1,borderColor:"rgb(138,138,138)",borderCap:"round",shadowColor:"#1ABC9C",points:[1.06271,12,15.06271,12]}]}),ht.Default.setImage("editor.undo",{background:"rgb(191,191,191)",width:16,height:16,comps:[{type:"shape",background:"rgb(255,255,255)",points:[9.9945,5.006,6.0345,5.006,6.0345,3.527,6.0345,3.336,5.9255,3.162,5.7545,3.078,5.5825,2.994,5.3785,3.015,5.2275,3.132,2.4795,5.264,2.3575,5.359,2.2865,5.505,2.2865,5.659,2.2865,5.813,2.3575,5.959,2.4795,6.054,5.2275,8.186,5.3175,8.256,5.4255,8.292,5.5345,8.292,5.6095,8.292,5.6845,8.275,5.7545,8.241,5.9255,8.157,6.0345,7.983,6.0345,7.792,6.0345,6.006,9.9945,6.006,11.5445,6.006,12.7135,7.296,12.7135,9.006,12.7135,10.689,11.4815,12.006,9.9085,12.006,5.0345,12.006,4.7585,12.006,4.5345,12.23,4.5345,12.506,4.5345,12.782,4.7585,13.006,5.0345,13.006,9.9085,13.006,12.0425,13.006,13.7135,11.249,13.7135,9.006,13.7135,6.763,12.0795,5.006,9.9945,5.006,9.9945,5.006],segments:[1,2,2,4,4,2,4,4,2,4,4,4,2,2,4,4,2,4,4,2,4,4,2]}]}),ht.Default.setImage("editor.redo",{background:"rgb(191,191,191)",width:16,height:16,comps:[{type:"shape",background:"rgb(255,255,255)",shadowColor:"#1ABC9C",scaleX:-1,points:[9.9945,5.006,6.0345,5.006,6.0345,3.527,6.0345,3.336,5.9255,3.162,5.7545,3.078,5.5825,2.994,5.3785,3.015,5.2275,3.132,2.4795,5.264,2.3575,5.359,2.2865,5.505,2.2865,5.659,2.2865,5.813,2.3575,5.959,2.4795,6.054,5.2275,8.186,5.3175,8.256,5.4255,8.292,5.5345,8.292,5.6095,8.292,5.6845,8.275,5.7545,8.241,5.9255,8.157,6.0345,7.983,6.0345,7.792,6.0345,6.006,9.9945,6.006,11.5445,6.006,12.7135,7.296,12.7135,9.006,12.7135,10.689,11.4815,12.006,9.9085,12.006,5.0345,12.006,4.7585,12.006,4.5345,12.23,4.5345,12.506,4.5345,12.782,4.7585,13.006,5.0345,13.006,9.9085,13.006,12.0425,13.006,13.7135,11.249,13.7135,9.006,13.7135,6.763,12.0795,5.006,9.9945,5.006,9.9945,5.006],segments:[1,2,2,4,4,2,4,4,2,4,4,4,2,2,4,4,2,4,4,2,4,4,2]}]}),ht.Default.setImage("editor.edit",{background:"rgb(179,179,179)",width:16,height:16,blendMode:"override",comps:[{type:"shape",borderWidth:1,borderColor:"rgb(51,153,255)",shadowColor:"#1ABC9C",rotation:5.49779,closePath:!0,points:[6,-.83884,.5,13.16116,6.04966,10.58206,11.5,13.16116,6,-.83884]}]}),ht.Default.setImage("editor.rulers",{background:"rgb(179,179,179)",width:16,height:16,blendMode:"override",comps:[{type:"shape",borderWidth:1,borderColor:"rgb(138,138,138)",borderCap:"round",shadowColor:"#1ABC9C",rotation:1.5708,points:[1.50517,1.5,1.5,4.49799,2.47337,4.49798,1.5,4.49799,1.50003,14.5,11.23413,14.48019,11.23413,13.48171,11.23413,14.47896,14.5,14.47897,4.00002,14.47899,4.00001,12.00001,1.50521,12.00002]},{type:"shape",borderWidth:1,borderColor:"rgb(138,138,138)",borderCap:"round",shadowColor:"#1ABC9C",points:[14,6,14,14,6,14]}]}),ht.Default.setImage("editor.grid",{background:"rgb(179,179,179)",width:16,height:16,blendMode:"override",comps:[{type:"shape",borderWidth:1,
borderColor:"rgb(138,138,138)",borderCap:"round",shadowColor:"#1ABC9C",points:[4.49468,1.49999,4.5,14.49999,4.49468,11.53541,1.5,11.51432,14.5,11.51432,11.52105,11.53541,11.52105,14.49999,11.52105,1.49999,11.5,4.50429,14.5,4.50429,1.5,4.50429]}]}),ht.Default.setImage("editor.save",{background:"rgb(179,179,179)",width:16,height:16,blendMode:"override",comps:[{type:"shape",borderWidth:1,borderColor:"rgb(138,138,138)",shadowColor:"#1ABC9C",points:[3.66183,14.5,14.5,14.5,14.5,4.83454,10.71984,1.5,3.66183,1.5,3.66183,6.18654,10.71984,6.18654,10.71984,1.5,1.5,1.5,1.5,14.5,3.66183,14.5,3.66183,9.03168,12.17213,9.03168,12.17213,14.5]}]}),ht.Default.setImage("editor.preview",{background:"rgb(179,179,179)",width:16,height:16,blendMode:"override",comps:[{type:"shape",borderWidth:1,borderColor:"rgb(138,138,138)",borderCap:"round",points:[1.9869,6.489,2,2,14,8,1.9869,14,2,9.555]}]}),ht.Default.setImage("editor.reload",{background:"rgb(179,179,179)",width:16,height:16,blendMode:"override",comps:[{type:"triangle",background:"rgb(138,138,138)",borderWidth:1,borderColor:"rgb(138,138,138)",shadowColor:"#1ABC9C",rotation:1.5708,rect:[7.5,1.71892,3,2]},{type:"arc",borderWidth:1,borderColor:"rgb(138,138,138)",borderCap:"round",arcFrom:0,arcTo:4.7124,arcClose:!1,shadowColor:"#1ABC9C",rect:[2,2.78108,12,12]}]}),ht.Default.setImage("editor.zoomout",{width:16,height:16,comps:[{type:"shape",borderWidth:1,borderColor:"white",points:[2,8,14,8]}]}),ht.Default.setImage("editor.zoomin",{width:16,height:16,comps:[{type:"shape",borderWidth:1,borderColor:"white",points:[2,8,14,8,8,2,8,14],segments:[1,2,1,2]}]}),ht.Default.setImage("editor.zoomtofit",{background:"rgb(179,179,179)",width:16,height:16,blendMode:"override",comps:[{type:"shape",borderWidth:1,borderColor:"rgb(138,138,138)",borderCap:"round",shadowColor:"#1ABC9C",points:[8.00001,11.91764,8.00001,15]},{type:"triangle",background:"rgb(138,138,138)",borderWidth:1,borderColor:"rgb(138,138,138)",shadowColor:"#1ABC9C",rotation:-1.5708,rect:[9.75,7.24608,2,1.5]},{type:"shape",borderWidth:1,borderColor:"rgb(138,138,138)",borderCap:"round",shadowColor:"#1ABC9C",rotation:-1.5708,points:[13.516,6.484,13.516,9.51599]},{type:"shape",borderWidth:1,borderColor:"rgb(138,138,138)",borderCap:"round",shadowColor:"#1ABC9C",rotation:-3.14159,points:[8.00001,.99999,8.00001,4.08236]},{type:"shape",borderWidth:1,borderColor:"rgb(138,138,138)",borderCap:"round",shadowColor:"#1ABC9C",rotation:1.5708,points:[2.516,6.4801,2.516,9.51209]},{type:"triangle",background:"rgb(138,138,138)",borderWidth:1,borderColor:"rgb(138,138,138)",shadowColor:"#1ABC9C",rotation:1.5708,rect:[4.25,7.24608,2,1.5]},{type:"triangle",background:"rgb(138,138,138)",borderWidth:1,borderColor:"rgb(138,138,138)",shadowColor:"#1ABC9C",rotation:3.14159,rect:[7.00001,4.5,2,1.5]},{type:"triangle",background:"rgb(138,138,138)",borderWidth:1,borderColor:"rgb(138,138,138)",shadowColor:"#1ABC9C",rotation:6.28319,rect:[7,10,2,1.5]}]}),ht.Default.setImage("editor.toggleleft",{background:"rgb(179,179,179)",width:16,height:16,blendMode:"override",comps:[{type:"rect",borderWidth:1,borderColor:"rgb(138,138,138)",shadowColor:"#1ABC9C",rotation:1.5708,rect:[2.50002,1.00002,10.99995,13.99996]},{type:"shape",borderWidth:1,borderColor:"rgb(138,138,138)",borderCap:"round",shadowColor:"#1ABC9C",points:[3.49001,5.50001,3.51001,10.49999]}]}),ht.Default.setImage("editor.toggleboth",{background:"rgb(179,179,179)",width:16,height:16,blendMode:"override",comps:[{type:"rect",borderWidth:1,borderColor:"rgb(138,138,138)",shadowColor:"#1ABC9C",rotation:1.5708,rect:[2.5,1,11,14]}]}),ht.Default.setImage("editor.toggleright",{background:"rgb(179,179,179)",width:16,height:16,blendMode:"override",comps:[{type:"rect",borderWidth:1,borderColor:"rgb(138,138,138)",shadowColor:"#1ABC9C",rotation:1.5708,rect:[2.50002,1.00002,10.99995,13.99996]},{type:"shape",borderWidth:1,borderColor:"rgb(138,138,138)",borderCap:"round",shadowColor:"#1ABC9C",points:[12.49999,5.50001,12.51999,10.49999]}]}),ht.Default.setImage("editor.layout.helper",ht.Default.parse(JSON.stringify({modified:"Mon Oct 29 2018 09:55:40 GMT+0800 (\u4e2d\u56fd\u6807\u51c6\u65f6\u95f4)",dataBindings:[{attr:"selectColor",valueType:"Color",defaultValue:"#60ACFC"},{attr:"layout.h",valueType:"String"},{attr:"layout.v",valueType:"String"}],width:100,height:100,interactive:!0,disableSelectedBorder:!0,pixelPerfect:!1,comps:[{type:"rect",borderColor:"#979797",displayName:"\u5de6\u4fa7\u4ea4\u4e92",rect:[5.51795,27.5,20.9641,44.5],onDown:"__ht__function(event, data, view, point, width, height) {\nif (ht.Default.isShiftDown()) {\n    data.a('layout.h', 'leftright');\n}\nelse {\n    data.a('layout.h', 'left');\n}\n}"},{type:"rect",borderColor:"#979797",displayName:"\u53f3\u4fa7\u4ea4\u4e92",rect:[74.0359,27.5,20.9641,45],onDown:"__ht__function(event, data, view, point, width, height) {\nif (ht.Default.isShiftDown()) {\n    data.a('layout.h', 'leftright');\n}\nelse {\n    data.a('layout.h', 'right');\n}\n}"},{type:"rect",borderColor:"#979797",displayName:"\u4e0a\u4fa7\u4ea4\u4e92",rect:[27.5,6,45,20],onDown:"__ht__function(event, data, view, point, width, height) {\nif (ht.Default.isShiftDown()) {\n    data.a('layout.v', 'topbottom');\n}\nelse {\n    data.a('layout.v', 'top');\n}\n}"},{type:"rect",borderColor:"#979797",displayName:"\u4e0b\u4fa7\u4ea4\u4e92",rect:[27.5,74,45,20],onDown:"__ht__function(event, data, view, point, width, height) {\nif (ht.Default.isShiftDown()) {\n    data.a('layout.v', 'topbottom');\n}\nelse {\n    data.a('layout.v', 'bottom');\n}\n}"},{type:"rect",borderColor:"#979797",displayName:"\u6a2a\u5411\u4e2d\u5fc3\u4ea4\u4e92",rect:[28.22051,44,16,12],onDown:"__ht__function(event, data, view, point, width, height) {\ndata.a('layout.h', 'center');\n}"},{type:"rect",borderColor:"#979797",displayName:"\u6a2a\u5411\u4e2d\u5fc3\u4ea4\u4e92",rect:[55.77949,44,16,12],onDown:"__ht__function(event, data, view, point, width, height) {\ndata.a('layout.h', 'center');\n}"},{type:"rect",borderColor:"#979797",displayName:"\u7eb5\u5411\u4e2d\u5fc3\u4ea4\u4e92",rect:[44.22051,28,11.55897,16],onDown:"__ht__function(event, data, view, point, width, height) {\ndata.a('layout.v', 'center');\n}"},{type:"rect",borderColor:"#979797",displayName:"\u7eb5\u5411\u4e2d\u5fc3\u4ea4\u4e92",rect:[44.22051,56,11.55897,16],onDown:"__ht__function(event, data, view, point, width, height) {\ndata.a('layout.v', 'center');\n}"},{type:"rect",borderWidth:1,borderColor:"#d4d4d4",rect:[5,5,90,90]},{type:"rect",borderWidth:1,borderColor:"#d4d4d4",borderPattern:[6,6],rect:[27.5,27.5,45,45]},{type:"rect",background:{func:"__ht__function(data, view) {\nvar layoutH = data.a('layout.h');\nif (layoutH === 'left' || layoutH === 'leftright') {\n    return data.a('selectColor');\n}\nreturn '#d4d4d4';\n}",value:"#D4D4D4"},borderColor:"#979797",rect:[8,48,16,4]},{type:"rect",background:{func:"__ht__function(data, view) {\nvar layoutH = data.a('layout.h');\nif (layoutH === 'right' || layoutH === 'leftright') {\n    return data.a('selectColor');\n}\nreturn '#d4d4d4';\n}",value:"#D8D8D8"},borderColor:"#979797",rect:[76,48,16,4]},{type:"rect",background:{func:"__ht__function(data, view) {\nvar layoutH = data.a('layout.h');\nif (layoutH === 'center') {\n    return data.a('selectColor');\n}\nreturn '#d4d4d4';\n}",value:"#D8D8D8"},borderColor:"#979797",rect:[34,48,32,4],onDown:"__ht__function(event, data, view, point, width, height) {\ndata.a('layout.h', 'center');\n}"},{type:"rect",background:{func:"__ht__function(data, view) {\nvar layoutV = data.a('layout.v');\nif (layoutV === 'bottom' || layoutV === 'topbottom') {\n    return data.a('selectColor');\n}\nreturn '#d4d4d4';\n}",value:"#D8D8D8"},borderColor:"#979797",rect:[48,76,4,16]},{type:"rect",background:{func:"__ht__function(data, view) {\nvar layoutV = data.a('layout.v');\nif (layoutV === 'top' || layoutV === 'topbottom') {\n    return data.a('selectColor');\n}\nreturn '#d4d4d4';\n}",value:"#D8D8D8"},borderColor:"#979797",rect:[48,8,4,16]},{type:"rect",background:{func:"__ht__function(data, view) {\nvar layoutV = data.a('layout.v');\nif (layoutV === 'center') {\n    return data.a('selectColor');\n}\nreturn '#d4d4d4';\n}",value:"#D8D8D8"},borderColor:"#979797",rect:[48,34,4,32],onDown:"__ht__function(event, data, view, point, width, height) {\ndata.a('layout.v', 'center');\n}"},{type:"rect",background:{func:"__ht__function(data, view) {\nif (data.a('layout.h') === 'center' || data.a('layout.v')  === 'center') {\n    return data.a('selectColor');\n}\nreturn '#d4d4d4';\n}",value:"#D8D8D8"},borderColor:"#979797",rect:[48,48,4,4]}]}))),ht.Default.setImage("editor.attachPoint",{width:10,height:10,boundExtend:1,comps:[{type:"shape",borderWidth:1,background:{func:"attr@selectColor",value:"rgb(51,153,255)"},borderColor:{func:"attr@selectColor",value:"rgb(51,153,255)"},closePath:!0,points:[5,0,0,5,5,10,10,5]}]}),ht.Default.setImage("editor.debug",{width:16,height:16,comps:[{type:"shape",borderWidth:1,borderColor:"rgb(255,255,255)",pixelPerfect:!0,points:[7.94786,14.04023,7.94786,14.04023,5.74115,14.04023,3.96501,12.19542,3.96501,9.90337,3.96501,5.76652,11.98452,5.76652,11.98452,9.90337,11.9307,12.19542,10.15457,14.04023,7.94786,14.04023,12.60426,13.98532,12.60426,13.11086,12.16217,12.33113,11.46956,11.86165,11.95932,6.90006,12.73466,6.45216,13.26319,5.60927,13.26319,4.65313,13.26319,4.65313,3.34528,13.98532,3.34528,13.13137,3.76687,12.36776,4.43165,11.8952,1.94907,9.37134,3.96309,9.37134,3.93694,6.8475,3.19558,6.38817,2.74126,5.57307,2.74126,4.65313,2.74126,4.65313,10.93997,4.92497,5.00957,4.92497,5.00957,3.27764,6.32743,1.95977,7.97477,1.95977,9.6221,1.95977,10.93997,3.27764,10.93997,4.92497,10.93997,4.92497,7.97477,13.98532,7.97477,7.94509,12.03691,9.37134,14.05093,9.37134],segments:[1,2,4,2,2,2,4,5,1,4,1,4,2,1,4,1,2,1,4,2,1,2,4,4,2,5,1,2,1,2]}]}),ht.Default.setImage("editor.changepath",{width:16,height:16,blendMode:"override",comps:[{type:"shape",background:"rgba(16,16,16,0.95)",points:[7.2006,2.00311,7.45968,2.00311,7.66821,2.2085,7.66821,2.46056,7.66821,2.74686,7.4344,2.94602,7.14688,2.94602,7.14688,2.94602,3.93364,2.94602,3.2101,2.94602,2.93838,3.1763,2.93838,3.8827,2.93838,3.8827,2.93838,12.02083,2.93838,12.72724,3.30489,13.05398,4.02842,13.05398,4.02842,13.05398,11.89883,12.95762,12.62236,12.95762,12.89408,12.54052,12.89408,11.83412,12.89408,11.83412,12.89092,9.04586,12.89092,8.77823,13.07734,8.5604,13.34905,8.55418,13.63025,8.54795,13.8609,8.77201,13.8609,9.04897,13.8609,9.04897,13.8609,12.44405,13.8609,13.29982,13.14684,13.99699,12.27165,13.99699,12.27165,13.99699,3.58925,13.99699,2.71721,14,2.00316,13.30605,2,12.44405,2,12.44405,2,3.55284,2.00316,2.69395,2.71406,2,3.58925,2.00311,3.58925,2.00311,5.98268,4.56551,6.47098,4.56551,6.86682,4.95539,6.86682,5.43633,6.86682,5.91727,6.47098,6.30714,5.98268,6.30714,5.8955,6.30714,5.81126,6.29472,5.7317,6.27157,4.80649,7.69079,6.97343,8.7681,7.11289,8.83739,7.21132,8.96958,7.23677,9.12153,7.26223,9.27348,7.21193,9.42968,7.1024,9.53954,6.12831,10.51776,6.16853,10.60408,6.19095,10.70012,6.19095,10.80132,6.19095,11.17727,5.88151,11.48204,5.4998,11.48204,5.11809,11.48204,4.80865,11.17727,4.80865,10.80132,4.80865,10.42536,5.11809,10.12059,5.4998,10.12059,5.59802,10.12059,5.69146,10.14077,5.77607,10.17715,6.75004,9.19918,4.58295,8.12247,4.45891,8.06048,4.36681,7.9494,4.3304,7.81736,4.29384,7.68517,4.31605,7.5434,4.39118,7.42822,5.31627,6.00864,5.18067,5.85559,5.09853,5.65541,5.09853,5.43633,5.09853,4.95539,5.49438,4.56551,5.98268,4.56551,11.72631,3.61933,12.99182,4.8723,11.53686,6.30532,10.99551,6.8452,10.81501,7.01857,10.65271,7.17735,10.50831,7.3217,10.38798,7.442,10.28489,7.54456,10.19906,7.62949,10.08578,7.74089,10.02914,7.79593,9.99408,7.82841,9.98054,7.83833,9.93534,7.87829,9.8835,7.92053,9.82488,7.96505,9.76625,8.00957,9.70531,8.04513,9.64206,8.07172,9.57881,8.10287,9.4864,8.14055,9.36468,8.18492,9.24296,8.22929,9.11552,8.27259,8.98223,8.31483,8.84894,8.35708,8.72274,8.3937,8.60333,8.42485,8.48393,8.456,8.39491,8.4759,8.33613,8.48471,8.21425,8.49809,8.13311,8.48031,8.09253,8.43138,8.05196,8.38246,8.0407,8.30025,8.05874,8.18477,8.06785,8.12247,8.08929,8.03252,8.12308,7.91476,8.15825,7.79229,8.19435,7.67012,8.23138,7.54811,8.26979,7.42138,8.30697,7.30484,8.34307,7.19817,8.37917,7.0915,8.40848,7.01826,8.43101,6.9783,8.45816,6.916,8.48855,6.85932,8.52234,6.80827,8.55612,6.75722,8.60472,6.70054,8.66782,6.63824,8.69462,6.61162,8.72847,6.57783,8.78256,6.52344,8.85696,6.44846,8.93963,6.36514,9.03954,6.26568,9.15679,6.14998,11.72631,3.61933,13.00864,2.65644,13.0742,2.65857,13.1373,2.66859,13.19808,2.68652,13.25886,2.70445,13.31178,2.72436,13.35698,2.74639,13.45171,2.79532,13.55661,2.88087,13.67171,3.00303,13.78679,3.1252,13.87581,3.25299,13.93891,3.38624,13.93922,3.38609,13.95726,3.42606,13.97192,3.4727,13.98319,3.52604,13.99445,3.57937,14,3.63483,14,3.69257,14,3.75031,13.98874,3.80806,13.96621,3.86595,13.94369,3.92384,13.90759,3.9793,13.85791,4.03248,13.80376,4.08581,13.75532,4.13246,13.71243,4.17242,13.66955,4.21239,13.63236,4.24794,13.60074,4.27909,13.56464,4.31465,13.53085,4.3458,13.49922,4.37254,12.23372,3.12611,12.28787,3.07718,12.3522,3.01838,12.42671,2.94954,12.50123,2.88071,12.56324,2.82632,12.61277,2.7862,12.67602,2.73728,12.74143,2.70278,12.809,2.68303,12.87658,2.66312,12.94307,2.65416,13.00864,2.65644],segments:[1,4,4,2,2,4,2,2,4,2,2,4,2,2,4,4,2,2,4,2,2,4,2,2,4,2,5,1,4,4,4,2,2,4,4,2,4,4,4,4,4,2,2,4,4,2,4,4,5,1,2,2,2,4,4,2,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,2,4,4,2,5,1,4,4,4,4,2,4,4,4,4,4,4,4,2,4,4,4,4,5]}]}),ht.Default.setImage("editor.layer",{width:16,height:16,blendMode:"override",comps:[{type:"shape",background:oN.config.color_dark,pixelPerfect:!0,points:[1.73333,5.5,7.73333,8.5,7.8,8.53333,7.9,8.56667,8,8.56667,8.1,8.56667,8.16667,8.53333,8.26667,8.5,14.26667,5.5,14.46667,5.4,14.56667,5.2,14.56667,5,14.56667,4.8,14.43333,4.6,14.26667,4.5,8.26667,1.5,8.1,1.43333,7.93333,1.43333,7.76667,1.5,1.76667,4.5,1.56667,4.6,1.46667,4.8,1.46667,5,1.46667,5.2,1.56667,5.4,1.73333,5.5,8,2.63333,12.73333,5,8,7.36667,3.26667,5,8,2.63333,13.73333,10.5,8,13.36667,2.26667,10.5,2,10.36667,1.66667,10.46667,1.5,10.76667,1.36667,11.03333,1.46667,11.36667,1.76667,11.53333,7.76667,14.53333,7.83333,14.56667,7.93333,14.6,8.03333,14.6,8.13333,14.6,8.2,14.56667,8.3,14.53333,14.3,11.53333,14.56667,11.4,14.7,11.06667,14.56667,10.76667,14.36667,10.46667,14.03333,10.36667,13.73333,10.5,13.73333,7.5,8,10.36667,2.26667,7.5,2,7.36667,1.66667,7.46667,1.5,7.76667,1.36667,8.03333,1.46667,8.36667,1.76667,8.53333,7.76667,11.53333,7.83333,11.56667,7.93333,11.6,8.03333,11.6,8.13333,11.6,8.2,11.56667,8.3,11.53333,14.3,8.53333,14.56667,8.4,14.7,8.06667,14.56667,7.76667,14.36667,7.46667,14.03333,7.36667,13.73333,7.5],segments:[1,2,4,4,2,4,4,2,4,2,4,4,5,1,2,2,2,2,5,1,2,2,4,4,2,4,4,2,4,4,5,1,2,2,4,4,2,4,4,2,4,4,5]}]}),ht.Default.setImage("editor.corners",{width:16,height:16,blendMode:"override",comps:[{type:"shape",borderWidth:1,borderColor:"#979797",borderCap:"round",points:[14,10,14,14,10,14,10,2,14,2,14,6,6,14,2,14,2,10,2,6,2,2,6,2],segments:[1,2,2,1,2,2,1,2,2,1,2,2]}]}),ht.Default.setImage("editor.display.rect",{background:"rgb(179,179,179)",width:16,height:16,blendMode:"override",comps:[{type:"rect",borderWidth:1,borderColor:"rgb(138,138,138)",shadowColor:"#1ABC9C",rect:[2.5,1.5,11,13]}]}),ht.Default.setImage("editor.display.oval",{background:"rgb(179,179,179)",width:16,height:16,blendMode:"override",comps:[{type:"circle",borderWidth:1,borderColor:"rgb(138,138,138)",shadowColor:"#1ABC9C",rect:[1,1,14,14]}]}),ht.Default.setImage("editor.display.roundrect",{background:"rgb(179,179,179)",width:16,height:16,blendMode:"override",comps:[{type:"roundRect",borderWidth:1,borderColor:"rgb(138,138,138)",cornerRadius:2.5,shadowColor:"#1ABC9C",rect:[2.5,1,11,14]}]}),ht.Default.setImage("editor.display.triangle",{background:"rgb(179,179,179)",width:16,height:16,blendMode:"override",comps:[{type:"shape",borderWidth:1,borderColor:"rgb(138,138,138)",borderCap:"round",rotation:4.71239,points:[1.00872,1,14.99345,8,.99345,15,1.00872,1]}]}),ht.Default.setImage("editor.display.polygon",{width:16,height:16,comps:[{type:"polygon",rect:[1,1,14,14],borderColor:"white",borderWidth:1}]}),ht.Default.setImage("editor.display.star",{width:16,height:16,comps:[{type:"star",rect:[1,1,14,14],borderColor:"white",borderWidth:1}]}),ht.Default.setImage("editor.display.arc",{width:16,height:16,comps:[{type:"arc",rect:[1,1,14,14],arcFrom:0,arcTo:4.1888,borderColor:"white",borderWidth:1}]}),ht.Default.setImage("editor.display.shape",{background:"rgb(179,179,179)",width:16,height:16,blendMode:"override",comps:[{type:"arc",borderWidth:1,borderColor:"rgb(138,138,138)",shadowColor:"#1ABC9C",rotation:-2.35619,rect:[6.45666,.50222,10,8]},{type:"oval",background:"rgb(138,138,138)",borderColor:"rgb(138,138,138)",shadowColor:"#1ABC9C",rotation:-2.35619,rect:[4.92983,8.48004,2.48323,2.47136]},{type:"shape",borderWidth:1,borderColor:"rgb(138,138,138)",borderCap:"round",shadowColor:"#1ABC9C",rotation:-2.35619,points:[.71918,15.84031,-.26373,13.78,4.61411,6.85806,4.66212,13.2497,4.61411,6.85806,9.56535,13.77996,8.58245,15.84028]}]}),ht.Default.setImage("editor.display.node",{background:"rgb(179,179,179)",width:16,height:16,blendMode:"override",comps:[{type:"shape",borderWidth:1,borderColor:"rgb(138,138,138)",borderCap:"round",shadowColor:"#1ABC9C",points:[1.5,9.38462,14.5,9.38462,14.5,11.23077,14.5,2,1.5,2,1.5,11.23077,14.5,11.23077,7.07143,11.23077,5,15,11,15,8.92857,11.23077]}]}),ht.Default.setImage("editor.display.group",{background:"rgb(179,179,179)",width:16,height:16,blendMode:"override",comps:[{type:"shape",borderWidth:1,borderColor:"rgb(138,138,138)",borderCap:"round",shadowColor:"#1ABC9C",points:[13,12.5,13,10.54,3,10.54,13,10.54,13,5.5,3,5.5,3,12.5,13,12.5,7,12.5,5.85714,15.5,10.14287,15.5,9,12.5]},{type:"shape",borderWidth:1,borderColor:"rgb(138,138,138)",borderCap:"round",shadowColor:"#1ABC9C",points:[15.5,15.5,.5,15.5,.5,.5,6.92857,.5,8,2.19286,15.5,2.19286,15.5,15.5]}]}),ht.Default.setImage("editor.display.edge",{background:"rgb(179,179,179)",width:16,height:16,blendMode:"override",comps:[{type:"circle",borderWidth:1,borderColor:"rgb(138,138,138)",shadowColor:"#1ABC9C",rect:[.69044,.97071,4,4.00837]},{type:"circle",borderWidth:1,borderColor:"rgb(138,138,138)",shadowColor:"#1ABC9C",rect:[11.27696,10.99163,4,4.00837]},{type:"shape",borderWidth:1,borderColor:"rgb(138,138,138)",shadowColor:"#1ABC9C",points:[4.35933,3.02819,7.84441,2.9749,7.84441,12.99581,11.64067,12.99581]}]}),ht.Default.setImage("editor.display.text",{background:"rgb(179,179,179)",width:16,height:16,blendMode:"override",comps:[{type:"shape",borderWidth:1,borderColor:"rgb(138,138,138)",borderCap:"round",shadowColor:"#1ABC9C",points:[1,15,8.06501,1,15,15,12.38059,9.8,4.10171,9.8]}]}),ht.Default.setImage("editor.display.subgraph",{gridThickColor:"rgb(191,191,191)",width:16,height:16,blendMode:"override",comps:[{type:"shape",borderWidth:1,borderColor:"rgb(207,207,207)",visible:!1,closePath:!0,points:[2.81788,9.09381,2.81788,9.09381,1.38027,6.92868,3.20223,5.43826,5.02418,3.94784,6.51488,5.43826,6.51488,5.43826,6.51488,5.43826,7.61273,3.06338,10.74281,3.94784,13.87289,4.8323,13.18212,9.09381,13.18212,9.09381,13.18212,9.09381,15.5,9.8671,15.5,11.92851,15.5,13.6866,14.14811,14.93662,13.18212,14.93662,2.81788,14.93662,1.83057,14.93662,.5,13.65558,.5,11.92851,.5,9.92221,2.81788,9.09381,2.81788,9.09381],segments:[1,4,4,4,4,4,4,2,4,4]},{type:"rect",borderWidth:1,borderColor:"rgb(138,138,138)",shadowColor:"#1ABC9C",rect:[4.99379,5.52777,6,4.47223]},{type:"circle",background:"rgb(138,138,138)",borderColor:"rgb(138,138,138)",visible:!1,shadowColor:"#1ABC9C",rect:[4,6.43826,2,2]},{type:"arc",borderWidth:1,borderColor:"rgb(138,138,138)",borderCap:"round",arcFrom:3.15905,arcTo:5.5676,arcClose:!1,visible:!1,shadowColor:"#1ABC9C",rect:[2.5,3.11794,5,5]},{type:"arc",borderWidth:1,borderColor:"rgb(138,138,138)",borderCap:"round",arcFrom:3.57792,arcTo:6.6497,arcClose:!1,visible:!1,shadowColor:"#1ABC9C",rect:[5.63862,1.53868,9.36138,7.15852]},{type:"arc",borderWidth:1,borderColor:"rgb(138,138,138)",borderCap:"round",arcFrom:1.5708,arcTo:3.87463,arcClose:!1,visible:!1,shadowColor:"#1ABC9C",rect:[-1,6.56338,8.99379,5.93662]},{type:"arc",borderWidth:1,borderColor:"rgb(138,138,138)",borderCap:"round",arcFrom:5.00909,arcTo:1.5708,arcClose:!1,visible:!1,shadowColor:"#1ABC9C",rect:[8.00621,6.56338,8.99379,5.93662]},{type:"shape",borderWidth:1,borderColor:"rgb(138,138,138)",borderCap:"round",visible:!1,points:[3.4969,12.5,12.5031,12.5]},{type:"shape",borderWidth:1,borderColor:"rgb(138,138,138)",points:[9.72,12.5,8,10,6.34,12.5]},{type:"circle",background:"rgb(138,138,138)",borderColor:"rgb(138,138,138)",shadowColor:"#1ABC9C",displayName:"\u5706\u5f62",rect:[0,0,2,2]},{type:"shape",borderWidth:1,borderColor:"rgb(138,138,138)",borderJoin:"miter",points:[15,15.5,8.02409,15.5,8.02409,14,8.02409,15.5,1,15.5]},{type:"shape",borderWidth:1,borderColor:"rgb(138,138,138)",closePath:!0,points:[2.81167,6.59481,2.81167,6.59481,1.80439,4.03022,3.39379,2.90023,4.98319,1.77025,6.47379,2.90023,6.47379,2.90023,6.47379,2.90023,7.60652,.5,10.7366,1.3939,13.86668,2.28781,13.17591,6.59481,13.17591,6.59481,13.17591,6.59481,15.49379,7.37636,15.49379,9.45978,15.49379,11.23663,14.1419,12.5,13.17591,12.5,2.81167,12.5,1.82436,12.5,.49379,11.20528,.49379,9.45978,.49379,7.43206,2.81167,6.59481,2.81167,6.59481],segments:[1,4,4,4,4,4,4,2,4,4]}]}),ht.Default.setImage("editor.symbol.rect",{background:"rgb(179,179,179)",width:16,height:16,blendMode:"override",comps:[{type:"rect",borderWidth:1,borderColor:"rgb(138,138,138)",shadowColor:"#1ABC9C",rect:[2.5,1.5,11,13]}]}),ht.Default.setImage("editor.symbol.oval",{background:"rgb(179,179,179)",width:16,height:16,blendMode:"override",comps:[{type:"circle",borderWidth:1,borderColor:"rgb(138,138,138)",shadowColor:"#1ABC9C",rect:[1,1,14,14]}]}),ht.Default.setImage("editor.symbol.roundrect",{background:"rgb(179,179,179)",width:16,height:16,blendMode:"override",comps:[{type:"roundRect",borderWidth:1,borderColor:"rgb(138,138,138)",cornerRadius:2.5,shadowColor:"#1ABC9C",rect:[2.5,1,11,14]}]}),ht.Default.setImage("editor.symbol.triangle",{background:"rgb(179,179,179)",width:16,height:16,blendMode:"override",comps:[{type:"shape",borderWidth:1,borderColor:"rgb(138,138,138)",borderCap:"round",rotation:4.71239,points:[1.00872,1,14.99345,8,.99345,15,1.00872,1]}]}),ht.Default.setImage("editor.symbol.polygon",{width:16,height:16,comps:[{type:"polygon",rect:[1,1,14,14],borderColor:"white",borderWidth:1}]}),ht.Default.setImage("editor.symbol.star",{width:16,height:16,comps:[{type:"star",rect:[1,1,14,14],borderColor:"white",borderWidth:1}]}),ht.Default.setImage("editor.symbol.arc",{width:16,height:16,comps:[{type:"arc",rect:[1,1,14,14],arcFrom:0,arcTo:4.1888,borderColor:"white",borderWidth:1}]}),ht.Default.setImage("editor.symbol.image",{background:"rgb(156,156,156)",width:16,height:16,comps:[{type:"rect",borderWidth:1,borderColor:"rgb(255,255,255)",rect:[.5,1.96,15,12]},{type:"circle",background:"rgb(255,255,255)",borderColor:"rgb(255,255,255)",rect:[3.32103,4.48721,1.5,1.5]},{type:"shape",borderWidth:1,borderColor:"rgb(255,255,255)",borderCap:"round",points:[2.18757,9.112,6.11684,9.112,7.77072,10.39241,9.50807,13.68975,9.69338,14.04145,9.04982,12.34611,7.45717,10.69236,7.45717,10.69236,8.72728,5.98721,14.05092,5.98721],segments:[1,4,4,4]}]}),ht.Default.setImage("editor.symbol.shape",{background:"rgb(179,179,179)",width:16,height:16,blendMode:"override",comps:[{type:"arc",borderWidth:1,borderColor:"rgb(138,138,138)",shadowColor:"#1ABC9C",rotation:-2.35619,rect:[6.45666,.50222,10,8]},{type:"oval",background:"rgb(138,138,138)",borderColor:"rgb(138,138,138)",shadowColor:"#1ABC9C",rotation:-2.35619,rect:[4.92983,8.48004,2.48323,2.47136]},{type:"shape",borderWidth:1,borderColor:"rgb(138,138,138)",borderCap:"round",shadowColor:"#1ABC9C",rotation:-2.35619,points:[.71918,15.84031,-.26373,13.78,4.61411,6.85806,4.66212,13.2497,4.61411,6.85806,9.56535,13.77996,8.58245,15.84028]}]}),ht.Default.setImage("editor.symbol.border",{background:"rgb(179,179,179)",width:16,height:16,blendMode:"override",comps:[{type:"shape",borderWidth:1,borderColor:"rgb(138,138,138)",borderCap:"round",points:[.5,6.01503,.5,2,15.48868,2,15.5,14,.5,14,.5,10]}]}),ht.Default.setImage("editor.symbol.text",{background:"rgb(179,179,179)",width:16,height:16,blendMode:"override",comps:[{type:"shape",borderWidth:1,borderColor:"rgb(138,138,138)",borderCap:"round",shadowColor:"#1ABC9C",points:[1,15,8.06501,1,15,15,12.38059,9.8,4.10171,9.8]}]}),ht.Default.setImage("editor.symbol.piechart",{background:"rgb(97,97,97)",width:16,height:16,comps:[{type:"arc",borderWidth:1,borderColor:"rgb(255,255,255)",arcFrom:.5236,arcTo:4.71239,rect:[.53628,2.06928,13.08634,13.08634]},{type:"arc",borderWidth:1,borderColor:"rgb(255,255,255)",arcFrom:4.71239,arcTo:.5236,rect:[2.37737,1,13.08634,13.08634]}]}),ht.Default.setImage("editor.symbol.onedimensionalcolumnchart",{background:"rgb(179,179,179)",width:16,height:16,blendMode:"override",comps:[{type:"rect",borderWidth:1,borderColor:"rgb(138,138,138)",rect:[3.42625,5.95042,3,9.04958]},{type:"rect",borderWidth:1,borderColor:"rgb(138,138,138)",rect:[10.00543,1,3,14]}]}),ht.Default.setImage("editor.symbol.columnchart",{background:"rgb(179,179,179)",width:16,height:16,blendMode:"override",comps:[{type:"rect",borderWidth:1,borderColor:"rgb(138,138,138)",rect:[1,9,3,6]},{type:"rect",borderWidth:1,borderColor:"rgb(138,138,138)",rect:[4,5.95042,3,9.04958]},{type:"rect",borderWidth:1,borderColor:"rgb(138,138,138)",rect:[9,1,3,14]},{type:"rect",borderWidth:1,borderColor:"rgb(138,138,138)",rect:[12,10.93747,3,4.06253]}]}),ht.Default.setImage("editor.symbol.linechart",{background:"rgb(179,179,179)",width:16,height:16,blendMode:"override",comps:[{type:"shape",borderWidth:1,borderColor:"rgb(138,138,138)",points:[1,14,5,7,11,8,15,2]}]}),ht.Default.setImage("editor.point.mirrored",{width:30,height:30,fitSize:!1,comps:[{type:"arc",background:"rgb(202,235,248)",borderWidth:2,borderColor:"rgb(17,158,216)",arcClose:!1,rect:[3.5,10.30081203536023,23,25.3726296254234]},{type:"oval",background:"rgb(255,255,255)",borderWidth:2,borderColor:"rgb(51,51,51)",rect:[12,7.300812035360231,6,6]},{type:"rect",background:"rgb(51,51,51)",borderColor:"#979797",rect:[17.842265898626422,9.310233818119592,9.826713258365732,2]},{type:"rect",background:"rgb(51,51,51)",borderColor:"#979797",rect:[24.713262902082427,8.310233818119592,3,4]},{type:"rect",background:"rgb(51,51,51)",borderColor:"#979797",rect:[2.4018068742542837,9.30081203536023,9.826713258365732,2]},{type:"rect",background:"rgb(51,51,51)",borderColor:"#979797",rect:[2.286737097917573,8.310233818119592,3,4]}]}),ht.Default.setImage("editor.point.straight",{width:30,height:30,fitSize:!1,comps:[{type:"shape",background:"rgb(200,234,247)",borderWidth:2,borderColor:"rgb(17,160,217)",points:[26.974999999999998,23.185840967335317,15.133692185007973,10.275109094255685,3.0250000000000004,23.185840967335317]},{type:"oval",background:"rgb(255,255,255)",borderWidth:2,borderColor:"rgb(51,51,51)",rect:[12,7.561327956066684,6,6]}]}),ht.Default.setImage("editor.point.disconnected",{width:30,height:30,fitSize:!1,comps:[{type:"shape",background:"rgb(200,234,247)",borderWidth:2,borderColor:"rgb(17,160,217)",points:[3.1940148593724587,22.95774078992803,3.1940148593724587,18.139874123261343,7.6015038461565965,10.497740789928038,14.542032480517832,10.497740789928038,26.80598514062754,22.95774078992803],segments:[1,4,2]},{type:"oval",background:"rgb(255,255,255)",borderWidth:2,borderColor:"rgb(51,51,51)",rect:[12.093814401372779,7.5391087731804305,6,6]},{type:"rect",background:"rgb(51,51,51)",borderColor:"#979797",rotation:.7853981633974483,rect:[16.36973009802768,14.555043156001322,9.826713258365732,2]},{type:"rect",background:"rgb(51,51,51)",borderColor:"#979797",rotation:.7853981633974483,rect:[22.831111406474626,16.51363217953681,3,4]},{type:"rect",background:"rgb(51,51,51)",borderColor:"#979797",rect:[2.2671011430070465,9.53910877318043,9.826713258365732,2]},{type:"rect",background:"rgb(51,51,51)",borderColor:"#979797",rect:[2.152031366670336,8.548530555939791,3,4]}]}),ht.Default.setImage("editor.point.asymmetric",{width:30,height:30,fitSize:!1,comps:[{type:"shape",background:"rgb(200,234,247)",borderWidth:2,borderColor:"rgb(17,160,217)",points:[3.5000000000000027,22.974997694265234,3.5000000000000027,17.50768540873153,5.131816608669447,11.637417102180905,12.400695544362113,11.637417102180905,22.516641067164265,11.637417102180905,26.5,22.974997694265234,26.5,22.974997694265234],segments:[1,4,4]},{type:"oval",background:"rgb(255,255,255)",borderWidth:2,borderColor:"rgb(51,51,51)",rect:[9.324670579660944,7.637417102180905,6,6]},{type:"rect",background:"rgb(51,51,51)",borderColor:"#979797",rect:[3.405482351035767,9.637417102180905,6.540642002660807,2]},{type:"rect",background:"rgb(51,51,51)",borderColor:"#979797",rect:[2.7221578598514142,8.637417102180905,3,4]},{type:"rect",background:"rgb(51,51,51)",borderColor:"#979797",rect:[15.278596259040164,9.637417102180905,11.965262549245955,2]},{type:"rect",background:"rgb(51,51,51)",borderColor:"#979797",rect:[24.731262324024406,8.637417102180905,3,4]}]}),ht.Default.setImage("editor.layout.circular",{width:16,height:16,comps:[{type:"shape",background:"white",points:[7,2,7,4,9,4,9,2,2,7,2,9,4,9,4,7,12,7,12,9,14,9,14,7,4,12,4,14,6,14,6,12,10,12,10,14,12,14,12,12],segments:[1,2,2,2,1,2,2,2,1,2,2,2,1,2,2,2,1,2,2,2]},{type:"shape",borderColor:"white",borderWidth:1,points:[8,3,3,8,5,13,11,13,13,8],segments:[1,2,2,2,2,5]}]}),ht.Default.setImage("editor.layout.symmetric",{width:16,height:16,comps:[{type:"shape",background:"white",points:[7,2,7,4,9,4,9,2,2,7,2,9,4,9,4,7,12,7,12,9,14,9,14,7,4,12,4,14,6,14,6,12,10,12,10,14,12,14,12,12],segments:[1,2,2,2,1,2,2,2,1,2,2,2,1,2,2,2,1,2,2,2]},{type:"shape",borderWidth:1,borderColor:"white",points:[8,8,8,3,8,8,3,8,8,8,5,13,8,8,11,13,8,8,13,8],segments:[1,2,1,2,1,2,1,2,1,2]}]}),ht.Default.setImage("editor.layout.hierarchical",{width:16,height:16,comps:[{type:"shape",background:"white",points:[4,3,4,5,6,5,6,3,10,3,10,5,12,5,12,3,1,11,1,13,3,13,3,11,7,11,7,13,9,13,9,11,13,11,13,13,15,13,15,11],segments:[1,2,2,2,1,2,2,2,1,2,2,2,1,2,2,2,1,2,2,2]},{type:"shape",borderColor:"white",borderWidth:1,points:[5,4,2,12,5,4,8,12,5,4,14,12,11,4,2,12,11,4,8,12,11,4,14,12],segments:[1,2,1,2,1,2,1,2,1,2,1,2]}]}),ht.Default.setImage("editor.layout.towardnorth",{width:16,height:16,comps:[{type:"image",name:"editor.layout.towardsouth",rotation:Math.PI,rect:[0,0,16,16]}]}),ht.Default.setImage("editor.layout.towardsouth",{width:16,height:16,comps:[{type:"shape",background:"white",points:[7,3,7,5,9,5,9,3,1,11,1,13,3,13,3,11,7,11,7,13,9,13,9,11,13,11,13,13,15,13,15,11],segments:[1,2,2,2,1,2,2,2,1,2,2,2,1,2,2,2]},{type:"shape",borderColor:"white",borderWidth:1,points:[8,4,2,12,8,4,8,12,8,4,14,12],segments:[1,2,1,2,1,2]}]}),ht.Default.setImage("editor.layout.towardeast",{width:16,height:16,comps:[{type:"image",name:"editor.layout.towardsouth",rotation:.5*-Math.PI,rect:[0,0,16,16]}]}),ht.Default.setImage("editor.layout.towardwest",{width:16,height:16,comps:[{type:"image",name:"editor.layout.towardsouth",rotation:.5*Math.PI,rect:[0,0,16,16]}]}),ht.Default.setImage("editor.align.distributehorizontal",{background:"rgb(150,150,150)",width:16,height:16,comps:[{type:"shape",points:[2,2,2,14,14,2,14,14],segments:[1,2,1,2],borderWidth:1,borderCap:"round",borderColor:{func:function(){return oN.config.color_dark}}},{type:"shape",points:[8,5,8,11],borderWidth:3,borderCap:"round",borderColor:{func:function(){return oN.config.color_select}}}]}),ht.Default.setImage("editor.align.distributevertical",{background:"rgb(150,150,150)",width:16,height:16,comps:[{type:"shape",points:[2,2,14,2,2,14,14,14],segments:[1,2,1,2],borderWidth:1,borderCap:"round",borderColor:{func:function(){return oN.config.color_dark}}},{type:"shape",points:[5,8,11,8],borderWidth:3,borderCap:"round",borderColor:{
func:function(){return oN.config.color_select}}}]}),ht.Default.setImage("editor.align.alignleft",{background:"rgb(150,150,150)",width:16,height:16,comps:[{type:"shape",points:[2,2,2,14],segments:[1,2],borderWidth:1,borderCap:"round",borderColor:{func:function(){return oN.config.color_dark}}},{type:"shape",points:[5,5,13,5,5,11,8,11],segments:[1,2,1,2],borderWidth:3,borderCap:"round",borderColor:{func:function(){return oN.config.color_select}}}]}),ht.Default.setImage("editor.align.alignhorizontal",{background:"rgb(150,150,150)",width:16,height:16,comps:[{type:"shape",points:[8,2,8,14],segments:[1,2],borderWidth:1,borderCap:"round",borderColor:{func:function(){return oN.config.color_dark}}},{type:"shape",points:[3,5,13,5,6,11,10,11],segments:[1,2,1,2],borderWidth:3,borderCap:"round",borderColor:{func:function(){return oN.config.color_select}}}]}),ht.Default.setImage("editor.align.alignright",{background:"rgb(150,150,150)",width:16,height:16,comps:[{type:"shape",points:[14,2,14,14],segments:[1,2],borderWidth:1,borderCap:"round",borderColor:{func:function(){return oN.config.color_dark}}},{type:"shape",points:[3,5,11,5,11,11,8,11],segments:[1,2,1,2],borderWidth:3,borderCap:"round",borderColor:{func:function(){return oN.config.color_select}}}]}),ht.Default.setImage("editor.align.aligntop",{background:"rgb(150,150,150)",width:16,height:16,comps:[{type:"shape",points:[2,2,14,2],segments:[1,2],borderWidth:1,borderCap:"round",borderColor:{func:function(){return oN.config.color_dark}}},{type:"shape",points:[5,5,5,13,11,5,11,8],segments:[1,2,1,2],borderWidth:3,borderCap:"round",borderColor:{func:function(){return oN.config.color_select}}}]}),ht.Default.setImage("editor.align.alignvertical",{background:"rgb(150,150,150)",width:16,height:16,comps:[{type:"shape",points:[2,8,14,8],segments:[1,2],borderWidth:1,borderCap:"round",borderColor:{func:function(){return oN.config.color_dark}}},{type:"shape",points:[5,3,5,13,11,6,11,10],segments:[1,2,1,2],borderWidth:3,borderCap:"round",borderColor:{func:function(){return oN.config.color_select}}}]}),ht.Default.setImage("editor.align.alignbottom",{background:"rgb(150,150,150)",width:16,height:16,comps:[{type:"shape",points:[2,14,14,14],segments:[1,2],borderWidth:1,borderCap:"round",borderColor:{func:function(){return oN.config.color_dark}}},{type:"shape",points:[5,3,5,11,11,11,11,8],segments:[1,2,1,2],borderWidth:3,borderCap:"round",borderColor:{func:function(){return oN.config.color_select}}}]}),ht.Default.setImage("editor.cursor.ew-resize",{width:24,height:12,comps:[{type:"shape",background:"rgb(255,255,255)",points:[6.58514,1.5,1.58514,6,6.58514,10.5,6.58514,7.5,17.41486,7.5,17.41486,10.5,22.41486,6,17.41486,1.5,17.41486,4.5,6.58514,4.5,6.58514,1.5],segments:[1,2,2,2,2,2,2,2,2,2,2,5]},{type:"shape",borderWidth:.8,borderWidthAbsolute:!0,borderColor:"#000000",points:[6.58514,1.5,1.58514,6,6.58514,10.5,6.58514,7.5,17.41486,7.5,17.41486,10.5,22.41486,6,17.41486,1.5,17.41486,4.5,6.58514,4.5,6.58514,1.5],segments:[1,2,2,2,2,2,2,2,2,2,2,5]}]});var ue=function(){return!0};uq("editor.layout.circular"),uq("editor.layout.symmetric"),uq("editor.layout.hierarchical"),uq("editor.layout.towardnorth"),uq("editor.layout.towardsouth"),uq("editor.layout.towardeast"),uq("editor.layout.towardwest"),uq("editor.root"),uq("editor.bind",ue),uq("editor.unbind"),uq("editor.dir"),uq("editor.dxf"),uq("editor.obj"),uq("editor.mtl"),uq("editor.ui-tab"),uq("editor.ttf"),uq("editor.otf"),uq("editor.sound"),uq("editor.video"),uq("editor.resetsize"),uq("editor.restore"),uq("editor.js"),ht.Data.prototype.$49$=vq,ht.Data.prototype.$50$=function(M){return this._refGraph?[]:[Dq.call(this,M),Wq]},ht.Node.prototype.$49$=Uq,ht.Node.prototype.$50$=function(M){return this._refGraph?[]:[oq.call(this,M),Hq]},ht.Edge.prototype.$49$=_q,ht.Edge.prototype.$50$=function(M){return this._refGraph?[]:[Vq.call(this,M),Tq]},ht.Group.prototype.$50$=function(M){return this._refGraph?[]:[kq.call(this,M),Zq]},ht.Shape.prototype.$50$=function(M){return this._refGraph?[]:[zq.call(this,M),Aq]},ht.Block.prototype.$50$=function(M){return this._refGraph?[]:[cq.call(this,M),Bq]},ht.RefGraph.prototype.$50$=function(M){return this._refGraph?[]:[Lq.call(this,M),iq]},ht.Points.prototype.$50$=function(M){return this._refGraph?[]:[Fq.call(this,M),MN]};var ge=function(M){function q(N,e,X){YN(this,q);var w=dN(this,M.call(this));return w.parse(N,e,X),w}return rN(q,M),q.prototype.getClass=function(){return q},q.prototype.toLabel=function(){return this.getDisplayName()||e("editor.comptype."+this.s("shape").toLowerCase())},q.prototype.parse=function(M,q,N){if(M){HM(this,"shape",M.type,"rect"),HM(this,"shape.background",M.background,null),HM(this,"shape.repeat.image",M.repeatImage),HM(this,"shape.repeat.image.stretch",M.repeatImageStretch),HM(this,"shape.repeat.image.rotation",M.repeatImageRotation),HM(this,"shape.border.width",M.borderWidth),HM(this,"shape.border.color",M.borderColor,null),HM(this,"shape.border.3d",M.border3d),HM(this,"shape.border.3d.color",M.border3dColor),HM(this,"shape.border.3d.accuracy",M.border3dAccuracy),HM(this,"shape.border.cap",M.borderCap),HM(this,"shape.border.join",M.borderJoin),HM(this,"shape.border.pattern",M.borderPattern),HM(this,"shape.gradient",M.gradient),HM(this,"shape.gradient.color",M.gradientColor),HM(this,"shape.dash",M.dash),HM(this,"shape.dash.pattern",M.dashPattern),HM(this,"shape.dash.offset",M.dashOffset),HM(this,"shape.dash.color",M.dashColor),HM(this,"shape.dash.width",M.dashWidth),HM(this,"shape.dash.3d",M.dash3d),HM(this,"shape.dash.3d.color",M.dash3dColor),HM(this,"shape.dash.3d.accuracy",M.dash3dAccuracy),HM(this,"shape.border.width.absolute",M.borderWidthAbsolute),HM(this,"shape.fill.clip.direction",M.fillClipDirection),HM(this,"shape.fill.clip.percentage",M.fillClipPercentage);var e=this.s("shape");"rect"===e?HM(this,"shape.depth",M.depth):"roundRect"===e?HM(this,"shape.corner.radius",M.cornerRadius):"polygon"===e?(HM(this,"shape.polygon.side",M.polygonSide),HM(this,"shape.regular",M.regular)):"arc"===e?(HM(this,"shape.arc.from",M.arcFrom),HM(this,"shape.arc.to",M.arcTo),HM(this,"shape.arc.close",M.arcClose),HM(this,"shape.arc.oval",M.arcOval)):"nStar"===e&&(HM(this,"shape.star.side",M.starSide),HM(this,"shape.corner.radius",M.cornerRadius),HM(this,"shape.star.ratio",M.starRatio),HM(this,"shape.regular",M.regular)),vM(this,M,q,N),M.gradientPack&&HM(this,"shape.gradient.pack",Yq(M.gradientPack,this)),M.borderGradientPack&&HM(this,"shape.border.gradient.pack",Yq(M.borderGradientPack,this))}},q.prototype.toJSON=function(){var M={};rM(this,M,"shape","type",void 0),rM(this,M,"shape.background","background",null),rM(this,M,"shape.repeat.image","repeatImage"),rM(this,M,"shape.repeat.image.stretch","repeatImageStretch"),rM(this,M,"shape.repeat.image.rotation","repeatImageRotation"),rM(this,M,"shape.border.width","borderWidth"),rM(this,M,"shape.border.color","borderColor",null),rM(this,M,"shape.border.3d","border3d"),rM(this,M,"shape.border.3d.color","border3dColor"),rM(this,M,"shape.border.3d.accuracy","border3dAccuracy"),rM(this,M,"shape.border.cap","borderCap"),rM(this,M,"shape.border.join","borderJoin"),rM(this,M,"shape.border.pattern","borderPattern"),rM(this,M,"shape.gradient","gradient"),rM(this,M,"shape.gradient.color","gradientColor"),rM(this,M,"shape.dash","dash"),rM(this,M,"shape.dash.pattern","dashPattern"),rM(this,M,"shape.dash.offset","dashOffset"),rM(this,M,"shape.dash.color","dashColor"),rM(this,M,"shape.dash.width","dashWidth"),rM(this,M,"shape.dash.3d","dash3d"),rM(this,M,"shape.dash.3d.color","dash3dColor"),rM(this,M,"shape.dash.3d.accuracy","dash3dAccuracy"),rM(this,M,"shape.gradient.pack","gradientPack",null),rM(this,M,"shape.border.gradient.pack","borderGradientPack",null),rM(this,M,"shape.border.width.absolute","borderWidthAbsolute"),rM(this,M,"shape.fill.clip.direction","fillClipDirection"),rM(this,M,"shape.fill.clip.percentage","fillClipPercentage");var q=this.s("shape");return"rect"===q?rM(this,M,"shape.depth","depth"):"roundRect"===q?rM(this,M,"shape.corner.radius","cornerRadius"):"polygon"===q?(rM(this,M,"shape.polygon.side","polygonSide"),rM(this,M,"shape.regular","regular")):"arc"===q?(rM(this,M,"shape.arc.from","arcFrom"),rM(this,M,"shape.arc.to","arcTo"),rM(this,M,"shape.arc.close","arcClose"),rM(this,M,"shape.arc.oval","arcOval")):"nStar"===q&&(rM(this,M,"shape.star.side","starSide"),rM(this,M,"shape.corner.radius","cornerRadius"),rM(this,M,"shape.star.ratio","starRatio"),rM(this,M,"shape.regular","regular")),oM(this,M),M},IN(q,[{key:"compType",get:function(){return this.s("shape")}}]),q}(ht.Node),Se=function(M){function q(N,e,X){YN(this,q);var w=dN(this,M.call(this));return w.parse(N,e,X),w}return rN(q,M),q.prototype.getClass=function(){return q},q.prototype.toLabel=function(){return this.getDisplayName()||e("editor.comptype.shape")},q.prototype.parse=function(M,q,N){if(M){HM(this,"type",M.type,"shape"),HM(this,"shape.background",M.background,null),HM(this,"shape.repeat.image",M.repeatImage),HM(this,"shape.repeat.image.stretch",M.repeatImageStretch),HM(this,"shape.repeat.image.rotation",M.repeatImageRotation),HM(this,"shape.border.width",M.borderWidth),HM(this,"shape.border.color",M.borderColor,null),HM(this,"shape.border.3d",M.border3d),HM(this,"shape.border.3d.color",M.border3dColor),HM(this,"shape.border.3d.accuracy",M.border3dAccuracy),HM(this,"shape.border.cap",M.borderCap),HM(this,"shape.border.join",M.borderJoin),HM(this,"shape.border.pattern",M.borderPattern),HM(this,"shape.gradient",M.gradient),HM(this,"shape.gradient.color",M.gradientColor),HM(this,"shape.dash",M.dash),HM(this,"shape.dash.pattern",M.dashPattern),HM(this,"shape.dash.offset",M.dashOffset),HM(this,"shape.dash.color",M.dashColor),HM(this,"shape.dash.width",M.dashWidth),HM(this,"shape.dash.3d",M.dash3d),HM(this,"shape.dash.3d.color",M.dash3dColor),HM(this,"shape.dash.3d.accuracy",M.dash3dAccuracy),HM(this,"shape.fill.rule",M.fillRule),HM(this,"shape.fill.clip.direction",M.fillClipDirection),HM(this,"shape.fill.clip.percentage",M.fillClipPercentage),HM(this,"shape.border.width.absolute",M.borderWidthAbsolute),vM(this,M,q,N),kM(this,M);var e=cM(zM(M.points)),X=zM(M.segments);if(X&&X.length){var w=X.reduce(function(M,q){return 5===q?M:M+(q-1||1)},0);e.length!==w&&(e=e.slice(0,w))}this.setPoints(e),this.setSegments(zM(M.segments));var $=void 0;if(M.rect){var t=zM(M.rect);t&&($={x:t[0],y:t[1],width:t[2],height:t[3]}),this.a("rect",AM(M.rect))}$||($=ht.Default.unionPoint(e)),$&&(ht.Default.setIsolating(!0),this.setRect($),ht.Default.setIsolating(!1)),M.gradientPack&&HM(this,"shape.gradient.pack",Yq(M.gradientPack,this)),M.borderGradientPack&&HM(this,"shape.border.gradient.pack",Yq(M.borderGradientPack,this))}},q.prototype.toJSON=function(){var M={};if(rM(this,M,"type","type",void 0),rM(this,M,"shape.background","background",null),rM(this,M,"shape.repeat.image","repeatImage"),rM(this,M,"shape.repeat.image.stretch","repeatImageStretch"),rM(this,M,"shape.repeat.image.rotation","repeatImageRotation"),rM(this,M,"shape.border.width","borderWidth"),rM(this,M,"shape.border.color","borderColor",null),rM(this,M,"shape.border.3d","border3d"),rM(this,M,"shape.border.3d.color","border3dColor"),rM(this,M,"shape.border.3d.accuracy","border3dAccuracy"),rM(this,M,"shape.border.cap","borderCap"),rM(this,M,"shape.border.join","borderJoin"),rM(this,M,"shape.border.pattern","borderPattern"),rM(this,M,"shape.gradient","gradient"),rM(this,M,"shape.gradient.color","gradientColor"),rM(this,M,"shape.dash","dash"),rM(this,M,"shape.dash.pattern","dashPattern"),rM(this,M,"shape.dash.offset","dashOffset"),rM(this,M,"shape.dash.color","dashColor"),rM(this,M,"shape.dash.width","dashWidth"),rM(this,M,"shape.dash.3d","dash3d"),rM(this,M,"shape.dash.3d.color","dash3dColor"),rM(this,M,"shape.dash.3d.accuracy","dash3dAccuracy"),rM(this,M,"shape.fill.rule","fillRule"),rM(this,M,"shape.fill.clip.direction","fillClipDirection"),rM(this,M,"shape.fill.clip.percentage","fillClipPercentage"),rM(this,M,"shape.gradient.pack","gradientPack",null),rM(this,M,"shape.border.gradient.pack","borderGradientPack",null),rM(this,M,"shape.border.width.absolute","borderWidthAbsolute"),oM(this,M),IM(this,M),WM(M,"points",this.a("points"),BM(this.getPoints())),this.getSegments()){var q=this.getSegments().toArray();if(q.length){var N=1===q[0];if(N)for(var e=1;e<q.length;e++)if(2!==q[e]){N=!1;break}N||WM(M,"segments",this.a("segments"),q)}}return M},IN(q,[{key:"compType",get:function(){return this.s("type")}}]),q}(ht.Shape),be=function(M){function q(N,e,X){YN(this,q);var w=dN(this,M.call(this));return w.parse(N,e,X),w}return rN(q,M),q.prototype.getClass=function(){return q},q.prototype.toLabel=function(){if(this.getDisplayName())return this.getDisplayName();var M=this.s("image");return M&&M.length<100?M:e("editor.comptype.image")},q.prototype.onStyleChanged=function(q,N,e){M.prototype.onStyleChanged.call(this,q,N,e),"image"===q&&this.setImage(e)},q.prototype.parse=function(M,q,N){M&&(HM(this,"type",M.type,"image"),HM(this,"body.color",M.color),HM(this,"image.stretch",M.stretch),HM(this,"image",M.name,"node_image"),vM(this,M,q,N))},q.prototype.toJSON=function(){var M={};return rM(this,M,"type","type",void 0),rM(this,M,"body.color","color"),rM(this,M,"image.stretch","stretch"),rM(this,M,"image","name"),oM(this,M),M},IN(q,[{key:"compType",get:function(){return this.s("type")}}]),q}(ht.Node),he=function(M){function q(N,e,X){YN(this,q);var w=dN(this,M.call(this));return w.parse(N,e,X),w}return rN(q,M),q.prototype.getClass=function(){return q},q.prototype.toLabel=function(){return this.getDisplayName()||this.s("text")||e("editor.comptype.text")},q.prototype.parse=function(M,q,N){M&&(HM(this,"type",M.type,"text"),HM(this,"text",M.text),HM(this,"text.align",M.align),HM(this,"text.vAlign",M.vAlign),HM(this,"text.color",M.color),HM(this,"text.gradient",M.gradient),HM(this,"text.gradient.color",M.gradientColor),HM(this,"text.font",M.font),HM(this,"text.vertical",M.vertical),HM(this,"text.vertical.gap",M.verticalGap),HM(this,"text.decoration",M.decoration),HM(this,"text.wrap",M.wrap),HM(this,"text.letter.gap",M.letterGap),HM(this,"text.border.width",M.borderWidth),HM(this,"text.border.color",M.borderColor),HM(this,"text.background",M.background),HM(this,"text.outline.width",M.outlineWidth),HM(this,"text.outline.color",M.outlineColor),HM(this,"text.corner.radius",M.cornerRadius),vM(this,M,q,N),M.gradientPack&&HM(this,"text.gradient.pack",Yq(M.gradientPack,this)))},q.prototype.toJSON=function(){var M={};return rM(this,M,"type","type",void 0),rM(this,M,"text","text"),rM(this,M,"text.align","align"),rM(this,M,"text.vAlign","vAlign"),rM(this,M,"text.color","color"),rM(this,M,"text.gradient","gradient"),rM(this,M,"text.gradient.color","gradientColor"),rM(this,M,"text.gradient.pack","gradientPack",null),rM(this,M,"text.font","font"),rM(this,M,"text.vertical","vertical"),rM(this,M,"text.vertical.gap","verticalGap"),rM(this,M,"text.decoration","decoration"),rM(this,M,"text.wrap","wrap"),rM(this,M,"text.letter.gap","letterGap"),rM(this,M,"text.border.width","borderWidth"),rM(this,M,"text.border.color","borderColor"),rM(this,M,"text.background","background"),rM(this,M,"text.outline.color","outlineColor"),rM(this,M,"text.outline.width","outlineWidth"),rM(this,M,"text.corner.radius","cornerRadius"),oM(this,M),M},IN(q,[{key:"compType",get:function(){return this.s("type")}}]),q}(ht.Text),ye=function(M){function q(N,e,X){YN(this,q);var w=dN(this,M.call(this));return w.s({"shape.border.color":"red","shape.border.width":1,"shape.background":null}),w.parse(N,e,X),w.setClosePath(!0),w}return rN(q,M),q.prototype.getClass=function(){return q},q.prototype.toLabel=function(){return this.getDisplayName()||e("editor.comptype.clip")},q.prototype.parse=function(M,q,N){M&&(HM(this,"type",M.type,"clip"),vM(this,M,q,N),this.setPoints(cM(zM(M.points))),this.setSegments(zM(M.segments)))},q.prototype.toJSON=function(){var M={};if(rM(this,M,"type","type",void 0),oM(this,M),WM(M,"points",this.a("points"),BM(this.getPoints())),this.getSegments()){var q=this.getSegments().toArray();if(q.length){var N=1===q[0];if(N)for(var e=1;e<q.length;e++)if(2!==q[e]){N=!1;break}N||WM(M,"segments",this.a("segments"),q)}}return M},IN(q,[{key:"compType",get:function(){return this.s("type")}}]),q}(ht.Shape),Pe=function(M){function q(N,e,X){YN(this,q);var w=dN(this,M.call(this));return w.parse(N,e,X),w}return rN(q,M),q.prototype.getClass=function(){return q},q.prototype.toLabel=function(){return this.getDisplayName()||e("editor.comptype.restore")},q.prototype.parse=function(M,q,N){M&&HM(this,"type",M.type,"restore")},q.prototype.toJSON=function(){var M={};return rM(this,M,"type","type",void 0),M},IN(q,[{key:"compType",get:function(){return this.s("type")}}]),q}(ht.Node),fe=function(M){function q(N,e,X,w){YN(this,q);var $=dN(this,M.call(this));return $.newAdded=w,$.defaultValueMap={},$.parse(N,e,X),$}return rN(q,M),q.prototype.toLabel=function(){return this.getDisplayName()||this.s("type")||e("editor.comptype.comp")},q.prototype.getClass=function(){return q},q.prototype.getStyle=function(q,N){var e=M.prototype.getStyle.call(this,q,N);return void 0===e&&(e=this.defaultValueMap[q]),e},q.prototype.$60$=function(M){this.properties&&(this.properties=null),this.disableDirty=!0,this.defaultValueMap={};var q=this.s("type"),N=ht.Default.getCompType(q);if(N){if(this.newAdded){var e=N.events,X=N.properties;if(e&&this._updateEvents(N.events),X)for(var w in X)X[w].defaultValue instanceof ht.DataModel&&this.s(w,X[w].defaultValue)}this.newAdded=void 0,this.$59$=null;var $={cache:N,width:{value:100,isSafeFunc:!0,func:function(M){return M._width}},height:{value:100,isSafeFunc:!0,func:function(M){return M._height}},comps:[{type:{func:function(M){return M.compType},isSafeFunc:!0}}]};if(!N.width||this._width>0||this.setWidth(N.width),!N.height||this._height>0||this.setHeight(N.height),N.properties){this.properties=N.properties;for(var t in this.properties){var E=this.properties[t];$.comps[0][t]={func:"style@"+t},HM(this,t,M?M[t]:void 0,E.defaultValue),this.defaultValueMap[t]=E.defaultValue}}var J=oN.config.customProperties.comp;J&&J.length&&J.forEach(function(M){var q=M.property;$.comps[0][q]={func:"style@"+q}}),this.setImage($),this.ivLater()}else this.$59$=M,"editor.comp"!==this.getImage()&&(this.setImage("editor.comp"),this.ivLater());this.disableDirty=!1},q.prototype.ivLater=function(){var M=this;ht.Default.callLater(function(){M.disableDirty=!0,M.iv(),M.disableDirty=!1})},q.prototype.onStyleChanged=function(q,N,e){M.prototype.onStyleChanged.call(this,q,N,e),"type"===q&&(N&&(this.newAdded=!0),this.$60$(this.parsingComp))},q.prototype.parse=function(M,q,N){M&&(this.parsingComp=M,vM(this,M,q,N),HM(this,"type",M.type),this.parsingComp=null)},q.prototype._updateEvents=function(M){var q=this;zN.forEach(function(M){return q.a(M,void 0)}),this.a(M)},q.prototype.toJSON=function(){var M={};if(rM(this,M,"type","type",void 0),oM(this,M),this.properties)for(var q in this.properties)rM(this,M,q,q,this.properties[q].defaultValue);return M},IN(q,[{key:"compType",get:function(){var M=this.s("type");if(this.$59$){var q=this.dm(),N=!!(void 0!==this.__hisIndex__&&q&&M&&ht.Default.getCompType(M));if(N&&this.beginTransaction(),this.$60$(this.$59$),N){var e;this.endTransaction();var X=q.getHistoryManager(),w=X.getHistories(),$=w.pop();this.__hisIndex__>=0&&(e=w[this.__hisIndex__]).push.apply(e,$),X.setHistoryIndex(w.length-1,!0),delete this.__hisIndex__}}else M&&ht.Default.getCompType(M)!==this.getImage().cache&&this.$60$(this.toJSON());return M}}]),q}(ht.Node),xe=function(M){function q(){return YN(this,q),dN(this,M.call(this))}return rN(q,M),q}(ht.widget.BorderPane),ne=function(M){function q(N){return YN(this,q),dN(this,M.call(this,N))}return rN(q,M),q}(ht.widget.ContextMenu),Re=function(M){function q(N){return YN(this,q),dN(this,M.call(this,N))}return rN(q,M),q.prototype.adjustZoom=function(M){return M>oN.config.maxZoom?oN.config.maxZoom:M<oN.config.minZoom?oN.config.minZoom:M},q.prototype.getUnionNodeRect=function(M){var q=this,N=void 0;return M=M._as||M,M.forEach(function(M){M instanceof ht.Node&&(N=c(N,q.getNodeRect(M)))}),N},q.prototype.$63$=function(M){this.validate();var q=this.getViewRect(),N=this.getUnionNodeRect(M);if(!q||!N||ht.Default.intersectsRect(q,N))return null;var e=q.x+q.width/2-N.x-N.width/2,X=q.y+q.height/2-N.y-N.height/2;return this.moveDatas(M,e,X),{x:e,y:X}},q.prototype.getFullscreenDatas=function(){return null},q}(ht.graph.GraphView),Ge=function(M){function q(N){return YN(this,q),dN(this,M.call(this,N))}return rN(q,M),q}(ht.widget.ListView),je=function(M){function q(N){YN(this,q);var e=dN(this,M.call(this,N));return e.getView().style.background=oN.config.color_pane_dark,e.setMaskBackground(null),e.setContentBorderColor(null),e.setContentBackground("white"),e.getMask().style.border=oN.config.color_select+" solid 1px",e}return rN(q,M),q}(ht.graph.Overview),Ke=function(M){function q(N,e,X,w){YN(this,q);var $=dN(this,M.call(this,N,e,X,w));return $.setTogglable(!1),$}return rN(q,M),q}(ht.widget.SplitView),pe=function(M){function q(N){return YN(this,q),dN(this,M.call(this,N))}return rN(q,M),q.prototype.validate=function(){this.getTableView().isEditing()||M.prototype.validate.call(this)},q}(ht.widget.TablePane),Ce=function(M){function q(){return YN(this,q),dN(this,M.call(this))}return rN(q,M),q.prototype.add=function(q,N,e){var X=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],w=M.prototype.add.call(this,q,N,e);return w.setVisible(X),w},q}(ht.widget.TabView),me=function(M){function q(N){return YN(this,q),dN(this,M.call(this,N))}return rN(q,M),q}(ht.widget.Toolbar),Oe=function(M){function q(N){YN(this,q);var e=dN(this,M.call(this,N));return e.setDoubleClickToToggle(!1),e}return rN(q,M),q.prototype.getToggleIcon=function(M){if(this._loader&&!this._loader.isLoaded(M))return this._collapseIcon;var q=M.getChildren(),N=q.size();if(N){for(var e=!1,X=0;X<N;X++)if(this.isVisible(q.get(X))){e=!0;break}if(e)return this.isExpanded(M)?this._expandIcon:this._collapseIcon}},q.prototype.hasExpandedChild=function(M){if(!this.isExpanded(M))return!1;var q=M.getChildren(),N=q.size();if(N)for(var e=0;e<N;e++)if(this.isVisible(q.get(e)))return!0;return!1},IN(q,[{key:"expandIds",get:function(){return Object.keys(this._expandMap)},set:function(M){var q=this;M.forEach(function(M){var N=q.dm().getDataById(M);N&&q.expand(N)})}},{key:"selectionIds",get:function(){var M=[];return this.sm().each(function(q){M.push(q.$33$||q._id)}),M},set:function(M){var q=this,N=[];M.forEach(function(M){var e=q.dm().getDataById(M);e&&N.push(e)}),this.sm().ss(N)}}]),q}(ht.widget.TreeView),Qe=function(M){8===M.keyCode&&M.preventDefault()},se=ht.widget.TextField.prototype.setEditable;ht.widget.TextField.prototype.setEditable=ht.widget.TextArea.prototype.setEditable=function(M){se.call(this,M);var q=this._element;M?q.removeEventListener("keydown",Qe):q.addEventListener("keydown",Qe)};var le=function M(q,N){var e=this;YN(this,M),this.editor=q,this.inspector=N,["isDataTitleVisible","isDataPropertyVisible","isCompTitleVisible","isCompPropertyVisible","isDisplayTitleVisible","isDisplayPropertyVisible","isSymbolTitleVisible","isSymbolPropertyVisible","isData3dTitleVisible","isData3dPropertyVisible","isSceneTitleVisible","isScenePropertyVisible"].forEach(function(M){var X=oN.config.detailFilter,w=oN.config.compactFilter,$=J(w);e[M]=function(){if(X[M]&&!X[M].apply(N,arguments))return!1;if(oN.config.commonAndAdvancedFilterMode){if(q.inspectorCompact)return!(w[M]&&!w[M].apply(N,arguments));if($)return!0;if(w[M]&&!w[M].apply(N,arguments))return!0;if(M.indexOf("Title")>0)return!0;var e=N._currentTitle;return!("isDataPropertyVisible"!==M||!w.isDataTitleVisible||w.isDataTitleVisible.call(N,arguments[0],arguments[1],e))||(!("isCompPropertyVisible"!==M||!w.isCompTitleVisible||w.isCompTitleVisible.call(N,arguments[0],arguments[1],e))||(!("isDisplayPropertyVisible"!==M||!w.isDisplayTitleVisible||w.isDisplayTitleVisible.call(N,arguments[0],e))||(!("isSymbolPropertyVisible"!==M||!w.isSymbolTitleVisible||w.isSymbolTitleVisible.call(N,arguments[0],e))||(!("isData3dPropertyVisible"!==M||!w.isData3dTitleVisible||w.isData3dTitleVisible.call(N,arguments[0],arguments[1],e))||!("isScenePropertyVisible"!==M||!w.isSceneTitleVisible||w.isSceneTitleVisible.call(N,arguments[0],e))))))}return!(q.inspectorCompact&&w[M]&&!w[M].apply(N,arguments))}})},Ye=ht.Default.labelColor,Ie=function(M){function q(N){YN(this,q);var e=dN(this,M.call(this,N)),X=e.gv=new ht.graph.GraphView,w=X.dm();X.setMovableFunc(function(){return!1}),X.setZoomable(!1),X.setPannable(!1),X.setPannable(!1),X.setRectSelectable(!1),X.setScrollBarVisible(!1),X.sm().setSelectionMode("single"),w.setBackground(oN.config.color_pane);for(var $=1;$<56;$++){var t=new ht.Node;t.setTag($),t.setRect(80,60,300,160),t.s({label:"   "+$+"   ","label.position":$,"label.offset.x":0,"label.offset.y":0,"label.color":Ye,"label.font":"18px Arial",shape:"rect","shape.background":null,"shape.border.width":1,"select.width":0,interactive:!0}),w.add(t)}X.sm().ms(function(M){!e._openSetting&&X.sm().ld()&&N.close()});var E=ht.Default.brighter(oN.config.color_select,50);return X.mi(function(M){var q=M.data,N=M.kind;"onEnter"===N?(q._hover=!0,q.iv()):"onLeave"===N&&(q._hover=!1,q.iv())}),X.getLabelBackground=function(M){return X.isSelected(M)?oN.config.color_select:M._hover?E:null},e}return rN(q,M),q.prototype.getView=function(){return this.gv.getView()},q.prototype.getValue=function(){var M=this.gv.sm().ld();return M?M.s("label.position"):this._sourceValue},q.prototype.getWidth=function(){return 360},q.prototype.getHeight=function(){return 220},q.prototype.onOpened=function(M){var q=this.gv,N=q.dm().getDataByTag(M);this._openSetting=!0,q.sm().ss(N),this._openSetting=!1,this._sourceValue=M,q.fitContent(!1,0)},q.prototype.onClosed=function(){},q}(ht.widget.BaseDropDownTemplate);ht.Default.setImage("editor.inspector.linedash",{width:100,height:20,fitSize:!0,comps:[{type:"shape",borderWidth:2,borderColor:ht.Default.labelColor,borderPattern:{func:"attr@pattern"},points:[0,10,100,10]}]});var re=function(M){function q(N){YN(this,q);var e=dN(this,M.call(this,N));e.rowHeight=24,e.hoverData=null;var X=e.listView=new Ge;X.getIconWidth=function(){return N.getWidth()},X.getLabel=function(){return""},X.getIcon=function(){return"editor.inspector.linedash"},X.setRowHeight(e.rowHeight),X.onDataClicked=function(){N.close()},[null].concat(oN.config.lineDashPatterns).forEach(function(M){var q=new ht.Data;q.a("pattern",M),X.dm().add(q)}),X.getView().style.background=oN.config.color_pane,X.getView().addEventListener("mousemove",function(M){var q=X.getDataAt(M);q!==e.hoverData&&(e.hoverData=q,X.redraw())});var w=e;return X.drawRowBackground=function(M,q,N,e,X,$,t){if(N)M.fillStyle=this.getSelectBackground();else{if(q!==w.hoverData)return;M.fillStyle=oN.config.color_hover}M.fillRect(e,X,$,t)},e}return rN(q,M),q.prototype.getView=function(){return this.listView.getView()},q.prototype.onOpened=function(M){if(M){var q=this.listView;q.dm().each(function(N){var e=N.a("pattern");e&&e.join(",")===M.join(",")&&q.sm().ss(N)})}},q.prototype.onClosed=function(){delete this.hoverData},q.prototype.getWidth=function(){return this.getMaster().getWidth()},q.prototype.getValue=function(){var M=this.listView,q=M.sm().ld();return q?q.a("pattern"):null},q.prototype.getHeight=function(){return this.listView.dm().size()*this.rowHeight},q}(ht.widget.BaseDropDownTemplate),de=function(M){function q(N,e,X,w){YN(this,q);var $=dN(this,M.call(this));return $.editor=X.editor,$.data=N,$.column=e,$.tableView=X,$.info=w,$.setEditable(!0),$.setDropDownComponent(re),$}return rN(q,M),q.prototype.editBeginning=function(){this.open()},q.prototype.onClosed=function(){this.tableView&&this.tableView.endEditing()},q.prototype.getValue=function(){var q=M.prototype.getValue.call(this);return kN(q)&&(q=q.split(",").map(function(M){return Number(M)})),q},q}(ht.widget.MultiComboBox),ae=function(M){function q(N){YN(this,q);var e=dN(this,M.call(this));return e.editor=N,e}return rN(q,M),q.prototype.getPaletteColors=function(){return oN.config.paletteColors},q.prototype.getMenuItemLabel=function(M){return e("editor."+M)},q.prototype.onContextMenuCreated=function(M){this.editor&&this.editor.menus.push(this.__menu__=M)},q.prototype.close=function(q){if(!this._picking){var N=this._dropDownComponentInstance;N&&N.isMenuShowing&&N.isMenuShowing()||M.prototype.close.call(this,q)}},q.prototype.onClosed=function(){var M=this.__menu__;if(this.__menu__=void 0,M){var q=this.editor.menus,N=q.indexOf(M);-1!==N&&q.splice(N,1)}},q.prototype.onColorPaletteAdded=function(){this.editor.uploadPaletteColors()},q.prototype.onColorPaletteDeleted=function(){this.editor.uploadPaletteColors()},q.prototype.getPaletteBorderColor=function(){return oN.config.color_line},q}(ht.widget.ColorPicker);ht.widget.ColorPicker=ae,ht.Default.onWidgetColorPickerCreated=function(M){var q=oN.config.color_line+" solid 1px",N=M.getView();N.querySelector(".satval").style.border=q,N.querySelector(".hue_image").style.border=q,N.querySelector(".preview").style.border=q;for(var e=N.querySelectorAll('input[type="button"]'),X=0;X<e.length;X++){var w=e[X];w.style.border=q,w.style.background="none",w.style.outline="none",w.style.width="30px",w.addEventListener("mouseover",function(M){M.target.style.background=oN.config.color_hover},!1),w.addEventListener("mouseout",function(M){M.target.style.background="none"},!1)}e=N.querySelectorAll("span");for(var $=0;$<e.length;$++)XN(M,N,e[$])},I("editor.gradient.type",{dataBindings:[{attr:"type",valueType:"String",defaultValue:"solid",extraInfo:{enum:{values:["solid","linear","radial"]}}},{attr:"background",valueType:"Color"},{attr:"selectColor",valueType:"Color"}],width:120,height:25,fitSize:!0,interactive:!0,comps:[{type:"circle",background:{func:function(M,q){return"solid"===M.a("type")?M.a("selectColor"):"#d8d8d8"},value:"rgb(48,242,120)"},borderWidth:1,borderColor:{func:function(M,q){return"solid"===M.a("type")?M.a("selectColor"):"#ccc"},value:"#CCCCCC"},layoutH:"center",layoutV:"center",shadowColor:{func:"attr@selectColor"},shadowOffsetX:1,shadowOffsetY:1,rect:[10.34036,2.5,20,20],onUp:function(M,q,N){var e=q.a("type");if("solid"!==e){q.a("type","solid");var X=q.a("onChange");X&&X(e,"solid",q,N)}},onEnter:function(M,q,N){N.setCursor("pointer")},onLeave:function(M,q,N){N.setCursor("default")}},{type:"circle",background:{func:function(M,q){return"linear"===M.a("type")?M.a("selectColor"):"#ccc"},value:"rgb(48,242,120)"},borderWidth:1,borderColor:{func:function(M,q){return"linear"===M.a("type")?M.a("selectColor"):"#ccc"},value:"#CCCCCC"},gradient:"linear.south",layoutH:"center",layoutV:"center",shadowColor:{func:"attr@selectColor"},rect:[50,2.5,20,20],onUp:function(M,q,N){var e=q.a("type");if("linear"!==e){q.a("type","linear");var X=q.a("onChange");X&&X(e,"linear",q,N)}},onEnter:function(M,q,N){N.setCursor("pointer")},onLeave:function(M,q,N){N.setCursor("default")}},{type:"circle",background:{func:function(M,q){return"radial"===M.a("type")?M.a("selectColor"):"#ccc"},value:"rgb(48,242,120)"},borderWidth:1,borderColor:{func:function(M,q){return"radial"===M.a("type")?M.a("selectColor"):"#ccc"},value:"#CCCCCC"},gradient:"radial.center",layoutH:"center",layoutV:"center",shadowColor:{func:"attr@selectColor"},displayName:"\u5706\u5f62",rect:[89.65964,2.5,20,20],onUp:function(M,q,N,e,X,w){var $=q.a("type");if("radial"!==$){q.a("type","radial");var t=q.a("onChange");t&&t($,"radial",q,N)}},onEnter:function(M,q,N){N.setCursor("pointer")},onLeave:function(M,q,N){N.setCursor("default")}},{type:"rect",background:"#CCCCCC",borderColor:"#979797",layoutH:"leftright",layoutV:"bottom",rect:[0,24,120,1]}]}),I("editor.gradient.pack.reverse",{background:"rgb(0,0,0)",width:16,height:16,blendMode:"override",comps:[{type:"shape",background:{func:function(M,q){return M.a("hovering")?M.a("selectColor")||"rgba(41,141,209,0.85)":"rgba(0,0,0,0.45)"},value:"rgba(0,0,0,0.45)"},
pixelPerfect:!0,onEnter:function(M,q,N){q.a("hovering",!0),N.setCursor("pointer")},onLeave:function(M,q,N){q.a("hovering",!1),N.setCursor("default")},points:[12.74582,8.8183,13.03207,8.8183,13.1716,9.15276,12.99683,9.35633,12.95451,9.39778,10.97695,11.03439,10.83768,11.14964,10.63135,11.13018,10.51609,10.99091,10.41364,10.86712,10.41764,10.69033,10.51761,10.57163,10.55957,10.53005,11.83587,9.47294,3.25353,9.47294,3.09284,9.47294,2.9592,9.35715,2.93148,9.20445,2.92621,9.14562,2.92621,8.98493,3.042,8.85129,3.19469,8.82357,3.25353,8.8183,12.74582,8.8183,5.48391,5.00909,5.58636,5.13288,5.58236,5.30967,5.48239,5.42837,5.44043,5.46995,4.16413,6.52706,12.74647,6.52706,12.90716,6.52706,13.0408,6.64285,13.06852,6.79555,13.07379,6.85438,13.07379,7.01507,12.958,7.14871,12.80531,7.17643,12.74647,7.1817,3.25418,7.1817,2.96793,7.1817,2.8284,6.84724,3.00317,6.64367,3.04549,6.60222,5.02305,4.96561,5.16232,4.85036,5.36865,4.86982,5.48391,5.00909],segments:[1,4,2,2,4,4,2,2,2,4,2,4,2,2,5,1,4,2,2,2,4,2,4,2,2,4,2,2,4,5]}]}),I("editor.gradient.pack.rotate",{background:"rgb(255,255,255)",width:16,height:16,comps:[{type:"shape",background:{func:function(M,q){return M.a("hovering")?M.a("selectColor")||"rgba(41,141,209,0.85)":"rgba(0,0,0,0.45)"},value:"rgba(0,0,0,0.45)"},pixelPerfect:!0,onEnter:function(M,q,N){q.a("hovering",!0),N.setCursor("pointer")},onLeave:function(M,q,N){q.a("hovering",!1),N.setCursor("default")},points:[11.06463,5.93185,12.13351,5.93185,13,6.7949,13,7.85953,13,7.85953,13,11.07232,13,12.13695,12.13351,13,11.06463,13,11.06463,13,6.71006,13,5.64118,13,4.77469,12.13695,4.77469,11.07232,4.77469,11.07232,4.77469,7.85953,4.77469,6.7949,5.64118,5.93185,6.71006,5.93185,6.71006,5.93185,11.06463,6.57441,6.71006,6.57441,5.99747,6.57441,5.41981,7.14978,5.41981,7.85953,5.41981,7.85953,5.41981,11.07232,5.41981,11.78207,5.99747,12.35744,6.71006,12.35744,6.71006,12.35744,11.06463,12.35744,11.77722,12.35744,12.35488,11.78207,12.35488,11.07232,12.35488,11.07232,12.35488,7.85953,12.35488,7.14978,11.77722,6.57441,11.06463,6.57441,11.06463,6.57441,5.95429,3.06575,5.99984,3.09174,7.5369,4.14078,7.79843,4.31926,7.6716,4.72708,7.35458,4.72708,5.34858,4.72708,3.71449,6.31306,3.64727,8.29478,3.64512,8.4218,3.64512,10.51011,3.64512,10.68755,3.50071,10.83139,3.32256,10.83139,3.16223,10.83139,3.02922,10.71488,3.00422,10.56223,3,10.51011,3,8.4218,3,6.38429,4.41055,4.67492,6.31207,4.20961,6.45087,4.17823,5.63518,3.6218,5.50292,3.53153,5.45932,3.36053,5.52533,3.22053,5.55142,3.17516,5.64205,3.04343,5.81373,3,5.95429,3.06575],segments:[1,4,2,2,4,2,2,4,2,2,4,2,5,1,2,4,2,2,4,2,2,4,2,2,4,2,5,1,2,2,4,4,2,2,4,4,2,2,4,2,2,4,2,4,5]}]});var De="solid",We="linear",ve=ht.Default,oe=ve.createCanvas,He=ve.setCanvas,Ue=ve.isString,Ve=ve.toColorData,Te=function(){var M="",q=void 0,N=oe(),e=void 0;return function(X,w,$){X!==q&&(He(N,X,1),e=N.getContext("2d",{willReadFrequently:!0}),q=X,M="");var t=w.join(",");if(t!==M){M=t,e.clearRect(0,0,X,1);for(var E=e.createLinearGradient(0,0,X,0),J=w.length,u=w[0]===We?5:Ue(w[5])?4:13;u<J;)E.addColorStop(w[u++],w[u++]);e.fillStyle=E,e.fillRect(0,0,X,1)}var g=e.getImageData(Math.floor((X-1)*$),0,1,1).data;return"rgba("+g[0]+","+g[1]+","+g[2]+","+(g[3]/255).toFixed(2)+")"}}(),_e=function(M){function q(){return YN(this,q),dN(this,M.apply(this,arguments))}return rN(q,M),q.prototype.setUp=function(){M.prototype.setUp.call(this)},q.prototype.tearDown=function(){M.prototype.tearDown.call(this)},q.prototype.handle_touchmove=function(M){this.handle_mousemove(M)},q.prototype.handle_mousemove=function(M){var q=this.gv;q.getDataAt(M)?q.setCursor("move"):q.setCursor(null)},q.prototype.handle_touchstart=function(M){this.handle_mousedown(M)},q.prototype.handle_mousedown=function(M){var q=this.gv,N=q.getDataAt(M);N&&N.a("pointIndex")&&(this.startDragging(M),this.draggingNode=N,q.editing=!0)},q.prototype.handleWindowMouseMove=function(M){var q=this.gv,N=this.draggingNode;if(N){var e=q.lp(M),X=this.caluCloset(e),w=q.dm().getDataByTag("preview"),$=w.getRect(),t=$.x,E=$.y,J=$.width,u=$.height;N.setX(null==X[0]?e.x:t+J*X[0]),N.setY(null==X[1]?e.y:E+u*X[1]);var g=q.getGradientPack(),S="linear"===g[0],b=null!=X[0]?X[0]:(e.x-t)/J,h=null!=X[1]?X[1]:(e.y-E)/u;if(S)g.splice(1===N.a("pointIndex")?1:3,2,b,h),q._setCloset(X);else if(1===N.a("pointIndex"))g.splice(1,2,b,h),q._setCloset(X);else{var y=g[1],P=Math.abs(b-y);g.splice(3,1,P)}q.setGradientPack(g.slice(0))}},q.prototype.handleWindowMouseUp=function(M){delete this.draggingNode,this.clearDragging(),this.gv.editing=!1,this.gv._setCloset(null)},q.prototype.caluCloset=function(M){var q=this.gv,N=q.dm().getDataByTag("preview"),e=N.getRect(),X=e.x,w=e.y,$=e.width,t=e.height,E=q.getZoom?q.getZoom():1,J=M.x,u=M.y,g=5/E,S=Math.abs,b=void 0,h=void 0;return S(X-J)<g?b=0:S(X+$/2-J)<g?b=.5:S(X+$-J)<g&&(b=1),S(w-u)<g?h=0:S(w+t/2-u)<g?h=.5:S(w+t-u)<g&&(h=1),[b,h]},q}(ht.graph.Interactor),ke=function(M){function q(N){YN(this,q);var e=dN(this,M.call(this,N));return e.dm().setHierarchicalRendering(!0),e.tx(-1e3),e.ty(-1e3),e.setInteractors([new ht.graph.ScrollBarInteractor(e),new ht.graph.SelectInteractor(e),new _e(e),new ht.graph.DefaultInteractor(e),new ht.graph.TouchInteractor(e)]),e._createNodes(),e.addBottomPainter(e._alphaGridPainter),e.addTopPainter(e._closetPainter),e.mp(function(M){if("zoom"===M.property){var q=1/e.getZoom();e.pointNode1.setScale(q,q),e.pointNode2.setScale(q,q)}}),e}return rN(q,M),q.prototype.getSelectWidth=function(){return 0},q.prototype._createNodes=function(){var M=this.dm(),q=this.previewNode=new ht.Node;q.setSize(100,100),q.setTag("preview"),q.p(50,50),q.s({"2d.selectable":!1,shape:"roundRect","shape.border.width":1,"shape.border.color":"#ccc","shape.corner.radius":2}),M.add(q),this.fitData(q);var N=this.pointNode1=this._createCircleNode(),e=this.pointNode2=this._createCircleNode(),X=new ht.Edge;X.setSource(N),X.setTarget(e),X.s({"edge.color":"rgb(255,255,255)","edge.dash.width":8,"border.width":1,"border.color":"#E4E4E4","2d.selectable":!1,"edge.width.absolute":!0}),M.add(X),N.p(50,0),N.setSize(8,8),N.a("pointIndex",1),N.setTag("point1"),M.add(N),e.p(50,100),e.setSize(8,8),e.a("pointIndex",2),e.setTag("point2"),M.add(e)},q.prototype._createCircleNode=function(){var M=new ht.Node;return M.s({shape:"circle","shape.background":"#fff","shape.border.width":1,"shape.border.width.absolute":!0,"shape.border.color":"#999999","shadow2.offset.x":0,"shadow2.offset.y":0,shadow2:!0,"shadow2.color":"rgba(0,0,0,0.45)","shadow2.blur":2}),M},q.prototype._setCloset=function(M){this._closet=M,this.redraw()},q.prototype._closetPainter=function(M){var q=this._closet;if(q){var N=q[0],e=q[1],X=this.dm().getDataByTag("preview").getRect(),w=X.x,$=X.y,t=X.width,E=X.height,J=this.getZoom(),u=3/J;if(M.strokeStyle="red",M.lineWidth=1/J,null!=N){var g=w+t*N;M.beginPath(),M.moveTo(g,$),M.lineTo(g,$+E),M.moveTo(g-u,$-u),M.lineTo(g+u,$+u),M.moveTo(g-u,$+E-u),M.lineTo(g+u,$+E+u),M.stroke()}if(null!=e){var S=$+E*e;M.beginPath(),M.moveTo(w,S),M.lineTo(w+t,S),M.moveTo(w-u,S-u),M.lineTo(w+u,S+u),M.moveTo(w+t-u,S-u),M.lineTo(w+t+u,S+u),M.stroke()}}},q.prototype._alphaGridPainter=function(M){rq(M,this.dm().getDataByTag("preview").getRect(),4/this.getZoom(),!0)},q.prototype.setGradientPack=function(M){if(M){var q=this.dm(),N=q.getDataByTag("preview"),e=q.getDataByTag("point1"),X=q.getDataByTag("point2");if(N.s("shape.gradient.pack",M),!ht.Default.isString(M)&&ht.Default.isArray(M)){var w=N.getRect(),$="linear"===M[0],t=void 0,E=void 0;$?(t=gN(w,M[1],M[2]),E=gN(w,M[3],M[4])):(t=gN(w,M[1],M[2]),E=gN(w,M[1]+M[3],M[2])),e.p(t),X.p(E),e.s("shape.background",Te(226,M,0)),X.s("shape.background",Te(226,M,1))}}},q.prototype.getGradientPack=function(){return this.dm().getDataByTag("preview").s("shape.gradient.pack")},q.prototype.fitPreviewNode=function(){var M=this.dm(),q=M.getDataByTag("preview");this.fitData(q)},q}(ht.graph.GraphView),Ze=oN.config,ze=Ze.color_light,Ae=Ze.color_select;oN.config.customPaletteColorEnabled&&(oN.config.paletteColors||(oN.config.paletteColors=[]),oN.config.linearPaletteColors||(oN.config.linearPaletteColors=[]),oN.config.radialPaletteColors||(oN.config.radialPaletteColors=[]));var ce=ht.Default,Be=ce.setImage,Le=ce.setCompType,ie=ce.onElementCreated,Fe=ce.isDelete,MX=ce.clone,qX=ce.grow,NX=ce.containsPoint,eX=ce.isCtrlDown,XX=ht.Math.Vector2,wX={handleRect:null,hover:null,activeIndexs:[],appendActive:function(M){this.isActive(M)||this.activeIndexs.push(M)},clearActive:function(){this.activeIndexs=[]},setActive:function(M){this.activeIndexs=[M]},getLastActive:function(){return this.activeIndexs[this.activeIndexs.length-1]},isActive:function(M){return this.activeIndexs.includes(M)},hasActive:function(){return!!this.activeIndexs.length},dragging:null,colorStops:null,barRect:null,hoverStop:null,sliders:[],dragged:!1,rectSelectP1:null,rectSelectP2:null};wX.appendActive(1);var $X=function(M){function q(N){YN(this,q);var e=dN(this,M.call(this,N)),X=e.form=new ht.widget.FormPane;e.lastGradient=null,X.setVPadding(0),X.setHPadding(0),X.setVGap(0),X.setHGap(0);var w=X.getView().style;return w.position="absolute",w.background=ze,e.sliderRow=X.addRow([{id:"graph",element:e.createSliderGraph()}],[.1],95),X.addRow([{id:"graph2",element:e.createBoardGraph()}],[.1],95),X.addRow([e.createColorPicker()],[.1],.1),e.$46$=X._rows,e.hideSliderRow(),e.typeCache={},e}return rN(q,M),q.prototype.getView=function(){return this.form.getView()},q.prototype.getValue=function(){return this.paneNode.a("gradient")},q.prototype.getWidth=function(){return 252},q.prototype.getHeight=function(){return this.colorPane.getHeight()+(this.typeNode.a("type")===De?32:190)},q.prototype.createColorPicker=function(){var M=this,q=this,N=!1,X=this.colorMaster={_instant:!0,_clearButtonVisible:!0,setClearButtonVisible:function(M){},isClearButtonVisible:function(){return!0},getView:function(){return q.getView()},getPaletteBorderColor:function(){return oN.config.color_line},getPaletteColors:function(){var M=q.typeNode.a("type");return M===De?oN.config.paletteColors:M===We?oN.config.linearPaletteColors:oN.config.radialPaletteColors},isInstant:function(){return!0},setInstant:function(M){},getValue:function(){return q._master.getValue()},setValue:function(M){q.typeNode.a("type")===De||_N(M)?q._master.setValue(M):N||(yN(q.paneNode,M),q.hexInput.value=M)},close:function(M,N){if(!q.isMenuShowing()){var e=q.typeNode.a("type"),X=q.colorPane.getValue();if(e===De)q.update(X),q._master.close(M);else if(X){if(_N(X))return q.update(X),void q._master.close(M);q.colorPane.onOpened(X),q.hexInput.value=X,N&&N.target&&"color_ok"===N.target.className&&q._master.close(M)}else q.paneNode.a("gradient",null),q._master.close(M)}},onContextMenuCreated:function(q){return M.editor.menus.push(q)},getMenuItemLabel:function(M){return e("editor."+M)},onColorPaletteAdded:function(q,N){return M.editor.uploadPaletteColors()},onColorPaletteDeleted:function(q,N){return M.editor.uploadPaletteColors()},layoutDropDown:function(){return M._master.layoutDropDown()}};Object.defineProperties(X,{editor:{get:function(){return q.editor}}});var w=this.colorPane=new ht.widget.ColorPickerTemp(X),$=w.onOpened;w.onOpened=function(q){if(_N(q))return void M.onOpened(q);$.call(w,q)},w.mi(function(M){var e=M.kind;if("beginEditHue"===e||"beginEditSV"===e)wX.activeIndexs.length>1&&(N=!0);else if("betweenEditHue"===e||"betweenEditSV"===e){if(N){var X=q.paneNode.a("gradient"),w=$N(X),$=X.slice(0,X[0]===We?5:4),t="betweenEditHue"===e;w.forEach(function(q,N){wX.isActive(N)&&(q.color=t?JN(q.color,M.newValue):uN(q.color,M.newValue.s,M.newValue.v))}),w.forEach(function(M){$.push(M.stop),$.push(M.color)}),q.paneNode.a("gradient",$)}}else"endEditHue"!==e&&"endEditSV"!==e||(N=!1)});var t=this.hexInput=document.createElement("input"),E=t.style;return t.addEventListener("keydown",function(N){if(n(N)){var e=N.target.value;if(!Je(e))return void M._master.editor.showErrorColorMessage(e);w.onOpened(e),yN(q.paneNode,e)}}),E.position="absolute",E.width="42px",E.height="22px",E.top="5px",E.left="5px",E.bottom="5px",E.boxSizing="border-box",E.display="none",w.getView().querySelector(".preview").parentNode.appendChild(t),ie&&ie(t),w},q.prototype.createSliderGraph=function(){var M=this,q=this.gv=new ht.graph.GraphView;q.setZoomable(!1),q.setPannable(!1),q.getSelectWidth=function(){return 0},q.setMovableFunc(function(){return!1}),q.setRectSelectable(!1),q.setScrollBarVisible(!1),q.handleScroll=function(M){return M.stopImmediatePropagation()};var N=this.typeNode=new ht.Node;N.setImage("editor.gradient.type"),N.setAnchor(0,0),N.p(0,0),N.setSize(252,32),N.a({selectColor:Ae,onChange:function(q,N){var e=ht.Default.clone(M.paneNode.a("gradient")),X=void 0;M.typeCache[q]=e,N===De?M.hideSliderRow():(M.showSliderRow(),wX.setActive(0)),(X=M.typeCache[N])||(q?q===De?(X=e||Ae,X=N===We?[We,.5,0,.5,1,0,X,1,ze]:["radial",.5,.5,.5,0,X,1,ze]):N===We?(X=e.slice(0),X.splice(3,1,1,.5),X.splice(0,1,We)):"radial"===N?(X=e.slice(0),X.splice(3,2,.5),X.splice(0,1,"radial")):q===We?X=e[6]:"radial"===q&&(X=e[5]):X=N===We?[We,.5,0,.5,1,0,Ae,1,ze]:"radial"===N?["radial",.5,.5,.5,0,Ae,1,ze]:Ae);var w=X;N===We?w=X[6]:"radial"===N&&(w=X[5]),M.paneNode.a("gradient",X),M.boardGv.setGradientPack(X),M.colorPane.onOpened(w),M._master.setValue(X)}}),q.dm().add(N);var X=this.paneNode=new ht.Node;return X.setWidth(252),X.setHeight(65),X.p(0,32),X.setAnchor(0,0),X.setImage("editor.gradient.pack"),X.a({selectColor:Ae,orientationTitle:e("editor.gradient.orientation"),onActiveSliderUpdated:function(q){M.colorPane.onOpened(q)}}),q.dm().add(X),q.dm().md(function(q){var N=q.property,e=q.data;"a:gradient"===N&&e===M.paneNode?(M._master.setValue(q.newValue),M._packUpdating||M.boardGv.setGradientPack(q.newValue)):"a:type"===N&&e===M.typeNode&&(M.colorPane.buildPaletteColors(),M._master.layoutDropDown())}),q.getView().addEventListener("keydown",function(q){if(N.a("type")!==De&&Fe(q)){hN(M.paneNode);var e=$N(M.paneNode.a("gradient"));M.colorPane.onOpened(e[wX.getLastActive()].color)}}),q},q.prototype.createBoardGraph=function(){var M=this,q=this.boardGv=new ke,N=q.handleScroll;return q.handleScroll=function(M){N.apply(this,arguments),M.stopImmediatePropagation()},q.dm().md(function(q){"s:shape.gradient.pack"!==q.property||M._packUpdating||M.paneNode.a("gradient",q.newValue)}),q.sm().ms(function(N){if("set"===N.kind){var e=q.sm().ld().a("pointIndex");if(e){var X=$N(M.paneNode.a("gradient")),w=1===e?0:X.length-1;w!==wX.getLastActive()&&(wX.setActive(w),M.colorPane.onOpened(X[w].color),M.paneNode.iv())}}}),q},q.prototype.hideSliderRow=function(){this.$46$[0].height=32,this.$46$[1].height=0,this.getView().style.height=32+this.colorPane.getHeight()+"px",this.hexInput.style.display="none",this.form.iv()},q.prototype.showSliderRow=function(){this.$46$[0].height=95,this.$46$[1].height=95,this.hexInput.style.display="block",this.getView().style.height=190+this.colorPane.getHeight()+"px",this.boardGv.fitPreviewNode(),this.form.iv()},q.prototype.isMenuShowing=function(){return this.colorPane.isMenuShowing()},q.prototype.onOpened=function(M){if(kN(M)&&"["===M[0]&&(M=JSON.parse(M)),_N(M)){var q=M[0];if(1===q.length)return;return"radial"!==q||kN(M[5])||(M.splice(7,6),M.splice(1,3)),wX.setActive(0),this.typeNode.a("type",q),this.update(M),this.showSliderRow(),void this.colorPane.onOpened(q===We?M[6]:M[5])}this.typeNode.a("type",De),this.update(M),this.hideSliderRow(),this.colorPane.onOpened(M)},q.prototype.onClosed=function(){var M=this.colorPane._menu;if(M){var q=this.editor.menus,N=q.indexOf(M);-1!==N&&q.splice(N,1)}},q.prototype.makeItemsHidden=function(M){var q=this;M.hidden=!0,M.forEach(function(M){var N=q.form.getItemView(M);N&&(N.style.display="none")})},q.prototype.makeItemsVisible=function(M){var q=this;M.hidden=!1,M.forEach(function(M){var N=q.form.getItemView(M);N&&(N.style.display="block")})},q.prototype.update=function(M){this._packUpdating=!0,this.paneNode.a("gradient",M),this.boardGv.setGradientPack(M),this._packUpdating=!1},IN(q,[{key:"editor",get:function(){return this._master.editor}}]),q}(ht.widget.BaseDropDownTemplate),tX=function(M){function q(N){YN(this,q);var e=dN(this,M.call(this));return e.editor=N,e.setEditable(!0),e.setDropDownComponent($X),e}return rN(q,M),q.prototype.setValue=function(q){if(!Ee(q))return void this.editor.showErrorColorMessage(q);q&&!kN(q)&&(q=JSON.stringify(q,void 0,0)),M.prototype.setValue.call(this,q)},q.prototype.getValue=function(){var q=M.prototype.getValue.call(this);return q&&"["===q[0]&&(q=JSON.parse(q)),q},q.prototype.drawValue=function(M,q,N,e,X){if(!(X<=0)){var w=this.getValue();w&&(M.beginPath(),M.rect(q+2,N+2,20,X-4),M.fillStyle=Iq(M,w,{x:q+2,y:N+2,width:20,height:X-4}),M.fill(),M.restore(),kN(w)||(w=JSON.stringify(w,void 0,0)),B(M,w,this.getLabelFont(),this.getLabelColor(),q+23,N,0,X))}},q.prototype.close=function(q){var N=this._dropDownComponentInstance;N&&(N.isMenuShowing&&N.isMenuShowing()||N.colorMaster&&N.colorMaster._picking)||M.prototype.close.call(this,q)},q.prototype.getMenuItemLabel=function(M){return e("editor."+M)},q.prototype.layoutDropDown=function(){this.isOpened()&&M.prototype.layoutDropDown.call(this)},q}(ht.widget.MultiComboBox),EX=function(M){function q(N,e,X,w){YN(this,q);var $=dN(this,M.call(this,X.editor));return $.data=N,$.column=e,$.tableView=X,$.info=w,$}return rN(q,M),q.prototype.editBeginning=function(){this.open()},q.prototype.onClosed=function(){this.tableView&&this.tableView.endEditing()},q}(tX);Le("editor.gradient.pack.slider",{width:255,height:60,func:function(M,q,N,e,X){var w=N.getValue("gradient");if(_N(w)){var $=q.x,t=q.y,E=q.width,J=q.height,u=w.length,g=w[0]===We?5:kN(w[5])?4:13,S={x:$+16,y:t+(J-10)/2,width:E-32,height:10},b=g;wX.sliders=[];var h=S.x,y=S.y,P=S.width,f=S.height;M.save(),M.beginPath(),TN(M,h,y,P,f,6),M.clip(),rq(M,S),M.beginPath(),TN(M,h,y,P,f,6);var x=M.createLinearGradient(h,y,h+P,y);for(b=g;b<u;)x.addColorStop(w[b++],w[b++]);M.fillStyle=x,M.fill(),M.strokeStyle="#CCCCCC",M.stroke(),M.restore(),wX.barRect=S;var n=0;for(b=g;b<u;){var R=w[b++],G=w[b++];wX.sliders.push({stop:R,color:G,rect:SN(M,S,n,R,G),index:n++})}null!=wX.hoverStop&&SN(M,S,null,wX.hoverStop,Te(S.width,w,wX.hoverStop));var j=MX(S);qX(j,2),wX.handleRect=j;var K=wX.rectSelectP1,p=wX.rectSelectP2;if(K&&p){var C=l({x:K.x,y:t},{x:p.x,y:t+J});M.fillStyle="rgba(156,156,156,0.4)",M.fillRect(C.x,C.y,C.width,C.height)}}}}),Be("editor.gradient.pack",{width:250,height:270,fitSize:!0,interactive:!0,pixelPerfect:!1,comps:[{type:"rect",rect:[0,35,250,1],layoutH:"leftright",layoutV:"top",background:"#ccc"},{type:"rect",rect:[0,270,250,1],layoutH:"leftright",layoutV:"bottom",background:"#ccc"},{type:"text",rect:[12,32,120,30],text:{func:"attr@orientationTitle",value:e("editor.gradient.orientation")},color:"#666666",align:"left",vAlign:"bottom",font:'12px PingFangSC-R, "PingFang SC"',layoutH:"left",layoutV:"top"},{type:"image",name:"editor.gradient.pack.reverse",rect:[215,44,16,16],layoutH:"right",layoutV:"top",onDown:function(M,q,N){var e=q.a("gradient"),X=$N(e),w=X.length,$=wX.activeIndexs;e=e.slice(0,e[0]===We?5:4),X.reverse(),wX.activeIndexs=$.map(function(M){return w-1-M}),X.forEach(function(M){e.push(1-M.stop),e.push(M.color)}),q.a("gradient",e.slice(0))}},{type:"image",name:"editor.gradient.pack.rotate",rect:[190,43,16,16],layoutH:"right",layoutV:"top",visible:{func:function(M,q){var N=M.a("gradient");return N&&N[0]===We}},onDown:function(M,q,N){var e=q.a("gradient");if(e[0]===We){var X=new XX(e[1],e[2]),w=new XX(e[3],e[4]),$={x:X.x+(w.x-X.x)/2,y:X.y+(w.y-X.y)/2};X.rotateAround($,Math.PI/2),w.rotateAround($,Math.PI/2),[X,w].forEach(function(M){var q=0,N=0;M.x<0?q=-M.x:M.x>1&&(q=-(M.x-1)),M.y<0?N=-M.y:M.y>1&&(N=-(M.y-1)),X.add({x:q,y:N}),w.add({x:q,y:N})}),e.splice(1,4,X.x,X.y,w.x,w.y),q.a("gradient",e.slice(0))}}},{type:"roundRect",rect:[242,39,4,24],layoutH:"right",layoutV:"top",opacity:.25,cornerRadius:2,background:{func:"attr@selectColor"}},{type:"editor.gradient.pack.slider",rect:[0,0,250,35],layoutH:"center",layoutV:"top",gradient:{func:"attr@gradient"},onActiveSliderUpdated:{func:"attr@onActiveSliderUpdated"},onDown:function(M,q,N,e,X,w){if(wX.hoverStop){var $=q.a("gradient"),t=$N(q.a("gradient")),E=Te(wX.barRect.width,$,wX.hoverStop);t.push({color:E,stop:wX.hoverStop}),t.sort(function(M,q){return M.stop>q.stop?1:-1}),$=$.slice(0,$[0]===We?5:4);var J=void 0;t.forEach(function(M,q){M.stop===wX.hoverStop&&(J=q),$.push(M.stop),$.push(M.color)}),q.a("gradient",$);var u=q.a("onActiveSliderUpdated");u&&u(E)}},onUp:function(M,q,N,e,X,w){if(wX.dragged)return void(wX.dragged=!1);var $=wX.getLastActive(),t=bN(wN(N,q,this,e));if(t&&(eX()?wX.appendActive(t.index):wX.setActive(t.index)),$!==wX.getLastActive()){var E=q.a("onActiveSliderUpdated");E&&t&&E(t.color),q.iv()}},onMove:function(M,q,N,e,X,w){if(!wX.dragging&&!wX.rectSelectP1){var $=wX.barRect,t=wX.handleRect,E=wN(N,q,this,e),J=bN(E),u=!1;(wX.hover?wX.hover.index:null)!==(J?J.index:null)&&(wX.hover=J,u=!0);var g=wX.hoverStop;!J&&NX(t,E)?wX.hoverStop=(E.x-$.x)/$.width:delete wX.hoverStop,wX.hoverStop!==g&&(u=!0),null!=wX.hoverStop?N.setCursor("crosshair"):null!=wX.hover?N.setCursor("ew-resize"):N.setCursor("default"),u&&q.iv()}},onLeave:function(M,q,N,e,X,w){wX.dragging||(N.setCursor("default"),null!=wX.hoverStop&&(delete wX.hoverStop,q.iv()))},onBeginDrag:function(M,q,N,e,X,w){var $=wN(N,q,this,e),t=bN($);if(t){for(var E=$N(q.a("gradient")),J=0;J<E.length;J++)if(t&&E[J].stop===t.stop){E.splice(J,1);break}delete wX.hover,wX.colorStops=E,wX.dragging=t,wX.setActive(t.index);var u=q.a("onActiveSliderUpdated");u&&t&&u(t.color)}else wX.rectSelectP1=$},onDrag:function(M,q,N,e,X,w){var $=wN(N,q,this,e);if(wX.dragging){var t=wX.barRect,E=Math.min(t.x+t.width,Math.max(t.x,$.x)),J=q.a("gradient"),u=(E-t.x)/t.width,g=wX.colorStops.slice(0);J=J.slice(0,J[0]===We?5:4),g.push({color:wX.dragging.color,stop:u}),g.sort(function(M,q){return M.stop>q.stop?1:-1});for(var S=wX.dragging.index,b=0;b<g.length;b++)if(g[b].stop===u){S!==b&&(wX.setActive(b),wX.dragging.index=b);break}g.forEach(function(M){J.push(M.stop),J.push(M.color)}),q.a("gradient",J)}else wX.rectSelectP1&&(wX.rectSelectP2=$,q.iv());wX.dragged=!0},onEndDrag:function(M,q,N,e,X,w){if(wX.rectSelectP1&&wX.rectSelectP2){var $=wX.barRect,t=$.x,E=$.width,J=l(wX.rectSelectP1,wX.rectSelectP2),u=J.x,g=u+J.width;$N(q.a("gradient")).forEach(function(M,q){var N=t+M.stop*E;N>=u&&N<=g&&wX.appendActive(q)}),delete wX.rectSelectP1,delete wX.rectSelectP2}delete wX.dragging,N.setCursor("default"),q.iv()}}]});var JX=function(M){function q(N,e,X){var w=arguments.length>3&&void 0!==arguments[3]&&arguments[3];YN(this,q);var $=dN(this,M.call(this));$.setHPadding(8),$.setVPadding(4);var t=oN.config.indent,E=$.getHGap();return $.indent=t,$.indent2=oN.config.indent2,$.w1=[t,.1],$.w1w1=[t,.1,t,.1],$.wcc=[t,40+2*E+"+0.1",t,20,.1,20],$.w2=[t-20-E,20,.1,t,.1],$.w3=[t-20-E,20,.1,20,.1,20,.1],$.w20=20+E+"+0.1",$.global=w,$.editor=N,$.name=e,$.type=X,$.inspectorFilter=new le(N,$),$.updateHandlers=[],$.propertyChangeHandlers=[],$.editor.fireEvent("inspectorInitializing",{inspector:$}),$.initForm(),$.editor.fireEvent("inspectorInitialized",{inspector:$}),$.editor.fireEvent("inspectorCreated",{inspector:$}),$.$46$=$._rows,$.selection=void 0,$.actionLabelDataBindingEnabled=!0,$}return rN(q,M),q.prototype.initForm=function(){},q.prototype.beginTransaction=function(){this.dataModel&&this.dataModel.beginTransaction()},q.prototype.endTransaction=function(){this.dataModel&&this.dataModel.endTransaction()},q.prototype.addUpdateHandler=function(M){this.updateHandlers.push(M)},q.prototype.removeUpdateHandler=function(M){E(this.updateHandlers,M)},q.prototype.addPropertyChangeHandler=function(M){this.propertyChangeHandlers.push(M)},q.prototype.removePropertyChangeHandler=function(M){E(this.propertyChangeHandlers,M)},q.prototype.$102$=function(){for(var M=this._rows,q=!0,N=M.length-1;N>=0;N--)M[N].title?q?this.removeRow(M[N]):q=!0:q=!1},q.prototype.isTitleVisible=function(M){return!1!==M.visible&&(!OM(M.visible)||!1!==M.visible(this))},q.prototype.isPropertyVisible=function(M){if(!1===M.visible)return!1;if(OM(M.visible)&&!M.visible(this))return!1;var q=this.editor.inspectorInputFilter;if(q){if(!M.keys)return!1;q=q.toLowerCase();var N=M.keys.name;if(N&&this.match(N.toLowerCase(),q))return!0;var e=M.keys.displayName;return!(!e||!this.match(e.toLowerCase(),q))}return!0},q.prototype.match=function(M,q){return M.indexOf(q)>=0},q.prototype.makeItemsHidden=function(M){var q=this;M.hidden=!0,M.forEach(function(M){var N=q.getItemView(M);N&&(N.style.display="none")})},q.prototype.makeItemsVisible=function(M){var q=this;M.hidden=!1,M.forEach(function(M){var N=q.getItemView(M);N&&(N.style.display="block")})},q.prototype.filterPropertiesLater=function(){var M=this;this._filterPropertiesLater||(this._filterPropertiesLater=!0,requestAnimationFrame(function(){M.filterProperties()}))},q.prototype.isTitleExpanded=function(M){return!(M&&!this.editor.inspectorInputFilter)||oN.config.expandedTitles[M]},q.prototype.filterProperties=function(){var M=this;this._filterPropertiesLater=!1;var q=[];this._currentTitle=null;var N=!1;this.$46$.forEach(function(e){var X=e.items;e.title?(!N&&"$$HTISFUCKINGAWESOME$$"!==M._currentTitle&&q.length&&q[q.length-1].title&&M.makeItemsHidden(q.pop().items),M.isTitleVisible(e)?(M._currentTitle=e.title,e.button.setIcon(M.isTitleExpanded(M._currentTitle)?"expandIcon":"collapseIcon"),q.push(e),M.makeItemsVisible(X)):(M._currentTitle="$$HTISFUCKINGAWESOME$$",M.makeItemsHidden(X)),N=!1):"$$HTISFUCKINGAWESOME$$"===M._currentTitle?M.makeItemsHidden(X):(M.isTitleExpanded(M._currentTitle)&&M.isPropertyVisible(e)?(q.push(e),M.makeItemsVisible(X)):M.makeItemsHidden(X),!N&&M.isPropertyVisible(e)&&(N=!0))}),!N&&"$$HTISFUCKINGAWESOME$$"!==this._currentTitle&&q.length&&q[q.length-1].title&&this.makeItemsHidden(q.pop().items),this._currentTitle=null,this._rows=q,this.updateProperties(),this.iv()},q.prototype.addTitle=function(M,q){var N=this;q=q||{};var e=this._oldTitle;this.editor.fireEvent("titleCreating",{oldTitle:e,title:M,inspector:this});var X=function(){oN.config.expandedTitles[M]=!oN.config.expandedTitles[M],N.filterProperties()},w=[],$=this.addButton(w,null,null,null,X,!0);$.setBorderColor(null),q.icon&&this.addImage(w,function(){return q.icon}),this.addTitleItem(w,M,q),q.title=M,q.background||(q.background=oN.config.inspectorTitleBackground||oN.config.color_pane_dark),q.button=$;var t=[20,.1];q.icon&&(t=[20,20,.1]);var E=q.buttons;if(E){var J=void 0,u=void 0;if(_N(E)?J=E:(J=E.items,u=E.widths),!u){u=[];for(var g=0,S=J.length;g<S;g++)u.push(20)}w.push.apply(w,J),t.push.apply(t,u)}var b=this.addRow(w,t,oN.config.inspectorTitleHeight||null,q);return this._oldTitle=M,this.editor.fireEvent("titleCreated",{oldTitle:e,title:M,inspector:this}),b},q.prototype.addTitleItem=function(M,q,N){var X=this,w=!1,$=function(){w&&(oN.config.expandedTitles[q]=!oN.config.expandedTitles[q],X.filterProperties()),w=!1},t=e("editor."+q.toLowerCase(),!0)||e(q),E=$q(t,"left",oN.config.boldFont);E.style.cursor="default";var J=void 0;E.addEventListener("mouseenter",function(){J||(J=N.background),N.background=ht.Default.darker(J,-4),X.iv()}),E.addEventListener("mouseleave",function(){N.background=J,w=!1,X.iv()}),E.addEventListener("mousedown",function(M){M.preventDefault(),w=!0}),E.addEventListener("mouseup",$),M.push(E)},q.prototype.$34$=function(M){var q=this;M&&(this.propertyChangeHandlers.forEach(function(N){N(M,q)}),this.$46$.forEach(function(N){N.onPropertyChanged&&N.onPropertyChanged(M,q)})),this._updatePropertiesLater||(this._updatePropertiesLater=!0,requestAnimationFrame(function(){q.updateProperties()}))},q.prototype.updateProperties=function(){this._updating=!0,this.updateHandlers.forEach(function(M){M()}),this.editor.fireEvent("propertiesUpdated",{inspector:this}),this._updating=!1,this._updatePropertiesLater=!1},q.prototype.eachSelection=function(M){this.dataModel&&(this.beginTransaction(),this.dataModel.sm().each(function(q){M(q)}),this.endTransaction())},q.prototype.getPropertyValue=function(M,q){q=this.fixAccessType(q);var N=b(q,M);return this.getValue(N)},q.prototype.setPropertyValue=function(M,q,N,e){N=this.fixAccessType(N);var X=h(N,M);X.once=e,this.setValue(X,q)},q.prototype.getValue=function(M){if(this.dataModel)return this.global?M(this.dataModel):this.data?M(this.data):void 0},q.prototype.setValue=function(M,q,N){if(!this._updating&&this.dataModel){if(this.beginTransaction(),this.global)M(this.dataModel,N?N():q);else if(M.once)this.data&&M(this.data,N?N():q);else{var e=this.selection;e&&0!==e.length||(e=this.dataModel.sm().getSelection()),0===e.length&&this.data?M(this.data,N?N():q):e.forEach(function(e){M(e,N?N():q)})}this.endTransaction()}},q.prototype.addLabelArray=function(M,q,N,e,X,w,$){return this.addLabel(M,q,N,e,void 0,$),this.addArray(M,N,e,X,w,$&&($.name||$.property))},q.prototype.addLabelTextArea=function(M,q,N,e,X){return this.addLabel(M,q,N,e,void 0,X),this.addTextArea(M,N,e)},q.prototype.fomatterTipToToolTip=function(M){var q=void 0;return M&&(q=M,_N(q)&&(q=q.map(function(M){return _N(M)&&(M=M.slice(0),M[0]="{"+M[0]+"}",M[1]=e(M[1]),M=M.join(" ")),M}).join("<br/>"))),q},q.prototype.addLabelMultiline=function(M,q,N,e,X,w){var $=this,E=void 0;if(w&&w.enum)E=this.addLabelComboBox(M,q,N,e,w.enum.values,t(w.enum.labels,w.enum.i18nLabels),w.enum.icons,X);else{var J=void 0;w&&w.formatterTip&&(J=this.fomatterTipToToolTip(w.formatterTip)),E=this.addLabelInput(M,q,N,e,void 0,void 0,void 0,X,J)}return this.addButton(M,"...",null,null,function(M){$.selection=$.editor.selection;var X=function(M){$.setValue(e,M),$.selection=void 0};$.editor.textView.open($.getValue(N),X,q,function(){return $.selection=void 0},w&&w.formatterTip)},!0),E},q.prototype.addLabelInput=function(M,q,N,e,X,w,$,t,E){return this.addLabel(M,q,N,e,w,t),this.addInput(M,N,e,X,$,w,void 0,void 0,E)},q.prototype.addLabelRange=function(M,q,N,e,X,w,$,t,E){var J=this,u=function(M){var q=N(M);return null==q?w:q};return this.addLabelInput(M,q,u,e?function(M,q){void 0!==w&&q>w&&(q=w),void 0!==X&&q<X&&(q=X);var N=u(M);e(M,q),N!==q||N!==w&&N!==X||J.updateProperties()}:null,t,$,void 0,E)},q.prototype.addLabelPosition=function(M,q,N,e,X){var w=this,$=function(M){var q=N(M);return null==q?1:q},t=function(M,q){q>55&&(q=55),q<1&&(q=1),e(M,q)};this.addLabel(M,q,$,t,1,X);var E=new ht.widget.MultiComboBox;return E.setEditable(!0),E.setDropDownComponent(Ie),E.onValueChanged=function(M,q){w.setValue(e,q)},M.push(E),this.updateHandlers.push(function(){var M=w.getValue($);E.setValue(M)}),E},q.prototype.addLabelDashPattern=function(M,q,N,e,X){return this.addLabel(M,q,N,e,null,X),this.addDashPattern(M,N,e)},q.prototype.addLabelColor=function(M,q,N,e){var X=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};return Object.assign(X,{valueType:"color"}),this.addLabel(M,q,N,e,void 0,X),this.addColor(M,N,e)},q.prototype.addLabelCheckBox=function(M,q,N,e,X){return this.addLabel(M,q,N,e,void 0,X),this.addCheckBox(M,N,e)},q.prototype.addLabelFunction=function(M,q,N,e,X,w,$){return this.addLabel(M,q,N,e,void 0,$),this.addFunction(M,N,e,X,w)},q.prototype.addLabelDataModel=function(M,q,N,e,X,w,$){return this.addLabel(M,q,N,e,void 0,$),this.addDataModel(M,N,e,X,w)},q.prototype.addLabelObject=function(M,q,N,e,X,w,$){return this.addLabel(M,q,N,e,void 0,$),this.addObject(M,N,e,X,w)},q.prototype.addLabelComboBox=function(M,q,N,e,X,w,$,t){return this.addLabel(M,q,N,e,void 0,t),this.addComboBox(M,N,e,X,w,$)},q.prototype.addLabelComboBoxURL=function(M,q,N,e,X,w,$,t,E){var J=this;this.addLabel(M,q,N,e,void 0,E);var u=this.addComboBox(M,N,e,X,w,$);return e&&(u.setEditable(!0),Qq(u,t||function(M,q){return!!q.view.draggingData},function(M){var q=u.getView().value=M.getFileUUID();J.setValue(e,q)})),u},q.prototype.addLabelURL=function(M,q,N,e,X,w){return this.addLabel(M,q,N,e,void 0,w),this.addURL(M,N,e,X)},q.prototype.addURL=function(M,q,N,e){var X=this.addInput(M,q,N);return N&&Qq(X,e||function(M,q){return!!q.view.draggingData
},function(M){X.getElement().value=M.getFileUUID(),X.handleChange()}),X},q.prototype.addLabelImage=function(M,q,N,e,X){var w=function(M,q){if(!q.view.draggingData)return!1;var N=q.view.draggingData.fileType;return"asset"===N||"symbol"===N};return this.addLabelURL(M,q,N,e,w,X),this.addImage(M,N,e)},q.prototype.addLabelData=function(M,q,N,e,X){var w=this,$=this.addLabelInput(M,q,function(M){var q=N(M);return q?q.toLabel()||q.getClassName():""},void 0,void 0,void 0,void 0,X);e&&(Qq($,function(M,q){return q.view.draggingData&&w.dataModel===q.view.draggingData.getDataModel()},function(M){w.setValue(e,M)}),$.getElement().onkeydown=function(M){G(M)&&w.setValue(e,null)});var t=new ht.widget.Image;t.drawImage=function(M,q,N,e,X,$){var E=t.data,J=w.editor.list;E&&J&&J.dm().contains(E)&&(q=J.getIcon(E))&&L(M,ht.Default.getImage(q),"centerUniform",N,e,X,$,E,J)};var E=this.editor,J=function(M){if(M.preventDefault(),t.data&&E.list)if(K(M))E.sm.ss(t.data);else{var q=E.gv;q&&q.fitData(t.data,oN.config.animate);var N=E.g3d;N&&N.flyTo(t.data,{animation:oN.config.animate});var e=E.list;e&&e.makeVisible(t.data)}},u=function(M){E.list&&(E.list._highlightData=M,E.list.redraw());var q=E.gv;q&&q.setHighlightData&&q.setHighlightData(M);var N=E.g3d;N&&N.setHighlightData&&N.setHighlightData(M)},g=t.getView();return g.style.cursor="pointer",g.addEventListener("mousedown",J,!1),g.addEventListener("touchstart",J,!1),g.addEventListener("mouseenter",function(M){u(t.data)}),g.addEventListener("mouseleave",function(M){u(null)}),this.updateHandlers.push(function(){if(!M.hidden){var q=t.data;t.data=w.getValue(N),t.fp("data",q,t.data)}}),M.push(t),$},q.prototype.addLabelGradient=function(M,q,N,e,X,w){var $=this,t=[],E=function(){return $.data&&$.data.s(X)||oN.config.color_light},J=function(){return $.data&&$.data.s(e)||oN.config.color_select};oN.consts.gradients.forEach(function(M){M?t.push({width:20,height:14,comps:[{type:"rect",rect:[0,0,20,14],gradient:M,gradientColor:{func:E},background:{func:J}}]}):t.push({width:20,height:14,comps:[]})});var u=this.addLabelComboBox(M,q,function(M){return M.s(N)},function(M,q){M.s(N,q)},oN.consts.gradients,null,t,w);return this.updateHandlers.push(function(){if(!M.hidden){var q=E(),N=J();u._lastGradientColor===q&&u._lastBackground===N||(u._lastGradientColor=q,u._lastBackground=N,u.iv())}}),u},q.prototype.addLabelFont=function(M,q,N,e,X){var w=this,$=this.addLabelInput(M,q,function(M){return N(M)||ht.Default.labelFont},e?function(M,q){e(M,q||void 0)}:null,void 0,void 0,void 0,X);return this.addButton(M,"...",null,null,function(M){w.selection=w.editor.selection;var X=function(M){w.setValue(e,M),w.selection=void 0};w.editor.fontView.open(w.getValue(N),X,q,function(){return w.selection=void 0})},!0),$},q.prototype.addLabelRotation=function(M,q,N,e,X,w,$,t){return this.addLabelInput(M,q,function(M){var q=N(M);return null==q?w:180/Math.PI*q},e?function(M,q){q=q*Math.PI/180,void 0!==w&&q>w&&(q=w),void 0!==X&&q<X&&(q=X),e(M,q)}:null,"number",$||1,void 0,t)},q.prototype.addLabelAlign=function(M,q,N,e,X){return this.addLabelComboBox(M,q,function(M){return N(M)||"center"},e,oN.consts.aligns,oN.consts.alignLabels,void 0,X)},q.prototype.addLabelVAlign=function(M,q,N,e,X){return this.addLabelComboBox(M,q,function(M){return N(M)||"bottom"},e,oN.consts.vAligns,oN.consts.vAlignLabels,void 0,X)},q.prototype.addLabelStretch=function(M,q,N,e,X,w){var $=oN.consts.stretchs.slice(0),t=oN.consts.stretchLabels.slice(0),E="fill";return w&&($.unshift(void 0),t.unshift(""),E=void 0),this.addLabelComboBox(M,q,function(M){return N(M)||E},e,$,t,void 0,X)},q.prototype.addLabelOrientation=function(M,q,N,e,X){return this.addLabelComboBox(M,q,function(M){return N(M)||"top"},e,oN.consts.orientations,oN.consts.orientationLabels,void 0,X)},q.prototype.addLabelLabel=function(M,q,N,e,X){return this.addLabelInput(M,q,function(M){var q=N(M);return q&&q.replace&&(q=q.replace(/\n/g,"\\n")),q},e?function(M,q){q&&q.replace&&(q=q.replace(/\\n/g,"\n")),e(M,q)}:null,void 0,void 0,void 0,X)},q.prototype.addLabelClipPercentage=function(M,q,N,e,X,w){var $=this,t=this.addLabelInput(M,q,function(M){var q=N(M);return void 0==q?1:q},function(M,q){t.isDisabled()||e(M,q)},"number",.01,void 0,X);this.addCheckBox(M,function(M){return void 0!=N(M)},function(M,q){q?e(M,1):e(M,void 0)}),this.updateHandlers.push(function(){$.data&&t.setDisabled(void 0==N($.data))})},q.prototype.toDisplayName=function(M){var q="";return M.forEach(function(M){if(M)if(kN(M))q+=M;else if(kN(M.element))q+=M.element;else{if(!M.element)return;M.element.innerHTML&&(q+=M.element.innerHTML)}}),q},q.prototype.addLabel=function(M,q,N,e,X){var w=this,$=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{},t=void 0,E=!1,J=N&&e&&X,u=oN.config.dataBindings||{};if(!$.name||u.filter&&!u.filter($.accessType,$.name,this)||(E=!0),t=$q(q,M.length?"right":"left"),M.push(t),t.style.cursor="default",E||J){t.style.cursor=J?"ew-resize":E&&this.actionLabelDataBindingEnabled?"pointer":"default";var g=function(M){M.preventDefault(),w.beginTransaction();var q=J?w.getValue(N)||0:0,g=ht.Default.getWindowInfo().width,S=C(M),b=S.x,h=void 0,y=void 0,P=void 0,f=!1,x=S,n=function(){var M=q+(b-S.x)*(OM(X)?X():X);w.setValue(e,M)},R=function(M){if(M.preventDefault(),J){if(w._labelDragging=!0,!h&&t.requestPointerLock){var q=!1;document.addEventListener("pointerlockchange",P=function(M){(q=!q)||G(M)}),t.requestPointerLock(),h=tq("ew-resize");var N={width:parseInt(h.style.width),height:parseInt(h.style.height)};y=b-N.width/2,h.style.top=S.y-N.height/2+"px",h.style.left=y+"px",document.body.appendChild(h)}var e=void 0;if(h)e=M.movementX,Math.abs(e)>200&&(e=0),y+=e,y<0?y=g+y:y>g&&(y-=g),h.style.left=y+"px";else{var X=C(M);e=X.x-x.x,x=X}b+=e,n(),f=!0}};window.addEventListener("mousemove",R,!1),window.addEventListener("touchmove",R,!1);var G=function(M){M.preventDefault(),delete w._labelDragging,document.exitPointerLock&&document.exitPointerLock(),h&&h.parentNode&&h.parentNode.removeChild(h),window.removeEventListener("mousemove",R,!1),window.removeEventListener("touchmove",R,!1),window.removeEventListener("mouseup",G,!1),window.removeEventListener("touchend",G,!1),document.removeEventListener("pointerlockchange",P),f&&J&&(n(),$.onEndEditing&&$.onEndEditing(w.data)),w.actionLabelDataBindingEnabled&&oN.config.actionLabelDataBindingEnabled&&E&&!f&&ht.Default.isLeftButton(M)&&u.onButtonClicked&&u.onButtonClicked(w.data,$.accessType,$.name,w.editor),w.endTransaction()};window.addEventListener("mouseup",G,!1),window.addEventListener("touchend",G,!1)};t.addEventListener("mousedown",g,!1),t.addEventListener("touchstart",g,!1)}return E&&this.updateHandlers.push(function(){if(w.data){var M=oN.config.isDataBound(w.data,$.accessType,$.name);t.style.color=M?oN.config.color_select:oN.config.color_dark}}),t},q.prototype.createHandleChange=function(M,q,N){var e=this;return function(){var X=M.value;if("pattern"===N)if(X=X.trim()){if(X.indexOf("[")<0||X.indexOf("]")<0)return;if(X=X.replace("[","").replace("]","").split(","),X.length){for(var w=[],$=0;$<X.length;$++){var t=parseFloat(X[$]);if(isNaN(t))return;w.push(t)}X=w}else X=void 0}else X=void 0;else if("number"===N){if(X=parseFloat(X),isNaN(X))return}else if("int"===N){if(X=parseInt(X),isNaN(X))return}else X||(X=void 0);e.setValue(q,X)}},q.prototype.createArrayIndexColumn=function(M,q,N,X,w,$){var t=this,E=M[q],J="object"===X?d(E,void 0,!1):E,u={name:q,width:50,align:"center",editable:!!N,sortable:!1,clickable:!1,getValueType:function(M){return X},getColorPicker:function(M){return"color"===X?{editor:t.editor}:null},getValue:function(M){return J},setValue:function(e,X,w,$){t.setValue(N,void 0,function(){var N=M.slice();return N[q]=VN(w),N})},isCellEditable:function(M,N,J,u){if("object"===X){var g=e("editor.object")+" ["+q+"]";return t.handleObjectViewOpen(E,function(q){N.setValue(M,N,q,u)},g,null,w&&w.objectProperties,$+"="+q),!1}return!0}};return"gradientPack"===X&&(u=UN(ht.Column,u),u.setItemEditor(EX),u.drawCell=function(N,e,X,w,$,t,E,J){var u=M[q];if(u){var g=void 0,S=!1;_N(u)&&u.length>1?(g=Iq(N,u,{x:$,y:t,width:E,height:J}),S=!0):g=u,N.fillStyle=g,N.fillRect($,t,E,J),S&&N.restore()}}),u},q.prototype.addArray=function(M,q,N,X,w,$){var t=this,E=new pe,J=E.getTableHeader();J.isColumnMovable=J.canColumnInsertBefore=function(M){return"length"!==M.getTag()},E.getView().style.border=oN.config.color_line+" solid 1px";var u=E.getTableView();u.getDataModel().add(new ht.Data),u.editor=this.editor;var g=u.getColumnModel();return u.getColumnModel().mh(function(M){g.each(function(M,q){q&&M.setName(q-1)});var e=(t.getValue(q)||[]).slice(0),X=M.oldIndex-1,w=M.newIndex-1,$=e[X];e[X]=e[w],e[w]=$,t.setValue(N,e)}),this.updateHandlers.push(function(){if(!M.hidden){var J=t.getValue(q);if(u.getColumnModel().clear(),E.addColumns([{name:e("editor.length"),width:50,tag:"length",align:"center",editable:!!N,sortable:!1,clickable:!1,valueType:"int",getValue:function(M){return J?J.length:0},setValue:function(M,q,e,w){t.setValue(N,void 0,function(){if(e>=0){var M=yq(J,e);return"number"===X||"int"===X?bq(M):"color"===X&&hq(M),M}})}}]),J){for(var g=[],S=0;S<J.length;S++)g.push(t.createArrayIndexColumn(J,S,N,X,w,$));E.addColumns(g)}}}),M.push(E),E},q.prototype.addTextArea=function(M,q,N){var e=this,X=new ht.widget.TextArea,w=X.getElement();return N?(w.onblur=function(){e.setValue(N,w.value)},w.forceOnblur=w.onblur):X.setEditable(!1),this.updateHandlers.push(function(){if(!M.hidden){var N=e.getValue(q);null==N&&(N=""),w.value!==N&&(w.value=N)}}),M.push(X),X},q.prototype.addInput=function(M,q,e,X,w,$,t,E,J){var u=this,g=new ht.widget.TextField;if("number"===X||"int"===X){g.setType("number");var S=g.getElement();CM($)&&(S.step=$),null!=t&&(S.min=t),null!=E&&(S.max=E)}var b=g.getElement();if(e){var h=this.createHandleChange(b,e,X);g.handleChange=h,w?(b.onkeyup=h,b.onchange=h):(b.onblur=h,b.forceOnblur=b.onblur,b.onkeydown=function(M){n(M)&&h()})}else g.setEditable(!1);return J&&(b.onmousemove=function(M){ht.Default.showToolTip(M,J)},b.onmouseleave=function(M){ht.Default.hideToolTip()}),this.updateHandlers.push(function(){if(!M.hidden){var e=u.getValue(q);"pattern"===X?e=e?"["+e.join()+"]":"":"number"===X?e=N(parseFloat(e||0)):"int"===X?e=parseInt(e||0):null==e&&(e=""),b.value!==e&&(kN(e)&&e.length>1e3&&e.startsWith("data:image")&&(e=e.substr(0,10)+"[...]"),b.value=e)}}),M.push(g),g},q.prototype.addColor=function(M,q,N){var e=this,X=new ae(this.editor);return N?(X.setInstant(!0),X.onValueChanged=function(){e.setValue(N,X.getValue())},X.addViewListener(function(M){"open"===M.kind?e.beginTransaction():"close"===M.kind&&e.endTransaction()})):X.setDisabled(!0),this.updateHandlers.push(function(){if(!M.hidden){var N=e.getValue(q);void 0===N&&(N=null),X.getValue()!=N&&X.setValue(N)}}),M.push(X),X},q.prototype.addImage=function(M,q,N){var e=this,X=new ht.widget.Image;return Oq(X,this.editor),this.updateHandlers.push(function(){if(!M.hidden||M.forceToUpdate){var N=e.getValue(q);X.setExtraInfo(N)}}),M.push(X),X},q.prototype.addCheckBox=function(M,q,N){var e=this,X=new ht.widget.CheckBox;return N?(X.handleClick=function(){X.setSelected(!X.isSelected())},X.onValueChanged=function(){e.setValue(N,X.getValue())}):X.setDisabled(!0),this.updateHandlers.push(function(){if(!M.hidden){var N=!!e.getValue(q);X.getValue()!==N&&X.setValue(N)}}),M.push(X),X},q.prototype.addFunction=function(M,q,N,X,w){var $=this,t=function(){var M=e("editor.function")+" - "+(X||"");$.selection=$.editor.selection;var t=function(M){$.setValue(N,M),$.selection=void 0};$.editor.functionView.open($.getValue(q),t,M,w,function(){return $.selection=void 0})},E=Jq(X,null,null,t);return M.push(E),this.updateHandlers.push(function(){if(!M.hidden){var N=$.getValue(q);E.setLabel(X||u(N)),E.setLabelColor(N?oN.config.color_select:ht.Default.labelColor)}}),E},q.prototype.addDataModel=function(M,q,N,e,X){var w=this,$=function(){w.selection=w.editor.selection;var M=function(M){w.setValue(N,M),w.selection=void 0};w.editor.dataModelView.open(w.getValue(q),M,void 0,X,function(){return w.selection=void 0})},t=Jq(e,null,null,$);return M.push(t),this.updateHandlers.push(function(){if(!M.hidden){var N=w.getValue(q);t.setLabel(e),t.setLabelColor(N?oN.config.color_select:ht.Default.labelColor)}}),t},q.prototype.addObject=function(M,q,N,X,w){var $=this,t=function(){var M=e("editor.object")+" - "+(X||"");$.selection=$.editor.selection;var t=function(M){$.setValue(N,M),$.selection=void 0};$.handleObjectViewOpen($.getValue(q),t,M,function(){return $.selection=void 0},w)},E=Jq(X,null,null,t);return M.push(E),this.updateHandlers.push(function(){if(!M.hidden){var N=$.getValue(q);E.setLabel(X||d(N,void 0,!1)),E.setLabelColor(void 0!==N?oN.config.color_select:ht.Default.labelColor)}}),E},q.prototype.addDashPattern=function(M,q,N){var e=this,X=new ht.widget.MultiComboBox;return X.setEditable(!0),X.setDropDownComponent(re),X.onValueChanged=function(M,q){kN(q)&&(q=q.replaceAll("\uff0c",","),q=q.split(",").map(function(M){return Number(M)})),e.setValue(N,q)},M.push(X),this.updateHandlers.push(function(){var M=e.getValue(q);X.setValue(M)}),X},q.prototype.handleObjectViewOpen=function(M,q,N,e,X,w){this.editor.objectView.open(M,q,N,e,X,w)},q.prototype.addComboBox=function(M,q,N,e,X,w){var $=this,t=new ht.widget.ComboBox;return t.setValues(e),t.setLabels(X),t.setIcons(w),t.setDisabled(!N),N&&(t.onValueChanged=function(){$.setValue(N,t.getValue())}),this.updateHandlers.push(function(){if(!M.hidden){var N=$.getValue(q);t.getValue()!==N&&t.setValue(N)}}),w&&w[0].width&&t.setIndent(w[0].width+4),M.push(t),t},q.prototype.addButton=function(M,q,N,e,X,w){var $=this,t=function(){$.global||w?X():$.eachSelection(X)},E=Jq(q,N,e,t);return M.push(E),E},q.prototype.addDBRow=function(M,q,N,e,X,w,$){var t=this,E=M.length,J=this.indent,u=void 0;if(!oN.config.dataBindings.onButtonClicked||!1===$||oN.config.dataBindings.filter&&!oN.config.dataBindings.filter(q,N,this))w?u=this.addRow(M,w,X,e):2===E?u=this.addRow(M,[J,.1],X,e):3===E?u=this.addRow(M,[J,.1,20],X,e):4===E?u=this.addRow(M,[J,.1,20,20],X,e):5===E?u=this.addRow(M,[J,.1,20,20,20],X,e):1===E&&(u=this.addRow(M,[.1],X,e));else{var g=function(){oN.config.dataBindings.onButtonClicked(t.data,q,N,t.editor)},S=void 0;S=oN.config.dataBindings.getToolTip?oN.config.dataBindings.getToolTip(q,N,this):q+":"+N;var b=this.addButton(M,null,S,null,g,!0);this.updateHandlers.push(function(){if(!M.hidden&&t.data){var e=oN.config.isDataBound(t.data,q,N);b.setIcon(e?"editor.bind.state":"editor.unbind.state")}}),w?(w=w.slice(),w.push(20),u=this.addRow(M,w,X,e)):2===E?u=this.addRow(M,[J,.1,20],X,e):3===E?u=this.addRow(M,[J,.1,20,20],X,e):4===E?u=this.addRow(M,[J,.1,20,20,20],X,e):5===E?u=this.addRow(M,[J,.1,20,20,20,20],X,e):1===E&&(u=this.addRow(M,[.1,20],X,e))}return u.keys={name:N,displayName:this.toDisplayName(M),accessType:q},!this.addingCustomProperties&&Me[this.type]&&Me[this.type][q+":"+N]&&this.removeRows([u]),u},q.prototype.addFuncRow=function(M,q,N,e,X){var w=this,$=this.indent,t=void 0,E=void 0;if(!oN.config.dataBindingsForSymbol.filter||oN.config.dataBindingsForSymbol.filter(N||q,this)){var J=function(){w.dataModel&&w.editor.funcView.toggle(t,q,N,w)},u=void 0;u=oN.config.dataBindingsForSymbol.getToolTip?oN.config.dataBindingsForSymbol.getToolTip(N||q,this):(N||q)+": { func: ... }",t=this.addButton(M,null,u,null,J,!0),this.updateHandlers.push(function(){if(!M.hidden){var N=!1;w.global?w.dataModel&&(N="clip"===q?OM(w.dataModel.a(q)):!!w.dataModel.a(q+"_func")):w.data&&(N=!!w.data.a(q)),t.setIcon(N?"editor.bind.state":"editor.unbind.state")}});var g=M.length;X?(X=X.slice(),X.push(20),E=this.addRow(M,X,e)):3===g?E=this.addRow(M,[$,.1,20],e):4===g?E=this.addRow(M,[$,.1,20,20],e):5===g?E=this.addRow(M,[$,.1,20,20,20],e):6===g&&(E=this.addRow(M,[$,.1,20,20,20,20],e))}else{var S=M.length;X?E=this.addRow(M,X,e):2===S?E=this.addRow(M,[$,.1],e):3===S?E=this.addRow(M,[$,.1,20],e):4===S?E=this.addRow(M,[$,.1,20,20],e):5===S?E=this.addRow(M,[$,.1,20,20,20],e):6===S&&(E=this.addRow(M,[$,.1,20,20,20,20],e))}return E.keys={name:N||q,displayName:this.toDisplayName(M)},!this.addingCustomProperties&&Me[this.type]&&Me[this.type][N||q]&&this.removeRows([E]),E},q.prototype.addNameRow=function(M,q,N,e,X,w){var $=this.indent,t=M.length,E=void 0;return X?E=this.addRow(M,X,e,w):2===t?E=this.addRow(M,[$,.1],e,w):3===t?E=this.addRow(M,[$,.1,20],e,w):4===t?E=this.addRow(M,[$,.1,20,20],e,w):5===t&&(E=this.addRow(M,[$,.1,20,20,20],e,w)),E.keys={name:q,displayName:this.toDisplayName(M),accessType:N},q=(N?N+":":"")+q,!this.addingCustomProperties&&Me[this.type]&&Me[this.type][q]&&this.removeRows([E]),E},q.prototype.$77$=function(){var M=this;this.addTitle("TitleGridsGuides");var q=[];this.addLabelCheckBox(q,e("editor.gridenabled"),function(M){return M.a("gridEnabled")},function(M,q){M.a("gridEnabled",q)}),this.addButton(q,e("editor.skew"),null,null,function(){M.editor.currentView&&M.editor.currentView.skewGrid&&M.editor.currentView.skewGrid()}),this.addButton(q,e("editor.reset"),null,null,function(){M.editor.currentView&&M.editor.currentView.resetGrid&&M.editor.currentView.resetGrid()}),this.addNameRow(q,"gridEnabled","a",void 0,[this.indent,20,.1,.1]),q=[],this.addLabelInput(q,e("editor.gridblocksize"),function(M){return M.a("gridBlockSize")},function(M,q){q>0&&M.a("gridBlockSize",q)},"int",1),this.addNameRow(q,"gridBlockSize","a"),q=[],this.addLabelInput(q,e("editor.gridthicklinesevery"),function(M){return M.a("gridThickLinesEvery")},function(M,q){q>0&&M.a("gridThickLinesEvery",q)},"int",1),this.addNameRow(q,"gridThickLinesEvery","a"),q=[],this.addLabelColor(q,e("editor.gridlightcolor"),function(M){return M.a("gridLightColor")},function(M,q){M.a("gridLightColor",q)}),this.addNameRow(q,"gridLightColor","a"),q=[],this.addLabelColor(q,e("editor.gridthickcolor"),function(M){return M.a("gridThickColor")},function(M,q){M.a("gridThickColor",q)}),this.addNameRow(q,"gridThickColor","a"),q=[],this.addLabelInput(q,e("editor.gridangle"),function(M){return 180/Math.PI*M.a("gridAngle")},function(M,q){M.a("gridAngle",q*Math.PI/180)},"number",1),this.addNameRow(q,"gridAngle","a"),q=[],this.addLabelInput(q,e("editor.gridrotation"),function(M){return 180/Math.PI*M.a("gridRotation")},function(M,q){M.a("gridRotation",q*Math.PI/180)},"number",1),this.addNameRow(q,"gridRotation","a"),q=[],this.addLabelInput(q,e("editor.gridzoomthreshold"),function(M){return M.a("gridZoomThreshold")},function(M,q){q>0&&M.a("gridZoomThreshold",q)},"number",.01),this.addNameRow(q,"gridZoomThreshold","a")},q.prototype.addHighlightProperties=function(){},q.prototype.$26$=function(){var M=this;this.addTitle("TitleEditingPoint");var q={Mirrored:0,Straight:1,Disconnected:2,Asymmetric:3};this.editingPointButtons=[];var N=function(N,X){var w=e("editor.editingpoint."+X.toLowerCase()),$="editor.point."+X.toLowerCase(),t=Jq(w,null,$,function(){M.editor.editInteractor.getSubModule("Curve").setCurrentSelectionStatus(t.statusValue)});t.setOrientation("v"),t.setTogglable(!0),t.setGroupId("editingPoint"),t.statusValue=q[X],M.editingPointButtons.push(t),N.push(t)},X=[];N(X,"Straight"),N(X,"Mirrored"),this.addRow(X,[.1,.1],60).items.tag="editingPointType",X=[],N(X,"Disconnected"),N(X,"Asymmetric"),this.addRow(X,[.1,.1],60).items.tag="editingPointType",oN.SceneView&&(X=[],X.push(e("editor.point")),this.addLabelInput(X,"X",function(q){return M.editor.getCurrentEditingPointValue("x")},function(q,N){return M.editor.setCurrentEditingPointValue("x",N)},"number",1),this.addLabelInput(X,"Y",function(q){return M.editor.getCurrentEditingPointValue("y")},function(q,N){return M.editor.setCurrentEditingPointValue("y",N)},"number",1),this.addNameRow(X,"currentEditingPoint.x.y",void 0,void 0,this.w2).visible=function(){return!(M.currentView instanceof oN.SceneView)},X=[],X.push(e("editor.point")),this.addLabelInput(X,"X",function(q){return M.editor.getCurrentEditingPointValue("x")},function(q,N){return M.editor.setCurrentEditingPointValue("x",N)},"number",1),this.addLabelInput(X,"Y",function(q){return M.editor.getCurrentEditingPointValue("e")},function(q,N){return M.editor.setCurrentEditingPointValue("e",N)},"number",1),this.addLabelInput(X,"Z",function(q){return M.editor.getCurrentEditingPointValue("y")},function(q,N){return M.editor.setCurrentEditingPointValue("y",N)},"number",1),this.addNameRow(X,"currentEditingPoint.x.y.z",void 0,void 0,this.w3).visible=function(){return M.currentView instanceof oN.SceneView})},q.prototype.addCustomProperties=function(){var M=this,q=oN.config.customProperties[this.type];q&&q.length&&(this.addTitle("TitleCustom"),q.forEach(function(q){M.addCustomProperty(q)}))},q.prototype.fixAccessType=function(M){return M=M||"a","symbol"===this.type?M="a":"comp"===this.type&&(M="s"),M},q.prototype.addEventProperties=function(M){var q=this,N=void 0;M?N=!1:(M=[],N=!0);var X=function(){var M=q.global?q.dataModel:q.data;M&&(M=q.global?[q.dataModel]:q.editor.selection),q.editor.eventView.open(M,q.type)};this.addLabel(M,e("editor.events"));var w=this.addButton(M,e("editor.eventhandlers"),null,null,X,!0);N&&("data"===this.type||"data3d"===this.type?(this.addLabel(M,e("editor.interactive")),this.addCheckBox(M,function(M){return!!M&&M.s("interactive")},function(M,q){M&&M.s("interactive",q)}),this.addRow(M,this.w1w1).keys={name:"eventHandlers",displayName:e("editor.eventhandlers")}):this.addRow(M,this.w1).keys={name:"eventHandlers",displayName:e("editor.eventhandlers")}),this.updateHandlers.push(function(){if(!M.hidden){var N=!1,e=q.global?q.dataModel:q.data;zN.forEach(function(M){N||(N="data"===q.type||"data3d"===q.type?e.s(M):e.a(M))}),w.setLabelColor(N?oN.config.color_select:ht.Default.labelColor)}})},q.prototype.addCustomProperty=function(M){var q=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],N=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],$=M.name,E=M.valueType,J=!1!==M.editable,u=M.defaultValue,g=this.fixAccessType(M.accessType),S=M.property;if(!(E=oN.config.valueTypes[E]))return!1;this.addingCustomProperties=!0;var y=e($)||S,P=b(g,S),f=h(g,S),x=function(M){var q=P(M);return void 0===q&&(q=u),q},n=J?f:null,R=M.extraInfo,G=void 0,j=void 0,K=void 0;R&&R.enum&&-1===["multiline"].indexOf(E.type)&&(G=R.enum.values,j=t(R.enum.labels,R.enum.i18nLabels),K=R.enum.icons);var p=M.dataBinding||M.bindable,C=oN.SceneView&&p&&("data"===this.type||"data3d"===this.type),m=void 0;if(R&&R.buildUI)m=R.buildUI(this,q,y,x,n,R),C=m&&m.actionLabel;else if(G)C?this.addActionLabelComboBox(q,y,g,S,G,j,K,x,n):this.addLabelComboBox(q,y,x,n,G,j,K);else if("int"===E.type||"number"===E.type)E.angle?C?this.addActionLabelRotation(q,y,g,S,E.min,E.max,E.step,x,n):this.addLabelRotation(q,y,x,n,E.min,E.max,E.step):C?this.addActionLabelRange(q,y,g,S,E.min,E.max,E.step,E.type,x,n):this.addLabelRange(q,y,x,n,E.min,E.max,E.step,E.type);else if("color"===E.type)C?this.addActionLabelColor(q,y,g,S,x,n):this.addLabelColor(q,y,x,n);else if("boolean"===E.type)C?this.addActionLabelCheckBox(q,y,g,S,x,n):this.addLabelCheckBox(q,y,x,n);else if("enum"===E.type)C?this.addActionLabelComboBox(q,y,g,S,E.values,E.labels,E.icons,x,n):this.addLabelComboBox(q,y,x,n,E.values,E.labels,E.icons);else if("image"===E.type)C?this.addActionLabelImage(q,y,g,S,x,n):this.addLabelImage(q,y,x,n);else if("url"===E.type)C?this.addActionLabelURL(q,y,g,S,void 0,x,n):this.addLabelURL(q,y,x,n);else if("multiline"===E.type)C?this.addActionLabelMultiline(q,y,g,S,x,n,R):this.addLabelMultiline(q,y,x,n,void 0,R);else if("colorArray"===E.type)C?this.addActionLabelArray(q,y,g,S,"color",x,n,R):this.addLabelArray(q,y,x,n,"color",R);else if("numberArray"===E.type)"DashPattern"===M.valueType?C?this.addActionLabelDashPattern(q,y,g,S,x,n):this.addLabelDashPattern(q,y,x,n):"CornerRadius"===M.valueType?C?this.addActionLabelCornerRadius(q,y,g,S,x,n):this.addLabelCornerRadius(q,y,x,n):C?this.addActionLabelArray(q,y,g,S,"number",x,n,R):this.addLabelArray(q,y,x,n,"number",R);else if("stringArray"===E.type)C?this.addActionLabelArray(q,y,g,S,"string",x,n,R):this.addLabelArray(q,y,x,n,"string",R);else if("gradientPackArray"===E.type)C?this.addActionLabelArray(q,y,g,S,"gradientPack",x,n,R):this.addLabelArray(q,y,x,n,"gradientPack",R);else if("objectArray"===E.type)C?this.addActionLabelArray(q,y,g,S,"object",x,n,R):this.addLabelArray(q,y,x,n,"object",R,{property:S});else if("function"===E.type)C?this.addActionLabelFunction(q,y,g,S,S,R&&R.arguments,x,n):this.addLabelFunction(q,y,x,n,S,R&&R.arguments);else if("dataModel"===E.type)this.addActionLabelDataModel(q,y,g,S,S,x,n);else if("object"===E.type)C?this.addActionLabelObject(q,y,g,S,S,x,n,R&&R.objectProperties):this.addLabelObject(q,y,x,n,S,R&&R.objectProperties);else if("font"===E.type)C?this.addActionLabelFont(q,y,g,S,x,n):this.addLabelFont(q,y,x,n);else if("gradientPack"===E.type)C?this.addActionLabelGradientPack(q,y,g,S,x,n):this.addLabelGradientPack(q,y,x,n);else if("custom"===E.type)m=E.buildUI(this,q,y,x,n,R),C=m&&m.actionLabel;else{var O=void 0;R&&R.formatterTip&&(O=this.fomatterTipToToolTip(R.formatterTip)),C?this.addActionLabelInput(q,y,g,S,void 0,void 0,void 0,x,n,void 0,O):this.addLabelInput(q,y,x,n,void 0,void 0,void 0,void 0,O)}if(N){var Q=void 0;"display"===this.type||"scene"===this.type||C||!p?Q=this.addNameRow(q,S,g,X(m,E),w(m,E)):"data"===this.type||"data3d"===this.type?Q=this.addDBRow(q,g,S,null,X(m,E),w(m,E)):"symbol"!==this.type&&"comp"!==this.type||(Q=this.addFuncRow(q,S,null,X(m,E),w(m,E))),Q&&R&&(Q.visible=R.visible,Q.onPropertyChanged=R.onPropertyChanged)}this.addingCustomProperties=!1},q.prototype.addLabelLayer=function(M,q){var N=this,X=b("p","layer"),w=h("p","layer");this.addLabel(M,e("editor.layer"),void 0,void 0,void 0,q);var $=new ht.widget.ComboBox;return $.onValueChanged=function(){N.setValue(w,$.getValue())},this.updateHandlers.push(function(){if(!M.hidden){$.setValues(N.editor.layerPane.layerNames);var q=N.getValue(X);$.getValue()!==q&&$.setValue(q)}}),M.push($),this.addButton(M,null,e("editor.focustolayer"),"editor.layer",function(){var M=N.editor,q=M.layerTab;if(q){M.rightBottomTabView.getTabModel().sm().ss(q);var e=M.layerPane;e.selectLayer(N.getValue(X)),ht.Default.callLater(function(){e.tableView.makeVisible(e.tableModel.sm().ld())},void 0,void 0,200)}},!0),$},q.prototype.addLabelIcons=function(M,q){var N=this;this.addLabel(M,e("editor.icons"),void 0,void 0,void 0,q);var X=function(){N.data&&N.editor.iconsView.toggle(w,N.data)},w=this.addButton(M,"Icons","s:icons",null,X,!0);return this.updateHandlers.push(function(){M.hidden||w.setLabelColor(N.data.s("icons")?oN.config.color_select:ht.Default.labelColor)}),w},q.prototype.addLabelBatch=function(M,q){var N=this,X=b("s","batch"),w=h("s","batch");this.addLabel(M,e("editor.batch"),void 0,void 0,void 0,q);var $=new ht.widget.ComboBox;return $.onValueChanged=function(){N.setValue(w,$.getValue())},this.updateHandlers.push(function(){if(!M.hidden){$.setValues(N.editor.batchView.batchNames);var q=N.getValue(X);$.getValue()!==q&&$.setValue(q)}}),M.push($),$},q.prototype.addActionLabel=function(M,q,N,e,X,w){var $=arguments.length>6&&void 0!==arguments[6]?arguments[6]:{};Object.assign($,{accessType:N,name:e}),this.addLabel(M,q,b(N,e,X),h(N,e,w),void 0,$)},q.prototype.addActionLabelInput=function(M,q,N,e,X,w,$,t,E,J,u){this.addLabelInput(M,q,b(N,e,t),h(N,e,E),X,w,$,{accessType:N,name:e,onEndEditing:J},u)},q.prototype.addActionLabelDashPattern=function(M,q,N,e,X,w,$){this.addLabelDashPattern(M,q,b(N,e,X),h(N,e,w),{accessType:N,name:e,onEndEditing:$})},q.prototype.addActionLabelData=function(M,q,N,e,X,w){this.addLabelData(M,q,b(N,e,X),h(N,e,w),{accessType:N,name:e})},q.prototype.addActionLabelRange=function(M,q,N,e,X,w,$,t,E,J,u){void 0===$&&($="int"===t?1:.1),this.addLabelRange(M,q,b(N,e,E),h(N,e,J),X,w,$,t,{accessType:N,name:e,onEndEditing:u})},q.prototype.addActionLabelCheckBox=function(M,q,N,e,X,w){this.addLabelCheckBox(M,q,b(N,e,X),h(N,e,w),{accessType:N,name:e})},q.prototype.addActionLabelColor=function(M,q,N,e,X,w){this.addLabelColor(M,q,b(N,e,X),h(N,e,w),{accessType:N,name:e})},q.prototype.addActionLabelImage=function(M,q,N,e,X,w){this.addLabelImage(M,q,b(N,e,X),h(N,e,w),{accessType:N,name:e})},q.prototype.addActionLabelObject=function(M,q,N,e,X,w,$,t){this.addLabelObject(M,q,b(N,e,w),h(N,e,$),X,t,{accessType:N,name:e})},q.prototype.addActionLabelComboBox=function(M,q,N,e,X,w,$,t,E){this.addLabelComboBox(M,q,b(N,e,t),h(N,e,E),X,w,$,{accessType:N,name:e})},q.prototype.addActionLabelComboBoxURL=function(M,q,N,e,X,w,$,t,E,J){this.addLabelComboBoxURL(M,q,b(N,e,E),h(N,e,J),X,w,$,t,{accessType:N,name:e})},q.prototype.addActionLabelFont=function(M,q,N,e,X,w){this.addLabelFont(M,q,b(N,e,X),h(N,e,w),{accessType:N,name:e})},q.prototype.addActionLabelPosition=function(M,q,N,e,X,w){this.addLabelPosition(M,q,b(N,e,X),h(N,e,w),{accessType:N,name:e})},q.prototype.addActionLabelMultiline=function(M,q,N,e,X,w,$){this.addLabelMultiline(M,q,b(N,e,X),h(N,e,w),{accessType:N,name:e},$)},q.prototype.addActionLabelRotation=function(M,q,N,e,X,w,$,t,E,J){this.addLabelRotation(M,q,b(N,e,t),h(N,e,E),X,w,$,{accessType:N,name:e,onEndEditing:J})},q.prototype.addActionLabelAlign=function(M,q,N,e,X,w){this.addLabelAlign(M,q,b(N,e,X),h(N,e,w),{accessType:N,name:e})},q.prototype.addActionLabelVAlign=function(M,q,N,e,X,w){this.addLabelVAlign(M,q,b(N,e,X),h(N,e,w),{accessType:N,name:e})},q.prototype.addActionLabelStretch=function(M,q,N,e,X,w,$){this.addLabelStretch(M,q,b(N,e,X),h(N,e,w),{accessType:N,name:e},$)},q.prototype.addActionLabelGradient=function(M,q,N,e,X){this.addLabelGradient(M,q,N,e,X,{accessType:"s",name:N})},q.prototype.addActionLabelOrientation=function(M,q,N,e,X,w){this.addLabelOrientation(M,q,b(N,e,X),h(N,e,w),{accessType:N,name:e})},q.prototype.addActionLabelURL=function(M,q,N,e,X,w,$){this.addLabelURL(M,q,b(N,e,w),h(N,e,$),X,{accessType:N,name:e})},q.prototype.addActionLabelArray=function(M,q,N,e,X,w,$,t){this.addLabelArray(M,q,b(N,e,w),h(N,e,$),X,t,{accessType:N,name:e})},q.prototype.addActionLabelFunction=function(M,q,N,e,X,w,$,t){this.addLabelFunction(M,q,b(N,e,$),h(N,e,t),X,w,{accessType:N,name:e})},q.prototype.addActionLabelDataModel=function(M,q,N,e,X,w,$,t){this.addLabelDataModel(M,q,b(N,e,$),h(N,e,t),X,w,{accessType:N,name:e})},q.prototype.addActionLabelLayer=function(M){this.addLabelLayer(M,{accessType:"p",name:"layer"})},q.prototype.addActionLabelIcons=function(M){this.addLabelIcons(M,{accessType:"s",name:"icons"})},q.prototype.addActionLabelBatch=function(M){this.addLabelBatch(M,{accessType:"s",name:"batch"})},q.prototype.addActionLabelClipPercentage=function(M,q,N,e,X,w,$){this.addLabelClipPercentage(M,q,b(N,e,X),h(N,e,w),{accessType:N,name:e,onEndEditing:$},b(N,e.replace("percentage","direction")))},q.prototype.endEdit=function(){var M=document.activeElement;this.getView().contains(M)&&M.blur()},q.prototype.isLabelDragging=function(){return!!this._labelDragging},q.prototype.addDBState=function(){var M=this,q=[];this.addLabelState(q);var N=this.addDBRow(q,"s","state");return N.visible=function(){var q=M.getStateEnum();return q&&q.length},N},q.prototype.getStateEnum=function(M){var q=void 0;q=M?M(this.data):this.data.getImage();var N=ht.Default.getImage(q);if(N&&N.comps){var e=this._stateMap={},X=[];return this.getNestState(N.comps,X),N.stateEnum&&N.stateEnum.forEach(function(M){e[M.value]||X.push(M)}),X}return null},q.prototype.getNestState=function(M,q){var N=this,e=this._stateMap;M.forEach(function(M){if("image"===M.type){var X=ht.Default.getImage(M.name);if(X&&X.comps){var w=X.stateEnum;w&&w.forEach(function(M){e[M.value]||(q.push(M),e[M.value]=1)}),N.getNestState(X.comps,q)}else if(!X)return void N.$34$()}})},q.prototype.addActionLabelState=function(M,q){this.addLabelState(M,{accessType:"s",name:"state",imageGetter:q})},q.prototype.addLabelState=function(M){var q=this,N=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},X=N.imageGetter,w=new ht.widget.ComboBox,$=function(M){var q=M.s("state");if(q)return q;var N=void 0;return X?N=X(M):M.getImage&&(N=M.getImage()),
N?(N=ht.Default.getImage(N),N?N.state:void 0):void 0},t=h("s","state");return this.addLabel(M,e("editor.state"),void 0,void 0,void 0,N),w.onValueChanged=function(){q.setValue(t,w.getValue())},this.updateHandlers.push(function(){if(!M.hidden){var N=q.getStateEnum(X);if(!N||0===!N)return void(w.getValues()&&w.getValues().length&&(w.setValues(),w.setLabels(),w.setValue()));var e=q.getValue($),t=N.map(function(M){return M.value}),E=N.map(function(M){return M.label||M.value});t.unshift(void 0),E.unshift(""),w.setValues(t),w.setLabels(E),w.getValue()!==e&&"object"!=typeof e&&w.setValue(e)}}),M.push(w),w},q.prototype.addActionLabelGradientPack=function(M,q,N,e,X,w){this.addLabelGradientPack(M,q,b(N,e,X),h(N,e,w),{accessType:N,name:e})},q.prototype.addLabelGradientPack=function(M,q,N,e,X){return this.addLabel(M,q,N,e,void 0,X),this.addGradientPack(M,N,e)},q.prototype.addGradientPack=function(M,q,N){var e=this,X=new tX(this.editor),w=function(M){return M?(kN(M)&&"["===M[0]&&(M=JSON.parse(M)),e.data instanceof ht.Node?Yq(M,e.data):M):M};return X.addViewListener(function(M){"open"===M.kind?e.beginTransaction():"close"===M.kind&&e.endTransaction()}),X.onValueChanged=function(){e.setValue(N,X.getValue())},this.updateHandlers.push(function(){var M=e.getValue(q);X.setValue(w(M))}),M.push(X),X},q.prototype.addActionLabelCornerRadius=function(M,q,N,e,X,w,$){var t=!(arguments.length>7&&void 0!==arguments[7])||arguments[7];this.addLabelCornerRadius(M,q,b(N,e,X),h(N,e,w),{accessType:N,name:e},$,t)},q.prototype.addLabelCornerRadius=function(M,q,N,X,w,$){var t=this,E=!(arguments.length>6&&void 0!==arguments[6])||arguments[6];this.addLabel(M,q,function(M){var q=N(M);return _N(q)?Math.max.apply(Math,q):q},function(M,q){var e=N(M);if(q=Math.max(0,q),_N(e)){var w=Math.max.apply(Math,e),$=q-w;q=e.map(function(M){return Math.max(M+$,0)})}X(M,q)},1,w);var J=new WN;J.setVPadding(0),J.setHPadding(0),J.makeItemsHidden=this.makeItemsHidden,J.makeItemsVisible=this.makeItemsVisible;var u=void 0,g=void 0,S=function(M,q){var e=dq(t.getValue(N));if(M){J.makeItemsHidden(g.items),J.makeItemsVisible(u.items),J.setRows([u]);var w=$?e[0]:[e[0]];!q&&t.setValue(X,w)}else J.makeItemsHidden(u.items),J.makeItemsVisible(g.items),J.setRows([g]),!q&&t.setValue(X,e)},b=Jq(null,e("editor.corners"),"editor.corners",function(){S()}),h=[];this.addInput(h,function(M){var q=N(M);return _N(q)?q[0]:q},function(M,q){q=Math.max(q,0),_N(q)&&$?q=q[0]:CM(q)&&!$&&(q=[q]),X(M,q)},"number",void 0,1,0),h.push(b),u=J.addRow(h,[.1,20],this.rowHeight);var y=Jq(null,e("editor.corners"),"editor.corners",function(){S(!0)});y.setIconColor(oN.config.color_select),h=[];for(var P=0;P<4;P++)!function(M){t.addInput(h,function(q){var e=dq(N(q));if(!E){if(1===M)return e[3];if(3===M)return e[1]}return e[M]},function(q,e){e=Math.max(e,0);var w=dq(N(q));E?w[M]=e:1===M?w[3]=e:3===M?w[1]=e:w[M]=e,X(q,w)},"number",void 0,1,0)}(P);h.push(y),g=J.addRow(h,[.1,.1,.1,.1,20],this.rowHeight);var f=this.getValue(N);S(!_N(f)||1===f.length,!0),M.push(J)},q.prototype.getAllRows=function(){return this.$46$||[]},q}(WN),uX=ht.widget.ColorPickerTemp;(ht.widget.ColorPickerTemp=function(M){var q=new uX(M),N=M.editor;if(N&&N.pickColor){var X=Jq(null,e("editor.pickcolor"),"editor.pickColor",function(){M._picking?N.cancelPickColor():(N.beginTransaction(),N.pickColor(X.getView().getBoundingClientRect(),q.$9o(),function(N){N&&(q.onOpened(N),M.setValue(N))},function(){M._picking=N.isColorPicking(),X.iv(),N.endTransaction()})),M._picking=N.isColorPicking()});X.setWidth(30),X.getIconColor=function(){return M._picking?"white":this.isPressed()?oN.config.color_select:oN.config.color_dark};var w=X.getCurrentBackground;X.getCurrentBackground=function(){var q=w.call(X);return!q&&M._picking&&(q=oN.config.color_select),q};var $=q.getView();$.querySelector(".color_ok").style.height="20px";var t=$.querySelector(".color_clear");t.style.height="20px";var E=X.getView();E.style.border=t.style.border;var J=t.parentNode;J.appendChild(document.createElement("br")),J.appendChild(document.createElement("br")),J.appendChild(E)}return q.getView().addEventListener("wheel",function(M){M.stopImmediatePropagation()}),q}).superClass=uX.superClass;var gX=uX.prototype,SX=gX.getHeight,bX=gX.getValue;MM(uX,{buildPaletteColors:function(){var M=arguments,q=this;if(oN.config.customPaletteColorEnabled){var N=this._paletteGV||this._initPaletteGV(),X=this._paletteForm=new JX(this._master.editor,"colorPickerPalette","colors",!0);X.setVPadding(0),X.setHPadding(0),X.isVScrollable=function(){return!1},X.isHScrollable=function(){return!1},X.setHGap(0),X.getRowBackground=function(){return null};var w=e("editor.favorites");oN.config.expandedTitles[w]=!0;var $=X.addTitle(w,{buttons:[this._createAddPaletteColorButton()]});X.getItemBackground=function(M){return $.items.indexOf(M)<0?null:$.background},$.items.unshift(null),$.items.push(null),$.widths.unshift(5),$.widths.push(5),this._paletteGVRowInfo=X.addRow([N],[.1]);var t=X.filterProperties;X.filterProperties=function(){t.apply(X,M),q._master.layoutDropDown()},X.filterPropertiesLater();var E=X.getView();E.style.marginTop="5px",E.addEventListener("wheel",function(M){N.getView().contains(M.target)||M.stopImmediatePropagation()},!0),this._paletteColorsDiv.appendChild(E),this._buildPaletteColors(),this._layoutPaletteGV()}},_addPaletteColor:function(M){var q=new ht.Node;return q.setAnchor(0,0),q.s({shape:"circle","shape.gradient.pack":M,"shape.border.width":1,"shape.border.color":"#CCCCCC",pixelPerfect:!1}),this._paletteGV.dm().add(q),q},_initPaletteGV:function(){var M=this,q=this._paletteGap=8,N=this._paletteColumnSize=8;this._paletteMaxRowSize=4.5,this._paletteSize=(this.getWidth()-q*(N+1))/N,this._paletteScrollHeight=0;var e=this._paletteGV=new ht.graph.GraphView;e.setZoomable(!1),e.setRectSelectable(!1),e.isMovable=function(){return!1},e.getSelectWidth=function(){return 0},e.adjustTranslateX=function(){return 0},e.adjustTranslateY=function(q){return q>=0?0:-q<M._paletteScrollHeight?q:-M._paletteScrollHeight},e.handleScroll=function(M){if(M.stopImmediatePropagation(),LN||M.wheelDelta!==M.wheelDeltaX){var q=LN&&M.detail?-M.detail:M.wheelDelta/40;this.ty(20*q)}},e.setZoom(1),e.setTranslate(0,0),e.onDataClicked=function(q,N){if(ht.Default.isLeftButton(N)){var e=q.s("shape.gradient.pack");if(M.onOpened(e),oN.config.closeColorPickerWhenSelectPaletteColor)return M.__value__=e,M._master.close(!1,N),void delete M.__value__;M._master.isInstant()&&M._master.setValue(e)}};var X=e.dm();return X.setAutoAdjustIndex(!1),X.mm(function(q){M._paletteColorsBuilding||M._layoutPaletteGV()}),this._initPaletteContextMenu(),e},_buildPaletteColors:function(){var M=this;this._paletteGV.dm().clear(),this._paletteColorsBuilding=!0;var q=function(N){if(N)return _N(N)&&!aq(N)?void N.forEach(q):void M._addPaletteColor(N)};q(this._master.getPaletteColors()),this._paletteColorsBuilding=!1},_layoutPaletteGV:function(){var M=this._paletteGap,q=this._paletteColumnSize,N=this._paletteMaxRowSize,e=this._paletteSize,X=M,w=1,$=0,t=0,E=this._paletteGV;E.dm().each(function(N){N.p(X,w),N.setSize(e,e),N.a("index",[$,t]),X+=e+M,++$%q==0&&(X=M,w+=e+M,t++)});var J=Math.ceil($/q),u=Math.ceil(J*(e+M)-M)+2,g=Math.min(J,N),S=Math.ceil(g*(e+M)-M)+2;this._paletteScrollHeight=u-S,this._paletteForm.setWidth(this.getWidth()),this._paletteGVRowInfo.height=S,E.dm().a({width:this.getWidth(),height:u}),this._paletteGV.ty(this._paletteGV.ty())},_updatePaletteColors:function(){var M=this._master.getPaletteColors();M.length=0,this._paletteGV.dm().each(function(q){return M.push(q.s("shape.gradient.pack"))})},_createAddPaletteColorButton:function(){var M=this,q=Jq(null,e("editor.addcolor"),"editor.addColor",function(){var q=M._master,N=q?q.getValue():M.$9o(),e=M._addPaletteColor(N);M._updatePaletteColors(),q.layoutDropDown(),q.onColorPaletteAdded&&q.onColorPaletteAdded(N,e.a("index")),M._paletteGV.makeVisible(e)});return q.getIconColor=function(){return this.isPressed()?oN.config.color_select:oN.config.color_dark},q},_initPaletteContextMenu:function(){var M=this,q=this._menu;if(!q){var N=this._paletteGV,e=this._master,X=e.getMenuItemLabel||function(M){return M.charAt(0).toUpperCase()+M.substr(1)};q=this._menu=new ht.widget.ContextMenu,q.beforeShow=function(M){return q._target=N.getDataAt(M.originEvent)},q.setItems([{id:"delete",label:X("delete"),action:function(N,X){X.preventDefault(),X.stopImmediatePropagation();var w=q._target;w.removeFromDataModel(),M._updatePaletteColors(),e.layoutDropDown(),e.onColorPaletteDeleted&&e.onColorPaletteDeleted(w.s("shape.gradient.pack"),w.a("index")),q._target=null},visible:function(){return!!q._target}}]),q.addTo(this._paletteGV.getView()),e.onContextMenuCreated&&e.onContextMenuCreated(q)}},isMenuShowing:function(){return!!this._menu&&this._menu.isShowing()},getHeight:function(){if(!oN.config.customPaletteColorEnabled)return SX.call(this);var M=this._paletteForm,q=M.getRowHeight(),N=M.getRows(),e=N.length,X=(e-1)*M.getVGap()+2*M.getVPadding();return N.forEach(function(M){return X+=M.height||q}),X=Math.ceil(X),this._paletteForm.setHeight(X),176+X},getValue:function(){return this.__value__||bX.call(this)}}),function(M,q,N){var e=M.ht,X=e.Default,w=X.getInternal(),t=function(){var M;return function(q,N,e){M||(M=document.createElement("div")),M.innerHTML=q;var X=M.style;X.position="absolute",X.font=N;var w=E(N);w&&(X.lineHeight=w),e&&(X.writingMode="vertical-lr"),document.body.appendChild(M);var $={width:M.clientWidth,height:M.clientHeight};return document.body.removeChild(M),$}}(),E=function(){var M=/(\d+\.?\d*|\.\d+)(px|em|rem|pt|%)?(?:\/(\d*\.?\d*|\.\d*)(px|em|rem|pt|%)?)?/;return function(q){var N=q.match(M);return N?N[3]?N[3]+(N[4]||N[2]):N[1]+N[2]:null}}();w.addMethod(X,{svgToShape:function(M,q){var N=new e.SvgConverter(q);return{converter:N,output:N.toShape(M)}}});var J=e.Context2dProxy=function(M,q,N){var e=this;e.ctx=M,e.writer=q,e.$1A={a:1,b:0,c:0,d:1,tx:0,ty:0},e.$2A(),e.$3A=!0,e._splitToBezier=N.splitToBezier,e.$4A=N.segments,e._minimumFontSize=N.minimumFontSize,e.$5A=[];for(var X in CanvasRenderingContext2D.prototype)if("webkitImageSmoothingEnabled"!==X){var w=M[X];"function"==typeof w&&(M[X]=function(q,N){return function(){try{var X=N.apply(M,arguments);return e.handleFunc(q,X,arguments),X}catch(M){}}}(X,w))}};J.prototype={},J.prototype.constructor=J,J.prototype.handleFunc=function(M,q,N){var e=this;switch(M){case"save":e.$7A();break;case"restore":e.$8A();break;case"translate":e.$9A.apply(e,N);break;case"rotate":e.$AA.apply(e,N);break;case"scale":e.$BA.apply(e,N);break;case"setTransform":e.$CA.apply(e,N);break;case"transform":e.$DA.apply(e,N);break;case"fillText":case"strokeText":e.$EA(N[0],N[1],N[2],"fillText"===M,N[3]);break;case"rect":e.$FA.apply(e,N);break;case"roundRect":e._ctxRoundRect.apply(e,N);break;case"fill":e._ctxFill(N[0]);break;case"fillRect":e.$FA.apply(e,N),e.$10A("fill");break;case"stroke":e.$10A("stroke");break;case"moveTo":e.$11A(N[0],N[1]);break;case"lineTo":e.$12A(N[0],N[1]);break;case"beginPath":e.$13A();break;case"closePath":e.$14A();break;case"arc":e.$15A.apply(e,N);break;case"ellipse":e.$16A.apply(e,N);break;case"quadraticCurveTo":e.$17A([{x:N[0],y:N[1]}],N[2],N[3]);break;case"bezierCurveTo":e.$17A([{x:N[0],y:N[1]},{x:N[2],y:N[3]}],N[4],N[5]);break;case"createLinearGradient":e._ctxCreateGradient(q,!0,N);break;case"createRadialGradient":e._ctxCreateGradient(q,!1,N);break;case"createPattern":e._ctxCreatePattern(q,N[0],N[1]);break;case"drawImage":e._ctxDrawImage.apply(e,N);break;case"clip":e._ctxClip()}},J.prototype.handleSetter=function(M,q){},J.prototype.$7A=function(){var M=this,q={},N=M.$1A;for(var e in N)q[e]=N[e],"clip"===e&&N[e]&&delete N[e];M.$5A.push(q)},J.prototype.$8A=function(){var M=this;M.$1A.clip&&M.writer.addRestore(),M.$1A=M.$5A.pop(),M._transformUpdated()},J.prototype.$9A=function(M,q){if(M=M||0,q=q||0,0!==M||0!==q){var N=this,e=N.$1A,X=e.a,w=e.b,$=e.c,t=e.d;e.tx=X*M+$*q+e.tx,e.ty=w*M+t*q+e.ty,N._transformUpdated()}},J.prototype.$BA=function(M,q){if(M=M||1,q=q||1,1!==M||1!==q){var N=this,e=N.$1A;e.a*=M,e.b*=M,e.c*=q,e.d*=q,N._transformUpdated()}},J.prototype.$AA=function(M){var q=Math.cos(M),N=Math.sin(M),e=this,X=e.$1A,w=X.a,$=X.b,t=X.c,E=X.d;X.a=w*q+t*N,X.b=$*q+E*N,X.c=-w*N+t*q,X.d=-$*N+E*q,e._transformUpdated()},J.prototype.$CA=function(M,q,N,e,X,w){var $=this,t=$.$1A;t.a=M,t.b=q,t.c=N,t.d=e,t.tx=X,t.ty=w,$._transformUpdated()},J.prototype.$DA=function(M,q,N,e,X,w){var $=this,t=$.$1A,E=t.a,J=t.b,u=t.c,g=t.d;t.a=E*M+u*q,t.b=J*M+g*q,t.c=E*N+u*e,t.d=J*N+g*e,t.tx=E*X+u*w+t.tx,t.ty=J*X+g*w+t.ty,$._transformUpdated()},J.prototype._transformUpdated=function(){},J.prototype.$18A=function(){var M=this.$1A;return 0===M.b&&0===M.c?0:Math.atan2(M.b,M.a)},J.prototype.$19A=function(){var M=this.$1A;return{x:Math.sqrt(M.a*M.a+M.c*M.c),y:Math.sqrt(M.b*M.b+M.d*M.d)}},J.prototype.$20A=function(M){var q=this.$1A,N=M.x,e=M.y;return{x:q.a*N+q.c*e+q.tx,y:q.b*N+q.d*e+q.ty}},J.prototype.$21A=function(M){for(var q=this,N=new Array(M.length),e=0,X=M.length;e<X;e++)N[e]=q.$20A(M[e]);return N},J.prototype.$22A=function(M){var q=this.$1A;return M*Math.max(Math.sqrt(q.c*q.c+q.d*q.d),Math.sqrt(q.a*q.a+q.b*q.b))},J.prototype.$23A=function(M,q){var N=M-q;return N>-1e-5&&N<1e-5},J.prototype._getTextFirstPixelLine=function(M,q){var N,e=this._measureTextCanvas;e?N=this._measureTextContext:(e=this._measureTextCanvas=document.createElement("canvas"),N=this._measureTextContext=e.getContext("2d")),N.font=M;var X=Math.ceil(N.measureText("H").width),w=4*X;e.width=X,e.height=w,N.fillStyle="#f00",N.fillRect(0,0,X,w),N.textBaseline=q,N.fillStyle="#000",N.font=M,N.fillText("H",0,w/2);var $=N.getImageData(0,0,X,w);if(!$)return 0;$=$.data;var t,E,J=4*X;for(t=0;t<w;t++)for(E=0;E<J;E+=4)if(255!==$[J*t+E])return t;return 0},J.prototype._calcShift=function(M,q,N){var e=this._fontBaselineShiftCache;e||(e=this._fontBaselineShiftCache={});var X=M+q+N,w=e[X];if(w)return w;var $=this._getTextFirstPixelLine(M,q),t=this._getTextFirstPixelLine(M,N);return e[X]=$-t},J.prototype.$EA=function(M,q,N,X,w){var $=this,t=$.ctx;if(M.trim().length){var E=t.font,J=X?t.fillStyle:t.strokeStyle,u=t.textAlign,g=t.textBaseline,S=t.globalAlpha;"middle"!==g&&"top"!==g&&"bottom"!==g&&(N-=$._calcShift(E,"middle",g),g="middle");var b,h,y=$.$19A(),P=$._minimumFontSize;if("string"==typeof E&&(h=E.match(/[\d\.]+/))){b=h[0];var f=$.$22A(b);if(b!==f){var x=b/f;y.x*=x,y.y*=x}if(f<P){var x=f/P;y.x*=x,y.y*=x,f=P}E=E.replace(h[0],f)}var n=$.$18A();"string"==typeof J&&"rgba(0,0,0,0)"===J.replace(/ /g,"")||(J={color:J},$._tryConvertAndRecordGradient(J),$._adjustStyle(J),w.underline&&(J.decoration="underline"),w.vertical&&(J.vertical=!0),$.writer.svgId=$.ctx._svgId,$.writer.$2AA(M,$.$20A({x:q-e.Default.textExtraWidth/2*y.x,y:N}),E,n,u,g,J,y,S))}},J.prototype._ctxDrawImage=function(M,q,e,X,w,$,t,E,J){var u=M.width,g=M.height;if(u&&g){var S=this,b=S.$1A,h=S.$19A(),y=S.$18A();if(3===arguments.length)return void S.writer.addImage(M,{rect:[b.tx+q,b.ty+e,u,g],rotation:y,scaleX:h.x,scaleY:h.y});X===N&&w===N?($=q,t=e,q=0,e=0,X=E=M.width,w=J=M.height):$===N&&t===N&&($=q,t=e,E=X,J=w,q=0,e=0,X=M.width,w=M.height);var P=E/X,f=J/w,x=$-P*q,n=t-f*e,R=b.a,G=b.b,j=b.c,K=b.d;b.tx,b.ty}},J.prototype._ctxClip=function(){var M=this;M.$1A.clip=!0,M.$10A("clip")},J.prototype._ctxCreateGradient=function(M,q,N){M.isLinear=q,M.points=q?[N[0],N[1],N[2],N[3]]:[N[0],N[1],N[2],N[3],N[4],N[5]];var e=this.$1A;M.trans=[e.a,e.b,e.c,e.d,e.tx,e.ty];var X=M.addColorStop;M.addColorStop=function(q,N){X.apply(this,arguments),M.colorStops||(M.colorStops=[]),M.colorStops.push(q,N)}},J.prototype._ctxCreatePattern=function(M,q,N){},J.prototype.$FA=function(M,q,N,e){var X=this.$20A({x:M,y:q}),w={type:"rect",rect:[X.x,X.y,N,e],_nodeLocalMat:this.ctx._nodeLocalMat};return this._path.push(w),w},J.prototype._ctxRoundRect=function(M,q,N,X,w){if(e.Default.isArray(w)){for(var $=[],t=0,E=w.length;t<E;t++)$[t]=this.$22A(w[t]);w=$}else w=this.$22A(w);var J=this.$FA(M,q,N,X);J.type="roundRect",J.radii=w},J.prototype.$11A=function(M,q){var N=this,e=N.$20A({x:M,y:q});N._headPoint=e,N._path.push({type:"moveTo",x:e.x,y:e.y})},J.prototype.$12A=function(M,q){var N=this,e=N.$20A({x:M,y:q});N._path.push({type:"lineTo",x:e.x,y:e.y})},J.prototype.$15A=function(M,q,N,e,X,w){e=e||0,X=X||2*Math.PI,N&&this.$16A(M,q,N,N,0,e,X,w)},J.prototype.$16A=function(M,q,N,e,X,w,$,t){var E,J,u,g,S,b,h,y,P,f,x,n,R,G,j=this,K=j.$19A(),p=j.$20A({x:M,y:q});S=Math.sin(X),b=Math.cos(X);var C=function(M){return m(Math.cos(-M),Math.sin(-M))},m=function(X,w){var $=N*X,t=e*w;return{x:M+(b*$-S*t),y:q+(S*$+b*t)}},O=[],Q=$;if(t)for(;Q>=w;)Q-=2*Math.PI;else for(;Q<=w;)Q+=2*Math.PI;for(P=(Q-w)/j.$4A,x=0;x<=j.$4A;x++)f=w+P*x,n=j.$20A(C(-f)),O.push(n);var s=w,l=Q;if(O[0],g=O[O.length-1],E=j.$24A(w,$,t),w=E.start,$=E.end,h=j.$23A(K.x,K.y),y=j.$23A(N,e),!j.$3A&&h&&y&&j.$23A(Math.abs(w-$),2*Math.PI))j._path.push({type:"circle",x:p.x,y:p.y,end:g,keyPoints:O,radius:N*K.x});else if(!j.$3A&&h&&y)J=j.$18A(),u=Math.cos(J),R=j.$1A.a*u<0,G=j.$1A.d*u<0,E=j.$25A(w,$,R,G),w=E.start-J,$=E.end-J,j._path.push({type:"arc",x:p.x,y:p.y,end:g,radius:N*K.x,startAngle:w,endAngle:$,keyPoints:O});else{if(j.$3A||!h){if(j._path.length||j._path.push({type:"moveTo",x:O[0].x,y:O[0].y}),j._splitToBezier){var Y,I,r,d=l-s,a=Math.max(Math.ceil(Math.abs(d)/Math.PI*2),1),D=d/a,W=Math.tan(.5*D),v=Math.sin(D)*(Math.sqrt(4+3*W*W)-1)/3,o=Math.cos(s),H=Math.sin(s);for(x=0;x<a;x++){r=s+(x+1)*D,Y=Math.cos(r),I=Math.sin(r);var U=m(Y,I);j.$17A([m(o-H*v,H+o*v),m(Y+I*v,I-Y*v)],U.x,U.y),o=Y,H=I,r}return}for(x=1;x<=j.$4A;x++)n=O[x],j._path.push({type:"lineTo",x:n.x,y:n.y});return}var V,T,_=j.$20A(C(0)),k=j.$20A(C(Math.PI/2)),Z=function(M,q){var N=M.x-q.x,e=M.y-q.y;return Math.sqrt(N*N+e*e)},z=Z(_,p),A=Z(k,p);A>z?(T=z,z=A,A=T,V=k):V=_,J=j.$18A(),u=Math.cos(J),R=j.$1A.a*u<0,G=j.$1A.d*u<0,E=j.$25A(w-Math.PI/2,$-Math.PI/2,R,G),w=E.start,$=E.end,j._path.push({type:"ellipse",x:p.x,y:p.y,end:g,major:{x:V.x-p.x,y:V.y-p.y},ratio:A/z,startAngle:w,endAngle:$,keyPoints:O})}},J.prototype.$17A=function(M,q,N){var e=this,X=e.$20A({x:q,y:N});this._path.push({type:"bezier",x:X.x,y:X.y,ctrl:e.$21A(M)})},J.prototype.$13A=function(){this.$2A()},J.prototype.$14A=function(){var M=this,q=M._headPoint;q&&(M._path.push({type:"lineTo",x:q.x,y:q.y,subType:"closePath"}),M._headPoint=null,M._lastPoint=null)},J.prototype.$24A=function(M,q,N){M=-M,q=-q;var e,X=M%(2*Math.PI),w=q%(2*Math.PI);for(X<0&&(X+=2*Math.PI),w<0&&(w+=2*Math.PI),N||(e=X,X=w,w=e);w<=X;)w+=2*Math.PI;return{start:X,end:w}},J.prototype.$25A=function(M,q,N,e){var X;return(e||N)&&(N&&e?(M=Math.PI+M,q=Math.PI+q):(X=Math.PI*(N?1:2)-q,q=Math.PI*(N?1:2)-M,M=X)),{start:M,end:q}},J.prototype._ctxFill=function(M){var q=this;return q._fillRule=M||"nonzero",q.$10A("fill")},J.prototype._tryConvertAndRecordGradient=function(M){if("string"!=typeof M.color){var q=this;if(M.color instanceof CanvasGradient){var N=M.color,e=[N.isLinear?"L":"R"];e=e.concat(N.points),e=e.concat(N.trans),e=e.concat(N.colorStops),M.gradientPack=e}else if(M.color instanceof CanvasPattern&&M.color.gradient){var X=M.color,N=X.gradient,e=[N.isLinear?"L":"R"];e=e.concat(N.points);var w=X.trans,$=q.$1A,t=$.a,E=$.b,J=$.c,u=$.d,g=$.tx,S=$.ty,b=w[0],h=w[1],y=w[2],P=w[3],f=w[4],x=w[5];e=e.concat([t*b+J*h,E*b+u*h,t*y+J*P,E*y+u*P,t*f+J*x+g,E*f+u*x+S]),e=e.concat(N.colorStops),M.gradientPack=e}else M.trans=[q.$1A.a,q.$1A.b,q.$1A.c,q.$1A.d,q.$1A.tx,q.$1A.ty],M.color=M.color.image?M.color.image:M.color,M.isPattern=!0}},J.prototype.$10A=function(M){var q=this,N=q._path;if(N.length){var e,X,w,$,t=[],E=[];if("clip"===M)$={clip:!0};else{if("stroke"===M){$={stroke:!0,lineWidth:q.$22A(q.ctx.lineWidth),color:q.ctx.strokeStyle};var J=q.ctx.lineCap;"butt"!==J&&($.lineCap=J);var u=q.ctx.getLineDash();if(u&&u.length){$.dash=!0;for(var g=0,S=u.length;g<S;g++)u[g]=q.$22A(u[g]);$.dashPattern=u,$.dashOffset=q.$22A(q.ctx.lineDashOffset)}}else $={stroke:!1,color:q.ctx.fillStyle},"nonzero"!==q._fillRule&&($.fillRule=q._fillRule);if(q.ctx.globalAlpha<1&&($.opacity=q.ctx.globalAlpha),q._tryConvertAndRecordGradient($),"string"==typeof $.color&&"rgba(0,0,0,0)"===$.color.replace(/ /g,""))return}this._adjustStyle($);var b=this.$19A(),h=this.$18A();for(X=0,e=N.length;X<e;X++)switch(w=N[X],w.type){case"moveTo":q._lastPoint={x:w.x,y:w.y},t.push(q._lastPoint),E.push(1);break;case"lineTo":"closePath"===w.subType?E.push(5):(t.push({x:w.x,y:w.y}),E.push(2)),q._lastPoint={x:w.x,y:w.y};break;case"rect":q.writer.svgId=q.ctx._svgId,q.writer.addRect(w.rect,b,h,$,w._nodeLocalMat);break;case"roundRect":q.writer.svgId=q.ctx._svgId,q.writer.addRoundRect(w.rect,w.radii,b,h,$,w._nodeLocalMat);break;case"circle":case"arc":case"ellipse":console.log("split to line",w.type);break;case"arcBegin":q.writer.svgId=q.ctx._svgId,t.length&&E.length&&q.writer.$2BA(t,E,$),t=[],E=[];break;case"arcClose":q.writer.svgId=q.ctx._svgId,q.writer.$2BA(t,E,$),t=[],E=[];break;case"bezier":if(!q._lastPoint)break;1===w.ctrl.length?(t.push({x:w.ctrl[0].x,y:w.ctrl[0].y},{x:w.x,y:w.y}),E.push(3)):(t.push({x:w.ctrl[0].x,y:w.ctrl[0].y},{x:w.ctrl[1].x,y:w.ctrl[1].y},{x:w.x,y:w.y}),E.push(4)),q._lastPoint={x:w.x,y:w.y};break;default:t.push({x:w.x,y:w.y}),E.push(2)}t.length&&E.length&&(q.writer.svgId=q.ctx._svgId,q.writer.$2BA(t,E,$))}},J.prototype.$2A=function(){var M=this;M._path=[],M._lastPoint=null,M._headPoint=null},J.prototype._adjustStyle=function(M){var q=this.ctx,N=q.globalCompositeOperation;"source-over"!==N&&(M.composite=N)};var u=e.SvgConverter=function(M){var q=this;q.$26A(M||{}),q.$27A()};u.prototype={},u.prototype.constructor=u,u.prototype.$26A=function(M){var q,e=this;q=e.options={},q.size=M.size||512,q.segments=M.segments||16,q.splitToBezier=M.splitToBezier===N||M.splitToBezier,q.minimumFontSize=M.minimumFontSize==N?8:M.minimumFontSize,q.combinePath=M.combinePath||!1,q.gatherTextSize=M.gatherTextSize||!1},u.prototype.$27A=function(){var M=this,q=document.createElement("canvas");q.width=q.height=M.options.size,q.style.width=q.style.height=M.options.size;var N=q.getContext;q.getContext=function(q){return function(N){var e=q.apply(this,arguments);return"2d"===N&&M.$28A(e),e}}(N),M._canvas=q,M._segments=[]},u.prototype.toShape=function(M){var q=this;return q._segments=[],q._imageCount=0,q.imageMap={},canvg(q._canvas,M,{ignoreMouse:!0,ignoreAnimation:!0,combinePath:q.options.combinePath}),q.write()},u.prototype.$28A=function(M){var q=this;return new e.Context2dProxy(M,q,q.options)},u.prototype.write=function(){var M=this;return{width:M._canvas.width,height:M._canvas.height,comps:M._segments,imageMap:M.imageMap}},u.prototype.$29A=function(M){var q=this;M.svgId=M.displayName=this.svgId,q._segments.push(M)},u.prototype.$2AA=function(M,q,N,X,w,$,E,J,u){w=w||"left","start"===w?w="left":"end"===w&&(w="right");var g=this,S={type:"text",text:M,rotation:X,align:w,vAlign:$,font:N,opacity:u,scaleX:J.x,scaleY:J.y};if(g.options.gatherTextSize){var b=.5;"left"===w?b=0:"right"===w&&(b=1),S.anchorX=b;var h=.5;"top"===$?h=0:"bottom"===$&&(h=1,q.y+=e.Default.textExtraWidth*J.y),S.anchorY=h;var y=t(M,N,E.vertical),P=y.width,f=y.height+e.Default.textExtraWidth;S.rect=[q.x-b*P,q.y-h*f,P,f]}else S.rect=[q.x,q.y,.01,.01];E.vertical&&(S.vertical=E.vertical),E.decoration&&(S.decoration=E.decoration),E.gradientPack?S.gradientPack=E.gradientPack:S.color=E.color,g.$29A(S)},u.prototype._fixGraidentPack=function(){var M=new e.Math.Matrix2d,q=new e.Math.Matrix2d;return function(N,e){if(e){N=N.slice(0);var X="L"===N[0];M.fromArray(X?[N[5],N[6],N[7],N[8],N[9],N[10]]:[N[7],N[8],N[9],N[10],N[11],N[12]]),q.fromArray(e),M.prepend(q),X?N.splice.apply(N,[5,6].concat(M.toArray())):N.splice.apply(N,[7,6].concat(M.toArray()))}return N}}(),u.prototype.addImage=function(M,q){var N,e=this.imageMap;for(var X in e)if(e[X]===M){N=X;break}N||(N="image"+this._imageCount++,e[N]=M);var w={type:"image",name:N,rect:q.rect,scaleX:q.scaleX,scaleY:q.scaleY,anchorX:0,anchorY:0};q.rotation&&(w.rotation=q.rotation),this.$29A(w)},u.prototype.$2BA=function(M,q,N){for(var e=this,X=[],w=0,$=M.length;w<$;w++){var t=M[w];X.push(t.x,t.y)}if(N.clip)return void e.$29A({type:"clip",points:X,segments:q});var E={type:"shape",points:X,segments:q};e._fillStyle(E,N),e.$29A(E)},u.prototype.addRestore=function(){this.$29A({type:"restore"})},u.prototype.addRect=function(M,q,N,X,w){var $=this;if(X.clip){var t=[],E=[],J=M[0],u=M[1],g=M[2],S=M[3],b=new e.Math.Matrix2d(N,J,u,g,S);return[[0,0],[1,0],[1,1],[0,1]].forEach(function(M,q){var N=b.tf(M[0],M[1]);E.push(0===q?1:2),t.push(N.x,N.y)}),void $.$29A({type:"clip",points:t,segments:E})}var h={type:"rect",rect:M,scaleX:q.x,scaleY:q.y,rotation:N,anchorX:0,anchorY:0};$._fillStyle(h,X,w),$.$29A(h)},u.prototype.addRoundRect=function(M,q,N,X,w,$){var t=this;if(w.clip){var E=[],J=[];e.Default.isArray(q)||(q=[q,q,q,q]);var u=Math.min(M[2],M[3]);q.forEach(function(M,N){q[N]=q[N]/u});var g,S,b,h,y,P,f=Math.PI/2,x=new e.Math.Matrix2d;for(y=0;y<4;y++){for(x.identity(),x.appendTranslate(.5,.5),x.appendRotate(f*y),x.appendTranslate(-.5,-.5),g=q[y],S=.4514162296451364*g,b=[0,g,0,S,S,0,g,0],P=0;P<8;P+=2)h=x.tf(b[P],b[P+1]),E.push(h.x,h.y);J.push(0==y?1:2,4)}for(x.setFromTransform(X,M[0],M[1],M[2],M[3]),y=0,len=E.length;y<len;y+=2)h=x.tf(E[y],E[y+1]),E[y]=h.x,E[y+1]=h.y;return void t.$29A({type:"clip",points:E,segments:J})}if(e.Default.isArray(q)){var n=q[1];q[1]=q[3],q[3]=n}var R={type:"roundRect",rect:M,scaleX:N.x,scaleY:N.y,rotation:X,cornerRadius:q,anchorX:0,anchorY:0};t._fillStyle(R,w,$),t.$29A(R)},u.prototype._fillStyle=function(M,q,e){q.opacity!=N&&(M.opacity=q.opacity),q.composite!=N&&(M.composite=q.composite),q.stroke?(q.dash?(M.dash=q.dash,M.dashPattern=q.dashPattern,M.dashOffset=q.dashOffset,M.dashColor=q.color,M.dashWidth=q.lineWidth,M.borderColor=null,M.borderWidth=0,M.background=null):(M.borderColor=q.color,M.borderWidth=q.lineWidth,M.background=null,q.gradientPack&&(M.borderGradientPack=this._fixGraidentPack(q.gradientPack,e),M.borderColor=null)),q.lineCap&&(M.borderCap=q.lineCap)):(M.borderColor=null,M.borderWidth=0,q.isPattern?(M.repeatImage=q.color,M.trans=q.trans,M.background=null):q.gradientPack?(M.gradientPack=this._fixGraidentPack(q.gradientPack,e),M.background=null):M.background=q.color,q.gradient&&(M.gradient=q.gradient,M.gradientColor=q.gradientColor),q.fillRule&&(M.fillRule=q.fillRule))},function(M){function q(M){this.ok=!1,"#"==M.charAt(0)&&(M=M.substr(1,6)),M=M.replace(/ /g,""),M=M.toLowerCase();var N={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"};for(var e in N)M==e&&(M=N[e]);for(var X=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(M){return[parseInt(M[1]),parseInt(M[2]),parseInt(M[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(M){return[parseInt(M[1],16),parseInt(M[2],16),parseInt(M[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(M){return[parseInt(M[1]+M[1],16),parseInt(M[2]+M[2],16),parseInt(M[3]+M[3],16)]}}],w=0;w<X.length;w++){var $=X[w].re,t=X[w].process,E=$.exec(M);if(E){var J=t(E);this.r=J[0],this.g=J[1],this.b=J[2],this.ok=!0}}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var M=this.r.toString(16),q=this.g.toString(16),N=this.b.toString(16);return 1==M.length&&(M="0"+M),1==q.length&&(q="0"+q),1==N.length&&(N="0"+N),"#"+M+q+N},this.getHelpXML=function(){for(var M=new Array,e=0;e<X.length;e++)for(var w=X[e].example,$=0;$<w.length;$++)M[M.length]=w[$];for(var t in N)M[M.length]=t;var E=document.createElement("ul");E.setAttribute("id","rgbcolor-examples");for(var e=0;e<M.length;e++)try{var J=document.createElement("li"),u=new q(M[e]),g=document.createElement("div");g.style.cssText="margin: 3px; border: 1px solid black; background:"+u.toHex()+"; color:"+u.toHex(),g.appendChild(document.createTextNode("test"));var S=document.createTextNode(" "+M[e]+" -> "+u.toRGB()+" -> "+u.toHex());J.appendChild(g),J.appendChild(S),E.appendChild(J)}catch(M){}return E}}M.RGBColor=q}(void 0!==M?M:this),function(M){function q(M){for(var q=M.data,N=M.width*M.height*4,e=0;e<N;e+=4){var X=q[e+3]/255;q[e]*=X,q[e+1]*=X,q[e+2]*=X}}function N(M){for(var q=M.data,N=M.width*M.height*4,e=0;e<N;e+=4){var X=q[e+3];0!=X&&(X=255/X,q[e]*=X,q[e+1]*=X,q[e+2]*=X)}}function e(M,q,N,e){var $=document.getElementById(M),t=$.naturalWidth,E=$.naturalHeight,J=document.getElementById(q);J.style.width=t+"px",J.style.height=E+"px",J.width=t,J.height=E;var u=J.getContext("2d");u.clearRect(0,0,t,E),u.drawImage($,0,0),isNaN(N)||N<1||(e?X(q,0,0,t,E,N):w(q,0,0,t,E,N))}function X(M,e,X,w,J,u){if(!(isNaN(u)||u<1)){u|=0;var g,S=document.getElementById(M),b=S.getContext("2d");try{try{g=b.getImageData(e,X,w,J)}catch(M){try{netscape.security.PrivilegeManager.enablePrivilege("UniversalBrowserRead"),g=b.getImageData(e,X,w,J)}catch(M){throw alert("Cannot access local image"),new Error("unable to access local image data: "+M)}}}catch(M){throw alert("Cannot access image"),new Error("unable to access image data: "+M)}q(g);var h,y,P,f,x,n,R,G,j,K,p,C,m,O,Q,s,l,Y,I,r,d,a,D,W,v=g.data,o=u+u+1,H=w-1,U=J-1,V=u+1,T=V*(V+1)/2,_=new $,k=_;for(P=1;P<o;P++)if(k=k.next=new $,P==V)var Z=k;k.next=_;var z=null,A=null
;R=n=0;var c=t[u],B=E[u];for(y=0;y<J;y++){for(s=l=Y=I=G=j=K=p=0,C=V*(r=v[n]),m=V*(d=v[n+1]),O=V*(a=v[n+2]),Q=V*(D=v[n+3]),G+=T*r,j+=T*d,K+=T*a,p+=T*D,k=_,P=0;P<V;P++)k.r=r,k.g=d,k.b=a,k.a=D,k=k.next;for(P=1;P<V;P++)f=n+((H<P?H:P)<<2),G+=(k.r=r=v[f])*(W=V-P),j+=(k.g=d=v[f+1])*W,K+=(k.b=a=v[f+2])*W,p+=(k.a=D=v[f+3])*W,s+=r,l+=d,Y+=a,I+=D,k=k.next;for(z=_,A=Z,h=0;h<w;h++)v[n]=G*c>>B,v[n+1]=j*c>>B,v[n+2]=K*c>>B,v[n+3]=p*c>>B,G-=C,j-=m,K-=O,p-=Q,C-=z.r,m-=z.g,O-=z.b,Q-=z.a,f=R+((f=h+u+1)<H?f:H)<<2,s+=z.r=v[f],l+=z.g=v[f+1],Y+=z.b=v[f+2],I+=z.a=v[f+3],G+=s,j+=l,K+=Y,p+=I,z=z.next,C+=r=A.r,m+=d=A.g,O+=a=A.b,Q+=D=A.a,s-=r,l-=d,Y-=a,I-=D,A=A.next,n+=4;R+=w}for(h=0;h<w;h++){for(l=Y=I=s=j=K=p=G=0,n=h<<2,C=V*(r=v[n]),m=V*(d=v[n+1]),O=V*(a=v[n+2]),Q=V*(D=v[n+3]),G+=T*r,j+=T*d,K+=T*a,p+=T*D,k=_,P=0;P<V;P++)k.r=r,k.g=d,k.b=a,k.a=D,k=k.next;for(x=w,P=1;P<=u;P++)n=x+h<<2,G+=(k.r=r=v[n])*(W=V-P),j+=(k.g=d=v[n+1])*W,K+=(k.b=a=v[n+2])*W,p+=(k.a=D=v[n+3])*W,s+=r,l+=d,Y+=a,I+=D,k=k.next,P<U&&(x+=w);for(n=h,z=_,A=Z,y=0;y<J;y++)f=n<<2,v[f]=G*c>>B,v[f+1]=j*c>>B,v[f+2]=K*c>>B,v[f+3]=p*c>>B,G-=C,j-=m,K-=O,p-=Q,C-=z.r,m-=z.g,O-=z.b,Q-=z.a,f=h+((f=y+V)<U?f:U)*w<<2,G+=s+=z.r=v[f],j+=l+=z.g=v[f+1],K+=Y+=z.b=v[f+2],p+=I+=z.a=v[f+3],z=z.next,C+=r=A.r,m+=d=A.g,O+=a=A.b,Q+=D=A.a,s-=r,l-=d,Y-=a,I-=D,A=A.next,n+=w}N(g),b.putImageData(g,e,X)}}function w(M,q,N,e,X,w){if(!(isNaN(w)||w<1)){w|=0;var J,u=document.getElementById(M),g=u.getContext("2d");try{try{J=g.getImageData(q,N,e,X)}catch(M){try{netscape.security.PrivilegeManager.enablePrivilege("UniversalBrowserRead"),J=g.getImageData(q,N,e,X)}catch(M){throw alert("Cannot access local image"),new Error("unable to access local image data: "+M)}}}catch(M){throw alert("Cannot access image"),new Error("unable to access image data: "+M)}var S,b,h,y,P,f,x,n,R,G,j,K,p,C,m,O,Q,s,l,Y,I=J.data,r=w+w+1,d=e-1,a=X-1,D=w+1,W=D*(D+1)/2,v=new $,o=v;for(h=1;h<r;h++)if(o=o.next=new $,h==D)var H=o;o.next=v;var U=null,V=null;x=f=0;var T=t[w],_=E[w];for(b=0;b<X;b++){for(C=m=O=n=R=G=0,j=D*(Q=I[f]),K=D*(s=I[f+1]),p=D*(l=I[f+2]),n+=W*Q,R+=W*s,G+=W*l,o=v,h=0;h<D;h++)o.r=Q,o.g=s,o.b=l,o=o.next;for(h=1;h<D;h++)y=f+((d<h?d:h)<<2),n+=(o.r=Q=I[y])*(Y=D-h),R+=(o.g=s=I[y+1])*Y,G+=(o.b=l=I[y+2])*Y,C+=Q,m+=s,O+=l,o=o.next;for(U=v,V=H,S=0;S<e;S++)I[f]=n*T>>_,I[f+1]=R*T>>_,I[f+2]=G*T>>_,n-=j,R-=K,G-=p,j-=U.r,K-=U.g,p-=U.b,y=x+((y=S+w+1)<d?y:d)<<2,C+=U.r=I[y],m+=U.g=I[y+1],O+=U.b=I[y+2],n+=C,R+=m,G+=O,U=U.next,j+=Q=V.r,K+=s=V.g,p+=l=V.b,C-=Q,m-=s,O-=l,V=V.next,f+=4;x+=e}for(S=0;S<e;S++){for(m=O=C=R=G=n=0,f=S<<2,j=D*(Q=I[f]),K=D*(s=I[f+1]),p=D*(l=I[f+2]),n+=W*Q,R+=W*s,G+=W*l,o=v,h=0;h<D;h++)o.r=Q,o.g=s,o.b=l,o=o.next;for(P=e,h=1;h<=w;h++)f=P+S<<2,n+=(o.r=Q=I[f])*(Y=D-h),R+=(o.g=s=I[f+1])*Y,G+=(o.b=l=I[f+2])*Y,C+=Q,m+=s,O+=l,o=o.next,h<a&&(P+=e);for(f=S,U=v,V=H,b=0;b<X;b++)y=f<<2,I[y]=n*T>>_,I[y+1]=R*T>>_,I[y+2]=G*T>>_,n-=j,R-=K,G-=p,j-=U.r,K-=U.g,p-=U.b,y=S+((y=b+D)<a?y:a)*e<<2,n+=C+=U.r=I[y],R+=m+=U.g=I[y+1],G+=O+=U.b=I[y+2],U=U.next,j+=Q=V.r,K+=s=V.g,p+=l=V.b,C-=Q,m-=s,O-=l,V=V.next,f+=e}g.putImageData(J,q,N)}}function $(){this.r=0,this.g=0,this.b=0,this.a=0,this.next=null}var t=[512,512,456,512,328,456,335,512,405,328,271,456,388,335,292,512,454,405,364,328,298,271,496,456,420,388,360,335,312,292,273,512,482,454,428,405,383,364,345,328,312,298,284,271,259,496,475,456,437,420,404,388,374,360,347,335,323,312,302,292,282,273,265,512,497,482,468,454,441,428,417,405,394,383,373,364,354,345,337,328,320,312,305,298,291,284,278,271,265,259,507,496,485,475,465,456,446,437,428,420,412,404,396,388,381,374,367,360,354,347,341,335,329,323,318,312,307,302,297,292,287,282,278,273,269,265,261,512,505,497,489,482,475,468,461,454,447,441,435,428,422,417,411,405,399,394,389,383,378,373,368,364,359,354,350,345,341,337,332,328,324,320,316,312,309,305,301,298,294,291,287,284,281,278,274,271,268,265,262,259,257,507,501,496,491,485,480,475,470,465,460,456,451,446,442,437,433,428,424,420,416,412,408,404,400,396,392,388,385,381,377,374,370,367,363,360,357,354,350,347,344,341,338,335,332,329,326,323,320,318,315,312,310,307,304,302,299,297,294,292,289,287,285,282,280,278,275,273,271,269,267,265,263,261,259],E=[9,11,12,13,13,14,14,15,15,15,15,16,16,16,16,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24],J={image:e,canvasRGBA:X,canvasRGB:w};M.stackBlur=J}(void 0!==M?M:this),function(X,w){X.canvg=function(X,w){function t(M){var q=[0,0,0],N=function(N,e){var X=M.match(N);null!=X&&(q[e]+=X.length,M=M.replace(N," "))};return M=M.replace(/:not\(([^\)]*)\)/g,"     $1 "),M=M.replace(/{[\s\S]*/gm," "),N(g,1),N(S,0),N(b,1),N(h,2),N(y,1),N(P,1),M=M.replace(/[\*\s\+>~]/g," "),M=M.replace(/[#\.]/g," "),N(f,2),q.join("")}function E($){var E={opts:$};E.FRAMERATE=30,E.MAX_VIRTUAL_PIXELS=3e4,E.log=function(M){},1==E.opts.log&&"undefined"!=typeof console&&(E.log=function(M){console.log(M)}),E.init=function(M){var q=0;E.UniqueId=function(){return"canvg"+ ++q},E.Definitions={},E.Styles={},E.StylesSpecificity={},E.Animations=[],E.Images=[],E.ctx=M,E.ViewPort=new function(){this.viewPorts=[],this.Clear=function(){this.viewPorts=[]},this.SetCurrent=function(M,q){this.viewPorts.push({width:M,height:q})},this.RemoveCurrent=function(){this.viewPorts.pop()},this.Current=function(){return this.viewPorts[this.viewPorts.length-1]},this.width=function(){var M,q=this.Current();return q&&(M=q.width)?M:100},this.height=function(){var M,q=this.Current();return q&&(M=q.height)?M:100},this.ComputeSize=function(M){return null!=M&&"number"==typeof M?M:"x"==M?this.width():"y"==M?this.height():Math.sqrt(Math.pow(this.width(),2)+Math.pow(this.height(),2))/Math.sqrt(2)}}},E.init(),E.ImagesLoaded=function(){for(var M=0;M<E.Images.length;M++)if(!E.Images[M].loaded)return!1;return!0},E.trim=function(M){return M.replace(/^\s+|\s+$/g,"")},E.compressSpaces=function(M){return M.replace(/[\s\r\t\n]+/gm," ")},E.ajax=function(M){M=e.Default.beforeLoadURL(M);var q=new e.Request,N={};return N.url=encodeURI(M),N.sync=!0,q.send(N),q.getResponseText()},E.parseXml=function(q){if("undefined"!=typeof Windows&&void 0!==Windows.Data&&void 0!==Windows.Data.Xml){var N=new Windows.Data.Xml.Dom.XmlDocument,e=new Windows.Data.Xml.Dom.XmlLoadSettings;return e.prohibitDtd=!1,N.loadXml(q,e),N}if(M.DOMParser){return(new DOMParser).parseFromString(q,"text/xml")}q=q.replace(/<!DOCTYPE svg[^>]*>/,"");var N=new ActiveXObject("Microsoft.XMLDOM");return N.async="false",N.loadXML(q),N},E.Property=function(M,q){this.name=M,this.value=q},E.Property.prototype.getValue=function(){return this.value},E.Property.prototype.hasValue=function(){return null!=this.value&&""!==this.value},E.Property.prototype.numValue=function(){if(!this.hasValue())return 0;var M=parseFloat(this.value);return(this.value+"").match(/%$/)&&(M/=100),M},E.Property.prototype.valueOrDefault=function(M){return this.hasValue()?this.value:M},E.Property.prototype.numValueOrDefault=function(M){return this.hasValue()?this.numValue():M},E.Property.prototype.addOpacity=function(M){var q=this.value;if(null!=M.value&&""!=M.value&&"string"==typeof this.value){var N=new X(this.value);N.ok&&(q="rgba("+N.r+", "+N.g+", "+N.b+", "+M.numValue()+")")}return new E.Property(this.name,q)},E.Property.prototype.getDefinition=function(){var M=this.value.match(/#([^\)'"]+)/);return M&&(M=M[1]),M||(M=this.value),E.Definitions[M]},E.Property.prototype.isUrlDefinition=function(){return 0==this.value.indexOf("url(")},E.Property.prototype.getFillStyleDefinition=function(M,q){var N=this.getDefinition();if(null!=N&&N.createGradient)return N.createGradient(E.ctx,M,q);if(null!=N&&N.createPattern){if(N.getHrefAttribute().hasValue()){var e=N.attribute("patternTransform");N=N.getHrefAttribute().getDefinition(),e.hasValue()&&(N.attribute("patternTransform",!0).value=e.value)}return N.createPattern(E.ctx,M)}return null},E.Property.prototype.getDPI=function(M){return 96},E.Property.prototype.getEM=function(M){var q=12,N=new E.Property("fontSize",E.Font.Parse(E.ctx.font).fontSize);return N.hasValue()&&(q=N.toPixels(M)),q},E.Property.prototype.getUnits=function(){return(this.value+"").replace(/[0-9\.\-]/g,"")},E.Property.prototype.toPixels=function(M,q){if(!this.hasValue())return 0;var N=this.value+"";if(N.match(/em$/))return this.numValue()*this.getEM(M);if(N.match(/ex$/))return this.numValue()*this.getEM(M)/2;if(N.match(/px$/))return this.numValue();if(N.match(/pt$/))return this.numValue()*this.getDPI(M)*(1/72);if(N.match(/pc$/))return 15*this.numValue();if(N.match(/cm$/))return this.numValue()*this.getDPI(M)/2.54;if(N.match(/mm$/))return this.numValue()*this.getDPI(M)/25.4;if(N.match(/in$/))return this.numValue()*this.getDPI(M);if(N.match(/%$/))return this.numValue()*E.ViewPort.ComputeSize(M);var e=this.numValue();return q&&e<1?e*E.ViewPort.ComputeSize(M):e},E.Property.prototype.toMilliseconds=function(){if(!this.hasValue())return 0;var M=this.value+"";return M.match(/s$/)?1e3*this.numValue():(M.match(/ms$/),this.numValue())},E.Property.prototype.toRadians=function(){if(!this.hasValue())return 0;var M=this.value+"";return M.match(/deg$/)?this.numValue()*(Math.PI/180):M.match(/grad$/)?this.numValue()*(Math.PI/200):M.match(/rad$/)?this.numValue():this.numValue()*(Math.PI/180)};var u={baseline:"alphabetic","before-edge":"top","text-before-edge":"top",middle:"middle",central:"middle","after-edge":"bottom","text-after-edge":"bottom",ideographic:"ideographic",alphabetic:"alphabetic",hanging:"hanging",mathematical:"alphabetic"};return E.Property.prototype.toTextBaseline=function(){return this.hasValue()?u[this.value]:null},E.Font=new function(){this.Styles="normal|italic|oblique|inherit",this.Variants="normal|small-caps|inherit",this.Weights="normal|bold|bolder|lighter|100|200|300|400|500|600|700|800|900|inherit",this.CreateFont=function(M,q,N,e,X,w){var $=null!=w?this.Parse(w):this.CreateFont("","","","","",E.ctx.font);return{fontFamily:X||$.fontFamily,fontSize:e||$.fontSize,fontStyle:M||$.fontStyle,fontWeight:N||$.fontWeight,fontVariant:q||$.fontVariant,toString:function(){return[this.fontStyle,this.fontVariant,this.fontWeight,this.fontSize,this.fontFamily].join(" ")}}};var M=this;this.Parse=function(q){for(var N={},e=E.trim(E.compressSpaces(q||"")).split(" "),X={fontSize:!1,fontStyle:!1,fontWeight:!1,fontVariant:!1},w="",$=0;$<e.length;$++)X.fontStyle||-1==M.Styles.indexOf(e[$])?X.fontVariant||-1==M.Variants.indexOf(e[$])?X.fontWeight||-1==M.Weights.indexOf(e[$])?X.fontSize?"inherit"!=e[$]&&(w+=e[$]):("inherit"!=e[$]&&(N.fontSize=e[$].split("/")[0]),X.fontStyle=X.fontVariant=X.fontWeight=X.fontSize=!0):("inherit"!=e[$]&&(N.fontWeight=e[$]),X.fontStyle=X.fontVariant=X.fontWeight=!0):("inherit"!=e[$]&&(N.fontVariant=e[$]),X.fontStyle=X.fontVariant=!0):("inherit"!=e[$]&&(N.fontStyle=e[$]),X.fontStyle=!0);return""!=w&&(N.fontFamily=w),N}},E.ToNumberArray=function(M){for(var q=E.trim(E.compressSpaces((M||"").replace(/,/g," "))).split(" "),N=0;N<q.length;N++)q[N]=parseFloat(q[N]);return q},E.Point=function(M,q){this.x=M,this.y=q},E.Point.prototype.angleTo=function(M){return Math.atan2(M.y-this.y,M.x-this.x)},E.Point.prototype.applyTransform=function(M){var q=this.x*M[0]+this.y*M[2]+M[4],N=this.x*M[1]+this.y*M[3]+M[5];this.x=q,this.y=N},E.CreatePoint=function(M){var q=E.ToNumberArray(M);return new E.Point(q[0],q[1])},E.CreatePath=function(M){for(var q=E.ToNumberArray(M),N=[],e=0;e<q.length;e+=2)N.push(new E.Point(q[e],q[e+1]));return N},E.BoundingBox=function(M,q,N,e){this.x1=Number.NaN,this.y1=Number.NaN,this.x2=Number.NaN,this.y2=Number.NaN,this.x=function(){return this.x1},this.y=function(){return this.y1},this.width=function(){return this.x2-this.x1},this.height=function(){return this.y2-this.y1},this.addPoint=function(M,q){null!=M&&((isNaN(this.x1)||isNaN(this.x2))&&(this.x1=M,this.x2=M),M<this.x1&&(this.x1=M),M>this.x2&&(this.x2=M)),null!=q&&((isNaN(this.y1)||isNaN(this.y2))&&(this.y1=q,this.y2=q),q<this.y1&&(this.y1=q),q>this.y2&&(this.y2=q))},this.addX=function(M){this.addPoint(M,null)},this.addY=function(M){this.addPoint(null,M)},this.addBoundingBox=function(M){this.addPoint(M.x1,M.y1),this.addPoint(M.x2,M.y2)},this.addQuadraticCurve=function(M,q,N,e,X,w){var $=M+2/3*(N-M),t=q+2/3*(e-q),E=$+1/3*(X-M),J=t+1/3*(w-q);this.addBezierCurve(M,q,$,E,t,J,X,w)},this.addBezierCurve=function(M,q,N,e,X,w,$,t){var E=[M,q],J=[N,e],u=[X,w],g=[$,t];this.addPoint(E[0],E[1]),this.addPoint(g[0],g[1]);for(var S=0;S<=1;S++){var b=function(M){return Math.pow(1-M,3)*E[S]+3*Math.pow(1-M,2)*M*J[S]+3*(1-M)*Math.pow(M,2)*u[S]+Math.pow(M,3)*g[S]},h=6*E[S]-12*J[S]+6*u[S],y=-3*E[S]+9*J[S]-9*u[S]+3*g[S],P=3*J[S]-3*E[S];if(0!=y){var f=Math.pow(h,2)-4*P*y;if(!(f<0)){var x=(-h+Math.sqrt(f))/(2*y);0<x&&x<1&&(0==S&&this.addX(b(x)),1==S&&this.addY(b(x)));var n=(-h-Math.sqrt(f))/(2*y);0<n&&n<1&&(0==S&&this.addX(b(n)),1==S&&this.addY(b(n)))}}else{if(0==h)continue;var R=-P/h;0<R&&R<1&&(0==S&&this.addX(b(R)),1==S&&this.addY(b(R)))}}},this.isPointInBox=function(M,q){return this.x1<=M&&M<=this.x2&&this.y1<=q&&q<=this.y2},this.addPoint(M,q),this.addPoint(N,e)},E.Transform=function(M){var q=this;this.Type={},this.Type.translate=function(M){this.p=E.CreatePoint(M),this.getMatrix=function(){return[1,0,0,1,this.p.x||0,this.p.y||0]},this.apply=function(M){M.translate(this.p.x||0,this.p.y||0)},this.unapply=function(M){M.translate(-1*this.p.x||0,-1*this.p.y||0)},this.applyToPoint=function(M){M.applyTransform([1,0,0,1,this.p.x||0,this.p.y||0])}},this.Type.rotate=function(M){var q=E.ToNumberArray(M);this.angle=new E.Property("angle",q[0]),this.cx=q[1]||0,this.cy=q[2]||0,this.apply=function(M){M.translate(this.cx,this.cy),M.rotate(this.angle.toRadians()),M.translate(-this.cx,-this.cy)},this.getMatrix=function(){var M=this.angle.toRadians(),q=Math.sin(M),N=Math.cos(M),e=this.cx,X=this.cy;return[N,q,-q,N,N*-e+q*X+e,q*-e-N*X+X]},this.unapply=function(M){M.translate(this.cx,this.cy),M.rotate(-1*this.angle.toRadians()),M.translate(-this.cx,-this.cy)},this.applyToPoint=function(M){var q=this.angle.toRadians();M.applyTransform([1,0,0,1,this.p.x||0,this.p.y||0]),M.applyTransform([Math.cos(q),Math.sin(q),-Math.sin(q),Math.cos(q),0,0]),M.applyTransform([1,0,0,1,-this.p.x||0,-this.p.y||0])}},this.Type.scale=function(M){this.p=E.CreatePoint(M),this.getMatrix=function(){return[this.p.x||1,0,0,this.p.y||this.p.x||1,0,0]},this.apply=function(M){M.scale(this.p.x||1,this.p.y||this.p.x||1)},this.unapply=function(M){M.scale(1/this.p.x||1,1/this.p.y||this.p.x||1)},this.applyToPoint=function(M){M.applyTransform([this.p.x||0,0,0,this.p.y||0,0,0])}},this.Type.matrix=function(M){this.m=E.ToNumberArray(M),this.getMatrix=function(){return this.m},this.apply=function(M){M.transform(this.m[0],this.m[1],this.m[2],this.m[3],this.m[4],this.m[5])},this.unapply=function(M){var q=this.m[0],N=this.m[2],e=this.m[4],X=this.m[1],w=this.m[3],$=this.m[5],t=1/(q*(1*w-0*$)-N*(1*X-0*$)+e*(0*X-0*w));M.transform(t*(1*w-0*$),t*(0*$-1*X),t*(0*e-1*N),t*(1*q-0*e),t*(N*$-e*w),t*(e*X-q*$))},this.applyToPoint=function(M){M.applyTransform(this.m)}},this.Type.SkewBase=function(M){this.base=q.Type.matrix,this.base(M),this.angle=new E.Property("angle",M)},this.Type.SkewBase.prototype=new this.Type.matrix,this.Type.skewX=function(M){this.base=q.Type.SkewBase,this.base(M),this.m=[1,0,Math.tan(this.angle.toRadians()),1,0,0]},this.Type.skewX.prototype=new this.Type.SkewBase,this.Type.skewY=function(M){this.base=q.Type.SkewBase,this.base(M),this.m=[1,Math.tan(this.angle.toRadians()),0,1,0,0]},this.Type.skewY.prototype=new this.Type.SkewBase,this.transforms=[],this.getMatrix=function(){for(var M=1,q=0,N=0,e=1,X=0,w=0,$=0;$<this.transforms.length;$++){var t=this.transforms[$].getMatrix(),E=M,J=q,u=N,g=e,S=X,b=w;M=E*t[0]+u*t[1],q=J*t[0]+g*t[1],N=E*t[2]+u*t[3],e=J*t[2]+g*t[3],X=E*t[4]+u*t[5]+S,w=J*t[4]+g*t[5]+b}return[M,q,N,e,X,w]},this.apply=function(M){for(var q=0;q<this.transforms.length;q++)this.transforms[q].apply(M)},this.unapply=function(M){for(var q=this.transforms.length-1;q>=0;q--)this.transforms[q].unapply(M)},this.applyToPoint=function(M){for(var q=0;q<this.transforms.length;q++)this.transforms[q].applyToPoint(M)};for(var N=E.trim(E.compressSpaces(M)).replace(/\)([a-zA-Z])/g,") $1").replace(/\)(\s?,\s?)/g,") ").split(/\s(?=[a-z])/),e=0;e<N.length;e++){var X=E.trim(N[e].split("(")[0]),w=N[e].split("(")[1].replace(")",""),$=this.Type[X];if(void 0!==$){var t=new $(w);t.type=X,this.transforms.push(t)}}},E.AspectRatio=function(M,q,N,e,X,w,$,t,J,u){q=E.compressSpaces(q),q=q.replace(/^defer\s/,"");var g=q.split(" ")[0]||"xMidYMid",S=q.split(" ")[1]||"meet",b=N/e,h=X/w,y=Math.min(b,h),P=Math.max(b,h);"meet"==S&&(e*=y,w*=y),"slice"==S&&(e*=P,w*=P),J=new E.Property("refX",J),u=new E.Property("refY",u),J.hasValue()&&u.hasValue()?M.translate(-y*J.toPixels("x"),-y*u.toPixels("y")):(g.match(/^xMid/)&&("meet"==S&&y==h||"slice"==S&&P==h)&&M.translate(N/2-e/2,0),g.match(/YMid$/)&&("meet"==S&&y==b||"slice"==S&&P==b)&&M.translate(0,X/2-w/2),g.match(/^xMax/)&&("meet"==S&&y==h||"slice"==S&&P==h)&&M.translate(N-e,0),g.match(/YMax$/)&&("meet"==S&&y==b||"slice"==S&&P==b)&&M.translate(0,X-w)),"none"==g?M.scale(b,h):"meet"==S?M.scale(y,y):"slice"==S&&M.scale(P,P),M.translate(null==$?0:-$,null==t?0:-t)},E.Element={},E.EmptyProperty=new E.Property("EMPTY",""),E.Element.ElementBase=function(M){this.attributes={},this.styles={},this.stylesSpecificity={},this.children=[],this.attribute=function(M,q){var N=this.attributes[M];return null!=N?N:(1==q&&(N=new E.Property(M,""),this.attributes[M]=N),N||E.EmptyProperty)},this.getHrefAttribute=function(){for(var M in this.attributes)if("href"==M||M.match(/:href$/))return this.attributes[M];return E.EmptyProperty},this.style=function(M,q,N){var e=this.styles[M];if(null!=e)return e;var X=this.attribute(M);if(null!=X&&X.hasValue())return this.styles[M]=X,X;if(1!=N){var w=this.parent;if(null!=w){var $=w.style(M);if(null!=$&&$.hasValue())return $}}return 1==q&&(e=new E.Property(M,""),this.styles[M]=e),e||E.EmptyProperty},this.render=function(M){var q=M._svgId;if(M._svgId=this.attribute("id").value,"none"!=this.style("display").value&&"hidden"!=this.style("visibility").value){if(M.save(),this.style("mask").hasValue()){var N=this.style("mask").getDefinition();null!=N&&N.apply(M,this)}else this.setContext(M),this.renderChildren(M),this.clearContext(M);M.restore(),M._svgId=q}},this.setContext=function(M){},this.clearContext=function(M){},this.renderChildren=function(M){for(var q=0;q<this.children.length;q++)this.children[q].render(M)},this.addChild=function(M,q){var N=M;q&&(N=E.CreateElement(M)),N.parent=this,"title"!=N.type&&this.children.push(N)},this.addStylesFromStyleDefinition=function(){for(var q in E.Styles)if("@"!=q[0]&&J(M,q)){var N=E.Styles[q],e=E.StylesSpecificity[q];if(null!=N)for(var X in N){var w=this.stylesSpecificity[X];void 0===w&&(w="000"),e>w&&(this.styles[X]=N[X],this.stylesSpecificity[X]=e)}}};var q=new RegExp("^[A-Z-]+$");if(null!=M&&1==M.nodeType){for(var N=0;N<M.attributes.length;N++){var e=M.attributes[N],X=function(M){return q.test(M)?M.toLowerCase():M}(e.nodeName);this.attributes[X]=new E.Property(X,e.value)}if(this.addStylesFromStyleDefinition(),this.attribute("style").hasValue())for(var w=this.attribute("style").value.split(";"),N=0;N<w.length;N++)if(""!=E.trim(w[N])){var $=w[N].split(":"),t=E.trim($[0]),u=E.trim($[1]);this.styles[t]=new E.Property(t,u)}this.attribute("id").hasValue()&&null==E.Definitions[this.attribute("id").value]&&(E.Definitions[this.attribute("id").value]=this);for(var N=0;N<M.childNodes.length;N++){var g=M.childNodes[N];if(1==g.nodeType&&this.addChild(g,!0),this.captureTextNodes&&(3==g.nodeType||4==g.nodeType)){var S=g.value||g.text||g.textContent||"";""!=E.compressSpaces(S)&&this.addChild(new E.Element.tspan(g),!1)}}}},E.Element.RenderedElementBase=function(M){this.base=E.Element.ElementBase,this.base(M),this.setContext=function(M,q){var N=this.style("mix-blend-mode");if(N.hasValue()&&(M.save(),M.globalCompositeOperation=N.value),!q){if(this.style("fill").isUrlDefinition()){var e=this.style("fill").getFillStyleDefinition(this,this.style("fill-opacity"));null!=e&&(M.fillStyle=e)}else if(this.style("fill").hasValue()){var X=this.style("fill");"currentColor"==X.value&&(X.value=this.style("color").value),"inherit"!=X.value&&(M.fillStyle="none"==X.value?"rgba(0,0,0,0)":X.value)}if(this.style("fill-opacity").hasValue()){var X=new E.Property("fill",M.fillStyle);X=X.addOpacity(this.style("fill-opacity")),M.fillStyle=X.value}if(this.style("stroke").isUrlDefinition()){var e=this.style("stroke").getFillStyleDefinition(this,this.style("stroke-opacity"));null!=e&&(M.strokeStyle=e)}else if(this.style("stroke").hasValue()){var w=this.style("stroke");"currentColor"==w.value&&(w.value=this.style("color").value||"#000"),"inherit"!=w.value&&(M.strokeStyle="none"==w.value?"rgba(0,0,0,0)":w.value)}if(this.style("stroke-opacity").hasValue()){var w=new E.Property("stroke",M.strokeStyle);w=w.addOpacity(this.style("stroke-opacity")),M.strokeStyle=w.value}if(this.style("stroke-width").hasValue()){var $=this.style("stroke-width").toPixels();M.lineWidth=0==$?.001:$}if(this.style("stroke-linecap").hasValue()&&(M.lineCap=this.style("stroke-linecap").value),this.style("stroke-linejoin").hasValue()&&(M.lineJoin=this.style("stroke-linejoin").value),this.style("stroke-miterlimit").hasValue()&&(M.miterLimit=this.style("stroke-miterlimit").value),this.style("stroke-dasharray").hasValue()&&"none"!=this.style("stroke-dasharray").value){var t=E.ToNumberArray(this.style("stroke-dasharray").value);void 0!==M.setLineDash?M.setLineDash(t):void 0!==M.webkitLineDash?M.webkitLineDash=t:void 0===M.mozDash||1==t.length&&0==t[0]||(M.mozDash=t);var J=this.style("stroke-dashoffset").numValueOrDefault(1);void 0!==M.lineDashOffset?M.lineDashOffset=J:void 0!==M.webkitLineDashOffset?M.webkitLineDashOffset=J:void 0!==M.mozDashOffset&&(M.mozDashOffset=J)}if(void 0!==M.font){var u=this.style("font-size"),g=E.Font.CreateFont(this.style("font-style").value,this.style("font-variant").value,this.style("font-weight").value,u.hasValue()?u.toPixels()+"px":"",this.style("font-family").value);u!==E.EmptyProperty&&u.value!=g.fontSize&&(this.styles["font-size"]=new E.Property("font-size",g.fontSize)),M.font=g.toString()}this.style("text-align").hasValue()?M.textAlign=this.style("text-align").value:M.textAlign="start"}var S=null;if(this.style("transform",!1,!0).hasValue()){var b=new E.Transform(this.style("transform",!1,!0).value);b.apply(M),S=b.getMatrix()}if(M._nodeLocalMat=S,this.style("clip-path",!1,!0).hasValue()){var h=this.style("clip-path",!1,!0).getDefinition();null!=h&&h.apply(M)}this.style("opacity").hasValue()&&(M.globalAlpha=this.style("opacity").numValue())},this.clearContext=function(M){this.style("mix-blend-mode").hasValue()&&M.restore()}},E.Element.RenderedElementBase.prototype=new E.Element.ElementBase,E.Element.PathElementBase=function(M){this.base=E.Element.RenderedElementBase,this.base(M),this.path=function(M){return null!=M&&M.beginPath(),new E.BoundingBox},this.renderChildren=function(M){this.path(M),E.Mouse.checkPath(this,M),""!=M.fillStyle&&("inherit"!=this.style("fill-rule").valueOrDefault("inherit")?M.fill(this.style("fill-rule").value):M.fill()),""!=M.strokeStyle&&M.stroke();var q=this.getMarkers();if(null!=q){if(this.style("marker-start").isUrlDefinition()){var N=this.style("marker-start").getDefinition();if(!N)return;N.render(M,q[0][0],q[0][1],"start")}if(this.style("marker-mid").isUrlDefinition()){var N=this.style("marker-mid").getDefinition();if(!N)return;for(var e=1;e<q.length-1;e++)N.render(M,q[e][0],q[e][1],"mid",q[e-1][1])}if(this.style("marker-end").isUrlDefinition()){var N=this.style("marker-end").getDefinition();if(!N)return;N.render(M,q[q.length-1][0],q[q.length-1][1],"end")}}},this.getBoundingBox=function(){return this.path()},this.getMarkers=function(){return null}},E.Element.PathElementBase.prototype=new E.Element.RenderedElementBase,E.Element.svg=function(q){if(this.base=E.Element.RenderedElementBase,this.base(q),this.attribute("viewBox").hasValue()){var N=E.ToNumberArray(this.attribute("viewBox").value),e=N[2],X=N[3];this.attribute("width").hasValue()||(this.attributes.width=new E.Property("width",Math.round(e)+"px")),this.attribute("height").hasValue()||(this.attributes.height=new E.Property("height",Math.round(X)+"px"))}this.baseClearContext=this.clearContext,this.clearContext=function(M){this.baseClearContext(M),E.ViewPort.RemoveCurrent()},this.baseSetContext=this.setContext,this.setContext=function(q){q.strokeStyle="rgba(0,0,0,0)",q.lineCap="butt",q.lineJoin="miter",q.miterLimit=4,void 0!==q.font&&void 0!==M.getComputedStyle&&(q.font=M.getComputedStyle(q.canvas).getPropertyValue("font")),this.baseSetContext(q),this.attribute("x").hasValue()||(this.attribute("x",!0).value=0),this.attribute("y").hasValue()||(this.attribute("y",!0).value=0),q.translate(this.attribute("x").toPixels("x"),this.attribute("y").toPixels("y"));var N=E.ViewPort.width(),e=E.ViewPort.height(),X=0,w=0;if(this.attribute("width").hasValue()||(this.attribute("width",!0).value="100%"),this.attribute("height").hasValue()||(this.attribute("height",!0).value="100%"),void 0===this.root&&(N=this.attribute("width").toPixels("x"),e=this.attribute("height").toPixels("y"),this.attribute("refX").hasValue()&&this.attribute("refY").hasValue()&&(X=-this.attribute("refX").toPixels("x"),w=-this.attribute("refY").toPixels("y")),"visible"!=this.attribute("overflow").valueOrDefault("hidden")&&(q.beginPath(),q.moveTo(X,w),q.lineTo(N,w),q.lineTo(N,e),q.lineTo(X,e),q.closePath(),q.clip())),E.ViewPort.SetCurrent(N,e),this.attribute("viewBox").hasValue()){var $=E.ToNumberArray(this.attribute("viewBox").value),t=$[0],J=$[1];N=$[2],e=$[3],E.AspectRatio(q,this.attribute("preserveAspectRatio").value,E.ViewPort.width(),N,E.ViewPort.height(),e,t,J,this.attribute("refX").value,this.attribute("refY").value),E.ViewPort.RemoveCurrent(),E.ViewPort.SetCurrent($[2],$[3])}else 0===X&&0===w||q.translate(X,w)}},E.Element.svg.prototype=new E.Element.RenderedElementBase,E.Element.rect=function(M){this.base=E.Element.PathElementBase,this.base(M),this.path=function(M){var q=this.attribute("x").toPixels("x"),N=this.attribute("y").toPixels("y"),X=this.attribute("width").toPixels("x"),w=this.attribute("height").toPixels("y"),$=this.attribute("rx").toPixels("x"),t=this.attribute("ry").toPixels("y");if(this.attribute("rx").hasValue()&&!this.attribute("ry").hasValue()&&(t=$),this.attribute("ry").hasValue()&&!this.attribute("rx").hasValue()&&($=t),$=Math.min($,X/2),t=Math.min(t,w/2),null!=M){M.beginPath();var J=Math.max($,t);0===J?M.rect(q,N,X,w):e.Default.drawRoundRect(M,q,N,X,w,J)}return new E.BoundingBox(q,N,q+X,N+w)}},E.Element.rect.prototype=new E.Element.PathElementBase,E.Element.circle=function(M){this.base=E.Element.PathElementBase,this.base(M),this.path=function(M){var q=this.attribute("cx").toPixels("x"),N=this.attribute("cy").toPixels("y"),e=this.attribute("r").toPixels();return null!=M&&(M.beginPath(),M.arc(q,N,e,0,2*Math.PI,!0),M.closePath()),new E.BoundingBox(q-e,N-e,q+e,N+e)}},E.Element.circle.prototype=new E.Element.PathElementBase,E.Element.ellipse=function(M){this.base=E.Element.PathElementBase,this.base(M),this.path=function(M){var q=(Math.sqrt(2)-1)/3*4,N=this.attribute("rx").toPixels("x"),e=this.attribute("ry").toPixels("y"),X=this.attribute("cx").toPixels("x"),w=this.attribute("cy").toPixels("y");return null!=M&&(M.beginPath(),M.moveTo(X,w-e),M.bezierCurveTo(X+q*N,w-e,X+N,w-q*e,X+N,w),M.bezierCurveTo(X+N,w+q*e,X+q*N,w+e,X,w+e),M.bezierCurveTo(X-q*N,w+e,X-N,w+q*e,X-N,w),M.bezierCurveTo(X-N,w-q*e,X-q*N,w-e,X,w-e),M.closePath()),new E.BoundingBox(X-N,w-e,X+N,w+e)}},E.Element.ellipse.prototype=new E.Element.PathElementBase,E.Element.line=function(M){this.base=E.Element.PathElementBase,this.base(M),this.getPoints=function(){return[new E.Point(this.attribute("x1").toPixels("x"),this.attribute("y1").toPixels("y")),new E.Point(this.attribute("x2").toPixels("x"),this.attribute("y2").toPixels("y"))]},this.path=function(M){var q=this.getPoints();return null!=M&&(M.beginPath(),M.moveTo(q[0].x,q[0].y),M.lineTo(q[1].x,q[1].y)),new E.BoundingBox(q[0].x,q[0].y,q[1].x,q[1].y)},this.getMarkers=function(){var M=this.getPoints(),q=M[0].angleTo(M[1]);return[[M[0],q],[M[1],q]]}},E.Element.line.prototype=new E.Element.PathElementBase,E.Element.polyline=function(M){this.base=E.Element.PathElementBase,this.base(M),this.points=E.CreatePath(this.attribute("points").value),this.path=function(M){var q=new E.BoundingBox(this.points[0].x,this.points[0].y);null!=M&&(M.beginPath(),M.moveTo(this.points[0].x,this.points[0].y));for(var N=1;N<this.points.length;N++)q.addPoint(this.points[N].x,this.points[N].y),null!=M&&M.lineTo(this.points[N].x,this.points[N].y);return q},this.getMarkers=function(){for(var M=[],q=0;q<this.points.length-1;q++)M.push([this.points[q],this.points[q].angleTo(this.points[q+1])]);return M.length>0&&M.push([this.points[this.points.length-1],M[M.length-1][1]]),M}},E.Element.polyline.prototype=new E.Element.PathElementBase,E.Element.polygon=function(M){this.base=E.Element.polyline,this.base(M),this.basePath=this.path,this.path=function(M){var q=this.basePath(M);return null!=M&&(M.lineTo(this.points[0].x,this.points[0].y),M.closePath()),q}},E.Element.polygon.prototype=new E.Element.polyline,E.Element.path=function(M){this.base=E.Element.PathElementBase,this.base(M);var q=this.attribute("d").value;q=q.replace(/,/gm," ");for(var N=0;N<2;N++)q=q.replace(/([MmZzLlHhVvCcSsQqTtAa])([^\s])/gm,"$1 $2");q=q.replace(/([^\s])([MmZzLlHhVvCcSsQqTtAa])/gm,"$1 $2"),q=q.replace(/([0-9])([+\-])/gm,"$1 $2");for(var N=0;N<2;N++)q=q.replace(/(\.[0-9]*)(\.)/gm,"$1 $2");q=q.replace(/([Aa](\s+[0-9]+){3})\s+([01])\s*([01])/gm,"$1 $3 $4 "),q=E.compressSpaces(q),q=E.trim(q),this.PathParser=new function(M){this.tokens=M.split(" "),this.reset=function(){this.i=-1,this.command="",this.previousCommand="",this.start=new E.Point(0,0),this.control=new E.Point(0,0),this.current=new E.Point(0,0),this.points=[],this.angles=[]},this.isEnd=function(){return this.i>=this.tokens.length-1},this.isCommandOrEnd=function(){return!!this.isEnd()||null!=this.tokens[this.i+1].match(/^[A-Za-z]$/)},this.isRelativeCommand=function(){switch(this.command){case"m":case"l":case"h":case"v":case"c":case"s":case"q":case"t":case"a":case"z":return!0}return!1},this.getToken=function(){return this.i++,this.tokens[this.i]},this.getScalar=function(){return parseFloat(this.getToken())},this.nextCommand=function(){this.previousCommand=this.command,this.command=this.getToken()},this.getPoint=function(){var M=new E.Point(this.getScalar(),this.getScalar());return this.makeAbsolute(M)},this.getAsControlPoint=function(){var M=this.getPoint();return this.control=M,M},this.getAsCurrentPoint=function(){var M=this.getPoint();return this.current=M,M},this.getReflectedControlPoint=function(){return"c"!=this.previousCommand.toLowerCase()&&"s"!=this.previousCommand.toLowerCase()&&"q"!=this.previousCommand.toLowerCase()&&"t"!=this.previousCommand.toLowerCase()?this.current:new E.Point(2*this.current.x-this.control.x,2*this.current.y-this.control.y)},this.makeAbsolute=function(M){return this.isRelativeCommand()&&(M.x+=this.current.x,M.y+=this.current.y),M},this.addMarker=function(M,q,N){null!=N&&this.angles.length>0&&null==this.angles[this.angles.length-1]&&(this.angles[this.angles.length-1]=this.points[this.points.length-1].angleTo(N)),
this.addMarkerAngle(M,null==q?null:q.angleTo(M))},this.addMarkerAngle=function(M,q){this.points.push(M),this.angles.push(q)},this.getMarkerPoints=function(){return this.points},this.getMarkerAngles=function(){for(var M=0;M<this.angles.length;M++)if(null==this.angles[M])for(var q=M+1;q<this.angles.length;q++)if(null!=this.angles[q]){this.angles[M]=this.angles[q];break}return this.angles}}(q),this.path=function(M){var q=this.PathParser;q.reset();var N=new E.BoundingBox;for(null!=M&&M.beginPath();!q.isEnd();)switch(q.nextCommand(),q.command){case"M":case"m":var e=q.getAsCurrentPoint();for(q.addMarker(e),N.addPoint(e.x,e.y),null!=M&&M.moveTo(e.x,e.y),q.start=q.current;!q.isCommandOrEnd();){var e=q.getAsCurrentPoint();q.addMarker(e,q.start),N.addPoint(e.x,e.y),null!=M&&M.lineTo(e.x,e.y)}break;case"L":case"l":for(;!q.isCommandOrEnd();){var X=q.current,e=q.getAsCurrentPoint();q.addMarker(e,X),N.addPoint(e.x,e.y),null!=M&&M.lineTo(e.x,e.y)}break;case"H":case"h":for(;!q.isCommandOrEnd();){var w=new E.Point((q.isRelativeCommand()?q.current.x:0)+q.getScalar(),q.current.y);q.addMarker(w,q.current),q.current=w,N.addPoint(q.current.x,q.current.y),null!=M&&M.lineTo(q.current.x,q.current.y)}break;case"V":case"v":for(;!q.isCommandOrEnd();){var w=new E.Point(q.current.x,(q.isRelativeCommand()?q.current.y:0)+q.getScalar());q.addMarker(w,q.current),q.current=w,N.addPoint(q.current.x,q.current.y),null!=M&&M.lineTo(q.current.x,q.current.y)}break;case"C":case"c":for(;!q.isCommandOrEnd();){var $=q.current,t=q.getPoint(),J=q.getAsControlPoint(),u=q.getAsCurrentPoint();q.addMarker(u,J,t),N.addBezierCurve($.x,$.y,t.x,t.y,J.x,J.y,u.x,u.y),null!=M&&M.bezierCurveTo(t.x,t.y,J.x,J.y,u.x,u.y)}break;case"S":case"s":for(;!q.isCommandOrEnd();){var $=q.current,t=q.getReflectedControlPoint(),J=q.getAsControlPoint(),u=q.getAsCurrentPoint();q.addMarker(u,J,t),N.addBezierCurve($.x,$.y,t.x,t.y,J.x,J.y,u.x,u.y),null!=M&&M.bezierCurveTo(t.x,t.y,J.x,J.y,u.x,u.y),q.previousCommand=q.command}break;case"Q":case"q":for(;!q.isCommandOrEnd();){var $=q.current,J=q.getAsControlPoint(),u=q.getAsCurrentPoint();q.addMarker(u,J,J),N.addQuadraticCurve($.x,$.y,J.x,J.y,u.x,u.y),null!=M&&M.quadraticCurveTo(J.x,J.y,u.x,u.y)}break;case"T":case"t":for(;!q.isCommandOrEnd();){var $=q.current,J=q.getReflectedControlPoint();q.control=J;var u=q.getAsCurrentPoint();q.addMarker(u,J,J),N.addQuadraticCurve($.x,$.y,J.x,J.y,u.x,u.y),null!=M&&M.quadraticCurveTo(J.x,J.y,u.x,u.y),q.previousCommand=q.command}break;case"A":case"a":for(;!q.isCommandOrEnd();){var $=q.current,g=q.getScalar(),S=q.getScalar(),b=q.getScalar()*(Math.PI/180),h=q.getScalar(),y=q.getScalar(),u=q.getAsCurrentPoint(),P=new E.Point(Math.cos(b)*($.x-u.x)/2+Math.sin(b)*($.y-u.y)/2,-Math.sin(b)*($.x-u.x)/2+Math.cos(b)*($.y-u.y)/2),f=Math.pow(P.x,2)/Math.pow(g,2)+Math.pow(P.y,2)/Math.pow(S,2);if(f<1e-6)q.addMarker(u,$),N.addPoint(u.x,u.y),null!=M&&M.lineTo(u.x,u.y);else{f>1&&(g*=Math.sqrt(f),S*=Math.sqrt(f));var x=(h==y?-1:1)*Math.sqrt((Math.pow(g,2)*Math.pow(S,2)-Math.pow(g,2)*Math.pow(P.y,2)-Math.pow(S,2)*Math.pow(P.x,2))/(Math.pow(g,2)*Math.pow(P.y,2)+Math.pow(S,2)*Math.pow(P.x,2)));isNaN(x)&&(x=0);var n=new E.Point(x*g*P.y/S,x*-S*P.x/g),R=new E.Point(($.x+u.x)/2+Math.cos(b)*n.x-Math.sin(b)*n.y,($.y+u.y)/2+Math.sin(b)*n.x+Math.cos(b)*n.y),G=function(M){return Math.sqrt(Math.pow(M[0],2)+Math.pow(M[1],2))},j=function(M,q){return(M[0]*q[0]+M[1]*q[1])/(G(M)*G(q))},K=function(M,q){return(M[0]*q[1]<M[1]*q[0]?-1:1)*Math.acos(j(M,q))},p=K([1,0],[(P.x-n.x)/g,(P.y-n.y)/S]),C=[(P.x-n.x)/g,(P.y-n.y)/S],m=[(-P.x-n.x)/g,(-P.y-n.y)/S],O=K(C,m);j(C,m)<=-1&&(O=Math.PI),j(C,m)>=1&&(O=0);var Q=1-y?1:-1,s=p+Q*(O/2),l=new E.Point(R.x+g*Math.cos(s),R.y+S*Math.sin(s));if(q.addMarkerAngle(l,s-Q*Math.PI/2),q.addMarkerAngle(u,s-Q*Math.PI),N.addPoint(u.x,u.y),null!=M){var j=g>S?g:S,Y=g>S?1:g/S,I=g>S?S/g:1;M.translate(R.x,R.y),M.rotate(b),M.scale(Y,I),M.arc(0,0,j,p,p+O,1-y),M.scale(1/Y,1/I),M.rotate(-b),M.translate(-R.x,-R.y)}}}break;case"Z":case"z":null!=M&&M.closePath(),q.current=q.start}return N},this.getMarkers=function(){for(var M=this.PathParser.getMarkerPoints(),q=this.PathParser.getMarkerAngles(),N=[],e=0;e<M.length;e++)N.push([M[e],q[e]]);return N}},E.Element.path.prototype=new E.Element.PathElementBase,E.Element.pattern=function(M){this.base=E.Element.ElementBase,this.base(M),this.createPattern=function(M,q){var N=this.attribute("width").toPixels("x",!0),e=this.attribute("height").toPixels("y",!0),X=new E.Element.svg;X.attributes.viewBox=new E.Property("viewBox",this.attribute("viewBox").value),X.attributes.width=new E.Property("width",N+"px"),X.attributes.height=new E.Property("height",e+"px"),X.attributes.transform=new E.Property("transform",this.attribute("patternTransform").value),X.children=this.children;var w=document.createElement("canvas");w.width=N,w.height=e;var $=w.getContext("2d");this.attribute("x").hasValue()&&this.attribute("y").hasValue()&&$.translate(this.attribute("x").toPixels("x",!0),this.attribute("y").toPixels("y",!0));for(var t=-1;t<=1;t++)for(var J=-1;J<=1;J++)$.save(),X.attributes.x=new E.Property("x",t*w.width),X.attributes.y=new E.Property("y",J*w.height),X.render($),$.restore();return M.createPattern(w,"repeat")}},E.Element.pattern.prototype=new E.Element.ElementBase,E.Element.marker=function(M){this.base=E.Element.ElementBase,this.base(M),this.baseRender=this.render,this.render=function(M,q,e,X,w){if(w!==N){e=(e+w)/2;var $=(e-w)%(2*Math.PI);Math.abs($)>Math.PI&&(e+=Math.PI)}if(q){M.save(),M.translate(q.x,q.y);var t=this.attribute("orient").valueOrDefault("auto")||"";"auto"===t?M.rotate(e):"auto-start-reverse"===t?M.rotate("start"===X?e+Math.PI:e):t&&M.rotate(new E.Property("angle",t).toRadians()),"strokeWidth"==this.attribute("markerUnits").valueOrDefault("strokeWidth")&&M.scale(M.lineWidth,M.lineWidth);var J=new E.Element.svg;J.attributes.viewBox=new E.Property("viewBox",this.attribute("viewBox").value),J.attributes.refX=new E.Property("refX",parseFloat(this.attribute("refX").value)),J.attributes.refY=new E.Property("refY",parseFloat(this.attribute("refY").value)),J.attributes.width=new E.Property("width",this.attribute("markerWidth").value),J.attributes.height=new E.Property("height",this.attribute("markerHeight").value),J.attributes.fill=new E.Property("fill",this.attribute("fill").valueOrDefault("black")),J.attributes.stroke=new E.Property("stroke",this.attribute("stroke").valueOrDefault("none")),J.children=this.children,J.render(M),M.restore()}}},E.Element.marker.prototype=new E.Element.ElementBase,E.Element.defs=function(M){this.base=E.Element.ElementBase,this.base(M),this.render=function(M){}},E.Element.defs.prototype=new E.Element.ElementBase,E.Element.GradientBase=function(M){this.base=E.Element.ElementBase,this.base(M),this.stops=[];for(var q=0;q<this.children.length;q++){var N=this.children[q];"stop"==N.type&&this.stops.push(N)}this.getGradient=function(){},this.gradientUnits=function(){return this.attribute("gradientUnits").valueOrDefault("objectBoundingBox")},this.attributesToInherit=["gradientUnits","gradientTransform"],this.inheritStopContainer=function(M){for(var q=0;q<this.attributesToInherit.length;q++){var N=this.attributesToInherit[q];!this.attribute(N).hasValue()&&M.attribute(N).hasValue()&&(this.attribute(N,!0).value=M.attribute(N).value)}},this.createGradient=function(M,q,N){var e=this;this.getHrefAttribute().hasValue()&&(e=this.getHrefAttribute().getDefinition(),this.inheritStopContainer(e));var X=function(M){if(N.hasValue()){return new E.Property("color",M).addOpacity(N).value}return M},w=this.getGradient(M,q);if(null==w)return X(e.stops[e.stops.length-1].color);for(var $=0;$<e.stops.length;$++)w.addColorStop(e.stops[$].offset,X(e.stops[$].color));return w}},E.Element.GradientBase.prototype=new E.Element.ElementBase,E.Element.linearGradient=function(M){this.base=E.Element.GradientBase,this.base(M),this.attributesToInherit.push("x1"),this.attributesToInherit.push("y1"),this.attributesToInherit.push("x2"),this.attributesToInherit.push("y2"),this.getGradient=function(M,q){this.attribute("x1").hasValue()||this.attribute("y1").hasValue()||this.attribute("x2").hasValue()||this.attribute("y2").hasValue()||(this.attribute("x1",!0).value=0,this.attribute("y1",!0).value=0,this.attribute("x2",!0).value=1,this.attribute("y2",!0).value=0);var N="objectBoundingBox"==this.gradientUnits(),X=N?1*this.attribute("x1").numValue():this.attribute("x1").toPixels("x"),w=N?1*this.attribute("y1").numValue():this.attribute("y1").toPixels("y"),$=N?1*this.attribute("x2").numValue():this.attribute("x2").toPixels("x"),t=N?1*this.attribute("y2").numValue():this.attribute("y2").toPixels("y"),J=this.attribute("gradientTransform");if(J.hasValue()){var u=new E.Transform(J.value),g=(new e.Math.Matrix2d).fromArray(u.getMatrix()),S=g.tf(X,w);X=S.x,w=S.y,S=g.tf($,t),$=S.x,t=S.y}else{var b=q.attribute("transform");if(b.hasValue())var h=new E.Transform(b.value)}var y=null;if(X!=$||w!=t){if(N){var P=q.getBoundingBox(),f=P.width(),x=P.height();X*=f,$*=f,w*=x,t*=x;var n=P.x(),R=P.y();X+=n,$+=n,w+=R,t+=R}h&&h.apply(M),y=M.createLinearGradient(X,w,$,t),h&&h.unapply(M)}return y}},E.Element.linearGradient.prototype=new E.Element.GradientBase,E.Element.radialGradient=function(M){this.base=E.Element.GradientBase,this.base(M),this.attributesToInherit.push("cx"),this.attributesToInherit.push("cy"),this.attributesToInherit.push("r"),this.attributesToInherit.push("fx"),this.attributesToInherit.push("fy"),this.getGradient=function(M,q){this.attribute("cx").hasValue()||(this.attribute("cx",!0).value="50%"),this.attribute("cy").hasValue()||(this.attribute("cy",!0).value="50%"),this.attribute("r").hasValue()||(this.attribute("r",!0).value="50%");var N="objectBoundingBox"==this.gradientUnits(),X=N?1*this.attribute("cx").numValue():this.attribute("cx").toPixels("x"),w=N?1*this.attribute("cy").numValue():this.attribute("cy").toPixels("y"),$=X,t=w;this.attribute("fx").hasValue()&&($=N?1*this.attribute("fx").numValue():this.attribute("fx").toPixels("x")),this.attribute("fy").hasValue()&&(t=N?1*this.attribute("fy").numValue():this.attribute("fy").toPixels("y"));var J=N?1*this.attribute("r").numValue():this.attribute("r").toPixels(),u=this.attribute("gradientTransform");if(u.hasValue()){var g=new E.Transform(u.value),S=(new e.Math.Matrix2d).fromArray(g.getMatrix()),b=S.tf($,t);$=b.x,t=b.y,b=S.tf(X,w),X=b.x,w=b.y}else{var h=q.attribute("transform");if(h.hasValue())var y=new E.Transform(h.value)}if(N){var P=q.getBoundingBox(),f=P.width(),x=P.height();$*=f,X*=f,t*=x,w*=x;var n=P.x(),R=P.y();$+=n,X+=n,t+=R,w+=R,J*=Math.min(f,x)}y&&y.apply(M);var G=M.createRadialGradient($,t,0,X,w,J);return y&&y.unapply(M),G}},E.Element.radialGradient.prototype=new E.Element.GradientBase,E.Element.stop=function(M){this.base=E.Element.ElementBase,this.base(M),this.offset=this.attribute("offset").numValue(),this.offset<0&&(this.offset=0),this.offset>1&&(this.offset=1);var q=this.style("stop-color",!0);""===q.value&&(q.value="#000");var N=q.value;N&&"#"===N[0]&&(N=parseInt(N.substr(1),16),isNaN(N)&&(q.value="#000")),this.style("stop-opacity").hasValue()&&(q=q.addOpacity(this.style("stop-opacity"))),this.color=q.value},E.Element.stop.prototype=new E.Element.ElementBase,E.Element.AnimateBase=function(M){this.base=E.Element.ElementBase,this.base(M),E.Animations.push(this),this.duration=0,this.begin=this.attribute("begin").toMilliseconds(),this.maxDuration=this.begin+this.attribute("dur").toMilliseconds(),this.getProperty=function(){var M=this.attribute("attributeType").value,q=this.attribute("attributeName").value;return"CSS"==M?this.parent.style(q,!0):this.parent.attribute(q,!0)},this.initialValue=null,this.initialUnits="",this.removed=!1,this.calcValue=function(){return""},this.update=function(M){if(null==this.initialValue&&(this.initialValue=this.getProperty().value,this.initialUnits=this.getProperty().getUnits()),this.duration>this.maxDuration){if("indefinite"==this.attribute("repeatCount").value||"indefinite"==this.attribute("repeatDur").value)this.duration=0;else if("freeze"!=this.attribute("fill").valueOrDefault("remove")||this.frozen){if("remove"==this.attribute("fill").valueOrDefault("remove")&&!this.removed)return this.removed=!0,this.getProperty().value=this.parent.animationFrozen?this.parent.animationFrozenValue:this.initialValue,!0}else this.frozen=!0,this.parent.animationFrozen=!0,this.parent.animationFrozenValue=this.getProperty().value;return!1}this.duration=this.duration+M;var q=!1;if(this.begin<this.duration){var N=this.calcValue();if(this.attribute("type").hasValue()){N=this.attribute("type").value+"("+N+")"}this.getProperty().value=N,q=!0}return q},this.from=this.attribute("from"),this.to=this.attribute("to"),this.values=this.attribute("values"),this.values.hasValue()&&(this.values.value=this.values.value.split(";")),this.progress=function(){var M={progress:(this.duration-this.begin)/(this.maxDuration-this.begin)};if(this.values.hasValue()){var q=M.progress*(this.values.value.length-1),N=Math.floor(q),e=Math.ceil(q);M.from=new E.Property("from",parseFloat(this.values.value[N])),M.to=new E.Property("to",parseFloat(this.values.value[e])),M.progress=(q-N)/(e-N)}else M.from=this.from,M.to=this.to;return M}},E.Element.AnimateBase.prototype=new E.Element.ElementBase,E.Element.animate=function(M){this.base=E.Element.AnimateBase,this.base(M),this.calcValue=function(){var M=this.progress();return M.from.numValue()+(M.to.numValue()-M.from.numValue())*M.progress+this.initialUnits}},E.Element.animate.prototype=new E.Element.AnimateBase,E.Element.animateColor=function(M){this.base=E.Element.AnimateBase,this.base(M),this.calcValue=function(){var M=this.progress(),q=new X(M.from.value),N=new X(M.to.value);if(q.ok&&N.ok){var e=q.r+(N.r-q.r)*M.progress,w=q.g+(N.g-q.g)*M.progress,$=q.b+(N.b-q.b)*M.progress;return"rgb("+parseInt(e,10)+","+parseInt(w,10)+","+parseInt($,10)+")"}return this.attribute("from").value}},E.Element.animateColor.prototype=new E.Element.AnimateBase,E.Element.animateTransform=function(M){this.base=E.Element.AnimateBase,this.base(M),this.calcValue=function(){for(var M=this.progress(),q=E.ToNumberArray(M.from.value),N=E.ToNumberArray(M.to.value),e="",X=0;X<q.length;X++)e+=q[X]+(N[X]-q[X])*M.progress+" ";return e}},E.Element.animateTransform.prototype=new E.Element.animate,E.Element.font=function(M){this.base=E.Element.ElementBase,this.base(M),this.horizAdvX=this.attribute("horiz-adv-x").numValue(),this.isRTL=!1,this.isArabic=!1,this.fontFace=null,this.missingGlyph=null,this.glyphs=[];for(var q=0;q<this.children.length;q++){var N=this.children[q];"font-face"==N.type?(this.fontFace=N,N.style("font-family").hasValue()&&(E.Definitions[N.style("font-family").value]=this)):"missing-glyph"==N.type?this.missingGlyph=N:"glyph"==N.type&&(""!=N.arabicForm?(this.isRTL=!0,this.isArabic=!0,void 0===this.glyphs[N.unicode]&&(this.glyphs[N.unicode]=[]),this.glyphs[N.unicode][N.arabicForm]=N):this.glyphs[N.unicode]=N)}},E.Element.font.prototype=new E.Element.ElementBase,E.Element.fontface=function(M){this.base=E.Element.ElementBase,this.base(M),this.ascent=this.attribute("ascent").value,this.descent=this.attribute("descent").value,this.unitsPerEm=this.attribute("units-per-em").numValue()},E.Element.fontface.prototype=new E.Element.ElementBase,E.Element.missingglyph=function(M){this.base=E.Element.path,this.base(M),this.horizAdvX=0},E.Element.missingglyph.prototype=new E.Element.path,E.Element.glyph=function(M){this.base=E.Element.path,this.base(M),this.horizAdvX=this.attribute("horiz-adv-x").numValue(),this.unicode=this.attribute("unicode").value,this.arabicForm=this.attribute("arabic-form").value},E.Element.glyph.prototype=new E.Element.path,E.Element.text=function(M){this.captureTextNodes=!0,this.base=E.Element.RenderedElementBase,this.base(M),this.baseSetContext=this.setContext,this.setContext=function(M){this.baseSetContext(M);var q=this.style("dominant-baseline").toTextBaseline();null==q&&(q=this.style("alignment-baseline").toTextBaseline()),null!=q&&(M.textBaseline=q)},this.getBoundingBox=function(){var M=this.attribute("x").toPixels("x"),q=this.attribute("y").toPixels("y"),N=this.parent.style("font-size").numValueOrDefault(E.Font.Parse(E.ctx.font).fontSize);return new E.BoundingBox(M,q-N,M+Math.floor(2*N/3)*this.children[0].getText().length,q)},this.renderChildren=function(M){this.x=this.attribute("x").toPixels("x"),this.y=this.attribute("y").toPixels("y"),this.attribute("dx").hasValue()&&(this.x+=this.attribute("dx").toPixels("x")),this.attribute("dy").hasValue()&&(this.y+=this.attribute("dy").toPixels("y")),this.x+=this.getAnchorDelta(M,this,0);for(var q=0;q<this.children.length;q++)this.renderChild(M,this,this,q)},this.getAnchorDelta=function(M,q,N){var e=this.style("text-anchor").valueOrDefault("start");if("start"!=e){for(var X=0,w=N;w<q.children.length;w++){var $=q.children[w];if(w>N&&$.attribute("x").hasValue())break;$.measureTextRecursive&&(X+=$.measureTextRecursive(M))}return-1*("end"==e?X:X/2)}return 0},this.renderChild=function(M,q,N,e){var X=N.children[e];X.attribute("x").hasValue()?(X.x=X.attribute("x").toPixels("x")+q.getAnchorDelta(M,N,e),X.attribute("dx").hasValue()&&(X.x+=X.attribute("dx").toPixels("x"))):(X.attribute("dx").hasValue()&&(q.x+=X.attribute("dx").toPixels("x")),X.x=q.x),q.x=X.x+(X.measureText?X.measureText(M):0),X.attribute("y").hasValue()?(X.y=X.attribute("y").toPixels("y"),X.attribute("dy").hasValue()&&(X.y+=X.attribute("dy").toPixels("y"))):(X.attribute("dy").hasValue()&&(q.y+=X.attribute("dy").toPixels("y")),X.y=q.y),q.y=X.y,X.render(M);for(var e=0;e<X.children.length;e++)q.renderChild(M,q,X,e)}},E.Element.text.prototype=new E.Element.RenderedElementBase,E.Element.TextElementBase=function(M){this.base=E.Element.RenderedElementBase,this.base(M),this.getGlyph=function(M,q,N){var e=q[N],X=null;if(M.isArabic){var w="isolated";(0==N||" "==q[N-1])&&N<q.length-2&&" "!=q[N+1]&&(w="terminal"),N>0&&" "!=q[N-1]&&N<q.length-2&&" "!=q[N+1]&&(w="medial"),N>0&&" "!=q[N-1]&&(N==q.length-1||" "==q[N+1])&&(w="initial"),void 0!==M.glyphs[e]&&null==(X=M.glyphs[e][w])&&"glyph"==M.glyphs[e].type&&(X=M.glyphs[e])}else X=M.glyphs[e];return null==X&&(X=M.missingGlyph),X},this.renderChildren=function(M){var q=this.parent.style("font-family").getDefinition();if(null==q){var N={};if(this.parent.styles){this.parent.styles["text-decoration"]&&"underline"==this.parent.styles["text-decoration"].value&&(N.underline=!0);for(var e,X=this.parent,w=0;w<2&&X&&!N.vertical;){if(e=X.attributes["writing-mode"]){var $=e.value;if("tb-rl"==$||"tb"==$){N.vertical=!0;break}}if(e=X.styles["writing-mode"]){var $=e.value;if("tb-rl"==$||"tb"==$){N.vertical=!0;break}}X=X.parent,w++}}""!=M.fillStyle&&M.fillText(E.compressSpaces(this.getText()),this.x,this.y,N),""!=M.strokeStyle&&M.strokeText(E.compressSpaces(this.getText()),this.x,this.y,N)}else{var t=this.parent.style("font-size").numValueOrDefault(E.Font.Parse(E.ctx.font).fontSize),J=this.parent.style("font-style").valueOrDefault(E.Font.Parse(E.ctx.font).fontStyle),u=this.getText();q.isRTL&&(u=u.split("").reverse().join(""));for(var g=E.ToNumberArray(this.parent.attribute("dx").value),w=0;w<u.length;w++){var S=this.getGlyph(q,u,w),b=t/q.fontFace.unitsPerEm;M.translate(this.x,this.y),M.scale(b,-b);var h=M.lineWidth;M.lineWidth=M.lineWidth*q.fontFace.unitsPerEm/t,"italic"==J&&M.transform(1,0,.4,1,0,0),S.render(M),"italic"==J&&M.transform(1,0,-.4,1,0,0),M.lineWidth=h,M.scale(1/b,-1/b),M.translate(-this.x,-this.y),this.x+=t*(S.horizAdvX||q.horizAdvX)/q.fontFace.unitsPerEm,void 0===g[w]||isNaN(g[w])||(this.x+=g[w])}}},this.getText=function(){},this.measureTextRecursive=function(M){for(var q=this.measureText(M),N=0;N<this.children.length;N++)q+=this.children[N].measureTextRecursive(M);return q},this.measureText=function(M){var q=this.parent.style("font-family").getDefinition();if(null!=q){var N=this.parent.style("font-size").numValueOrDefault(E.Font.Parse(E.ctx.font).fontSize),e=0,X=this.getText();q.isRTL&&(X=X.split("").reverse().join(""));for(var w=E.ToNumberArray(this.parent.attribute("dx").value),$=0;$<X.length;$++){e+=(this.getGlyph(q,X,$).horizAdvX||q.horizAdvX)*N/q.fontFace.unitsPerEm,void 0===w[$]||isNaN(w[$])||(e+=w[$])}return e}var t=E.compressSpaces(this.getText());if(!M.measureText)return 10*t.length;M.save(),this.setContext(M,!0);var J=M.measureText(t).width;return this.clearContext(M),M.restore(),J},this.getBoundingBox=function(){var M=this.parent.style("font-size").numValueOrDefault(E.Font.Parse(E.ctx.font).fontSize);return new E.BoundingBox(this.x,this.y-M,this.x+this.measureText(E.ctx),this.y)}},E.Element.TextElementBase.prototype=new E.Element.RenderedElementBase,E.Element.tspan=function(M){this.captureTextNodes=!0,this.base=E.Element.TextElementBase,this.base(M),this.text=E.compressSpaces(M.value||M.text||M.textContent||""),this.getText=function(){return this.children.length>0?"":this.text}},E.Element.tspan.prototype=new E.Element.TextElementBase,E.Element.tref=function(M){this.base=E.Element.TextElementBase,this.base(M),this.getText=function(){var M=this.getHrefAttribute().getDefinition();if(null!=M)return M.children[0].getText()}},E.Element.tref.prototype=new E.Element.TextElementBase,E.Element.a=function(q){this.base=E.Element.TextElementBase,this.base(q),this.hasText=q.childNodes.length>0;for(var N=0;N<q.childNodes.length;N++)3!=q.childNodes[N].nodeType&&(this.hasText=!1);this.text=this.hasText?q.childNodes[0].value:"",this.getText=function(){return this.text},this.baseRenderChildren=this.renderChildren,this.renderChildren=function(M){if(this.hasText){this.baseRenderChildren(M);var q=new E.Property("fontSize",E.Font.Parse(E.ctx.font).fontSize);E.Mouse.checkBoundingBox(this,new E.BoundingBox(this.x,this.y-q.toPixels("y"),this.x+this.measureText(M),this.y))}else if(this.children.length>0){var N=new E.Element.g;N.children=this.children,N.parent=this,N.render(M)}},this.onclick=function(){M.open(this.getHrefAttribute().value)},this.onmousemove=function(){E.ctx.canvas.style.cursor="pointer"}},E.Element.a.prototype=new E.Element.TextElementBase,E.Element.image=function(M){this.base=E.Element.RenderedElementBase,this.base(M);var q=this.getHrefAttribute().value;if(""!=q){var N=q.match(/\.svg$/);if(E.Images.push(this),this.loaded=!1,N)this.img=E.ajax(q),this.loaded=!0;else{this.img=document.createElement("img"),1==E.opts.useCORS&&(this.img.crossOrigin="Anonymous");var e=this;this.img.onload=function(){e.loaded=!0},this.img.onerror=function(){E.log('ERROR: image "'+q+'" not found'),e.loaded=!0},this.img.src=q}this.renderChildren=function(M){var q=this.attribute("x").toPixels("x"),e=this.attribute("y").toPixels("y"),X=this.attribute("width").toPixels("x"),w=this.attribute("height").toPixels("y");0!=X&&0!=w&&(M.save(),N?M.drawSvg(this.img,q,e,X,w):(M.translate(q,e),E.AspectRatio(M,this.attribute("preserveAspectRatio").value,X,this.img.width,w,this.img.height,0,0),M.drawImage(this.img,0,0)),M.restore())},this.getBoundingBox=function(){var M=this.attribute("x").toPixels("x"),q=this.attribute("y").toPixels("y"),N=this.attribute("width").toPixels("x"),e=this.attribute("height").toPixels("y");return new E.BoundingBox(M,q,M+N,q+e)}}},E.Element.image.prototype=new E.Element.RenderedElementBase,E.Element.g=function(M){this.base=E.Element.RenderedElementBase,this.base(M),this.getBoundingBox=function(){for(var M=new E.BoundingBox,q=0;q<this.children.length;q++)M.addBoundingBox(this.children[q].getBoundingBox());return M}},E.Element.g.prototype=new E.Element.RenderedElementBase,E.Element.symbol=function(M){this.base=E.Element.RenderedElementBase,this.base(M),this.render=function(M){}},E.Element.symbol.prototype=new E.Element.RenderedElementBase,E.Element.switch=function(M){this.base=E.Element.RenderedElementBase,this.base(M)},E.Element.switch.prototype=new E.Element.symbol,E.Element.style=function(M){this.base=E.Element.ElementBase,this.base(M);for(var q="",N=0;N<M.childNodes.length;N++)q+=M.childNodes[N].data;q=q.replace(/(\/\*([^*]|[\r\n]|(\*+([^*\/]|[\r\n])))*\*+\/)|(^[\s]*\/\/.*)/gm,""),q=E.compressSpaces(q);for(var e=q.split("}"),N=0;N<e.length;N++)if(""!=E.trim(e[N]))for(var X=e[N].split("{"),w=X[0].split(","),$=X[1].split(";"),J=0;J<w.length;J++){var u=E.trim(w[J]);if(""!=u){for(var g=E.Styles[u]||{},S=0;S<$.length;S++){var b=$[S].indexOf(":"),h=$[S].substr(0,b),y=$[S].substr(b+1,$[S].length-b);null!=h&&null!=y&&(g[E.trim(h)]=new E.Property(E.trim(h),E.trim(y)))}if(E.Styles[u]=g,E.StylesSpecificity[u]=t(u),"@font-face"==u)for(var P=g["font-family"].value.replace(/"/g,""),f=g.src.value.split(","),x=0;x<f.length;x++)if(f[x].indexOf('format("svg")')>0)for(var n=f[x].indexOf("url"),R=f[x].indexOf(")",n),G=f[x].substr(n+5,R-n-6),j=E.parseXml(E.ajax(G)),K=j.getElementsByTagName("font"),p=0;p<K.length;p++){var C=E.CreateElement(K[p]);E.Definitions[P]=C}}}},E.Element.style.prototype=new E.Element.ElementBase,E.Element.use=function(M){this.base=E.Element.RenderedElementBase,this.base(M),this.baseSetContext=this.setContext,this.setContext=function(M){this.baseSetContext(M),this.attribute("x").hasValue()&&M.translate(this.attribute("x").toPixels("x"),0),this.attribute("y").hasValue()&&M.translate(0,this.attribute("y").toPixels("y"))};var q=this.getHrefAttribute().getDefinition();this.path=function(M){null!=q&&q.path(M)},this.getBoundingBox=function(){if(null!=q)return q.getBoundingBox()},this.renderChildren=function(M){if(null!=q){var N=q;"symbol"==q.type&&(N=new E.Element.svg,N.type="svg",N.attributes.viewBox=new E.Property("viewBox",q.attribute("viewBox").value),N.attributes.preserveAspectRatio=new E.Property("preserveAspectRatio",q.attribute("preserveAspectRatio").value),N.attributes.overflow=new E.Property("overflow",q.attribute("overflow").value),N.children=q.children),"svg"==N.type&&(this.attribute("width").hasValue()&&(N.attributes.width=new E.Property("width",this.attribute("width").value)),this.attribute("height").hasValue()&&(N.attributes.height=new E.Property("height",this.attribute("height").value)));var e=N.parent;N.parent=null,N.render(M),N.parent=e}}},E.Element.use.prototype=new E.Element.RenderedElementBase,E.Element.mask=function(M){this.base=E.Element.ElementBase,this.base(M),this.apply=function(M,q){var N=this.attribute("x").toPixels("x"),e=this.attribute("y").toPixels("y"),X=this.attribute("width").toPixels("x"),w=this.attribute("height").toPixels("y"),$=1;if(0==X&&0==w){for(var t=new E.BoundingBox,J=0;J<this.children.length;J++)this.children[J].getBoundingBox&&t.addBoundingBox(this.children[J].getBoundingBox());N=Math.floor(t.x1),e=Math.floor(t.y1),X=Math.floor(t.width()),w=Math.floor(t.height())}if(X&&w){var u=N+X,g=e+w;(u>2048||g>2048)&&($=Math.min(2048/u,2048/g),u*=$,g*=$);var S=q.style("mask").value;q.style("mask").value="";var b=document.createElement("canvas");b.width=u,b.height=g;var h=b.getContext("2d");if(h.save(),1!==$&&h.scale($,$),this.renderChildren(h),h.restore(),b.width&&b.height){var y=document.createElement("canvas");y.width=u,y.height=g;var P=y.getContext("2d");P.save(),1!==$&&P.scale($,$),q.render(P),P.restore(),P.globalCompositeOperation="destination-in",P.fillStyle=h.createPattern(b,"no-repeat"),P.fillRect(0,0,u,g),M.save(),1!==$&&M.scale(1/$,1/$),M.fillStyle=P.createPattern(y,"no-repeat"),M.fillRect(0,0,u,g),M.restore(),q.style("mask").value=S}}},this.render=function(M){}},E.Element.mask.prototype=new E.Element.ElementBase,E.Element.clipPath=function(M){this.base=E.Element.ElementBase,this.base(M),this.apply=function(M){var q=M.beginPath;M.beginPath=function(){};var N=M.closePath;M.closePath=function(){};var e;this.style("transform",!1,!0).hasValue()&&(e=new E.Transform(this.style("transform",!1,!0).value),e.apply(M)),q.call(M);for(var X=0;X<this.children.length;X++){var w=this.children[X];if(void 0!==w.path){var $=null;w.style("transform",!1,!0).hasValue()&&($=new E.Transform(w.style("transform",!1,!0).value),$.apply(M)),w.path(M),M.closePath=N,$&&$.unapply(M)}}N.call(M),M.clip(),e&&e.unapply(M),M.beginPath=q,M.closePath=N},this.render=function(M){}},E.Element.clipPath.prototype=new E.Element.ElementBase,E.Element.filter=function(M){this.base=E.Element.ElementBase,this.base(M),this.apply=function(M,q){return},this.render=function(M){}},E.Element.filter.prototype=new E.Element.ElementBase,E.Element.feMorphology=function(M){this.base=E.Element.ElementBase,this.base(M),this.apply=function(M,q,N,e,X){}},E.Element.feMorphology.prototype=new E.Element.ElementBase,E.Element.feComposite=function(M){this.base=E.Element.ElementBase,this.base(M),this.apply=function(M,q,N,e,X){}},E.Element.feComposite.prototype=new E.Element.ElementBase,E.Element.feColorMatrix=function(M){function q(M,q,N,e,X,w){return M[N*e*4+4*q+w]}function N(M,q,N,e,X,w,$){M[N*e*4+4*q+w]=$}function e(M,q){var N=X[M];return N*(N<0?q-255:q)}this.base=E.Element.ElementBase,this.base(M);var X=E.ToNumberArray(this.attribute("values").value);switch(this.attribute("type").valueOrDefault("matrix")){case"saturate":var w=X[0];X=[.213+.787*w,.715-.715*w,.072-.072*w,0,0,.213-.213*w,.715+.285*w,.072-.072*w,0,0,.213-.213*w,.715-.715*w,.072+.928*w,0,0,0,0,0,1,0,0,0,0,0,1];break;case"hueRotate":var $=X[0]*Math.PI/180,t=function(M,q,N){return M+Math.cos($)*q+Math.sin($)*N};X=[t(.213,.787,-.213),t(.715,-.715,-.715),t(.072,-.072,.928),0,0,t(.213,-.213,.143),t(.715,.285,.14),t(.072,-.072,-.283),0,0,t(.213,-.213,-.787),t(.715,-.715,.715),t(.072,.928,.072),0,0,0,0,0,1,0,0,0,0,0,1];break;case"luminanceToAlpha":X=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,.2125,.7154,.0721,0,0,0,0,0,0,1]}this.apply=function(M,X,w,$,t){if($&&t){for(var E=M.getImageData(0,0,$,t),w=0;w<t;w++)for(var X=0;X<$;X++){var J=q(E.data,X,w,$,t,0),u=q(E.data,X,w,$,t,1),g=q(E.data,X,w,$,t,2),S=q(E.data,X,w,$,t,3);N(E.data,X,w,$,t,0,e(0,J)+e(1,u)+e(2,g)+e(3,S)+e(4,1)),N(E.data,X,w,$,t,1,e(5,J)+e(6,u)+e(7,g)+e(8,S)+e(9,1)),N(E.data,X,w,$,t,2,e(10,J)+e(11,u)+e(12,g)+e(13,S)+e(14,1)),N(E.data,X,w,$,t,3,e(15,J)+e(16,u)+e(17,g)+e(18,S)+e(19,1))}M.clearRect(0,0,$,t),M.putImageData(E,0,0)}}},E.Element.feColorMatrix.prototype=new E.Element.ElementBase,E.Element.feGaussianBlur=function(M){this.base=E.Element.ElementBase,this.base(M),this.blurRadius=Math.floor(this.attribute("stdDeviation").numValue()),this.extraFilterDistance=this.blurRadius,this.apply=function(M,q,N,e,X){if(void 0===w.canvasRGBA)return void E.log("ERROR: StackBlur.js must be included for blur to work");M.canvas.id=E.UniqueId(),M.canvas.style.display="none",document.body.appendChild(M.canvas),w.canvasRGBA(M.canvas.id,q,N,e,X,this.blurRadius),document.body.removeChild(M.canvas)}},E.Element.feGaussianBlur.prototype=new E.Element.ElementBase,E.Element.title=function(M){},E.Element.title.prototype=new E.Element.ElementBase,E.Element.desc=function(M){},E.Element.desc.prototype=new E.Element.ElementBase,E.Element.MISSING=function(M){E.log("ERROR: Element '"+M.nodeName+"' not yet implemented.")},E.Element.MISSING.prototype=new E.Element.ElementBase,E.CreateElement=function(M){var q=M.nodeName.replace(/^[^:]+:/,"");q=q.replace(/\-/g,"");var N=null;return N=void 0!==E.Element[q]?new E.Element[q](M):new E.Element.MISSING(M),N.type=M.nodeName,N},E.load=function(M,q){E.loadXml(M,E.ajax(q))},E.loadXml=function(M,q){E.loadXmlDoc(M,E.parseXml(q))},E.loadXmlDoc=function(q,N){E.prepareDOM(N),E.init(q);var e=function(N){for(var e=q.canvas;e;)N.x-=e.offsetLeft,N.y-=e.offsetTop,e=e.offsetParent;return M.scrollX&&(N.x+=M.scrollX),M.scrollY&&(N.y+=M.scrollY),N};1!=E.opts.ignoreMouse&&(q.canvas.onclick=function(M){var q=e(new E.Point(null!=M?M.clientX:event.clientX,null!=M?M.clientY:event.clientY));E.Mouse.onclick(q.x,q.y)},q.canvas.onmousemove=function(M){var q=e(new E.Point(null!=M?M.clientX:event.clientX,null!=M?M.clientY:event.clientY));E.Mouse.onmousemove(q.x,q.y)});var X=E.CreateElement(N.documentElement);X.root=!0,X.addStylesFromStyleDefinition();var w=!0,$=function(){var M=!1;q.canvas.parentElement||(M=!0,document.body.appendChild(q.canvas)),E.ViewPort.Clear(),
q.canvas.parentNode&&E.ViewPort.SetCurrent(q.canvas.parentNode.clientWidth,q.canvas.parentNode.clientHeight),1!=E.opts.ignoreDimensions&&(X.style("width").hasValue()&&(q.canvas.width=X.style("width").toPixels("x"),q.canvas.style.width=q.canvas.width+"px"),X.style("height").hasValue()&&(q.canvas.height=X.style("height").toPixels("y"),q.canvas.style.height=q.canvas.height+"px"));var e=q.canvas.clientWidth||q.canvas.width,$=q.canvas.clientHeight||q.canvas.height;if(1==E.opts.ignoreDimensions&&X.style("width").hasValue()&&X.style("height").hasValue()&&(e=X.style("width").toPixels("x"),$=X.style("height").toPixels("y")),E.ViewPort.SetCurrent(e,$),null!=E.opts.offsetX&&(X.attribute("x",!0).value=E.opts.offsetX),null!=E.opts.offsetY&&(X.attribute("y",!0).value=E.opts.offsetY),null!=E.opts.scaleWidth||null!=E.opts.scaleHeight){var t=null,J=null,u=E.ToNumberArray(X.attribute("viewBox").value);null!=E.opts.scaleWidth&&(X.attribute("width").hasValue()?t=X.attribute("width").toPixels("x")/E.opts.scaleWidth:isNaN(u[2])||(t=u[2]/E.opts.scaleWidth)),null!=E.opts.scaleHeight&&(X.attribute("height").hasValue()?J=X.attribute("height").toPixels("y")/E.opts.scaleHeight:isNaN(u[3])||(J=u[3]/E.opts.scaleHeight)),null==t&&(t=J),null==J&&(J=t),X.attribute("width",!0).value=E.opts.scaleWidth,X.attribute("height",!0).value=E.opts.scaleHeight,X.style("transform",!0,!0).value+=" scale("+1/t+","+1/J+")"}1!=E.opts.ignoreClear&&q.clearRect(0,0,e,$),X.render(q),w&&(w=!1,"function"==typeof E.opts.renderCallback&&E.opts.renderCallback(N)),M&&q.canvas.parentElement&&q.canvas.parentElement.removeChild(q.canvas)},t=!0;E.ImagesLoaded()&&(t=!1,$()),E.intervalID=setInterval(function(){var M=!1;if(t&&E.ImagesLoaded()&&(t=!1,M=!0),1!=E.opts.ignoreMouse&&(M|=E.Mouse.hasEvents()),1!=E.opts.ignoreAnimation)for(var q=0;q<E.Animations.length;q++)M|=E.Animations[q].update(1e3/E.FRAMERATE);"function"==typeof E.opts.forceRedraw&&1==E.opts.forceRedraw()&&(M=!0),M&&($(),E.Mouse.runEvents())},1e3/E.FRAMERATE)},E.stop=function(){E.intervalID&&clearInterval(E.intervalID)},E.Mouse=new function(){this.events=[],this.hasEvents=function(){return 0!=this.events.length},this.onclick=function(M,q){this.events.push({type:"onclick",x:M,y:q,run:function(M){M.onclick&&M.onclick()}})},this.onmousemove=function(M,q){this.events.push({type:"onmousemove",x:M,y:q,run:function(M){M.onmousemove&&M.onmousemove()}})},this.eventElements=[],this.checkPath=function(M,q){for(var N=0;N<this.events.length;N++){var e=this.events[N];q.isPointInPath&&q.isPointInPath(e.x,e.y)&&(this.eventElements[N]=M)}},this.checkBoundingBox=function(M,q){for(var N=0;N<this.events.length;N++){var e=this.events[N];q.isPointInBox(e.x,e.y)&&(this.eventElements[N]=M)}},this.runEvents=function(){E.ctx.canvas.style.cursor="";for(var M=0;M<this.events.length;M++)for(var q=this.events[M],N=this.eventElements[M];N;)q.run(N),N=N.parent;this.events=[],this.eventElements=[]},E.prepareDOM=function(M){function N(M,N){if(0!=N.length){var e={};N.forEach(function(M){if(!M.getAttribute("transform")){var q=M.getAttribute("class");e[q]||(e[q]=[]),e[q].push(M)}}),q.keys(e).forEach(function(q){var N=[];e[q].forEach(function(X,w){N.push(X.getAttribute("d")),w>0&&M.removeChild(e[q][w])}),e[q][0].setAttribute("d",N.join(" "))})}}function e(M){for(var q=M.length,N=q-1;N>0;N--)if(null==M[N].node){var e=M[N-1].text+M[N].text;M[N].combined=!0,M[N-1].text=e,null!=M[N-1].node&&(M[N-1].node.textContent=e)}else{var X,w,$,t,E,J;if(null==M[N-1].node)continue;if(E=M[N].node,J=M[N-1].node,X=E.getAttribute("x"),$=E.getAttribute("dx"),w=E.getAttribute("y"),t=E.getAttribute("dy"),null!=X||null!=w||null!=$||null!=t)continue;if(E.getAttribute("class")!=J.getAttribute("class"))continue;var e=M[N-1].text+M[N].text;M[N-1].node.textContent=e,M[N-1].text=e,M[N].combined=!0}var u=[];return M.forEach(function(M){M.combined||u.push(M)}),u}function X(M,q){var N=e(q);return e(N),M.textContent="",N.forEach(function(q){q.combined||(q.node?M.appendChild(q.node):M.append(q.text))}),N}function w(M){if("tb-rl"==M.getAttribute("writing-mode")){var q=M.getAttribute("x")-1.5,N=M.getAttribute("y")-1.5;M.removeAttribute("writing-mode");var e=M.getAttribute("transform"),X="rotate(90,"+q+","+N+")";e=e?e+" "+X:X,M.setAttribute("transform",e)}}function $(M){for(var q=M.length,N=0;N<q;N++)if(M.charCodeAt(N)>255)return!0;return!1}function t(M,q){var N=M.getAttribute("y");M.getAttribute("x");N&&(N=parseFloat(N)+3,M.setAttribute("y",N));var e=0,X=0;q.forEach(function(M){if(null==M.node)return e+=M.text.length,void(X+=M.text.length);var q=M.node.getAttribute("x"),N=M.node.getAttribute("y"),w=M.node.getAttribute("dx"),$=M.node.getAttribute("dy");null==q&&null==w&&M.node.setAttribute("x",q),null!=w&&(w=parseFloat(w.substring(0,w.length-2))-X+"em",M.node.setAttribute("dx",w)),X+=M.text.length,null==N&&(null==$&&($="0em"),0!=(e+=parseFloat($.substring(0,$.length-2)))&&(M.node.setAttribute("dy",e+"em"),e+=M.text.length))})}function J(M){for(var q=[],N=M.childElementCount,e=0;e<N;e++){var X=M.children[e].textContent;X&&((X=M.children[e].textContent=X.trim())&&(M.children[e].textContent=X+"svgC"+e))}var w=M.textContent;w&&(w=w.trim());for(var e=0;e<N;e++){var X=M.children[e].textContent;if(X){var $=w.indexOf(X);$>0&&(q.push({text:w.substring(0,$),node:null}),w=w.substring($)),q.push({text:X,node:M.children[e]}),w=w.substring(X.length)}}w.length>0&&q.push({text:w,node:null});for(var e=0;e<N;e++){var X=M.children[e].textContent;if(X){var t=M.children[e].textContent,E=t.indexOf("svgC"+e);M.children[e].textContent=t.substring(0,E)}}return q.forEach(function(M){null!=M.node&&(M.text=M.node.textContent)}),q}function u(M){for(var q=[],N=M.childElementCount,e=0;e<N;e++)"v:"==M.children[e].tagName.slice(0,2)&&q.push(M.children[e]);q.forEach(function(q){M.removeChild(q)})}function g(M){for(var q=[],e=0;e<M.childElementCount;e++){var S=M.children[e],b=S.tagName,h=M.getAttribute("transform"),y=!1;switch(h&&h.indexOf("rotate")>=0&&!0,"tb-rl"==S.getAttribute("writing-mode")&&(y=!0),b){case"g":g(S);break;case"text":u(S);var P=J(S);P=X(S,P),$(S.textContent)?y&&t(S,P):w(S);break;case"path":q.push(S)}}E.opts.combinePath&&N(M,q)}for(var S=M.children[0],b=0;b<S.childElementCount;b++)if("g"==S.children[b].tagName){g(S.children[b]);break}}},E}var J,u=function(M,q,N){if(null!=M||null!=q||null!=N){"string"==typeof M&&(M=document.getElementById(M)),null!=M.svg&&M.svg.stop();var e=E(N||{});1==M.childNodes.length&&"OBJECT"==M.childNodes[0].nodeName||(M.svg=e);var X=M.getContext("2d");void 0!==q.documentElement?e.loadXmlDoc(X,q):"<"==q.substr(0,1)?e.loadXml(X,q):e.load(X,q)}else for(var w=document.querySelectorAll("svg"),$=0;$<w.length;$++){var t=w[$],J=document.createElement("canvas");J.width=t.clientWidth,J.height=t.clientHeight,t.parentNode.insertBefore(J,t),t.parentNode.removeChild(t);var g=document.createElement("div");g.appendChild(t),u(J,g.innerHTML)}};void 0!==Element.prototype.matches?J=function(M,q){var N;try{N=M.matches(q)}catch(M){N=!1}return N}:void 0!==Element.prototype.webkitMatchesSelector?J=function(M,q){return M.webkitMatchesSelector(q)}:void 0!==Element.prototype.mozMatchesSelector?J=function(M,q){return M.mozMatchesSelector(q)}:void 0!==Element.prototype.msMatchesSelector?J=function(M,q){return M.msMatchesSelector(q)}:void 0!==Element.prototype.oMatchesSelector?J=function(M,q){return M.oMatchesSelector(q)}:("function"!=typeof jQuery&&"function"!=typeof Zepto||(J=function(M,q){return $(M).is(q)}),void 0===J&&(J=Sizzle.matchesSelector));var g=/(\[[^\]]+\])/g,S=/(#[^\s\+>~\.\[:]+)/g,b=/(\.[^\s\+>~\.\[:]+)/g,h=/(::[^\s\+>~\.\[:]+|:first-line|:first-letter|:before|:after)/gi,y=/(:[\w-]+\([^\)]*\))/gi,P=/(:[^\s\+>~\.\[:]+)/g,f=/([^\s\+>~\.\[:]+)/g;return"undefined"!=typeof CanvasRenderingContext2D&&(CanvasRenderingContext2D.prototype.drawSvg=function(M,q,N,e,X,w){var $={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0,ignoreClear:!0,offsetX:q,offsetY:N,scaleWidth:e,scaleHeight:X};for(var t in w)w.hasOwnProperty(t)&&($[t]=w[t]);u(this.canvas,M,$)}),u}(X.RGBColor,X.stackBlur)}(void 0!==M?M:this)}("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:(0,eval)("this"),Object),function(M,q,N){function e(M){this._pointer=0,this._data=M,this._eof=!1}function X(M,q){return M<=9?q:M>=10&&M<=59?parseFloat(q):M>=60&&M<=99?parseInt(q):M>=100&&M<=109?q:M>=110&&M<=149?parseFloat(q):M>=160&&M<=179?parseInt(q):M>=210&&M<=239?parseFloat(q):M>=270&&M<=289?parseInt(q):M>=290&&M<=299?w(q):M>=300&&M<=369?q:M>=370&&M<=389?parseInt(q):M>=390&&M<=399?q:M>=400&&M<=409?parseInt(q):M>=410&&M<=419?q:M>=420&&M<=429?parseInt(q):M>=430&&M<=439?q:M>=440&&M<=459?parseInt(q):M>=460&&M<=469?parseFloat(q):M>=470&&M<=481?q:999===M?q:M>=1e3&&M<=1009?q:M>=1010&&M<=1059?parseFloat(q):M>=1060&&M<=1071?parseInt(q):(console.log("WARNING: Group code does not have a defined type: %j",{code:M,value:q}),q)}function w(M){if("0"===M)return!1;if("1"===M)return!0;throw TypeError("String '"+M+"' cannot be cast to Boolean type")}function $(M){M&&M.sanitize!==N&&(this.sanitize=M.sanitize)}function t(M){P.debug("unhandled group "+E(M))}function E(M){return M.code+":"+M.value}function J(M){return f[M]}function u(M){return null==M?N:"#"+((1<<24)+M).toString(16).slice(1)}function g(M,q,N,e,X,w){var $,t,E,J,u=N.length,g=N[0].length;if(q<1)throw new Error("degree must be at least 1 (linear)");if(q>u-1)throw new Error("degree must be less than or equal to point count - 1");if(!X)for(X=[],$=0;$<u;$++)X[$]=1;if(e){if(e.length!==u+q+1)throw new Error("bad knot vector length")}else{var e=[];for($=0;$<u+q+1;$++)e[$]=$}var S=[q,e.length-1-q],b=e[S[0]],h=e[S[1]];for(M=M*(h-b)+b,E=S[0];E<S[1]-1&&!(M>=e[E]&&M<=e[E+1]);E++);var y=[];for($=0;$<u;$++){for(y[$]=[],t=0;t<g;t++)y[$][t]=N[$][t]*X[$];y[$][g]=X[$]}var P;for(J=1;J<=q+1;J++)for($=E;$>E-q-1+J;$--)for(P=(M-e[$])/(e[$+q+1-J]-e[$]),t=0;t<g+1;t++)y[$][t]=(1-P)*y[$-1][t]+P*y[$][t];var w=w||[];for($=0;$<g;$++)w[$]=y[E][$]/y[E][g];return w}function S(M){return M?'"'+M+'"':null}var b=M.ht,h=b.Default;h.getInternal().addMethod(h,{cadToShape:function(M,q){return new b.DxfViewer(q).toShape(M)},shapeToCad:function(M,q,N){return new b.DxfWriter(N).toDxf(M,q)}});var y=function(){},P={debug:y,warn:y,error:y},f=[0,16711680,16776960,65280,65535,255,16711935,16777215,8421504,12632256,16711680,16744319,13369344,13395558,10027008,10046540,8323072,8339263,4980736,4990502,16727808,16752511,13382400,13401958,10036736,10051404,8331008,8343359,4985600,4992806,16744192,16760703,13395456,13408614,10046464,10056268,8339200,8347455,4990464,4995366,16760576,16768895,13408512,13415014,10056192,10061132,8347392,8351551,4995328,4997670,16776960,16777087,13421568,13421670,10000384,10000460,8355584,8355647,5000192,5000230,12582656,14679935,10079232,11717734,7510016,8755276,6258432,7307071,3755008,4344870,8388352,12582783,6736896,10079334,5019648,7510092,4161280,6258495,2509824,3755046,4194048,10485631,3394560,8375398,2529280,6264908,2064128,5209919,1264640,3099686,65280,8388479,52224,6736998,38912,5019724,32512,4161343,19456,2509862,65343,8388511,52275,6737023,38950,5019743,32543,4161359,19475,2509871,65407,8388543,52326,6737049,38988,5019762,32575,4161375,19494,2509881,65471,8388575,52377,6737074,39026,5019781,32607,4161391,19513,2509890,65535,8388607,52428,6737100,39064,5019800,32639,4161407,19532,2509900,49151,8380415,39372,6730444,29336,5014936,24447,4157311,14668,2507340,32767,8372223,26316,6724044,19608,5010072,16255,4153215,9804,2505036,16383,8364031,13260,6717388,9880,5005208,8063,4149119,4940,2502476,255,8355839,204,6710988,152,5000344,127,4145023,76,2500172,4129023,10452991,3342540,8349388,2490520,6245528,2031743,5193599,1245260,3089996,8323327,12550143,6684876,10053324,4980888,7490712,4128895,6242175,2490444,3745356,12517631,14647295,10027212,11691724,7471256,8735896,6226047,7290751,3735628,4335180,16711935,16744447,13369548,13395660,9961624,9981080,8323199,8339327,4980812,4990540,16711871,16744415,13369497,13395634,9961586,9981061,8323167,8339311,4980793,4990530,16711807,16744383,13369446,13395609,9961548,9981042,8323135,8339295,4980774,4990521,16711743,16744351,13369395,13395583,9961510,9981023,8323103,8339279,4980755,4990511,3355443,5987163,8684676,11382189,14079702,16777215];e.prototype.next=function(M){var q;if(!this.hasNext())throw this._eof?new Error("Cannot call 'next' after EOF group has been read"):new Error("Unexpected end of input: EOF group not read before end of file. Ended on code "+this._data[this._pointer]);return q={code:parseInt(this._data[this._pointer])},this._pointer++,q.value=X(q.code,this._data[this._pointer].trim()),this._pointer++,M||0!==q.code||"EOF"!==q.value||(this._eof=!0),q},e.prototype.hasNext=function(){return!this._eof&&!(this._pointer>this._data.length-2)},e.prototype.isEOF=function(){return this._eof},$.prototype.parse=function(M,q){throw new Error("read() not implemented. Use readSync()")},$.prototype.parseSync=function(M){return"string"==typeof M?this._parse(M):(console.error("Cannot read dxf source of type `"+typeof M),null)},$.prototype.parseStream=function(M,q){function N(M){w+=M}function e(){try{var M=$._parse(w)}catch(M){return q(M)}q(null,M)}function X(M){q(M)}var w="",$=this;M.on("data",N),M.on("end",e),M.on("error",X)},$.prototype.sanitizeFileName=function(){var M=/[\/\?<>\\:\*\|":]/g,q=/[\x00-\x1f\x80-\x9f]/g,N=/^\.+$/,e=/^(con|prn|aux|nul|com[0-9]|lpt[0-9])(\..*)?$/i,X=/[\. ]+$/;return function(w){var $=this.sanitize;return null==$?w:w.replace(M,$).replace(q,$).replace(N,$).replace(e,$).replace(X,$)}}(),$.prototype._parse=function(M){var X,w,$=this,u={},g=0,S=M.split(/\r\n|\r|\n/g);if(X=new e(S),!X.hasNext())throw Error("Empty file");var h=function(M,q){return w.code===M&&w.value===q},y=function(){var M=null,q=null,N={};for(w=X.next();;){if(h(0,"ENDSEC")){M&&(N[M]=q);break}9===w.code?(M&&(N[M]=q),M=w.value):10===w.code?q={x:w.value}:20===w.code?q.y=w.value:30===w.code?q.z=w.value:q=w.value,w=X.next()}return w=X.next(),N},f=function(){var M,q={};for(w=X.next();"EOF"!==w.value&&!h(0,"ENDSEC");)h(0,"BLOCK")?(P.debug("block {"),M=x(),P.debug("}"),eM(M),M.name?q[M.name]=M:P.error('block with handle "'+M.handle+'" is missing a name.')):(t(w),w=X.next());return q},x=function(){var M={};for(w=X.next();"EOF"!==w.value;){switch(w.code){case 1:M.xrefPath=w.value,w=X.next();break;case 2:M.name=$.sanitizeFileName(w.value),w=X.next();break;case 3:M.name2=$.sanitizeFileName(w.value),w=X.next();break;case 5:M.handle=w.value,w=X.next();break;case 8:M.layer=w.value,w=X.next();break;case 10:M.position=s();break;case 67:M.paperSpace=!(!w.value||1!=w.value),w=X.next();break;case 70:0!=w.value&&(M.type=w.value),w=X.next();break;case 100:w=X.next();break;case 330:M.ownerHandle=w.value,w=X.next();break;case 0:if("ENDBLK"==w.value)break;X._pointer-=2,M.entities=C(!0);break;default:t(w),w=X.next()}if(h(0,"ENDBLK")){w=X.next();break}}return M},n=function(){var M={};for(w=X.next();"EOF"!==w.value&&!h(0,"ENDSEC");)if(h(0,"TABLE")){w=X.next();var q=p[w.value];q?(P.debug(w.value+" Table {"),M[p[w.value].tableName]=R(),P.debug("}")):P.debug("Unhandled Table "+w.value)}else w=X.next();return w=X.next(),M},R=function(){var M,N=p[w.value],e={},$=0;for(w=X.next();!h(0,"ENDTAB");)switch(w.code){case 5:e.handle=w.value,w=X.next();break;case 330:e.ownerHandle=w.value,w=X.next();break;case 100:"AcDbSymbolTable"===w.value?w=X.next():(t(w),w=X.next());break;case 70:$=w.value,w=X.next();break;case 0:w.value===N.dxfSymbolName?e[N.tableRecordsProperty]=N.parseTableRecords():(t(w),w=X.next());break;default:t(w),w=X.next()}var E=e[N.tableRecordsProperty];return E&&(E.constructor===Array?M=E.length:"object"==typeof E&&(M=q.keys(E).length),$!==M&&P.warn("Parsed "+M+" "+N.dxfSymbolName+"'s but expected "+$)),w=X.next(),e},G=function(){var M=[],q={};for(P.debug("ViewPort {"),w=X.next();!h(0,"ENDTAB");)switch(w.code){case 2:q.name=w.value,w=X.next();break;case 10:q.lowerLeftCorner=s();break;case 11:q.upperRightCorner=s();break;case 12:q.center=s();break;case 13:q.snapBasePoint=s();break;case 14:q.snapSpacing=s();break;case 15:q.gridSpacing=s();break;case 16:q.viewDirectionFromTarget=s();break;case 17:q.viewTarget=s();break;case 40:q.viewHeight=w.value,q.aspectRatio!==N&&(q.viewWidth=w.value*q.aspectRatio),w=X.next();break;case 41:q.aspectRatio=w.value,q.viewHeight!==N&&(q.viewWidth=w.value*q.viewHeight),w=X.next();break;case 42:q.lensLength=w.value,w=X.next();break;case 43:q.frontClippingPlane=w.value,w=X.next();break;case 44:q.backClippingPlane=w.value,w=X.next();break;case 45:q.viewHeight=w.value,w=X.next();break;case 50:q.snapRotationAngle=w.value,w=X.next();break;case 51:q.viewTwistAngle=w.value,w=X.next();break;case 79:q.orthographicType=w.value,w=X.next();break;case 110:q.ucsOrigin=s();break;case 111:q.ucsXAxis=s();break;case 112:q.ucsYAxis=s();break;case 110:q.ucsOrigin=s();break;case 281:q.renderMode=w.value,w=X.next();break;case 281:q.defaultLightingType=w.value,w=X.next();break;case 292:q.defaultLightingOn=w.value,w=X.next();break;case 330:q.ownerHandle=w.value,w=X.next();break;case 63:case 421:case 431:q.ambientColor=w.value,w=X.next();break;case 0:"VPORT"===w.value&&(P.debug("}"),M.push(q),P.debug("ViewPort {"),q={},w=X.next());break;default:t(w),w=X.next()}return P.debug("}"),M.push(q),M},j=function(){var M,q,N={},e={};for(P.debug("LType {"),w=X.next();!h(0,"ENDTAB");)switch(w.code){case 2:e.name=w.value,M=w.value,w=X.next();break;case 3:e.description=w.value,w=X.next();break;case 73:q=w.value,q>0&&(e.pattern=[]),w=X.next();break;case 40:e.patternLength=w.value,w=X.next();break;case 49:e.pattern.push(w.value),w=X.next();break;case 0:P.debug("}"),q>0&&q!==e.pattern.length&&P.warn("lengths do not match on LTYPE pattern"),N[M]=e,e={},P.debug("LType {"),w=X.next();break;default:w=X.next()}return P.debug("}"),N[M]=e,N},K=function(){var M,q={},e={};for(P.debug("Layer {"),w=X.next();!h(0,"ENDTAB");)switch(w.code){case 2:e.name=w.value,M=w.value,w=X.next();break;case 62:e.visible=w.value>=0,e.color=J(Math.abs(w.value)),w=X.next();break;case 6:e.lineType=w.value,w=X.next();break;case 0:"LAYER"===w.value&&(P.debug("}"),q[M]=e,P.debug("Layer {"),e={},M=N,w=X.next());break;default:t(w),w=X.next()}return P.debug("}"),q[M]=e,q},p={VPORT:{tableRecordsProperty:"viewPorts",tableName:"viewPort",dxfSymbolName:"VPORT",parseTableRecords:G},LTYPE:{tableRecordsProperty:"lineTypes",tableName:"lineType",dxfSymbolName:"LTYPE",parseTableRecords:j},LAYER:{tableRecordsProperty:"layers",tableName:"layer",dxfSymbolName:"LAYER",parseTableRecords:K}},C=function(M){var q=[],N=M?"ENDBLK":"ENDSEC";for(w=X.next();;)if(0===w.code){if(w.value===N)break;var e;if("LWPOLYLINE"===w.value)P.debug("LWPOLYLINE {"),e=W(),P.debug("}");else if("POLYLINE"===w.value)P.debug("POLYLINE {"),e=v(),P.debug("}");else if("LINE"===w.value)P.debug("LINE {"),e=o(),P.debug("}");else if("CIRCLE"===w.value)P.debug("CIRCLE {"),e=H(),P.debug("}");else if("ARC"===w.value)P.debug("ARC {"),e=H(),P.debug("}");else if("ELLIPSE"===w.value)P.debug("ELLIPSE {"),e=U(),P.debug("}");else if("SPLINE"===w.value)P.debug("SPLINE {"),e=L(),P.debug("}");else if("TEXT"===w.value)P.debug("TEXT {"),e=i(),P.debug("}");else if("ATTRIB"===w.value)P.debug("ATTRIB {"),e=F(),P.debug("}");else if("DIMENSION"===w.value)P.debug("DIMENSION {"),e=MM(),P.debug("}");else if("INSERT"===w.value)P.debug("INSERT {"),e=V(),P.debug("}");else if("HATCH"===w.value)P.debug("HATCH {"),e=T(),P.debug("}");else if("SOLID"===w.value)P.debug("SOLID {"),e=qM(),P.debug("}");else if("POINT"===w.value)P.debug("POINT {"),e=NM(),P.debug("}");else if("MTEXT"===w.value)P.debug("MTEXT {"),e=r(),P.debug("}");else if("ATTDEF"===w.value)P.debug("ATTDEF {"),e=a(),P.debug("}");else{if("LEADER"!==w.value){P.warn("Unhandled entity "+w.value),w=X.next();continue}P.debug("ATTDEF {"),e=D(),P.debug("}")}e instanceof Array?e.forEach(function(M){eM(M),q.push(M)}):(eM(e),q.push(e))}else w=X.next();return"ENDSEC"==N&&(w=X.next()),q},m=function(M){switch(w.code){case 0:M.type=w.value,w=X.next();break;case 5:M.handle=w.value,w=X.next();break;case 6:M.lineType=w.value,w=X.next();break;case 8:M.layer=w.value,w=X.next();break;case 48:M.lineTypeScale=w.value,w=X.next();break;case 60:M.visible=0===w.value,w=X.next();break;case 62:M.colorIndex=w.value,M.color=J(Math.abs(w.value)),w=X.next();break;case 67:M.inPaperSpace=0!==w.value,w=X.next();break;case 210:M.extrusionDirection=s();break;case 230:M.extrusionDirection={x:0,y:0,z:w.value},w=X.next();break;case 330:M.ownerHandle=w.value,w=X.next();break;case 347:M.materialObjectHandle=w.value,w=X.next();break;case 370:M.lineweight=w.value,w=X.next();break;case 420:M.color=w.value,w=X.next();break;case 100:if("AcDbEntity"==w.value){w=X.next();break}default:t(w),w=X.next()}},O=function(){var M={type:w.value};for(w=X.next();"EOF"!==w&&0!==w.code;)switch(w.code){case 10:M.x=w.value,w=X.next();break;case 20:M.y=w.value,w=X.next();break;case 30:M.z=w.value,w=X.next();break;case 40:case 41:case 42:w=X.next();break;case 70:M.curveFittingVertex=0!=(1|w.value),M.curveFitTangent=0!=(2|w.value),M.splineVertex=0!=(8|w.value),M.splineControlPoint=0!=(16|w.value),M.ThreeDPolylineVertex=0!=(32|w.value),M.ThreeDPolylineMesh=0!=(64|w.value),M.polyfaceMeshVertex=0!=(128|w.value),w=X.next();break;case 50:case 71:case 72:case 73:case 74:w=X.next();break;default:m(M)}return M},Q=function(){var M={type:w.value};for(w=X.next();"EOF"!=w&&0!=w.code;)m(M);return M},s=function(){var M={},q=w.code;if(M.x=w.value,q+=10,w=X.next(),w.code!=q)throw new Error("Expected code for point value to be "+q+" but got "+w.code+".");return M.y=w.value,q+=10,w=X.next(),w.code!=q?M:(M.z=w.value,w=X.next(),M)},l=function(){var M={},q=w.code;return M.x=w.value,q+=1,w=X.next(),w.code!=q?(X._pointer-=2,M.y=1):M.y=w.value,q+=1,w=X.next(),w.code!=q?(X._pointer-=2,M.z=1):M.z=w.value,w=X.next(),M},Y=function(M){if(!M||M<=0)throw Error("n must be greater than 0 verticies");var q,N=[],e=!1,$=!1;for(q=0;q<M;q++){for(var t={};"EOF"!==w&&0!==w.code&&!$;){switch(w.code){case 10:if(e){$=!0;continue}t.x=w.value,e=!0;break;case 20:t.y=w.value;break;case 30:t.z=w.value;break;case 40:t.startWidth=w.value;break;case 41:t.endWidth=w.value;break;case 42:0!=w.value&&(t.bulge=w.value);break;default:if(e){$=!0;continue}}w=X.next()}N.push(t),e=!1,$=!1}return N},I=function(){for(var M=[];"EOF"!==w;)if(0===w.code)if("VERTEX"===w.value)M.push(O());else if("SEQEND"===w.value){Q();break}return M},r=function(){var M={type:w.value};for(w=X.next();"EOF"!==w&&0!==w.code;)switch(w.code){case 1:M.text=w.value,w=X.next();break;case 3:M.text+=w.value,w=X.next();break;case 10:M.position=s();break;case 40:M.height=w.value,w=X.next();break;case 41:M.width=w.value,w=X.next();break;case 71:M.attachmentPoint=w.value,w=X.next();break;case 72:M.drawingDirection=w.value,w=X.next();break;case 50:M.angle=2*w.value*Math.PI/360,w=X.next();break;case 11:M.directionX=w.value,w=X.next();break;case 21:M.directionY=w.value,w=X.next();break;case 60:M.hidden=1===w.value,w=X.next();break;case 101:M.embededObject=d();break;default:m(M)}return M},d=function(){var M={type:w.value};for(w=X.next();"EOF"!==w&&0!==w.code;)m(M);return M},a=function(){var M={type:w.value,scale:1,textStyle:"STANDARD",halign:0,valign:0};for(w=X.next();"EOF"!==w&&0!==w.code;)switch(w.code){case 1:M.text=w.value,w=X.next();break;case 2:M.tag=w.value,w=X.next();break;case 3:M.prompt=w.value,w=X.next();break;case 7:M.textStyle=w.value,w=X.next();break;case 10:M.startPoint=s();break;case 11:M.endPoint=s();break;case 39:M.thickness=w.value,w=X.next();break;case 40:M.textHeight=w.value,w=X.next();break;case 41:M.scale=w.value,w=X.next();break;case 50:M.rotation=w.value/180*Math.PI,w=X.next();break;case 51:M.obliqueAngle=w.value,w=X.next();break;case 70:M.invisible=!!(1&w.value),M.constant=!!(2&w.value),M.verificationRequired=!!(4&w.value),M.preset=!!(8&w.value),w=X.next();break;case 71:M.backwards=!!(2&w.value),M.mirrored=!!(4&w.value),w=X.next();break;case 72:M.halign=w.value,w=X.next();break;case 73:M.fieldLength=w.value,w=X.next();break;case 74:M.valign=w.value,w=X.next();break;case 100:w=X.next();break;case 210:M.extrusionDirectionX=w.value,w=X.next();break;case 220:M.extrusionDirectionY=w.value,w=X.next();break;case 230:M.extrusionDirectionZ=w.value,w=X.next();break;default:m(M)}return M},D=function(){var M={type:w.value,vertices:[]},q=0;for(w=X.next();"EOF"!==w&&0!==w.code;)switch(w.code){case 3:M.name=w.value,w=X.next();break;case 76:q=w.value,w=X.next();break;case 10:for(var N=0;N<q;N++)M.vertices.push(s());break;default:m(M)}return M},W=function(){var M={type:w.value,vertices:[]},q=0;for(w=X.next();"EOF"!==w&&0!==w.code;)switch(w.code){case 38:M.elevation=w.value,w=X.next();break;case 39:M.depth=w.value,w=X.next();break;case 70:M.shape=1===w.value,w=X.next();break;case 90:q=w.value,w=X.next();break;case 10:M.vertices=Y(q);break;case 40:0!==w.value&&(M.startWidth=w.value),w=X.next();break;case 41:0!==w.value&&(M.endWidth=w.value),w=X.next();break;case 43:0!==w.value&&(M.width=w.value),w=X.next();break;default:m(M)}return M},v=function(){var M={type:w.value,vertices:[]};for(w=X.next();"EOF"!==w&&0!==w.code;)switch(w.code){case 10:case 20:case 30:case 39:w=X.next();break;case 40:0!==w.value&&(M.startWidth=w.value),w=X.next();break;case 41:0!==w.value&&(M.endWidth=w.value),w=X.next();break;case 70:M.shape=1===w.value,w=X.next();break;case 71:case 72:case 73:case 74:case 75:case 100:w=X.next();break;default:m(M)}return M.vertices=I(),M},o=function(){var M={type:w.value,vertices:[]};for(w=X.next();"EOF"!==w&&0!==w.code;)switch(w.code){case 10:M.vertices.unshift(s());break;case 11:M.vertices.push(s());break;case 100:if("AcDbLine"==w.value){w=X.next();break}default:m(M)}return M},H=function(){var M,q;for(M={type:w.value},w=X.next();"EOF"!==w&&0!==w.code;)switch(w.code){case 10:M.center=s();break;case 40:M.radius=w.value,w=X.next();break;case 50:M.startAngle=Math.PI/180*w.value,w=X.next();break;case 51:q=Math.PI/180*w.value,q<M.startAngle?M.angleLength=q+2*Math.PI-M.startAngle:M.angleLength=q-M.startAngle,M.endAngle=q,w=X.next();break;default:m(M)}return M},U=function(){var M,q;for(M={type:w.value},w=X.next();"EOF"!==w&&0!==w.code;)switch(w.code){case 10:M.center=s();break;case 11:M.major=s();break;case 40:M.ratio=w.value,w=X.next();break;case 41:M.startAngle=w.value,w=X.next();break;case 42:q=w.value,q<M.startAngle?M.angleLength=q+2*Math.PI-M.startAngle:M.angleLength=q-M.startAngle,M.endAngle=q,w=X.next();break;default:m(M)}return M},V=function(){var M,q,N=[];for(M={type:w.value,attribs:N},w=X.next();"EOF"!==w;){if(0===w.code){if(q&&"ATTRIB"===w.value){N.push(F());continue}if(q&&"SEQEND"===w.value){Q();continue}break}switch(w.code){case 2:M.block=$.sanitizeFileName(w.value),w=X.next();break;case 10:M.center=s();break;case 41:M.scale=l();break;case 50:M.deg=w.value,w=X.next();break;case 66:q=1===w.value,w=X.next();break;default:m(M)}}var e={},t=u.blocks;if(t){var E=t[M.block];E&&E.entities&&E.entities.forEach(function(M){"ATTDEF"===M.type&&(e[M.tag]=1)})}var J=[M],g=[],S=M.center;return N.forEach(function(M){if(!e[M.attr])return void J.push(M);g.push(M);var q=M.startPoint;q&&(q.x-=S.x,q.y=S.y-q.y),(q=M.endPoint)&&(q.x-=S.x,q.y=S.y-q.y)}),M.attribs=g,J},T=function(){var M;for(M={type:w.value},w=X.next();"EOF"!==w&&0!==w.code;)switch(w.code){case 2:M.block=$.sanitizeFileName(w.value),w=X.next();break;case 10:M.center=s();break;case 70:M.patternFill=0===w.value,w=X.next();break;case 41:M.scale=l();break;case 52:M.deg=w.value,w=X.next();break;case 91:M.paths=_();break;case 78:M.patterns=B();break;default:m(M)}return M},_=function(){var M,q=[],N=[],e=w.value;for(w=X.next();e>0;)switch(w.code){case 97:e--,N.length>1?(M={type:"LINE",vertices:[]},N.forEach(function(q){"LINE"===q.type&&M.vertices.push.apply(M.vertices,q.vertices)}),q.push(M)):1===N.length&&q.push(N[0]),N=[],w=X.next();break;case 92:2&w.value?q.push(k()):w=X.next();break;case 72:switch(M=null,w.value){case 1:M=Z();break;case 2:M=z();break;case 3:M=A();break;case 4:M=c();break;default:w=X.next()}M&&N.push(M);break;default:w=X.next()}return q},k=function(){var M={type:"POLYLINE",vertices:[]};for(w=X.next();97!==w.code;)10===w.code?M.vertices.push(s()):w=X.next();return M},Z=function(){var M={type:"LINE",vertices:[]};for(w=X.next();97!==w.code&&72!==w.code;)10===w.code?M.vertices.push(s()):11===w.code?M.vertices.push(s()):w=X.next();return M},z=function(){var M={type:"ARC"};for(w=X.next();97!==w.code&&72!==w.code;)switch(w.code){case 10:M.center=s();break;case 40:M.radius=w.value,w=X.next();break;case 50:M.startAngle=Math.PI/180*w.value,w=X.next();break;case 51:var q=Math.PI/180*w.value;q<M.startAngle?M.angleLength=q+2*Math.PI-M.startAngle:M.angleLength=q-M.startAngle,M.endAngle=q,w=X.next();break;case 73:M.counterclockwise=!0,w=X.next();break;default:w=X.next()}return M},A=function(){var M,q;for(M={type:"ELLIPSE"},w=X.next();97!==w.code&&72!==w.code;)switch(w.code){case 10:M.center=s();break;case 11:M.major=s();break;case 40:M.majorLength=w.value,w=X.next();break;case 50:M.startAngle=w.value,w=X.next();break;case 51:q=w.value,q<M.startAngle?M.angleLength=q+2*Math.PI-M.startAngle:M.angleLength=q-M.startAngle,M.endAngle=q,w=X.next();break;case 73:M.counterclockwise=!0,w=X.next();break;default:m(M)}var N=M.major;return M.ratio=M.majorLength/Math.sqrt(N.x*N.x+N.y*N.y),M},c=function(){var M={type:"SPLINE",knots:[],vertices:[]};for(w=X.next();97!==w.code&&72!==w.code;)switch(w.code){case 94:M.degree=w.value,w=X.next();break;case 40:M.knots.push(w.value),w=X.next();break;case 10:M.vertices.push(s());break;default:m(M)}return M},B=function(){var M,q,e,$,t=[],E=w.value;for(w=X.next();E>0;)switch(w.code){case 53:M&&t.push(M),M={type:"LINE",vertices:[]},$=w.value/180*Math.PI,w=X.next(),q={x:w.value},w=X.next(),q.y=w.value,w=X.next(),e={x:w.value},w=X.next(),e.y=w.value,e=new b.Math.Vector2(e).rotateAround(N,$).add(q),M.vertices.push(q,{x:e.x,y:e.y}),w=X.next(),E--;break;default:w=X.next()}return t},L=function(){var M={type:w.value,knots:[],vertices:[]};for(w=X.next();"EOF"!==w&&0!==w.code;)switch(w.code){case 71:M.degree=w.value,w=X.next();break;case 40:M.knots.push(w.value),w=X.next();break;case 10:M.vertices.push(s());break;default:m(M)}return M},i=function(){var M;for(M={type:w.value},w=X.next();"EOF"!==w&&0!==w.code;)switch(w.code){case 10:M.startPoint=s();break;case 11:M.endPoint=s();break;case 40:M.textHeight=w.value,w=X.next();break;case 41:M.xScale=w.value,w=X.next();break;case 1:M.text=w.value,w=X.next();break;case 7:M.font=w.value,w=X.next();break;case 71:M.generationFlags=w.value,w=X.next();break;case 72:M.halign=w.value,w=X.next();break;case 73:M.valign=w.value,w=X.next();break;case 50:M.rotation=2*w.value*Math.PI/360,w=X.next();break;case 60:M.hidden=1===w.value,w=X.next();break;default:m(M)}return M},F=function(){var M;for(M={type:w.value},w=X.next();"EOF"!==w&&0!==w.code;)switch(w.code){case 10:M.startPoint=s();break;case 11:M.endPoint=s();break;case 40:M.textHeight=w.value,w=X.next();break;case 41:M.xScale=w.value,w=X.next();break;case 1:M.text=w.value,w=X.next();break;case 7:M.font=w.value,w=X.next();break;case 71:M.generationFlags=w.value,w=X.next();break;case 72:M.halign=w.value,w=X.next();break;case 74:M.valign=w.value,w=X.next();break;case 50:M.rotation=2*w.value*Math.PI/360,w=X.next();break;case 70:M.hidden=1===w.value,w=X.next();break;case 2:M.attr=w.value,w=X.next();break;default:m(M)}return M},MM=function(){var M;for(M={type:w.value},w=X.next();"EOF"!==w&&0!==w.code;)switch(w.code){case 2:M.block=$.sanitizeFileName(w.value),w=X.next();break;case 10:M.anchorPoint=s();break;case 11:M.middleOfText=s();break;case 71:M.attachmentPoint=w.value,w=X.next();break;case 42:M.actualMeasurement=w.value,w=X.next();break;case 1:M.text=w.value,w=X.next();break;case 50:M.angle=w.value,w=X.next();break;default:m(M)}return M},qM=function(){var M;for(M={type:w.value},M.points=[],w=X.next();"EOF"!==w&&0!==w.code;)switch(w.code){case 10:M.points[0]=s();break;case 11:M.points[1]=s();break;case 12:M.points[2]=s();break;case 13:
M.points[3]=s();break;default:m(M)}return M},NM=function(){var M;for(M={type:w.value},w=X.next();"EOF"!==w&&0!==w.code;)switch(w.code){case 10:M.position=s();break;case 39:M.thickness=w.value,w=X.next();break;case 100:if("AcDbPoint"==w.value){w=X.next();break}default:m(M)}return M},eM=function(M){if(!M)throw new TypeError("entity cannot be undefined or null");M.handle||(M.handle=g++)};return function(){for(w=X.next();!X.isEOF();)if(0===w.code&&"SECTION"===w.value){if(w=X.next(),2!==w.code){console.error("Unexpected code %s after 0:SECTION",E(w)),w=X.next();continue}"HEADER"===w.value?(P.debug("> HEADER"),u.header=y(),P.debug("<")):"BLOCKS"===w.value?(P.debug("> BLOCKS"),u.blocks=f(),P.debug("<")):"ENTITIES"===w.value?(P.debug("> ENTITIES"),u.entities=C(!1),P.debug("<")):"TABLES"===w.value?(P.debug("> TABLES"),u.tables=n(),P.debug("<")):"EOF"===w.value?P.debug("EOF"):P.warn("Skipping section '%s'",w.value)}else w=X.next()}(),u};var x=b.DxfViewer=function(M){this.$16w(M)};x.prototype={},x.prototype.constructor=x;var n={LINE:["LINE","POLYLINE","LEADER"],LWLINE:["LWPOLYLINE"],CIRCLE:["CIRCLE","ARC"],ELLIPSE:["ELLIPSE"],TEXT:["TEXT","MTEXT","ATTRIB"],SOLID:["SOLID"],POINT:["POINT"],ATTDEF:["ATTDEF"],HATCH:["HATCH"],SPLINE:["SPLINE"]};q.defineProperties(x.prototype,{dxf:{get:function(){return this._dxf}}}),x.prototype.$16w=function(M){var q=this,e=q.options={};M=M||{},e.font=M.font||"Standard",e.textScaleRatio=M.textScaleRatio||1,e.size=M.size,e.scale=M.scale,e.blockSize=M.blockSize||256,e.filter=M.filter,e.defaultColor=M.defaultColor||0,e.edgeLayer=M.edgeLayer,M.showText===N&&(M.showText=!0),e.showText=M.showText,e.mapColor=M.mapColor,e.circleSegments=M.circleSegments||72,e.browserMinFontSize=M.browserMinFontSize||12,e.useTextCompScale=M.useTextCompScale===N||M.useTextCompScale,e.boundingType=M.boundingType||"Reset",e.convertArcToBezier=M.convertArcToBezier,!1!==M.sanitize&&(e.sanitize=M.sanitize||"_")},x.prototype.toShape=function(M){var q=this;q.parseFile(M);var e,X,w,$=q._dxf.blocks,t=q.sortBlocks($);q._blockDef={};for(var E=t.length-1;E>=0;E--)X=t[E],w=$[X],w.entities&&(q._blockDef[X]||(e=q.entitiesToShape(w.entities,w.position,null,!1,N,!0))&&(e.flag=w.type,q._blockDef[X]=e));return e=q.entitiesToShape(q._dxf.entities,null,q.options.size,!0,q.options.scale),e.sortedBlockName=t,e.blockDef=q._blockDef,e.layers=q._dxf.tables.layer.layers,e},x.prototype.entitiesToShape=function(M,q,e,X,w,$){var t=this;t._minFontSize=12,t._bound={xMin:1/0,yMin:1/0,xMax:-1/0,yMax:-1/0},q=q||{x:0,y:0,z:0};var E,J,u,g=t._models={},S=t._dxf,b=!1;for(E=0,J=M.length;E<J;E++)u=M[E],b=t.$4w(g,u,S,N,N,$)||b;if(X)switch(t.options.boundingType){case"Viewport":var h=t.$19w;!h||isNaN(h.x)||isNaN(h.y)||isNaN(h.width)||isNaN(h.height)||(t._bound={xMin:h.x-h.width/2,xMax:h.x+h.width/2,yMin:h.y-h.height/2,yMax:h.y+h.height/2});break;case"Standard":t._bound={xMin:0,xMax:1,yMin:0,yMax:1}}t._shiftX=t._bound.xMin,t._shiftY=t._bound.yMax;var y=t._bound.xMax-t._bound.xMin,P=t._bound.yMax-t._bound.yMin;if(!(y<0||P<0)){if(y=y||1,P=P||1,t._bound.pos=q,w)t._scale=w;else{if(e){var f=e/y,x=e/P;t._scale=Math.min(f,x)}else t._scale=1;t.options.useTextCompScale||(t._scale*=Math.max(1,Math.ceil(t.options.browserMinFontSize/t._minFontSize)))}var n={};return t.shapeComps=[],t.$12w(),t.drawLWLine(),t.drawSpline(),t.$11w(),t.$9w(),t.$7w(),t.options.showText&&t.$8w(),n.dataBindings=t.drawAttrDef(),t.drawBlock(),n.width=y*t._scale,n.height=P*t._scale,n.comps=t.shapeComps,n.scale=t._scale,n.anchorX=-(t._bound.xMin-q.x)/y,n.anchorY=(t._bound.yMax-q.y)/P,n.bound=t._bound,n.entities=M,$&&(n.blendable=b),t._calcBoundExtend(n),n}},x.prototype._calcBoundExtend=function(M){var q=1,N=!1;M.comps.forEach(function(M){q=Math.max(q,M.borderWidth||0),M.borderWidthAbsolute&&(N=!0)}),M.boundExtend=q,N&&(M.boundExtendAbsolute=!0)},x.prototype._bulgesAt=function(M,q){return M[q].bulge},x.prototype._isStraightLine=function(M){return!M||Math.abs(M)<1e-6},x.prototype._getDistance=function(M,q){var N=M.x-q.x,e=M.y-q.y;return Math.sqrt(N*N+e*e)},x.prototype._getBulgeSegment=function(M,q,N){var e=this,X=N<0,w=4*Math.atan(N);if(Math.abs(w)>2*Math.PI-1e-6)return[q];var $={x:(M.x+q.x)/2,y:(M.y+q.y)/2},t=e._getDistance(M,q)/2,E=Math.atan2(q.y-M.y,q.x-M.x),J=Math.abs(t/Math.sin(w/2)),u=Math.abs(J*J-t*t),g=Math.sqrt(u);N>0?E+=Math.PI/2:E-=Math.PI/2,Math.abs(w)>Math.PI&&(g*=-1);var S,E,b=g*Math.cos(E)+$.x,h=g*Math.sin(E)+$.y,y=Math.atan2(M.y-h,M.x-b),P=Math.atan2(q.y-h,q.x-b),f=[];if(S=2*Math.PI/e.options.circleSegments,E=y,X){for(;P>y;)P-=2*Math.PI;for(;E>P;)E-=S,E<P&&(E=P),f.push({x:b+J*Math.cos(E),y:h+J*Math.sin(E)})}else{for(;P<y;)P+=2*Math.PI;for(;E<P;)E+=S,E>P&&(E=P),f.push({x:b+J*Math.cos(E),y:h+J*Math.sin(E)})}return f},x.prototype.$12w=function(){var M,q,e,X,w,$,t,E,J,u,g,S,b,h,y,P,f,x,R,G,j=this,K=j._models;for(M=n.LINE,X=0,w=M.length;X<w;X++){q=M[X],e=K[q];for(E in e)for(J=e[E],$=0,t=J.length;$<t;$++)if(u=J[$],(g=u.vertices)&&g.length){for(y=j.$3w(g[0].x,1),P=j.$3w(g[0].y,2),x={type:"shape",cadType:q,cadLayer:u.layer,maybeEdge:u.layer===j.options.edgeLayer,points:[y,P],segments:[1]},u.fill?x.background=E:(x.borderColor=E,x.borderCap="round"),G=N,u.startWidth?G=(u.startWidth+(u.endWidth?u.endWidth:u.startWidth))/2:u.width&&(G=u.width),G?x.borderWidth=j.$3w(G):(x.borderWidthAbsolute=!0,x.borderWidth=1),b=1,h=g.length;b<h;b++)S=g[b],f=j._bulgesAt(g,b-1),j._isStraightLine(f)?(x.points.push(j.$3w(S.x,1),j.$3w(S.y,2)),x.segments.push(2)):(R=j._getBulgeSegment(g[b-1],S,f),R.forEach(function(M){x.points.push(j.$3w(M.x,1),j.$3w(M.y,2)),x.segments.push(2)}));if(u.shape&&(f=j._bulgesAt(g,g.length-1),j._isStraightLine(f)?x.segments.push(5):(R=j._getBulgeSegment(g[g.length-1],g[0],f),R.forEach(function(M){x.points.push(j.$3w(M.x,1),j.$3w(M.y,2)),x.segments.push(2)}))),x.dash=["DASHED"].indexOf(u.lineType)>=0){x.dashColor=E,x.borderColor="rgba(0, 0, 0, 0)";var p=j.$3w(u.lineTypeScale||1);p&&(x.dashPattern=[p,p/2])}else if(u.lineType&&"ByBlock"!==u.lineType){var C=j._dxf,m=C.tables,O=m.lineType&&m.lineType.lineTypes,Q=O[u.lineType],s=u.lineTypeScale||1;Q&&Q.pattern?(x.dash=!0,x.dashPattern=Q.pattern.map(function(M){return j.$3w(Math.abs(M)*s)}),x.dashColor=E,x.borderColor="rgba(0, 0, 0, 0)"):x.dash=!1}u.lineweight&&u.lineweight>=0&&(x.borderWidth=j.$3w(u.lineweight/100)),x.handle=u.handle,j.shapeComps.push(x)}}},x.prototype.drawLWLine=function(){var M,q,e,X,w,$,t,E,J,u,g,S,h,y,P,f,x,R,G,j,K=this,p=K._models;for(M=n.LWLINE,X=0,w=M.length;X<w;X++){q=M[X],e=p[q];for(E in e){J=e[E];var C=[];for($=0,t=J.length;$<t;$++)if(u=J[$],(g=u.vertices)&&g.length){P=K.$3w(g[0].x,1),f=K.$3w(g[0].y,2),R={type:"shape",cadType:q,cadLayer:u.layer,maybeEdge:u.layer===K.options.edgeLayer,borderColor:E,borderCap:"round",points:[P,f],segments:[1]},j=N,u.startWidth?j=(u.startWidth+(u.endWidth?u.endWidth:u.startWidth))/2:u.width&&(j=u.width),j?R.borderWidth=K.$3w(j):(R.borderWidthAbsolute=!0,R.borderWidth=1);var m=g[0];for(h=1,y=g.length;h<y;h++)S=g[h],x=K._bulgesAt(g,h-1),K._isStraightLine(x)?(R.points.push(K.$3w(S.x,1),K.$3w(S.y,2)),m.startWidth!==m.endWidth?(C.push({from:m,to:S}),R.segments.push(1)):R.segments.push(2)):(K.extrusionZNegative(u)&&(x*=-1),G=K._getBulgeSegment(m,S,x),G.forEach(function(M){R.points.push(K.$3w(M.x,1),K.$3w(M.y,2)),R.segments.push(2)})),m=S;if(u.shape&&(x=K._bulgesAt(g,g.length-1),K._isStraightLine(x)?R.segments.push(5):(G=K._getBulgeSegment(g[g.length-1],g[0],x),G.forEach(function(M){R.points.push(K.$3w(M.x,1),K.$3w(M.y,2)),R.segments.push(2)}))),R.dash=["DASHED","HIDDEN"].indexOf(u.lineType)>=0){R.dashColor=E,R.borderColor="rgba(0, 0, 0, 0)";var O=K.$3w(u.lineTypeScale||1);O&&(R.dashPattern=[O,O/2])}u.lineweight&&u.lineweight>=0&&(R.borderWidth=K.$3w(u.lineweight/100)),R.handle=u.handle,K.shapeComps.push(R)}C.forEach(function(M){var q=M.from,N=M.to,e={x:K.$3w(q.x,1),y:K.$3w(q.y,2)},X={x:K.$3w(N.x,1),y:K.$3w(N.y,2)},w=Math.atan2(X.y-e.y,X.x-e.x)+Math.PI/2;if(q.startWidth<q.endWidth){var $=X;X=e,e=$,w+=Math.PI}var t=Math.max(q.startWidth,q.endWidth);t=K.$3w(t);var J=b.Default.getDistance(e,X);K.shapeComps.push({type:"triangle",rect:[e.x-t/2,e.y-J,t,J],anchorX:.5,anchorY:1,rotation:w,background:E})})}}},x.prototype.drawSpline=function(){var M,q,N,e,X,w,$,t,E,J,u,S,b=this,h=b._models;for(M=n.SPLINE,e=0,X=M.length;e<X;e++){q=M[e],N=h[q];for(t in N)for(E=N[t],w=0,$=E.length;w<$;w++)if(J=E[w],(u=J.vertices)&&u.length){u=u.map(function(M){return[b.$3w(M.x,1),b.$3w(M.y,2)]});for(var y=J.degree||1,P=[],f=[1],x=0,R=4*u.length;x<=R;x++){var G=g(x/R,y,u,J.knots);P.push(G[0],G[1])}var j=P.length/2-1;for(R=Math.floor(j/2+1e-6),x=0;x<R;x++)f.push(3);j%2&&f.push(2),S={type:"shape",cadType:q,cadLayer:J.layer,borderColor:t,borderCap:"round",borderWidthAbsolute:!0,borderWidth:1,points:P,segments:f},S.handle=J.handle,b.shapeComps.push(S)}}},x.prototype.drawBlock=function(){var M,q,N,e,X,w,$,t,E,J,u,g,S=this,b=S._models.BLOCK;if(b)for(M=0,q=b.length;M<q;M++)N=b[M],e=N.block,X=S._blockDef[e],u=N.transform,w=Math.atan2(u.b,u.a),Math.abs(w-Math.PI)<1e-5||Math.abs(w)<1e-5||Math.abs(w+Math.PI)<1e-5?(E=Math.cos(w),$=u.a/E,t=u.d/E):(J=Math.sin(w),$=u.b/J,t=-u.c/J),g={type:"image",cadType:"block",cadLayer:N.layer,handle:N.handle,name:e,rect:[[S.$3w(u.tx,1),S.$3w(u.ty,2)],S.$3w(X.width/X.scale),S.$3w(X.height/X.scale)],rotation:w,attribs:N.attribs,color:N.color},1===$&&1===t||(g.scaleX=$,g.scaleY=t),S.shapeComps.push(g)},x.prototype.$11w=function(){var M,q,N,e,X,w,$,t,E,J,u,g=this,S=g._models;for(M=n.SOLID,e=0,X=M.length;e<X;e++){q=M[e],N=S[q];for(t in N)for(E=N[t],w=0,$=E.length;w<$;w++)J=E[w],u=J.points,g.shapeComps.push({type:"shape",cadType:q,cadLayer:J.layer,handle:J.handle,background:t,points:[g.$3w(u[0].x,1),g.$3w(u[0].y,2),g.$3w(u[1].x,1),g.$3w(u[1].y,2),g.$3w(u[3].x,1),g.$3w(u[3].y,2),g.$3w(u[2].x,1),g.$3w(u[2].y,2)],segments:[1,2,2,2,5]})}},x.prototype.extrusionZNegative=function(M){var q=M.extrusionDirection;return!!q&&Math.abs(q.z+1)<1e-5},x.prototype.$9w=function(){var M,q,N,e,X,w,$,t,E,J,u,g,S,b,h,y,P,f,x,R,G=this,j=G._models;for(M=n.CIRCLE,e=0,X=M.length;e<X;e++){q=M[e],N=j[q];for(t in N)for(E=N[t],w=0,$=E.length;w<$;w++){if(J=E[w],u=J.startAngle||0,g=J.angleLength||2*Math.PI,S=u+g,b=G.$3w(J.radius),h=J.addonAngle||0,y=G.$3w(J.center.x,1),P=G.$3w(J.center.y,2),R=J.xInvert^G.extrusionZNegative(J),x=J.yInvert,x||R?R&&x?(u=Math.PI+u,S=Math.PI+S,f=!1):(u=Math.PI*(R?1:2)-u,S=Math.PI*(R?1:2)-S,f=!0):f=!1,f=!f,u=2*Math.PI-u-h,S=2*Math.PI-S-h,f){var K=u;u=S,S=K}var p={type:"arc",cadType:q,cadLayer:J.layer,handle:J.handle,rect:[y-b,P-b,2*b,2*b],arcFrom:u,arcTo:S,arcClose:!1};J.fill?p.background=t:(p.borderColor=t,p.borderWidth=1,p.borderWidthAbsolute=!0),G.options.convertArcToBezier?G.shapeComps.push(G._convertArcToBezier(p)):G.shapeComps.push(p)}}},x.prototype.$8w=function(){var M,q,N,e,X,w,$,t,E,u,g,b,h,y,P,f,x,R,G,j,K,p,C,m,O,Q=this,s=Q._models;M=n.TEXT,O=Q.options.textScaleRatio;var l=Q.options.useTextCompScale?Q.options.browserMinFontSize:0;for(e=0,X=M.length;e<X;e++){q=M[e],N=s[q];for(t in N)for(E=N[t],w=0,$=E.length;w<$;w++)if(u=E[w],(g=u.text||u.tag)&&g.length){if("MTEXT"===q)b=Q.$3w(u.height||12),h=Q.$3w(u.position.x,1),y=Q.$3w(u.position.y,2),K=u.angle?u.angle:u.directionX?Math.atan2(u.directionY,u.directionX):0,K+=u.addonAngle||0,m=1,j=u.attachmentPoint||1,R=j%3,G=Math.floor(j/3),G=1===G?"middle":0===G?"top":"bottom",f=0===R?"right":2===R?"center":"left";else{b=Q.$3w(u.textHeight||12),K=u.rotation||0,m=u.xScale||1,2===u.generationFlags?K=2*Math.PI-K:4===u.generationFlags?K=Math.PI-K:6===u.generationFlags&&(K=Math.PI+K),R=u.halign,G=u.valign;var Y=u.startPoint;(!Y||R||G)&&(Y=u.endPoint),h=Q.$3w(Y.x,1),y=Q.$3w(Y.y,2),4===R&&(R=1,G=2),f=2===R||5===R?"right":1===R||4===R?"center":"left",G=3===G?"top":2===G?"middle":"bottom"}y+=b/6,K=2*Math.PI-K;var I=b*O,r=1;if(I<l&&(r=I/l,I=l),5===R){var d=u.startPoint,a=u.endPoint;if(d&&a){var D=a.x-d.x;m=D/g.length/b}}if(o=g.match(/\\H([0-9\.]+)x;/)){var W=parseFloat(o[1]);I*=W,b*=W}var v=1;if((o=g.match(/\\W([0-9\.]+)[x;]/))&&(v=parseFloat(o[1])),P=I+"px "+(S(u.font)||Q.options.font),g=g.replace(/%%%/g,"%"),g=g.replace(/%%P/g,"\xb1"),g=g.replace(/%%C/g,"\u0444"),"MTEXT"===q){g=g.replace(/\\{/g,"#@#"),g=g.replace(/\\}/g,"#@@"),g=g.replace(/({|})/g,""),g=g.replace(/#@#/g,"{"),g=g.replace(/#@@/g,"}");var o,H=g.match(/\\[Cc]([^;]*);/);if(H){var U=J(parseInt(H[1]-1));U&&(t="#"+U.toString(16))}g=g.replace(/\\[FfLIOoKkNXQHWSACTPp~][^;]*;/g,""),p=g.split("\\P");var V=p.length;for(V>1&&"bottom"===G&&(y-=(V-1)*b*1.5),C=0;C<p.length;C++)x={type:"text",cadType:q,cadLayer:u.layer,handle:u.handle,color:t,text:p[C],rotation:K,rect:[h,y+C*b*1.5,0,0],align:f,vAlign:G,font:P,visible:!u.hidden},1!==r&&(x.scaleX=x.scaleY=r),x.scaleX=v*r,Q.shapeComps.push(x)}else x={type:"text",cadType:q,cadLayer:u.layer,handle:u.handle,color:t,text:g,scaleX:m,rotation:K,rect:[h,y,1e-5,1e-5],align:f,vAlign:G,font:P,visible:!u.hidden},1!==r&&(x.scaleX*=r,x.scaleY=r),Q.shapeComps.push(x)}}},x.prototype.drawAttrDef=function(){var M,q,N,e,X,w,$,t,E,J,u,g,b,h,y,P,f,x,n=this,R=n._models;x=n.options.textScaleRatio;var G=n.options.useTextCompScale?n.options.browserMinFontSize:0,j=R.ATTDEF,K=[],p={};for(N in j)for(e=j[N],M=0,q=e.length;M<q;M++){X=e[M],$=n.$3w(X.textHeight||12),P=X.rotation||0,2===X.generationFlags?P=2*Math.PI-P:4===X.generationFlags?P=Math.PI-P:6===X.generationFlags&&(P=Math.PI+P),P=2*Math.PI-P,h=X.halign,y=X.valign;var C=X.startPoint;(!C||h||y)&&(C=X.endPoint),t=n.$3w(C.x,1),E=n.$3w(C.y,2),g=X.tag,w=g||X.text||"";var m=p[g]||0;p[g]=m+1,m>0&&(g=g+"_"+m),g&&K.push({attr:g+".x",valueType:"Number"},{attr:g+".y",valueType:"Number"},{attr:g+".cadRotation",valueType:"Angle"});var O=!0;"invisible"in X&&(O=!X.invisible),!X.constant&&O&&(K.push({attr:g+".visible",valueType:"Boolean"}),K.push({attr:g+".text",valueType:"String"})),4===h&&(h=1,y=2),u=2===h||5===h?"right":1===h||4===h?"center":"left",y=3===y?"top":2===y?"middle":"bottom";var Q=$*x,s=1;Q<G&&(s=Q/G,Q=G),J=Q+"px "+(S(X.font)||n.options.font),f=X.scale||1;var l=f,Y=f;1!==s&&(l*=s,Y=s),b={type:"text",cadType:"ATTDEF",cadLayer:X.layer,handle:X.handle,color:N,text:w,scaleX:{func:new Function("data","view",["if (!data) return;","var PI2 = Math.PI * 2;","var r = (data.getRotation() % PI2 + PI2) % PI2 - Math.PI;","var f = Math.abs(r) <= Math.PI / 2 ? -1 : 1;","return Math.sign(data.getScaleX()) * f * "+l+";"].join("\n")),value:l},scaleY:{func:new Function("data","view",["if (!data) return;","var PI2 = Math.PI * 2;","var r = (data.getRotation() % PI2 + PI2) % PI2 - Math.PI;","var f = Math.abs(r) <= Math.PI / 2 ? -1 : 1;","return Math.sign(data.getScaleY()) * f * "+Y+";"].join("\n")),value:Y},rotation:P,rect:{func:new Function("data","view",["if (!data) return;","return [",'    data.ca("x") / data.getScaleX() + data.getAnchorX() * data.getWidth(),','    data.ca("y") / data.getScaleY() + data.getAnchorY() * data.getHeight(),',"    1e-5, 1e-5","]"].join("\n")),value:[t,E,1e-5,1e-5]},align:{func:new Function("data","view",["if (!data) return;","var PI2 = Math.PI * 2;","var r = (data.getRotation() % PI2 + PI2) % PI2 - Math.PI;","var f = Math.abs(r) <= Math.PI / 2 ? -1 : 1;",'if (data.getScaleX() * f > 0) return "'+u+'";','var map = { left: "right", right: "left", center: "center" };','return map["'+u+'"];'].join("\n")),value:u},vAlign:{func:new Function("data","view",["if (!data) return;","var PI2 = Math.PI * 2;","var r = (data.getRotation() % PI2 + PI2) % PI2 - Math.PI;","var f = Math.abs(r) <= Math.PI / 2 ? -1 : 1;",'if (data.getScaleY() * f > 0) return "'+y+'";','var map = { top: "bottom", bottom: "top", middle: "middle" };','return map["'+y+'"];'].join("\n")),value:y},font:J,visible:O,prefix:g},n.shapeComps.push(b)}return K},x.prototype.$7w=function(){var M,q,N,e,X,w,$,t,E,J,u,g,S,b,h,y,P,f,x,R,G,j,K=this,p=K._models;for(M=n.ELLIPSE,e=0,X=M.length;e<X;e++){q=M[e],N=p[q];for(t in N)for(E=N[t],w=0,$=E.length;w<$;w++){if(J=E[w],u=J.major,g=Math.atan2(u.y,u.x),S=K.$3w(Math.sqrt(u.x*u.x+u.y*u.y)),b=S*J.ratio,h=J.startAngle||0,y=J.angleLength||2*Math.PI,P=h+y,f=K.$3w(J.center.x,1),x=K.$3w(J.center.y,2),R=J.xInvert,G=J.yInvert^K.extrusionZNegative(J),G^=1,G||R?R&&G?(h=Math.PI+h,P=Math.PI+P,j=!1):(h=Math.PI*(R?1:2)-h,P=Math.PI*(R?1:2)-P,j=!0):j=!1,j){var C=h;h=P,P=C}g=2*Math.PI-g;var m={type:"arc",cadType:q,cadLayer:J.layer,handle:J.handle,rotation:g,rect:[f-S,x-b,2*S,2*b],arcFrom:h,arcTo:P,arcClose:!1,arcOval:!0};J.fill?m.background=t:(m.borderColor=t,m.borderWidth=1,m.borderWidthAbsolute=!0),K.options.convertArcToBezier?K.shapeComps.push(K._convertArcToBezier(m)):K.shapeComps.push(m)}}},x.prototype._convertArcToBezier=function(M){var q=M.arcFrom,N=M.arcTo;if(q===N)return M;q>N&&(N+=2*Math.PI);var e={type:"shape"},X=M.rect,w="type,rect,arcFrom,arcTo,arcClose,arcOval,rotation".split(",");for(var $ in M)w.indexOf($)>=0||(e[$]=M[$]);var t,E,J,u,g,S=e.points=[],b=e.segments=[1],h=N-q,y=Math.max(Math.ceil(Math.abs(h)/Math.PI*2),1),P=h/y,f=Math.tan(.5*P),x=Math.sin(P)*(Math.sqrt(4+3*f*f)-1)/3,n=Math.cos(q),R=Math.sin(q),G=X[2]/2,j=X[3]/2,K=X[0]+G,p=X[1]+j,C=Math.sin(M.rotation||0),m=Math.cos(M.rotation||0),O=function(M,q){var N=G*M,e=j*q;return{x:K+(m*N-C*e),y:p+(C*N+m*e)}},Q=O(n,R);S.push(Q.x,Q.y);for(var s=0;s<y;s++)J=q+(s+1)*P,t=Math.cos(J),E=Math.sin(J),Q=O(n-R*x,R+n*x),u=O(t+E*x,E-t*x),g=O(t,E),n=t,R=E,S.push(Q.x,Q.y,u.x,u.y,g.x,g.y),b.push(4);return e},x.prototype.$2cw=function(M,q,N){if(M){var e=M.x,X=M.y;return N=N||1,{x:e*N*q.a+X*q.c+q.tx,y:e*N*q.b+X*q.d+q.ty}}},x.prototype.$4w=function(M,q,N,e,X,w){var $=this,t=$.$2w(q,N);if(t&&(!$.options.filter||!$.options.filter(q,X))){var E,J,g,S=$.$2cw,b=q.type;if("HATCH"===b){if(q.patternFill)return;var h=q.paths,y=q.patterns;if(delete q.type,delete q.paths,delete q.patterns,h.forEach(function(t){for(var E in q)t[E]=q[E];t.fill=!0,$.$4w(M,t,N,e,X,w)}),!y)return;return void y.forEach(function(t){for(var E in q)t[E]=q[E];$.$4w(M,t,N,e,X,w)})}if("DIMENSION"===b||"INSERT"===b){if(!q.block)return;var P=N.blocks[q.block];if(!P||!P.entities)return;if(!(g=$._blockDef[q.block]))return void console.log("no entity ",q.block);var f=e||{a:1,b:0,c:0,d:1,tx:0,ty:0};if("INSERT"===b){var x=q.scale?q.scale.x:1,n=q.scale?q.scale.y:1,R=0,G=1,j=0;if(q.deg&&(R=q.deg*Math.PI/180,R=2*Math.PI-R,G=Math.cos(R),j=Math.sin(R)),e){var K=x*G,p=x*j,C=-n*j,m=n*G,O=q.center.x,Q=q.center.y;f={a:e.a*K+e.c*p,b:e.b*K+e.d*p,c:e.a*C+e.c*m,d:e.b*C+e.d*m,tx:e.a*O+e.c*Q+e.tx,ty:e.b*O+e.d*Q+e.ty}}else f={a:x*G,b:x*j,c:-n*j,d:n*G,tx:q.center.x,ty:q.center.y}}$.extrusionZNegative(q)&&(f.a*=-1,f.c*=-1,f.tx*=-1);var s=g.bound,l=(s.pos.x,s.pos.y,S({x:s.xMin,y:s.yMin},f)),Y=S({x:s.xMax,y:s.yMax},f),I=S({x:s.xMin,y:s.yMax},f),r=S({x:s.xMax,y:s.yMin},f),d=$._bound;d.xMin=Math.min(d.xMin,l.x,Y.x,I.x,r.x),d.yMin=Math.min(d.yMin,l.y,Y.y,I.y,r.y),d.xMax=Math.max(d.xMax,l.x,Y.x,I.x,r.x),d.yMax=Math.max(d.yMax,l.y,Y.y,I.y,r.y);var a;(a=$._models.BLOCK)||($._models.BLOCK=a=[]);var D={handle:q.handle,block:q.block,transform:f,attribs:q.attribs,layer:q.layer};return(!w&&$._blockDef[q.block].blendable||w&&q.color)&&(D.color=t),void a.push(D)}(E=M[b])||(E=M[b]={}),(J=E[t])||(J=E[t]=[]);var W=$.extrusionZNegative(q)&&["POINT","LINE","ELLIPSE"].indexOf(b)<0;if(e||W){e||(e={a:1,b:0,c:0,d:1,tx:0,ty:0});var v={};for(var o in q)v[o]=q[o];v.radius&&(v.radius*=Math.sqrt(e.a*e.a+e.b*e.b)),v.textHeight&&(v.textHeight*=Math.sqrt(e.a*e.a+e.b*e.b));var H=W?-1:1;if(v.position=S(v.position,e,H),v.startPoint=S(v.startPoint,e,H),v.center=S(v.center,e,H),"ELLIPSE"===b){var U;U=S({x:q.major.x+q.center.x,y:q.major.y+q.center.y},e,H),v.major={x:U.x-v.center.x,y:U.y-v.center.y},$.extrusionZNegative(q)&&(v.major.x*=-1)}var V;v.vertices&&(V=[],v.vertices.forEach(function(M){var q=S(M,e,H);M.bulge&&(q.bulge=M.bulge),V.push(q)}),v.vertices=V),v.points&&(V=[],v.points.forEach(function(M){var q=S(M,e,H);M.bulge&&(q.bulge=M.bulge),V.push(q)}),v.points=V);var T=Math.atan2(e.b,e.a),_=Math.cos(T);v.yInvert=e.d*_<0,v.xInvert=e.a*_<0,0!==T&&(v.addonAngle=T),q=v}return $.$8dw(q),J.push(q),t===u($.options.defaultColor)}},x.prototype.$8cw=function(M){for(var q=1/0,N=1/0,e=-1/0,X=-1/0,w=0,$=M.length;w<$;w++){var t=M[w];q=Math.min(q,t.x),N=Math.min(N,t.y),e=Math.max(e,t.x),X=Math.max(X,t.y)}return{xMin:q,yMin:N,xMax:e,yMax:X}},x.prototype.$8dw=function(M){var q,e,X=this;e=M.type;for(q in n){if(n[q].indexOf(e)>=0)break;q=N}if(q){var w,$,t,E,J,u,g,S,b,h,y,P,f,x,R,G,j,K,p,C,m,O=X.$8cw;switch(q){case"LINE":case"LWLINE":for(w=O(M.vertices),C=M.vertices.length,K=0;K<C;K++)p=M.vertices[K],X._isStraightLine(p.bulge)||(K!==C-1||M.shape)&&(m=O(X._getBulgeSegment(p,M.vertices[(K+1)%C],p.bulge)),w.xMin=Math.min(w.xMin,m.xMin),w.yMin=Math.min(w.yMin,m.yMin),w.xMax=Math.max(w.xMax,m.xMax),w.yMax=Math.max(w.yMax,m.yMax));break;case"SOLID":w=O(M.points);break;case"POINT":if(!M.position)return;$=M.position.x,t=M.position.y,w={xMin:$,yMin:t,xMax:$,yMax:t};break;case"TEXT":case"ATTDEF":var Q=M.text||"";if("TEXT"===q&&!Q)return;$=M.position?M.position.x:M.startPoint.x,t=M.position?M.position.y:M.startPoint.y,j=M.height||M.textHeight||12,X._minFontSize=Math.min(X._minFontSize,j),w={xMin:$,yMin:t,xMax:$+j*Q.length,yMax:t+j};break;case"CIRCLE":for($=M.center.x,t=M.center.y,E=M.radius,J=[],u=M.startAngle||0,g=u+(M.angleLength||2*Math.PI),S=M.xInvert^X.extrusionZNegative(M),b=M.yInvert,h=S?-1:1,y=b?-1:1,P=u;P<g+Math.PI/30;P+=Math.PI/30)P=Math.min(P,g),J.push({x:$+h*E*Math.cos(P),y:t+y*E*Math.sin(P)});w=O(J);break;case"ELLIPSE":for($=M.center.x,t=M.center.y,J=[],f=Math.sqrt(M.major.x*M.major.x+M.major.y*M.major.y),x=f*M.ratio,E=Math.atan2(M.major.y,M.major.x),R=Math.sin(E),G=Math.cos(E),u=M.startAngle||0,g=u+(M.angleLength||2*Math.PI),S=M.xInvert,b=M.yInvert^X.extrusionZNegative(M),h=S?-1:1,y=b?-1:1,P=u;P<g+Math.PI/30;P+=Math.PI/30){P=Math.min(P,g);var s=h*f*Math.cos(P),l=y*x*Math.sin(P);J.push({x:$+(G*s-R*l),y:t+(R*s+G*l)})}w=O(J);break;default:return}var Y=X._bound;Y.xMin=Math.min(Y.xMin,w.xMin),Y.yMin=Math.min(Y.yMin,w.yMin),Y.xMax=Math.max(Y.xMax,w.xMax),Y.yMax=Math.max(Y.yMax,w.yMax)}},x.prototype.parseFile=function(M){var q=this,N="string"==typeof q.options.sanitize?{sanitize:q.options.sanitize}:null,e=new $(N),X=e.parseSync(M);q._dxf=X,q._isAc2015="AC1015"===X.header.$ACADVER,q.$19w=q.$1w(X)},x.prototype.$3w=function(M,q){var N=this;return(2===q?-(M-N._shiftY):1===q?M-N._shiftX:M)*N._scale},x.prototype.$1w=function(M){var q,N,e,X,w,$,t,E,J,u,g,S;if(!q&&M.tables&&M.tables.viewPort){u=M.tables.viewPort.viewPorts;for(J in u)if(g=u[J],S=g.viewDirectionFromTarget,g.center&&(0===g.renderMode||S&&0===S.x&&0===S.y&&1===S.z)){e=g.center,X=g.upperRightCorner,w=g.lowerLeftCorner,q={x:X.x,y:X.y},N={x:w.x,y:w.y},$=g.viewWidth||0,t=g.viewHeight||0,g.viewTarget&&(e={x:e.x+g.viewTarget.x,y:e.y+g.viewTarget.y});break}}return!q&&M.header&&(E=M.header,E.$EXTMIN&&E.$EXTMAX&&(q=E.$EXTMAX,N=E.$EXTMIN)),$=Math.max($,q.x-N.x),t=Math.max(t,q.y-N.y),e=e||{x:$/2+N.x,y:t/2+N.y},{width:$,height:t,x:e.x,y:e.y}},x.prototype.$2w=function(M,q){var e,X=this;M||console.log("no entity",M),q.tables&&q.tables.layer&&(e=q.tables.layer.layers[M.layer]);var w;M.color!==N?w=M.color:256!==M.colorIndex&&M.colorIndex!=N||!e||(w=e.color),w&&16777215!==w||(w=X.options.defaultColor);var w=u(w);return X.options.mapColor&&(w=X.options.mapColor(w)),w},x.prototype.sortBlocks=function(M){var N,e,X,w,$=q.keys(M),t={};for(N in M)if(e=M[N],e.entities)for(var E=0,J=e.entities.length;E<J;E++)X=e.entities[E],"DIMENSION"!==(w=X.type)&&"INSERT"!==w||X.block&&(t[N]||(t[N]=[]),t[N].push(X.block));for(var u=$.length,g=u,S={},b=new Array(u),h=!1,y=function(M,q,N){if(N.indexOf(M)>=0)return void(h=!0);if(!S[q]){S[q]=!0;var e=t[M],X=e?e.length:0;if(X){var w=N.concat(M);do{var E=e[--X];if(y(E,$.indexOf(E),w),h)break}while(X)}b[--u]=M}};g--;)S[g]||y($[g],g,[]);return h?[]:b};var R=[0,5,9,13,15,18,20,25,30,35,40,50,53,60,70,80,90,100,106,120,140,158,200,211],G=function(M){for(var q,N,e,X,w=R.length,$=1;$<w;$++)if(q=R[$-1],N=R[$],e=q-M,X=N-M,e<=0&&X>=0)return Math.abs(e)<Math.abs(X)?q:N;return N},j=b.DxfWriter=function(M){this.$16w(M)};j.prototype={},j.prototype.constructor=j,q.defineProperties(j.prototype,{}),j.prototype.$16w=function(M){var N=this,e=b.DxfWriter.template;e.converted||(q.keys(e).forEach(function(M){e[M]=e[M].join("\n")}),e.converted=!0),N._transformFunc=M.transformFunc||function(M){return M},N._drawingScale=M.scale||1,N._matchFunc=M.matchFunc||function(){return!0},N._maxHandleId=262128},j.prototype.toDxf=function(M,q){var N=this;return N.dxfContent=M,N.gv=q,N.outputEntityLines=["ENTITIES","  0","ENDSEC"],N._fetchEntityContent(),N._collectGvEntity(),N._insertEntities(),N._write()},j.prototype._collectGvEntity=function(){var M=this;M.gv.dm().toDatas(M._matchFunc).each(function(q){var N=q.a("handle");N&&M._recordMaxHandleId(N)})},j.prototype._fetchEntityContent=function(){var M=this,q=M.dxfContent,N=M.entitiesStartIndex=q.indexOf("ENTITIES"),e=M.entitiesEndIndex=q.indexOf("ENDSEC",N)+"ENDSEC".length;M.entitiesContent=q.slice(N,e),M.dxfEntityLines=M.entitiesContent.split(/\r\n|\n/)},j.prototype._updateEntities=function(){var M=this,q=M.outputEntityLines,e=M.dxfEntityLines,X=M.gvEntities;q.push(e[0]);for(var w,$,t,E,J,u,g,S,b,h,y,P,f,x,n=1,R=1e5,G=M._findCode,j=M._toFloat;R--;){if("ENDSEC"===(E=e[n+1].trim())){q.push(e[n]),q.push(e[n+1]);break}for(w=n+2;R--&&"0"!==e[w].trim();)w+=2;if(J=e[G("5",e,n,w)],M._recordMaxHandleId(J),u=X[J]){for($=q.length,y=n;y<w;y++)q.push(e[y]);if(t=q.length,n=w,"edge"!==u.a("shapeType")){if("image"===u.a("shapeType")){for(g=M._getNodeRealScale(u),b=2*Math.PI-u.getRotation();b>=2*Math.PI;)b-=2*Math.PI;for(;b<0;)b+=2*Math.PI;S=M._transformFunc(u.getPosition()),Math.abs(g.x-1)<1e-5&&Math.abs(g.y+1)<1e-5&&(g.x=-1,g.y=1,b=2*Math.PI-b);var K={};[{key:"10",value:S.x},{key:"20",value:S.y},{key:"42",value:g.y,default:1,before:["50"]},{key:"41",value:g.x,default:1,dependOn:"42",before:["42","50"]},{key:"50",value:180*b/Math.PI,default:0}].forEach(function(M){if(P=M.key,f=M.value,x=M.default!==N&&Math.abs(f-M.default)<1e-5,f=j(f,"10"===P||"20"===P||"50"===P),h=G(P,q,$,t))f!==q[h].trim()&&(q[h]=f);else{if(x&&(!M.dependOn||K[M.dependOn]))return void(K[P]=!0);var e=!1;do{if(!M.before)break;if(h=N,M.before.forEach(function(M){var N=G(M,q,$,t);N&&(!h||N<h)&&(h=N)}),!h)break;q.splice(h-1,0," "+P,f),e=!0}while(!1);e||(q.push(" "+P),q.push(f)),t+=2}})}}else M._tryUpdateEdge(q,$,t,E,u)}else console.log("have no entity with handle "+J+" "+E),n=w}},j.prototype._recordMaxHandleId=function(M){var q=parseInt("0x"+M),N=this;N._maxHandleId=Math.max(N._maxHandleId,q)},j.prototype._nextHandleId=function(){return(++this._maxHandleId).toString(16).toUpperCase()},j.prototype._getNodeRealScale=function(M){var q=this,N=M.getScale(),e=M.getSize(),X=b.Default.getImage(M.getImage());return{x:N.x*e.width*X.scale/(X.width*q._drawingScale),y:N.y*e.height*X.scale/(X.height*q._drawingScale)}},j.template={INSERT:["  0","INSERT","  5","$HANDLE","330","1F","100","AcDbEntity","  8","0","100","AcDbBlockReference","  2","$BLOCK"," 10","$POSITION.X"," 20","$POSITION.Y"," 30","0.0"," 41","$SCALE.X"," 42","$SCALE.Y"," 50","$ROTATION"]},j.prototype._insertEntities=function(){var M,q=this;q.gv.dm().toDatas(q._matchFunc).each(function(N){if(M=null,N.a("addonBlock"))M=q._addonBlock(N);else if(N.a("addonText"))M=q._addonText(N);else if(N.a("addonARC")&&!N.s("shape.arc.oval")){var e=N.s("shape.arc.to"),X=N.s("shape.arc.from")||0;M=!e||Math.abs(e-X)>=2*Math.PI?q._addonCircle(N):q._addonARC(N)}else N.a("addonARC")&&N.s("shape.arc.oval")?M=q._addonEllipse(N):N.a("addonLine")?M=q._addonLine(N):N.a("addonRect")&&(M=q._addonRect(N));if(M){var w=M.length,$=q.outputEntityLines.length,t=$+w;q.outputEntityLines.length=t,q.outputEntityLines[t-1]=q.outputEntityLines[$-1],q.outputEntityLines[t-2]=q.outputEntityLines[$-2];for(var E=0,J=$-2;E<w;++E,++J)q.outputEntityLines[J]=M[E]}})};var K=function(M){if(M instanceof b.Shape){var q=new b.Matrix,N=M.getPosition();return q.translate(-N.x,-N.y).scale(M.getScaleX(),M.getScaleY()).rotate(M.getRotation()).translate(N.x,N.y),q}return M.getMatrix?M.getMatrix():new b.Matrix};j.prototype._addonRect=function(M){var q=this,N=M.getPoints(),e=M.getSegments(),X=!0;e&&(X=5===e.get(e.size()-1));var w=M.s("shape.dash"),$=M.s("shape.dash.pattern"),t=w?$[0]/10:1,E=10*(M.s("shape.border.width")||0);E=G(E);var J,u=M.s("shape.border.color");w&&(u=M.s("shape.dash.color")),u&&(u=b.Default.toColorData(u),parseFloat((u[3]/255).toFixed(2)),u=(u[0]<<16)+(u[1]<<8)+u[2],J=f.indexOf(u));var g=["  0","LWPOLYLINE","  5",M.a("handle")||q._nextHandleId(),"330","1F","100","AcDbEntity","  8","0"];w&&g.push.apply(g,["  6","DASHED"]),u&&(J>=0?g.push.apply(g,[" 62",J]):g.push.apply(g,["420",u])),1!==t&&g.push.apply(g,[" 48",t]),b.Default.isNumber(E)&&g.push.apply(g,["370",E]),g.push.apply(g,["100","AcDbPolyline"," 90","        "+N.size()," 70","     "+(X?1:0)," 43","0.0"]);var S,h=q._toFloat,y=K(M);return N.each(function(M){S=q._transformFunc(y.tf(M)),g.push.apply(g,[" 10",h(S.x,!0)," 20",h(S.y,!0)])}),g},j.prototype._addonCircle=function(M){var q=this,N=["  0","CIRCLE","  5",M.a("handle")||q._nextHandleId(),"330","1F","100","AcDbEntity","  8","0","100","AcDbCircle"],e=q._toFloat,X=q._transformFunc(M.getPosition());N.push.apply(N,[" 10",e(X.x,!0)," 20",e(X.y,!0)," 30","0.0"]);var w=M.getScale(),$=M.getWidth()*w.x,t=M.getHeight()*w.y;return N.push.apply(N,[" 40",.5*Math.min($,t)/q._drawingScale]),N},j.prototype._addonLine=function(M){var q,N=this,e=[],X=N._toFloat,w=M.getPoints(),$=K(M),t=N._transformFunc($.tf(w.get(0))),E=M.a("handle")||N._nextHandleId(),J=M.s("shape.dash"),u=M.s("shape.dash.pattern"),g=J?u[0]/10:1,S=10*(M.s("shape.border.width")||0);S=G(S);var h,y=M.s("shape.border.color");return J&&(y=M.s("shape.dash.color")),y&&(y=b.Default.toColorData(y),parseFloat((y[3]/255).toFixed(2)),y=(y[0]<<16)+(y[1]<<8)+y[2],h=f.indexOf(y)),w.each(function(M,w){0!==w&&(e.push.apply(e,["  0","LINE","  5",E,"330","1F","100","AcDbEntity","  8","0"]),J&&e.push.apply(e,["  6","DASHED"]),y&&(h>=0?e.push.apply(e,[" 62",h]):e.push.apply(e,["420",y])),1!==g&&e.push.apply(e,[" 48",g]),b.Default.isNumber(S)&&e.push.apply(e,["370",S]),e.push.apply(e,["100","AcDbLine"]),e.push.apply(e,[" 10",X(t.x,!0)," 20",X(t.y,!0)," 30","0.0"]),q=N._transformFunc($.tf(M)),e.push.apply(e,[" 11",X(q.x,!0)," 21",X(q.y,!0)," 31","0.0"]),t=q,E=N._nextHandleId())}),e},j.prototype._addonEllipse=function(M){var q=this,N=["  0","ELLIPSE","  5",M.a("handle")||q._nextHandleId()];N.push.apply(N,["330","1F","100","AcDbEntity","  8","0","100","AcDbEllipse"]);var e=q._toFloat,X=q._transformFunc(M.getPosition());N.push(" 10");N.push(e(X.x,!0));N.push(" 20");N.push(e(X.y,!0)),N.push.apply(N,[" 30","0.0"]);var w,$=M.getScale(),t=M.getWidth()*$.x/q._drawingScale,E=M.getHeight()*$.y/q._drawingScale,J=.5*Math.max(t,E),u=0;t>E?w={x:J,y:0}:(w={x:0,y:J},u=.5*-Math.PI);var g=-M.getRotation(),S=Math.sin(g),b=Math.cos(g),h=b*w.x-S*w.y,y=S*w.x+b*w.y;N.push.apply(N,[" 11",e(h,!0)," 21",e(y,!0)," 31","0.0"]),N.push.apply(N,["210","0.0","220","0.0","230","1.0"]);var P=t/E;P>1&&(P=1/P),N.push.apply(N,[" 40",e(P,!0)]);var f=M.s("shape.arc.from"),x=M.s("shape.arc.to"),n=2*Math.PI-x+u,R=(n+x-f)%(2*Math.PI);return N.push.apply(N,[" 41",n," 42",R||2*Math.PI]),N},j.prototype._addonARC=function(M){var q=this,N=["  0","ARC","  5",M.a("handle")||q._nextHandleId()];N.push.apply(N,["330","1F","100","AcDbEntity","  8","0","100","AcDbCircle"]);var e=q._toFloat,X=q._transformFunc(M.getPosition());N.push(" 10");N.push(e(X.x,!0));N.push(" 20");N.push(e(X.y,!0)),N.push.apply(N,[" 30","0.0"]);var w=M.getScale(),$=M.getWidth()*w.x,t=M.getHeight()*w.y,E=.5*Math.min($,t);N.push.apply(N,[" 40",e(E/q._drawingScale,!0)]),N.push.apply(N,["100","AcDbArc"]);var J=M.getRotation(),u=M.s("shape.arc.from"),g=M.s("shape.arc.to"),S=2*Math.PI,b=(S-g-J)%S,h=(b+g-u)%S;return h=h||2*Math.PI,N.push.apply(N,[" 50",e(180*b/Math.PI,!0)," 51",e(180*h/Math.PI,!0)]),N};var p={left:0,center:1,right:2},C={top:3,middle:2,bottom:1};j.prototype._addonText=function(M){
var q=this,N=["  0","TEXT","  5",M.a("handle")||q._nextHandleId()];N.push.apply(N,["330","1F","100","AcDbEntity","  8","0","100","AcDbText"]);var e=M.s("text.font")||"16px Standard",X=M.s("text"),w=b.Default.getTextSize(e,X),$=M.getScale(),t=parseFloat(e)/q._drawingScale*$.y,E=t/w.height*w.width,J=q._toFloat,u=q._transformFunc(M.getPosition());u.y+=t/4;var g=N.push(" 10");N.push(J(u.x,!0));var S=N.push(" 20");N.push(J(u.y,!0)),N.push.apply(N,[" 30","0.0"]),N.push(" 40"),N.push(t),N.push("  1"),N.push(X);var h=2*Math.PI-M.getRotation();N.push(" 50"),N.push(J(180*h/Math.PI%360,!0)),N.push(" 41"),N.push($.x/$.y),e=e.substr(e.indexOf("px")+3).split(","),N.push("  7"),N.push(e[0]);var y=M.s("text.align")||"left",P=M.s("text.vAlign")||"bottom";if("left"!==y&&(N.push(" 72"),N.push("     "+p[y])),"bottom"!==P||"left"!==y){N.push(" 11"),N.push(J(u.x,!0)),N.push(" 21"),N.push(J(u.y,!0)),N.push.apply(N,[" 31","0.0"]);var f=0,x=0;"center"===y?f=.5*E:"right"===y&&(f=E),f*=$.x,"top"===P?x=t:"middle"===P&&(x=.5*t),x*=$.y;var n=Math.cos(h+Math.PI),R=Math.sin(h+Math.PI);N[g]=n*f-R*x+u.x,N[S]=R*f+n*x+u.y}return N.push.apply(N,["100","AcDbText"]),"bottom"!==P&&(N.push(" 73"),N.push("     "+C[P])),N},j.prototype._addonBlock=function(M){var q=this,N=b.DxfWriter.template.INSERT;N=N.replace("$HANDLE",M.a("handle")||q._nextHandleId()),N=N.replace("$BLOCK",M.getImage());for(var e=q._getNodeRealScale(M),X=2*Math.PI-M.getRotation();X>=2*Math.PI;)X-=2*Math.PI;for(;X<0;)X+=2*Math.PI;var w=q._transformFunc(M.getPosition());Math.abs(e.x-1)<1e-5&&Math.abs(e.y+1)<1e-5&&(e.x=-1,e.y=1,X=2*Math.PI-X);var $=q._toFloat;return N=N.replace("$POSITION.X",$(w.x,!0)),N=N.replace("$POSITION.Y",$(w.y,!0)),N=N.replace("$SCALE.X",$(e.x)),N=N.replace("$SCALE.Y",$(e.y)),N=N.replace("$ROTATION",$(180*X/Math.PI,!0)),N.split(/\r\n|\n/)},j.prototype._tryUpdateEdge=function(M,q,N,e,X){var w=this,$=b.Default.getInternal(),t=$.getEdgeAgentPosition(w.gv,X.getSourceAgent(),X.s("edge.source.position"),X.s("edge.source.offset.x"),X.s("edge.source.offset.y"),X.s("edge.source.anchor.x"),X.s("edge.source.anchor.y")),E=$.getEdgeAgentPosition(w.gv,X.getTargetAgent(),X.s("edge.target.position"),X.s("edge.target.offset.x"),X.s("edge.target.offset.y"),X.s("edge.target.anchor.x"),X.s("edge.target.anchor.y"));t=w._transformFunc(t),E=w._transformFunc(E);var J=w._findCode;if("LINE"===e)M[J("10",M,q,N)]=t.x,M[J("20",M,q,N)]=t.y,M[J("11",M,q,N)]=E.x,M[J("21",M,q,N)]=E.y;else if("LWPOLYLINE"===e){for(var u,g=J("10",M,q,N),S=g;u=J("10",M,S+1,N);)S=u;S=(u=J("30",M,S+1,N))?u:J("20",M,S+1,N),M.splice(g-1,S-g+2);var h=[t];X.s("edge.points").each(function(M){h.push(w._transformFunc(M))}),h.push(E);var y=g-1;h.forEach(function(q){M.splice(y,0,"10",q.x,"20",q.y),y+=4})}},j.prototype._findCode=function(M,q,N,e){for(var X=N,w=!1;X<e;){if(M===q[X].trim()){w=!0;break}X+=2}if(w)return X+1},j.prototype._toFloat=function(M,q){return q||(M=Math.round(1e8*M)/1e8),M=""+M,M.indexOf(".")<0&&(M+=".0"),M},j.prototype._write=function(){var M=this,q=M.dxfContent,N=M.outputEntityLines.join("\n"),e=M.entitiesStartIndex,X=M.entitiesEndIndex;return q.slice(0,e)+N+q.slice(X)}}("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:(0,eval)("this"),Object);var hX=function(){function M(q,N){YN(this,M),this.editor=N,this.handler=q,this.cookie=0,this.callbacks={},this.cmds={};var e=oN.config.host||window.location.hostname,X=oN.config.port||window.location.port,w=this.url=window.location.protocol+"//"+e+":"+X;this.socket=io.connect(w),this.initEventListener()}return M.prototype.request=function(M,q,N){if("uploadLocalFile"===M)return void this.requestHttp(M,q,N);var e=++this.cookie;this.callbacks[e]=N,this.cmds[e]=M;var X=this.editor.sid;this.socket.emit(M,e,q,X?{sid:X}:null);var w=M;q&&(kN(q)?w=M+": "+q:q.path&&(w=M+": "+q.path)),this.handler({type:"request",message:w,cmd:M,data:q})},M.prototype.requestHttp=function(M,q,N){var e=++this.cookie;this.callbacks[e]=N,this.cmds[e]=M;var X=this.editor.sid;this[M](e,q,X||null,N);var w=M;q&&(kN(q)?w=M+": "+q:q.path&&(w=M+": "+q.path)),this.handler({type:"request",message:w,cmd:M,data:q})},M.prototype.uploadLocalFile=function(M,q,N){var e=this,X=new FormData,w=this.url+"/uploadFile",$=q.path;w+="?sid="+N,X.append("path",q.path),X.append("file",q.file),e.send("POST",w,X,function(q){var N=q.target;if(200===N.status||0===N.status){var X=N.response;if(e.handleRespone(M,!0),X){var w=JSON.parse(X);e.handler({type:"confirm",path:w.tempName,datas:w.paths})}else e.handler({type:"fileChanged",path:$})}})},M.prototype.send=function(M,q,N,e){var X=new ht.Request,w={};w.url=encodeURI(q),w.method=M,w.data=N,e&&(X.onload=e),X.send(w)},M.prototype.handleRespone=function(M,q){var N=this.callbacks[M],e=this.cmds[M];delete this.callbacks[M],delete this.cmds[M],this.handler({type:"response",message:e,cmd:e,data:q}),N&&N(q)},M.prototype.initEventListener=function(){var M=this;this.socket.on("connect",function(){M.handler({type:"connected",message:M.url})}),this.socket.on("disconnect",function(){M.handler({type:"disconnected",message:M.url})}),this.socket.on("fileChanged",function(q){M.handler({type:"fileChanged",path:q.path,event:q.event})}),this.socket.on("operationDone",function(q,N){M.handleRespone(q,N)}),this.socket.on("download",function(q){M.handler({type:"download",path:q})}),this.socket.on("confirm",function(q,N){M.handler({type:"confirm",path:q,datas:N})})},M}();ht.Default.getMSMap().hteditor_list_rename=function(M,q){M.rename=function(M,q){this.getLabel(M)!==q&&M.setDisplayName(q)},M.getEditRect=function(M){return{x:0,y:0,width:100,height:100}},M.beginEditing=function(M){var q=this;this.cancelEditing(),this.makeVisible(M),this.validate(),this._currentEditor=new ht.widget.TextField,this._currentEditor.data=M;var N=this._currentEditor.getElement(),e=this.getLabel(M);N.value=null==e?"":e,N.onblur=function(M){q.endEditing()},N.onkeydown=function(N){if(n(N)){if(q.endEditing(),oN.config.enterToRenameNext){var e=q.dm(),X=e.getSiblings(M),w=X.get(X.indexOf(M)+1);w&&q.beginEditing(w)}}else R(N)&&q.cancelEditing()},this.getView().appendChild(this._currentEditor.getView());var X=this.getEditRect(M),w=X.x,$=X.y,t=X.width,E=X.height;H(this._currentEditor,w,$,t,E),this._currentEditor.setFocus(),ht.Default.callLater(N.select,N)},M.endEditing=function(){var M=this._currentEditor;M&&(this.rename(M.data,M.getValue()),delete this._currentEditor,V(M.getView()),this.redraw(),this.setFocus())},M.cancelEditing=function(){var M=this._currentEditor;M&&(delete this._currentEditor,V(M.getView()),this.redraw(),this.setFocus())}};var yX=function(M){function q(N,e){var X=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];YN(this,q);var w=dN(this,M.call(this,e));return w.editor=N,w.editable=X,w.dragToIndexEnabled=!0,w.dragToChildEnabled=!0,w.dragToRootEnabled=!0,w.addTopPainter(w.drawDNDState.bind(w)),w}return rN(q,M),q.prototype.getLabelColor=function(q){if(q===this.draggingData&&!this.isSelected(q))return oN.config.color_select;if(this.editor.sceneView){if(!q.s("3d.visible"))return oN.config.color_disabled}else if(!q.s("2d.visible"))return oN.config.color_disabled;return M.prototype.getLabelColor.call(this,q)},q.prototype.handleDelete=function(){this.editable&&this.removeSelection()},q.prototype.isDroppable=function(M,q){return!1},q.prototype._clearDragInfo=function(){this.editor.dnd.hideTip(),this._dragInfo&&(this._dragInfo=null,this.redraw())},q.prototype._endDrag=function(M,q){},q.prototype._endCrossDrag=function(M,q){},q.prototype.drawDNDState=function(M){oN.config.drawDNDState?M.drawDNDState=!0:(oN.config.texureImage3D&&(M.texureImage3D=!0),M.texureImage2D=!0);var q=void 0;if(this._dragInfo&&this._dragInfo.inView?q=this._dragInfo:this._crossDragInfo&&(q=this._crossDragInfo),q){var N=this.getWidth(),e=this.getRowHeight(),X=q.type,w=q.parent,$=w?this.getRowDatas().indexOf(w):-1,t=oN.config.color_select_dark;if(q.refData){if(this.dragToChildEnabled&&i(M,t,0,$*e,N,e,2),"up"===X||"down"===X){var E=q.x,J=q.y;M.beginPath(),M.arc(E-3,J,3,0,2*Math.PI,!0),M.moveTo(E,J),M.lineTo(N,J),M.lineWidth=2,M.strokeStyle=t,M.stroke()}}else if("parent"===X){var u=this.getViewRect();i(M,t,u.x,u.y,u.width,u.height,2)}}},q.prototype._dragging=function(M,q){var N=this.getRowHeight(),e=this.lp(M),X=e.y/N,w=Math.floor(X);if(w>this.getRowSize()-1||w<0)q.refData=null,q.type="parent",q.parent=null;else{var $=e.y-w*N,t=this.dragToChildEnabled?.25:.5,E=this.dragToChildEnabled?.75:.5;this.dragToIndexEnabled?q.type=$<N*t?"up":$>N*E?"down":"parent":q.type="parent";var J=this.getRowDatas().get(w);J&&this.isInnerDroppable(M,q,J)?(q.refData=J,"up"===q.type?(q.parent=J.getParent(),q.x=(this.getLevel(J)+1)*this.getIndent(),q.y=w*N):"down"===q.type?(this.getToggleIcon(J)===this.getExpandIcon()?(q.parent=J,q.x=(this.getLevel(J)+2)*this.getIndent()):(q.parent=J.getParent(),q.x=(this.getLevel(J)+1)*this.getIndent()),q.y=(w+1)*N):q.parent=J):(q.refData=null,q.parent=null,q.type="parent")}this.dragToRootEnabled||q.parent||"parent"!==q.type||(q.type=null),this.autoScroll(M),this.redraw()},q.prototype.$1$=function(){var M="";if(this.draggingData&&(M=this.getLabel(this.draggingData),this.isSelected(this.draggingData))){var q=this.sm().size();M+=q>1?" (+"+q+") ":""}return M},q.prototype.handleDragAndDrop=function(M,q){if(this.editable){if("prepare"===q)return void this._clearDragInfo();"begin"===q&&(this._dragInfo={tip:this.$1$(),view:this});var N=this._dragInfo;if(N){var e=this.editor.dnd;if("begin"===q||"between"===q){return this.getView().contains(m(M))?(N.inView=!0,this._dragging(M,N),e.clearDropView(M,N)):(N.inView&&this.redraw(),N.inView=!1,e.crossDrag(M,N)),void e.showTip(N.tip,M)}return"end"===q?(N.inView?this._endDrag(M,N):e.crossDrop(M,N),void this._clearDragInfo()):"cancel"===q?(N.inView||e.crossCancel(M,N),void this._clearDragInfo()):void 0}}},q.prototype.handleCrossDrag=function(M,q,N){if("exit"===q||"cancel"===q)return this._crossDragInfo=null,void this.redraw();if("enter"===q||"over"===q)return this._crossDragInfo||(this._crossDragInfo={}),void this._dragging(M,this._crossDragInfo);if("drop"===q){if(this.explorer){var e=this._crossDragInfo.parent?this._crossDragInfo.parent.url:this.explorer.currentDir,X={url:e,event:M};this.editor.fireEvent("explorerCrossDrop",X),X.preventDefault||this._endCrossDrag(M,N)}else this._endCrossDrag(M,N);return this._crossDragInfo=null,void this.redraw()}},q.prototype.isEditable=function(M){return this.editable},q.prototype.handleDataDoubleSelect=function(M,q){if(this.isEditable(q)){var N=this.getLevel(q);N+=this.getIcon(q)?2:1,this.lp(M).x>N*this.getIndent()&&this.beginEditing(q)}},q.prototype.getEditingLabel=function(M){return this.getLabel(M)},q.prototype.addBlockItems=function(M){var q=this,N=function(){return q.sm().size()>0},X=function(){for(var M=q.sm(),N=M.getSelection(),e=0,X=M.size();e<X;e++){var w=N.get(e);if(w instanceof ht.Block&&!(w instanceof ht.RefGraph))return!0}return!1};M.push({separator:!0,visible:function(){return q.editable&&(N()||X())}}),M.push({id:"block",label:e("editor.block"),action:function(){q.editor.block()},visible:function(){return q.editable&&N()}}),M.push({id:"unblock",label:e("editor.unblock"),action:function(){q.editor.unblock()},visible:function(){return q.editable&&X()}})},q.prototype.addSelectDescendantItems=function(M){var q=this;M.push({id:"selectDescendant",label:e("editor.selectdescendant"),action:function(){var M=q.sm(),N=M.getSelection().toArray(),e=[];N.forEach(function(M){q.dm().eachByDepthFirst(function(M){N.indexOf(M)>=0||e.push(M)},M)}),M.as(e)},visible:function(){return!!q.sm().size()}})},q.prototype.isInnerDroppable=function(M,q,N){return!1!==N.a("droppable")&&!(!this.dragToRootEnabled&&!N.getParent())},q}(Oe);MM(yX,{hteditor_list_rename:1,getEditRect:function(M){var q=this.getLevel(M);q+=this.getIcon(M)?2:1;var N=this.getIndent()*q;return{x:N,y:this.ty()+this.getRowIndex(M)*this.getRowHeight(),width:Math.max(1,this.getWidth()-N),height:this.getRowHeight()}}});var PX=function(M){function q(N){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];YN(this,q);var X=dN(this,M.call(this,N.editor,N.dataModel,e));return X.explorer=N,X.dragToIndexEnabled=!1,X.setSortFunc(oN.config.createFileTreeSortFunc(X)),X}return rN(q,M),q.prototype.match=function(M,q){return M.indexOf(q)>=0},q.prototype.onPropertyChanged=function(q){var N=this;if(M.prototype.onPropertyChanged.call(this,q),"filter"===q.property){var e=q.newValue;if(e){var X=this._fileVisibleMap={};this.dm().eachByDepthFirst(function(M){var q=N.getLabel(M);(N.match(q,e)||N.match(M.url,e))&&(X[M.uuid]=!0);var w=M.getParent();w&&X[M.uuid]&&(X[w.uuid]=!0)}),this._cloneExpandMap||(this._cloneExpandMap=ht.Default.clone(this._expandMap)),this.expandAll()}else this._fileVisibleMap=void 0,this._cloneExpandMap&&(this._expandMap=this._cloneExpandMap),this._cloneExpandMap=void 0;this.ivm()}},q.prototype.isVisible=function(M){if("root"===M.fileType)return!0;if(!1===M.a("visible"))return!1;if("dir"!==M.fileType)return!1;if(this._visibleFunc&&!1===this._visibleFunc(M))return!1;var q=this._fileVisibleMap;return!(q&&!q[M.uuid])},q.prototype.onDataDoubleClicked=function(M,q){this.explorer.setFilter("")},q.prototype.getLabel=function(M){return e("url:"+M.url,!0)||this.getEditingLabel(M)},q.prototype.getEditingLabel=function(M){return M.getName()},q.prototype.handleBackgroundClick=function(M){},q.prototype.handleDelete=function(){this.editable&&oN.config.removeFileByKeyboardEnabled&&this.explorer.deleteSelection(this)},q.prototype.isDroppable=function(M,q){if(this.editable&&q.view===this.explorer.list){var N=this.getDataAt(M);if(!(this.dragToRootEnabled||N&&N.getParent()))return!1;var e=q.view.draggingData,X=e&&e.getImage();return!kN(X)||0!==X.indexOf(cN)}return q.view===this.editor.dndFromOutside},q.prototype._endCrossDrag=function(M,q){var N=this;if(this._crossDragInfo){var X=q.view,w=this._crossDragInfo.parent;if(w||(w=this.explorer.rootNode),X===this.explorer.list){var $=X.draggingData,t=function(){X.isSelected($)?X.sm().toSelection().each(function(M){N.editor.moveFile(M,w)}):N.editor.moveFile($,w)};oN.config.promptForMovingFile?eq(e("editor.move"),e("editor.confirmmovefile"),t,function(){}):t()}else X===this.editor.dndFromOutside&&this.editor.dropLocalFileOnDir(M,w)}},q.prototype._endDrag=function(M,q){var N=this,X=q.parent;if(!X){if(!this.dragToRootEnabled)return;X=this.explorer.rootNode}var w=this.draggingData,$=function(){if(N.isSelected(w)){N.getTopRowOrderSelection().each(function(M){N.editor.moveFile(M,X)})}else N.editor.moveFile(w,X),N.sm().ss(w);X&&N.expand(X)};oN.config.promptForMovingFile?eq(e("editor.move"),e("editor.confirmmovefile"),$,function(){}):$()},q.prototype.isEditable=function(M){return this.editable&&M&&!1!==M.a("editable")},q.prototype.beginEditing=function(q){var N={data:q,url:q.url};this.editor.fireEvent("fileRenaming",N),N.preventDefault||M.prototype.beginEditing.call(this,q)},q.prototype.rename=function(M,q){this.editor.renameFile(M,q,function(){M.s("label")?M.s("label",q):M.setName(q)})},q.prototype.getIcon=function(M){return void 0!==M.getIcon()?M.getIcon():"dir"===M.fileType?this.hasExpandedChild(M)?"editor.direxpanded":"editor.dircollapsed":"root"===M.fileType?"editor.root.state":null},q}(yX);MM(PX,{ms_ac:["filter"]});var fX=function(M){function q(N){return YN(this,q),dN(this,M.call(this,N))}return rN(q,M),q.prototype.isVScrollable=function(){return this.gv.getViewRect().height<this.gv.getScrollRect().height},q.prototype.isV=function(M){var q=this.gv.getViewRect();return this.isVScrollable()&&(q.x+q.width-this.gv.lp(M).x)*this.gv.getZoom()<ht.Default.scrollBarInteractiveSize},q.prototype.clear=function(M){M&&this._dragging&&!this._dragCancel&&this.gv.handleDragAndDrop(M,"end"),this.gv.draggingData&&(this.gv.draggingData.iv(),this.gv.draggingData=null,this.gv.redraw()),this._dragging=this._dragCancel=this._clientPoint=null},q.prototype.handle_mousedown=function(M){this.handle_touchstart(M)},q.prototype.handle_touchstart=function(M){if(!this.isV(M)&&!Mq(M.target)){NM(M),this.clear(M),this._clientPoint=C(M);var q=this.gv,N=q.getDataAt(M);j(M)?N?q.isDraggable&&!1===q.isDraggable(N)||(q.draggingData=N,N.iv(),q.redraw(),q.handleDragAndDrop(M,"prepare"),p(this,M)):q.sm().cs():(N?this.handleSelection(M,N):this._cancelDataDoubleSelect(),this.clear(M))}},q.prototype.handle_mouseup=function(M){this.handle_touchend(M)},q.prototype.handle_touchend=function(M){if(this._clientPoint&&!this._dragging){var q=this.gv.getDataAt(M);q?this.handleSelection(M,q):this._cancelDataDoubleSelect()}this.gv._justDoubleClickData=!1,this.gv._levelChanged=!1,this.clear(M)},q.prototype.handleWindowMouseMove=function(M){this.handleWindowTouchMove(M)},q.prototype.handleWindowMouseUp=function(M){this.handleWindowTouchEnd(M)},q.prototype.handleWindowTouchMove=function(M){NM(M),this._dragging?this._dragCancel||this.gv.handleDragAndDrop(M,"between"):this._clientPoint&&this.gv.draggingData&&s(C(M),this._clientPoint)>2&&(this._dragging=!0,this.gv.handleDragAndDrop(M,"begin"))},q.prototype.handleWindowTouchEnd=function(M){NM(M),this.clear(M)},q.prototype.handleSelection=function(M,q){var N=this.gv.sm();if(k(M))this.gv.isSelected(q)?N.removeSelection(q):N.appendSelection(q);else if(_(M)){var e=N.ld();if(e)for(var X=this.gv.nodes,w=X.indexOf(e),$=X.indexOf(q);w!==$;)w+=$>w?1:-1,N.as(X[w]);else N.ss(q)}else j(M)?(N.contains(q)?(this._handleDataDoubleSelect(M,q),K(M)&&this._cancelDataDoubleSelect()):this._cancelDataDoubleSelect(),!0!==this.gv._levelChanged&&N.ss(q)):N.contains(q)||N.ss(q)},q.prototype.handle_keydown=function(M){if(!Mq(M.target))if(R(M))this._dragging&&!this._dragCancel&&(this.gv.handleDragAndDrop(M,"cancel"),this._dragCancel=!0);else if(P(M)||x(M)||y(M)||f(M)){var q=this.gv.sm(),N=this.gv.nodes,e=q.ld();if(N.length){var X=void 0;if(e){var w=N.indexOf(e);P(M)||y(M)?0!==w&&(X=N[w-1]):w!==N.length-1&&(X=N[w+1])}else X=N[0];X&&(_(M)?q.as(X):q.ss(X))}}},q.prototype._handleDataDoubleSelect=function(M,q){var N=this;this._cancelDataDoubleSelect(),this._doubleSelectTimer=setTimeout(function(){N.gv.handleDataDoubleSelect(M,q),N._doubleSelectTimer=void 0},ht.Default.doubleClickSpeed)},q.prototype._cancelDataDoubleSelect=function(){this._doubleSelectTimer&&(clearTimeout(this._doubleSelectTimer),this._doubleSelectTimer)},q}(ht.graph.Interactor),xX=function(M){function q(N){YN(this,q);var e=dN(this,M.call(this,N.editor,N.dm));return e.displayView=N,e.graphView=N.graphView,e.nodeIcon=LM(e),e.initMenu(),e.initStudio&&e.initStudio(),N.dm.addDataPropertyChangeListener(function(M){var q=M.data;(q instanceof ht.Shape||q instanceof ht.Edge)&&(q.editorIcon=null)}),e.enableToolTip(),e}return rN(q,M),q.prototype.getToolTip=function(M){return oN.config.getToolTip(M,this)},q.prototype.getBorderColor=function(M){return null},q.prototype.onDataDoubleClicked=function(M,q){this.editor.fitSelection()},q.prototype.onPropertyChanged=function(q){"filter"===q.property&&(this.visibleMap=null,this.ivm()),M.prototype.onPropertyChanged.call(this,q)},q.prototype.handleDataPropertyChange=function(q){!this._filter||"name"!==q.property&&"displayName"!==q.property?M.prototype.handleDataPropertyChange.call(this,q):(this.visibleMap=null,this.ivm())},q.prototype.checkVisible=function(M){if(!this._filter)return!0;if(oN.config.displayTreeVisibleFunc)return oN.config.displayTreeVisibleFunc(M,this._filter);var q=this.getLabel(M),N=(this._filter+"").toLowerCase();return null!=q&&(q=(q+"").toLowerCase(),q.indexOf(N)>=0)},q.prototype.validateModel=function(){var q=this;this._filter&&!this.visibleMap&&(this.visibleMap={},this.getDataModel().each(function(M){if(q.checkVisible(M)){q.visibleMap[M._id]=!0;for(var N=M.getParent();N&&!q.visibleMap[N._id];)q.visibleMap[N._id]=!0,N=N.getParent()}})),M.prototype.validateModel.call(this),oN.config.filterDisplayViewEnabled&&this.graphView.setVisibleFunc(function(M){return q.isVisible(M,!0)})},q.prototype.isVisible=function(M,q){if(!q&&M._refGraph)return!1;var N=this.getVisibleFunc();return!(N&&!N(M))&&(!this._filter||this.visibleMap&&this.visibleMap[M._id])},q.prototype.validate=function(){this.graphView.validate(),M.prototype.validate.call(this)},q.prototype.getLabel=function(M){var q=M.getDisplayName()||M.getName()||M.getTag();return q||(q=M instanceof ht.Text?M.s("text"):M.s("label")),q||e(M.s("editor.folder")?"ht.Folder":M.getClassName())},q.prototype.getIcon=function(M){return M instanceof ht.SubGraph?"editor.subgraph":M instanceof ht.Group?"editor.group":M instanceof ht.RefGraph||M instanceof ht.Text?M.getIcon():M instanceof ht.Block?"editor.block":M instanceof ht.Shape?(M.editorIcon||(M.editorIcon=FM(M)),M.editorIcon):M instanceof ht.Edge?(M.editorIcon||(M.editorIcon=iM(this,M)),M.editorIcon):M instanceof ht.Node?this.nodeIcon:M.s("editor.folder")?this.hasExpandedChild(M)?"editor.direxpanded":"editor.dircollapsed":null},q.prototype.isDroppable=function(M,q){return!!this.editor.editable&&(q.view===this.editor.symbols.getFileListView()||(q.view===this.editor.assets.getFileListView()||q.view===this.editor.displays.getFileListView()))},q.prototype._endCrossDrag=function(M,q){var N=this;if(this.editor.editable&&this._crossDragInfo){this.editor.beginTransaction();var e=[],X=q.view,w=this._crossDragInfo.type,$=this._crossDragInfo.parent,t=this._crossDragInfo.refData;X!==this.editor.symbols.getFileListView()&&X!==this.editor.assets.getFileListView()||X.toDraggingDatas("down"===w).forEach(function(q){var X=new ht.Node;X.setImage(q.getFileUUID()),X.setDisplayName(D(q.getName())),e.push(X),N.displayView.addData(X,!0,void 0,void 0,M),N.editor.gv.$63$([X]),N._dropData(X,w,$,t)}),X===this.editor.displays.getFileListView()&&X.toDraggingDatas("down"===w).forEach(function(q){if(q.url!==N.editor.url){var X=new ht.RefGraph;X.setRef(q.getFileUUID()),X.setDisplayName(D(q.getName())),e.push(X),N.displayView.addData(X,!0,void 0,void 0,M),N._dropData(X,w,$,t)}}),e.length&&this.sm().ss(e),this.editor.endTransaction()}},q.prototype._endDrag=function(M,q){var N=this;if(this.editor.editable){this.editor.beginTransaction();var e=q.type,X=q.parent,w=q.refData;if(this.isSelected(this.draggingData)){var $=this.getTopRowOrderSelection();"down"===e&&$.reverse(),$.each(function(M){N._dropData(M,e,X,w)})}else this._dropData(this.draggingData,e,X,w),this.sm().ss(this.draggingData);X&&this.expand(X),this.editor.endTransaction()}},q.prototype._dropData=function(M,q,N,e){if(this.editor.editable)if(M.setParent(N),"down"===q||"up"===q){var X=N?N.getChildren():this.dm().getRoots(),w=X.indexOf(e);"down"===q&&w++,X.indexOf(M)<w&&w--,this.dm().moveTo(M,w)}else N||this.dm().moveToBottom(M)},q.prototype.initMenu=function(){this.menu=new ne;var M=[];this.initMenuItems(M),this.menu.setItems(M),this.menu.addTo(this.getView()),this.editor.menus.push(this.menu)},q.prototype.onClosed=function(){E(this.editor.menus,this.menu)},q.prototype.initMenuItems=function(M){var q=this,N=function(){for(var M=q.editor.selection,N=0;N<M.length;N++)if(M[N].s("editor.folder"))return!0;return!1};M.push.apply(M,[{id:"folder",label:e("editor.folder"),action:function(){q.editor.folder()},visible:function(){return q.editable&&!!q.editor.ld}},{id:"unfolder",label:e("editor.unfolder"),action:function(){q.editor.unfolder()},visible:function(){return q.editable&&N()}},{separator:!0,visible:function(){return q.editable&&!!q.editor.ld}},{id:"copy",label:e("editor.copy"),action:function(){q.editor.copy()},visible:function(){return!!q.editor.ld}},{id:"paste",label:e("editor.paste"),action:function(){q.editor.paste()},visible:function(){return q.editable&&q.editor.hasCopyInfo()}},{id:"delete",label:e("editor.delete"),action:function(){q.editor.delete()},visible:function(){return q.editable&&!!q.editor.ld}},{separator:!0,visible:function(){return q.editable&&!!q.editor.ld}},{id:"bringToFront",label:e("editor.bringtofront"),action:function(){q.editor.bringToFront()},visible:function(){return q.editable&&!!q.editor.ld}},{id:"bringForward",label:e("editor.bringforward"),action:function(){q.editor.bringForward()},visible:function(){return q.editable&&!!q.editor.ld}},{id:"sendBackward",label:e("editor.sendbackward"),action:function(){q.editor.sendBackward()},visible:function(){return q.editable&&!!q.editor.ld}},{id:"sendToBack",label:e("editor.sendtoback"),action:function(){q.editor.sendToBack()},visible:function(){return q.editable&&!!q.editor.ld}},{separator:!0,visible:function(){return q.editable&&!!q.editor.ld}},{id:"expandAll",label:e("editor.expandall"),action:function(){q.expandAll()}},{id:"collapseAll",label:e("editor.collapseall"),action:function(){q.collapseAll()}}]),this.addSelectDescendantItems(M),this.addBlockItems(M),this.editor.$103$(M),this.editor.addShapeSplitMenuItems(M)},IN(q,[{key:"editable",get:function(){return this.editor.editable},set:function(M){}}]),q}(yX);MM(xX,{ms_ac:["filter"]});var nX=function(M){function q(N){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];YN(this,q);var X=dN(this,M.call(this,N.dataModel));return X.explorer=N,X.editable=e,X.editor=N.editor,X.getHScrollBar().style.display="none",X.setMaxFileSize(oN.config.imageSize),X.enableToolTip(),X.setPannable(!1),X.setInteractors([new ht.graph.ScrollBarInteractor(X),new fX(X),new ht.graph.DefaultInteractor(X),new ht.graph.TouchInteractor(X,{editable:!1})]),X.mi(function(M){var q=M.kind;"beginScroll"===q?X.disableToolTip():"endScroll"===q&&X.enableToolTip()}),X}return rN(q,M),q.prototype.getToolTip=function(M){var q=this.getDataAt(M);return q?this._filter?q.url:this.getLabel(q):null},q.prototype.getLabel=function(M){return e("url:"+M.url,!0)||this.getEditingLabel(M)},q.prototype.isEditable=function(M){return this.editable&&M&&!1!==M.a("editable")},q.prototype.getEditingLabel=function(M){return M.s("label")||M.getName()},q.prototype.rename=function(M,q){this.editor.renameFile(M,q,function(){M.s("label")?M.s("label",q):M.setName(q)})},q.prototype.handleDelete=function(){this.editable&&oN.config.removeFileByKeyboardEnabled&&this.explorer.deleteSelection(this)},q.prototype.beginEditing=function(M){var q=this,N={data:M,url:M.url};if(this.editor.fireEvent("fileRenaming",N),!N.preventDefault){this.cancelEditing(),this.makeVisible(M),this.validate();var e=this.getDataUI(M),X=!1,w=void 0;if(this.explorer.isAccordionMode()&&"dir"===M.fileType?(w=M.getRect(),X=!0):e&&e.labelInfo&&(w=e.labelInfo.rect),w){var $=void 0,t=void 0,E=void 0,J=void 0;if(X)$=w.x,t=w.y,E=w.width,J=w.height;else if("list"===this._layoutType)$=this._rowHeight,t=M.p().y-this._rowHeight/2,E=this.getWidth()-$,J=this._rowHeight;else{var u=e.labelInfo.rect||M.getRect();$=M.p().x-M.getWidth()/2,t=u.y,E=M.getWidth(),J=u.height}t+=this.ty(),this._currentEditor=new ht.widget.TextField,this._currentEditor.data=M;var g=this._currentEditor.getElement(),S=this.getEditingLabel(M);"asset"===M.fileType&&(this._editingExtension=v(S),S=D(S)),g.value=null==S?"":S,g.onblur=function(M){q.endEditing()},g.onkeydown=function(M){n(M)?q.endEditing():R(M)&&q.cancelEditing()},this.getView().appendChild(this._currentEditor.getView()),H(this._currentEditor,$,t,E,J),this._currentEditor.setFocus(),ht.Default.callLater(g.select,g)}}},q.prototype.endEditing=function(){var M=this._currentEditor;M&&(this.rename(M.data,M.getValue()+(this._editingExtension||"")),delete this._currentEditor,delete this._editingExtension,V(M.getView()),this.redraw())},q.prototype.cancelEditing=function(){var M=this._currentEditor;M&&(delete this._currentEditor,V(M.getView()),this.redraw())},q.prototype._clearDragInfo=function(){this.editor.dnd.hideTip(),this._dragInfo&&(this._dragInfo=null,this.redraw())},q.prototype.handleDragAndDrop=function(M,q){if("prepare"===q)return void this._clearDragInfo();if("begin"===q){var N=this.draggingData;"display"===N.fileType&&ht.ui&&ht.ui.DragHelper.doDrag(this,{"a:clazz":"ht.ui.UIGraphView","a:initProps":{disableInit:!0,url:N.uuid+".json"}},{width:10,height:0,comps:[]},0,0),"symbol"===N.fileType?ht.ui&&ht.ui.DragHelper.doDrag(this,{"a:clazz":"ht.ui.UIVectorView","a:initProps":{url:N.uuid+".json"}},{width:10,height:0,comps:[]},0,0):"scene"===N.fileType?ht.ui&&ht.ui.DragHelper.doDrag(this,{"a:clazz":"ht.ui.UIGraph3dView","a:initProps":{disableInit:!0,url:N.uuid+".json"}},{width:10,height:0,comps:[]},0,0):"ui"===N.fileType&&ht.ui&&ht.ui.DragHelper.doDrag(this,{"a:clazz":"ht.ui.RefViewGroup","a:initProps":{url:N.uuid+".json",draggingData:N}},{width:10,height:0,comps:[]},0,0),this._dragInfo={tip:this.$1$(),view:this}}var e=this._dragInfo;if(e){var X=this.editor.dnd;if("begin"===q||"between"===q){return this.getView().contains(m(M))?(e.inView=!0,this._dragging(M,e),X.clearDropView(M,e)):(e.inView&&this.redraw(),e.inView=!1,X.crossDrag(M,e)),void X.showTip(e.tip,M)}return"end"===q?(e.inView?this._endDrag(M,e):X.crossDrop(M,e),void this._clearDragInfo()):"cancel"===q?(e.inView||X.crossCancel(M,e),void this._clearDragInfo()):void 0}},q.prototype._dragging=function(M,q){if(this.editable){var N=this.getDataAt(M);N&&"dir"===N.fileType&&!1!==N.a("droppable")?q.targetData=N:q.targetData=null,this.autoScroll(M),this.redraw()}},q.prototype.$1$=function(){var M="";if(this.draggingData&&(M=this.getLabel(this.draggingData),this.isSelected(this.draggingData))){var q=this.sm().size();M+=q>1?" (+"+q+") ":""}return M},q.prototype._endDrag=function(M,q){},q.prototype.handleSelectionChange=function(q){M.prototype.handleSelectionChange.call(this,q),this.redraw()},q.prototype.handleCrossDrag=function(M,q,N){if(this.editable){if("exit"===q||"cancel"===q)return this._crossDragInfo=null,void this.redraw();if("enter"===q||"over"===q)return this._crossDragInfo||(this._crossDragInfo={}),void this._dragging(M,this._crossDragInfo);if("drop"===q){var e=this._crossDragInfo.targetData?this._crossDragInfo.targetData.url:this.explorer.currentDir,X={url:e,event:M};return this.editor.fireEvent("explorerCrossDrop",X),X.preventDefault||this._endCrossDrag(M,N),this._crossDragInfo=null,void this.redraw()}}},q.prototype._endCrossDrag=function(M,q){if(this.editable&&this._crossDragInfo){var N=this._crossDragInfo.targetData;if(N&&"dir"===N.fileType||(N=this.dm().sm().ld()),N){var e=q.view;"displays"===this.explorer.rootDir&&e instanceof xX&&this.handleDisplayTreeDrop(e,N),e===this.editor.dndFromOutside&&this.editor.dropLocalFileOnDir(M,N)}}},q.prototype.validateImpl=function(){document.body.contains(this.getView())&&M.prototype.validateImpl.call(this)},q.prototype.isInteractive=function(){return!1},q}(Re);MM(nX,{ms_ac:["layoutType","fileSize","fileGap","rowHeight","maxFileSize","filter"],_fileRect:{x:0,y:0,width:0,height:0},_layoutType:"tile",_fileSize:50,_fileGap:6,_rowHeight:21,_maxFileSize:200});var RX={filter:!0,layoutType:!0,fileSize:!0,fileGap:!0,rowHeight:!0,visibleFunc:!0},GX=function(M){function q(N){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];YN(this,q);var X=dN(this,M.call(this,N,e));return X.nodes=[],X.doLayoutBind=X.doLayout.bind(X),X.dm().sm().ms(function(M){X.sm().cs(),X.doLayoutLater()}),X.dm().mm(function(){X.doLayoutLater()}),X.addInteractorListener(X.handleInteraction.bind(X)),X.addBottomPainter(X.paintBottom.bind(X)),X.addTopPainter(X.paintTop.bind(X)),X.getCoreInteractor().disabled=!0,X}return rN(q,M),q.prototype.selectAll=function(){this.sm().ss(this.nodes)},q.prototype.getDataAt=function(q){if("list"===this._layoutType){var N=Math.floor(this.lp(q).y/this._rowHeight);return this.nodes[N]}return M.prototype.getDataAt.call(this,q)},q.prototype.paintBottom=function(M){var q=this,N=this._rowHeight,e=this.getWidth();this.nodes.forEach(function(X){if(q.isSelected(X))if("list"===q._layoutType)M.beginPath(),M.rect(0,X.p().y-N/2,e,N),M.fillStyle=oN.config.color_select,M.fill();else{var w=X.getRect();i(M,oN.config.color_select,w.x-2,w.y-2,w.width+4,w.height+4,1)}})},q.prototype.paintTop=function(M){oN.config.drawDNDState?M.drawDNDState=!0:(oN.config.texureImage3D&&(M.texureImage3D=!0),M.texureImage2D=!0);var q=void 0
;if(this._dragInfo&&this._dragInfo.inView?q=this._dragInfo:this._crossDragInfo&&(q=this._crossDragInfo),q){var N=oN.config.color_select_dark,e=q.targetData;if(e)if("list"===this._layoutType){var X=e.p().y-this._rowHeight/2,w=this.getWidth(),$=this._rowHeight;i(M,N,0,X,w,$,2)}else{var t=e.getRect();M.beginPath(),M.rect(t.x,t.y,t.width,t.height),M.lineWidth=2,M.strokeStyle=oN.config.color_select_dark,M.stroke()}else{var E=this.getViewRect();i(M,N,E.x,E.y,E.width,E.height,2)}}},q.prototype.toDraggingDatas=function(M){var q=[];return this.isSelected(this.draggingData)?(this.sm().toSelection().each(function(M){"dir"!==M.fileType&&q.push(M)}),M&&q.reverse()):"dir"!==this.draggingData.fileType&&q.push(this.draggingData),q},q.prototype.isDroppable=function(M,q){return"displays"===this.explorer.rootDir&&q.view instanceof xX||q.view===this.editor.dndFromOutside},q.prototype._endDrag=function(M,q){var N=this,X=q.targetData;if(X){var w=this.draggingData,$=function(){N.isSelected(w)?N.sm().toSelection().each(function(M){N.editor.moveFile(M,X)}):N.editor.moveFile(w,X)};oN.config.promptForMovingFile?eq(e("editor.move"),e("editor.confirmmovefile"),$,function(){}):$()}},q.prototype.handleDisplayTreeDrop=function(M,q){var N=this,X=void 0;X=M.isSelected(M.draggingData)?M.getTopRowOrderSelection().toArray():[M.draggingData];var w={};X.forEach(function(M){qM(M,w)});var $=new ht.JSONSerializer(M.getDataModel(),!0);$.isSerializable=function(M){return w[M._id]};var t=$.serialize();qq(e("editor.inputnewdisplayname")+" ["+q.url+"]",M.getLabel(M.draggingData),{nullable:!1,trim:!0,maxLength:oN.config.maxFileNameLength,checkFunc:oN.config.checkFileName,$38$:this.editor.$38$,path:q.url+"/",editor:this.editor},function(M,e,X){if("ok"===e){gM(M)||(M+=".json");var $=X+M,E={path:$,content:t,parent_uuid:q.uuid,root_dir:q.rootDir};N.editor.request("upload",E,function(M){if(!0===M){var e=N.editor.gv,X=e.isVisible;e.isVisible=function(M){return X.call(e,M)&&w[M._id]},N.editor.saveImage(e,$.substr(0,$.length-5)+".png",void 0,M.uuid,M.parent_uuid,q.rootDir),e.isVisible=X,e.redraw()}N.editor.fireEvent("displayViewSaved",{url:$})})}})},q.prototype.handleDataDoubleSelect=function(M,q){if(this.isEditable(q)){var N=this.lp(M);if("list"===this._layoutType)N.x>this._rowHeight&&this.beginEditing(q);else{var e=this.getDataUI(q);e&&e.labelInfo&&e.labelInfo.rect&&ht.Default.containsPoint(e.labelInfo.rect,N)&&this.beginEditing(q)}}},q.prototype.getLabelColor=function(M){return M!==this.draggingData||this.isSelected(M)?"list"===this._layoutType?this.isSelected(M)?oN.config.color_light:ht.Default.labelColor:this.isSelected(M)?oN.config.color_select:ht.Default.labelColor:oN.config.color_select},q.prototype.handleInteraction=function(M){var q=M.kind,N=M.data,e=M.event;"doubleClickData"===q&&1===this.sm().size()&&(this._justDoubleClickData=!0,"dir"===N.fileType?(this.dm().sm().ss(N),this._levelChanged=!0):this.editor.open(N,_(e),!0))},q.prototype.handleScroll=function(M,q){NM(M),_(M)?q>0?this.setFileSize(Math.min(this.getFileSize()+2,this.getMaxFileSize())):this.setFileSize(Math.max(this.getFileSize()-2,1)):(LN||M.wheelDelta!==M.wheelDeltaX)&&(q=LN&&M.detail?-M.detail:M.wheelDelta/40,this.translate(0,20*q))},q.prototype.handlePinch=function(M,q,N){N<q?this.setFileSize(Math.min(this.getFileSize()+2,this.getMaxFileSize())):this.setFileSize(Math.max(this.getFileSize()-2,1))},q.prototype.onPropertyChanged=function(M){nX.prototype.onPropertyChanged.apply(this,arguments),RX[M.property]&&("fileSize"===M.property&&(this._fileSizeChanged=!0),this.doLayoutLater())},q.prototype.match=function(M,q){return M.indexOf(q)>=0},q.prototype.isVisible=function(M){if(this._layouting){if(!1===M.a("visible"))return!1;if(this._visibleFunc&&!1===this._visibleFunc(M))return!1;var q=this._filter;if(q){var N=this.dm().sm().ld();if(!M.isDescendantOf(N))return!1;if(oN.config.vision&&(M.uuid===D(q)||M.url===q))return!0;var e=this.getLabel(M);if(!e||!this.match(e,q)||!this.match(M.url,q)||"dir"===M.fileType||"root"===M.fileType)return!1}else{var X=this.dm().sm().ld();if(!X||M.getParent()!==X)return!1}if(!("unknow"!==M.fileType))return!1}else{if(this.nodes.indexOf(M)<0)return!1;if(!this.isNodeInRect(M))return!1}return!0},q.prototype.isNodeInRect=function(M){var q=ht.Default.clone(this.getViewRect());return ht.Default.grow(q,this.getFileSize()),!(!ht.Default.containsPoint(q,M.p())&&!ht.Default.intersectsRect(q,M.getRect()))},q.prototype.isMovable=function(){return!1},q.prototype.onValidated=function(){this._lastWidth===this.getWidth()&&this._lastHeight===this.getHeight()||this.doLayoutLater()},q.prototype.adjustTranslateX=function(){return 0},q.prototype.adjustTranslateY=function(M){var q=this.getHeight()-this._fileRect.height;return M<q&&(M=q),M>0?0:Math.round(M)},q.prototype.getContentRect=function(){return this._fileRect},q.prototype.doLayoutLater=function(){this._doLayoutLater||(this._doLayoutLater=!0,requestAnimationFrame(this.doLayoutBind))},q.prototype.getSortFunc=function(){return this._sortFunc},q.prototype.setSortFunc=function(M){this._sortFunc=M},q.prototype.doLayout=function(){if(this._doLayoutLater=!1,document.body.contains(this.getView())){this.redraw();var M=this.nodes;if(!this._fileSizeChanged){this._layouting=!0,M=this.nodes=this.dm().toDatas(this.isVisible,this).toArray();var q=this.getSortFunc();q&&M.sort(q),this._layouting=!1}delete this._fileSizeChanged;var N=this._lastWidth=this.getWidth();this._lastHeight=this.getHeight();var e=this._fileGap;if("list"===this._layoutType){for(var X=this._rowHeight,w=Math.max(X-4,2),$=0;$<M.length;$++)this.updateFileNodeProperties(M[$],e+w/2,X*$+2+w/2,w);this._fileRect={x:0,y:0,width:N,height:X*M.length}}else{for(var t=this._fileSize,E=t+e,J=t+e+16,u=e,g=e,S=0,b=0;b<M.length;b++)this.updateFileNodeProperties(M[b],u+t/2,g+t/2,t),(S+2)*E+e>N?(u=e,b!==M.length-1&&(g+=J),S=0):(u+=E,S++);this._fileRect={x:0,y:0,width:N,height:g+J}}this.tx(this.tx()),this.ty(this.ty()),this.showScrollBar()}},q.prototype.updateFileNodeProperties=function(M,q,N,e){"list"===this._layoutType?(M.setPosition(q,N),M.setSize(e,e),M.s({"label.position":20,"label.offset.x":3,"label.offset.y":0,"label.max":void 0})):(M.setPosition(q,N),M.setSize(e,e),M.s({"label.position":31,"label.offset.x":0,"label.offset.y":2,"label.max":e}))},q}(nX),jX=function(M){function q(N,e,X,w){YN(this,q);var $=dN(this,M.call(this));return $.setSize(20,20),$.setAnchor(.5,.5),$.s({"select.width":0,pixelPerfect:!1,"image.stretch":"centerUniform","label.position":17}),$.path=e,$.rootDir=N,$.update(e,X,w),$}return rN(q,M),q.prototype.update=function(M,q,N){var e=this.rootDir;this.path=M,this._id=this.url=M?M+"/"+q:q,this.value=N,this.uuid=mM(N)&&kN(N.fileType)&&null!=N.uuid?N.uuid:D(this.url),this.postfix=N&&N.postfix?N.postfix:v(this.url).substr(1);var X="unknow",w=void 0,$=void 0,t=N&&N.uuid&&this.postfix?this.uuid+"."+this.postfix:this.url,E=q;N&&N.attrs&&N.attrs.label&&(this.label=E=N.attrs.label),""===M?(X="root",$="editor.root.state"):"assets"===e&&($=this.getFileImage(q))?(X="asset",this.s("label",E)):gM(q)&&"displays"===e?(X="display",$=KM(t),this.s("label",D(q))):gM(q)&&"symbols"===e?(X="symbol",$=KM(t),this.s("label",D(q))):gM(q)&&"components"===e?(X="component",$=KM(t),this.s("label",D(q))):gM(q)&&"scenes"===e?(X="scene",$=KM(t),this.s("label",D(q))):gM(q)&&"models"===e?(X="model",$=KM(t),this.s("label",D(q))):SM(q)&&"models"===e?(X="model",$="editor.file.model.htb",this._imageURL=pM(t),this.s("label",D(q))):gM(q)&&"uis"===e?(X="ui",$=KM(t),this.s("label",D(q))):this.s("label",E),mM(N)&&(kN(N.fileType)?(X=N.fileType,w=N.fileIcon,$=N.fileImage||$||w,$||"dir"!==N.fileType||($="editor.dir"),this.a(N.attrs),this.s(N.styles)):(!0===N.dir||null==N.dir&&null==N.fileType)&&(X="dir",$="editor.dir")),$||($="editor.unknown"),this.fileType=X,this.setIcon(w),this.setImage($),this.setName(q)},q.prototype.getFileUUID=function(){return this.postfix?this.uuid+"."+this.postfix:this.uuid},q.prototype.getFileImage=function(M){return uM(M)?this.url:fM(M)?"editor.dxf.state":xM(M)?"editor.obj.state":nM(M)?"editor.mtl.state":RM(M)?"editor.ttf.state":GM(M)?"editor.otf.state":hM(M)?"editor.sound.state":yM(M)?"editor.video.state":jM(M)?"editor.js.state":void 0},q.prototype.setAnchor=function(){for(var q,N=arguments.length,e=Array(N),X=0;X<N;X++)e[X]=arguments[X];var w=(q=M.prototype.setAnchor).call.apply(q,[this].concat(e));return w||(this._anchor=this._anchor),w},q.prototype.updateLayoutAttaches=function(){},q}(ht.Node);ht.Default.setCompType("accordion-title-comp",function(M,q,N,e,X){var w=oN.config.drawAccordionTitle;if(w)return void w(M,q,e,X,{isHover:e.__hover,isExpanded:e.expanded,hoverColor:oN.config.color_hover,selectColor:oN.config.color_select});var $=e.__hover,t=q.x,E=q.y,J=q.width,u=q.height,g=X.getLabel(e),S=X.getFileGap();M.save(),($||X.isSelected(e))&&(M.fillStyle=oN.config.color_hover,M.fillRect(t,E,J,u)),M.fillStyle=oN.config.color_select,M.fillRect(t+S,E+(u-8)/2,8,8),g&&ht.Default.drawText(M,g,"bold 14px Arial",ht.Default.labelColor,t+S+8+8,E,200,u,"left","middle"),M.restore()}),ht.Default.setImage("accordion-title",{width:160,height:24,fitSize:!0,pixelPerfect:!1,interactive:!0,boundExtend:2,onDown:function(M,q,N,e,X,w){ht.Default.isLeftButton(M)&&(N.getMutex()&&!q.expanded&&N.dirs.forEach(function(M){M!==q&&(M.expanded=!1)}),q.expanded=!q.expanded,N.ivm())},onEnter:function(M,q,N,e,X,w){q.__hover=!0,q.iv()},onLeave:function(M,q,N,e,X,w){q.__hover=!1,q.iv()},comps:[{type:"accordion-title-comp",displayName:"clock-pointer",rect:[0,0,160,24]}]});var KX={layoutType:!0,fileSize:!0,fileGap:!0,rowHeight:!0,filePadding:!0,titleHeight:!0},pX=function(M){function q(N){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];YN(this,q);var X=dN(this,M.call(this,N,e));return X.setFileGap(10),X.setMutex(oN.config.accordionMutex),X.nodes=[],X.dirs=[],X.bottomRects=[],X.addViewListener(function(M){"beginValidate"===M.kind&&X.doLayout()}),X.setSelectionModelShared(!1),X.dm().sm().ms(function(){X.sm().cs()}),X._layouted=!1,X.mi(X.handleInteraction.bind(X)),X.addBottomPainter(X.paintBottom.bind(X)),X.addTopPainter(X.paintTop.bind(X)),X}return rN(q,M),q.prototype.paintBottom=function(M){var q=this,N=this._rowHeight,e=this.getWidth();this.nodes.forEach(function(X){if("list"===q._layoutType)q.isSelected(X)&&(M.beginPath(),M.rect(0,X.p().y-N/2,e,N),M.fillStyle=oN.config.color_select,M.fill());else{var w=q.isSelected(X)?oN.config.color_select:oN.config.color_mask,$=X.getRect(),t=$.x,E=$.y,J=$.width,u=$.height,g=q._filePadding;i(M,w,t-g,E-g,J+2*g,u+2*g,1)}}),M.beginPath(),M.lineWidth=2,M.strokeStyle=oN.config.color_hover,this.bottomRects.forEach(function(q){var N=q.x,e=q.y,X=q.width,w=q.height;M.moveTo(N+10,e+w/2),M.lineTo(N+X-10,e+w/2)}),M.stroke()},q.prototype.isDroppable=function(M,q){return"displays"===this.explorer.rootDir&&q.view instanceof xX||q.view===this.editor.dndFromOutside},q.prototype.handleDragAndDrop=function(q,N){var e=this.draggingData;e&&"dir"!==e.fileType&&M.prototype.handleDragAndDrop.call(this,q,N)},q.prototype.isLabelVisible=function(M){return"dir"!==M.fileType},q.prototype.paintTop=function(M){oN.config.drawDNDState?M.drawDNDState=!0:(oN.config.texureImage3D&&(M.texureImage3D=!0),M.texureImage2D=!0);var q=void 0;if(this._dragInfo&&this._dragInfo.inView?q=this._dragInfo:this._crossDragInfo&&(q=this._crossDragInfo),q){var N=oN.config.color_select_dark,e=q.targetData;if(e){var X=e.getRect();M.beginPath(),M.rect(X.x,X.y,X.width,X.height),M.lineWidth=2,M.strokeStyle=oN.config.color_select_dark,M.stroke()}else{var w=this.getViewRect();i(M,N,0,0,w.width,w.height,2)}}},q.prototype.getDataAt=function(q){if("list"!==this._layoutType)return M.prototype.getDataAt.call(this,q);var N=M.prototype.getDataAt.call(this,q);if(N)return N;for(var e=this.lp(q).y,X=0;X<this.nodes.length;X++){var w=this.nodes[X],$=w.getY(),t=this._rowHeight,E=$-t/2,J=$+t/2;if(e>=E&&e<J)return w}},q.prototype.handleInteraction=function(M){var q=M.kind,N=M.data,e=M.event;"doubleClickData"===q&&1===this.sm().size()&&"dir"!==N.fileType&&(this.setFilter(""),N.getParent().expanded=!0,this.sm().ss(N),this.ivm(),this.editor.open(N,_(e),!0))},q.prototype.handleDataDoubleSelect=function(M,q){if(this.isEditable(q)){var N=this.lp(M);if("dir"!==q.fileType)if("list"===this._layoutType)N.x>this._rowHeight&&this.beginEditing(q);else{var e=this.getDataUI(q);e&&e.labelInfo&&e.labelInfo.rect&&ht.Default.containsPoint(e.labelInfo.rect,N)&&this.beginEditing(q)}}},q.prototype.getLabelColor=function(M){return M!==this.draggingData||this.isSelected(M)?"list"===this._layoutType?this.isSelected(M)?oN.config.color_light:ht.Default.labelColor:this.isSelected(M)?oN.config.color_select:ht.Default.labelColor:oN.config.color_select},q.prototype.isVisible=function(M){if(!this._layouted)return!1;if(this._visibleFunc&&!1===this._visibleFunc(M))return!1;var q=this.explorer.rootDir,N=M.getParent();if(!1===M.a("visible"))return!1;if("unknow"===M.fileType||!N)return!1;if(this._visibleFunc&&!this._visibleFunc(M))return!1;if(this._filter){var e=this.getLabel(M);if(N.url===q&&"dir"===M.fileType){for(var X=M.getChildren(),w=0;w<X.length;w++){var $=X.get(w);if(this.isVisible($))return!0}return!1}if(N.getParent()&&N.getParent().url===q&&"dir"!==M.fileType)return!(!e||e.indexOf(this._filter)<0)}return N.url===q&&"dir"===M.fileType||!(!N.getParent()||N.getParent().url!==q||"dir"===M.fileType)&&!!N.expanded},q.prototype.adjustTranslateX=function(M){return 0},q.prototype.adjustTranslateY=function(M){if(!this.contentHeight)return 0;var q=this.getViewRect(),N=q.height-this.contentHeight;return M>=0||N>=0?0:M>N?M:N},q.prototype.getImage=function(M){if(M.getImage)return"dir"===M.fileType?"accordion-title":M.getImage()},q.prototype.doLayout=function(){var M=this;if(this._lastWidth!==this.getWidth()||this._lastHeight!==this.getHeight()||this._lastFileSize!==this.getFileSize()){this._doLayoutLater=!1,this.redraw();var q=this.dirs=[],N=this.nodes=[],e=this.bottomRects=[];this.dm().each(function(N){M.isVisible(N)&&"dir"===N.fileType&&q.push(N)});var X=this._lastWidth=this.getWidth(),w=this._titleHeight,$=0;this._lastHeight=this.getHeight(),this._lastFileSize=this._fileSize,this._expandIds&&(this.dirs.forEach(function(q){q.expanded=M._expandIds.indexOf(q.getId())>=0}),delete this._expandIds),q.forEach(function(q){q.setAnchor(0,0),q.p(0,$),q.setSize(X,w),q.s("label",null),$+=w;var t=[];q.getChildren().each(function(q){M.isVisible(q)&&(t.push(q),N.push(q))}),$=M.layoutChildren(t,$),q.expanded&&(e.push({x:0,y:$,width:X,height:16}),$+=16)}),this.contentHeight=$,this._layouted=!0}},q.prototype.layoutChildren=function(M,q){if(!M||0===M.length)return q;var N=this._fileGap;if("list"===this._layoutType){var e=this._rowHeight,X=Math.max(e-4,15);return M.forEach(function(M,w){M.setPosition(N+X/2+oN.config.accordionListIndent,q+2+X/2),M.setSize(X,X),M.s({"label.position":20,"label.offset.x":3,"label.offset.y":0,"label.max":void 0}),q+=e}),q}var w=this.getWidth(),$=this._fileSize,t=this._filePadding,E=$+2*t,J=N,u=q+N,g=0,S=$+N+2*t,b=$+N+16+2*t;return M.forEach(function(q,e){q.setPosition(J+E/2,u+E/2),q.setSize($,$),q.s({"label.position":31,"label.offset.x":0,"label.offset.y":2+t,"label.max":E}),(g+2)*S+N>w?(J=N,e!==M.length-1&&(u+=b),g=0):(J+=S,g++)}),u+b},q.prototype.handleScroll=function(M){var q=LN&&M.detail?-M.detail:M.wheelDelta/10;(LN||M.wheelDelta!==M.wheelDeltaX)&&this.translate(0,q)},q.prototype.adjustZoom=function(){return 1},q.prototype.onPropertyChanged=function(q){M.prototype.onPropertyChanged.call(this,q);var N=q.property;"dataModel"!==N&&"fileSize"!==N||this.doLayout()},q.prototype._endDrag=function(M,q){var N=this,X=q.targetData;if(X&&"dir"===X.fileType){var w=this.draggingData,$=function(){N.isSelected(w)?N.sm().toSelection().each(function(M){N.editor.moveFile(M,X)}):N.editor.moveFile(w,X),N.doLayout(),N.redraw()};oN.config.promptForMovingFile?eq(e("editor.move"),e("editor.confirmmovefile"),$,function(){}):$()}},q.prototype.toDraggingDatas=function(M){var q=[];return this.isSelected(this.draggingData)?(this.sm().toSelection().each(function(M){"dir"!==M.fileType&&q.push(M)}),M&&q.reverse()):"dir"!==this.draggingData.fileType&&q.push(this.draggingData),q},q.prototype.invalidateModel=function(){this._lastWidth=null,this.iv()},q.prototype.ivm=function(){this.invalidateModel()},q.prototype.getContentRect=function(){return{x:0,y:0,width:this.getWidth(),height:this.contentHeight||0}},q.prototype.onPropertyChanged=function(q){M.prototype.onPropertyChanged.apply(this,arguments),KX[q.property]&&this.ivm()},q.prototype.isInteractive=function(M){return"dir"===M.fileType},IN(q,[{key:"expandIds",get:function(){var M=[];return this.dirs.forEach(function(q){q.expanded&&M.push(q.getId())}),M},set:function(M){this._expandIds=M,this._lastWidth=null}}]),q}(nX);MM(pX,{ms_ac:["filePadding","titleHeight","mutex"],_mutex:!1,_filePadding:6,_titleHeight:36});var CX=function(M){function q(N,e){var X=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];YN(this,q);var w=dN(this,M.call(this));return w.editor=N,w.rootDir=e,w.copyFileInfos=[],w.dataModel=new ht.DataModel,w.dataModel.setHierarchicalRendering(!0),w.dataModel.setAutoAdjustIndex(!1),w.urlUUIDMap={},w.uuidURLMap={},w.$6$(X),w}return rN(q,M),q.prototype.$6$=function(M){var q=this,N=this.mode=oN.config.explorerMode;"accordion"===N&&(this.accordion=new pX(this,M)),this.tree=new PX(this,M),this.list=new GX(this,M),this.controlPane=new WN,this.controlPane.addRow([{id:"filter",textField:{}},{id:"url",textField:{editable:!1}},{id:"slider",slider:{min:1,max:this.getFileListView().getMaxFileSize(),step:1,onValueChanged:function(M,N){q.getFileListView().setFileSize(N),q.getFileListView().setLayoutType(N>16?"tile":"list")}}}],[.1,.2,ht.Default.isTouchable?70:50]);var e=this.controlPane.getViewById("filter").getElement(),X=null,w=function(){X&&clearTimeout(X),X=setTimeout(function(){X=null,q.setFilter(e.value)},oN.config.filterDelay)};e.addEventListener("input",function(M){q._filterComposing||w()}),e.addEventListener("compositionstart",function(M){q._filterComposing=!0,X&&(clearTimeout(X),X=null)}),e.addEventListener("compositionend",function(M){q._filterComposing=!1,w()});var $=function(M){"filter"===M.property&&(e.value=M.newValue||"",e.value||q.tree.makeVisible(q.tree.sm().ld()||q.rootNode))};("accordion"===N?this.accordion:this.list).mp($);var t=this.controlPane.getItemById("slider").element;t.getToolTip=function(){},this.getFileListView().mp(function(M){"fileSize"===M.property&&t.setValue(M.newValue)}),this.bottomPane=new xe,this.bottomPane.setCenterView(this.getFileListView()),this.bottomPane.setBottomView(this.controlPane),this.bottomPane.setBottomHeight(ht.Default.widgetRowHeight+8),this.setOrientation("vertical");var E=this.getFileSize();"accordion"===N?(this.setLeftView(this.bottomPane),this.setPosition(1),this.accordion.sm().ms(function(){q.$51$(q.accordion)}),this.accordion.setFileSize(E),this.setDraggable(!1)):(this.setLeftView(this.tree),this.setRightView(this.bottomPane),this.setPosition(oN.config.explorerSplitViewPosition),this.list.setSelectionModelShared(!1),this.list.sm().ms(function(){q.$51$(q.list)}),this.list.setFileSize(E)),this.tree.menu=new ne,this.treeMenuItems=[],this.initTreeMenu(this.tree.menu,this.treeMenuItems),this.tree.menu.setItems(this.treeMenuItems),this.tree.menu.addTo(this.tree.getView()),this.editor.menus.push(this.tree.menu),this.list.menu=new ne,this.listMenuItems=[],this.initListMenu(this.list.menu,this.listMenuItems),this.list.menu.setItems(this.listMenuItems),this.list.menu.addTo(this.list.getView()),this.editor.menus.push(this.list.menu),this.isAccordionMode()&&(this.accordion.menu=new ne,this.accordionMenuItems=[],this.initAccordionMenu(this.accordion.menu,this.accordionMenuItems),this.accordion.menu.setItems(this.accordionMenuItems),this.accordion.menu.addTo(this.accordion.getView()),this.editor.menus.push(this.accordion.menu))},q.prototype.getFileSize=function(){return oN.config.fileSize},q.prototype.setFilter=function(M){if(!this._filterComposing)return"accordion"===this.mode?(this.accordion.setFilter(M),this.accordion.ivm()):(this.tree.setFilter(M),this.list.setFilter(M)),!0},q.prototype.$51$=function(M){var q=M.sm().ld();this.controlPane.v("url",q?q.getFileUUID():"")},q.prototype.isAccordionMode=function(){return"accordion"===this.mode},q.prototype.findFileNode=function(M){var q=this.dataModel.getDataById(M);return!q&&this.uuidURLMap[M]&&(q=this.dataModel.getDataById(this.uuidURLMap[M])),q},q.prototype.parse=function(M){var q=this,N=void 0,e=void 0,X=void 0,w=void 0,$=void 0;if("accordion"===this.mode?(e=this.accordion.expandIds,N=this.accordion.ty()):(N=this.tree.ty(),e=this.tree.expandIds,X=this.tree.selectionIds,w=this.tree.dm().size(),$=this.list.sm().toSelection().toArray().map(function(M){return M.getFileUUID()})),this.dataModel.clear(),_N(M))M.forEach(function(M){if(M){var N=M.attrs&&M.attrs.path?M.attrs.path:"",e=q.rootNode=q.addFileNode(q.rootDir,N,M.name,M);q.parseRoot(e,M)}});else{var t=this.rootNode=this.addFileNode(this.rootDir,"",this.rootDir);this.parseRoot(t,M)}var E=this.dataModel.getDatas(),J={};if(this.urlUUIDMap={},this.uuidURLMap={},E.toArray().forEach(function(M,N){J[M._id]=N,q.uuidURLMap[M.getFileUUID()]=M.url,q.urlUUIDMap[M.url]=M.getFileUUID()}),E.sort(function(M,q){return"root"===M.fileType?-1:"root"===q.fileType?1:"dir"===M.fileType&&"dir"!==q.fileType?-1:"dir"!==M.fileType&&"dir"===q.fileType?1:J[M._id]-J[q._id]}),"accordion"===this.mode)this.accordion.expandIds=e,this.accordion.ty(N);else{this.tree.expandIds=e,this.tree.selectionIds=X,this.tree.ty(N),0===w&&(this.tree.expand(this.rootNode),this.editor.explorer===this&&this.tree.sm().ss(this.rootNode));var u=$.map(function(M){return q.findFileNode(M)}).filter(function(M){return!!M});this.list.sm().ss(u)}this.list.doLayout();var g={explorer:this};this.editor.fireEvent("explorerUpdated",g)},q.prototype.parseRoot=function(M,q){M.a("editable",!1);var N=void 0;"dir"===q.fileType||"root"===q.fileType?(M.a(q.attrs),M.s(q.styles),q.fileIcon&&(M.setIcon(q.fileIcon),M.setImage(q.fileIcon)),N=q.children):N=q;for(var e in N)this.parseChild(M,e,N[e])},q.prototype.parseChild=function(M,q,N){var e=this.addFileNode(this.rootDir,M.url,q,N);e.setParent(M);var X=void 0;N&&"dir"===N.fileType?X=N.children:"dir"===e.fileType&&(X=N);for(var w in X)this.parseChild(e,w,X[w]);return e},q.prototype.deleteSelection=function(M){var q=this,N=[];if(M.sm().getTopSelection().forEach(function(M){var e={data:M,url:M.url};q.editor.fireEvent("fileDeleting",e),e.preventDefault||N.push(M)}),N.length){var X=M.getLabel(N[0])||N[0].getName(),w=e("editor.delete")+" ["+X+"]";N.length>1&&(w+=" ("+N.length+")");var $=function(){q.editor.removeFiles(N)};oN.config.deleteFileConfirm?eq(w,e("editor.deleteselection"),$,function(){}):$()}},q.prototype.addNewItem=function(M,q,N,X){var w=this,$={id:N,label:e("editor."+N.toLowerCase()),action:function(){if(q instanceof GX){var M=w.tree.sm().ld();M&&"dir"===M.fileType&&(w.editor._rightClickURL=M.url)}w.editor[N](),X&&w.editor.save(),delete w.editor._rightClickURL},visible:function(){var M=w.tree.sm().ld();if(w.onDrawingDir(M))return!1;if(!q.editable||oN.config.vision&&M&&2!==M.a("dir_type")&&!M.a("editable"))return!1;if(w.isAccordionMode()){var N=w.accordion.sm().ld();return N&&"dir"===N.fileType}return!0}};return M.push($),$},q.prototype.addDeleteItem=function(M,q){var N=this,X={id:"delete",label:e("editor.delete"),action:function(){N.deleteSelection(q)},visible:function(){return!(!q.sm().ld()||!q.isEditable(q.sm().ld()))}};return M.push(X),X},q.prototype.addNewFolderItem=function(M,q){var N=this,X={id:"newFolder",label:e("editor.newfolder"),action:function(){N.editor.newFolder(q)},visible:function(){var M=N.tree.sm().ld();return!(!M||3===M.a("dir_type")||N.onDrawingDir(M))}};return M.push(X),X},q.prototype.addLocateTreeFileItem=function(M){var q=this,N=void 0;return oN.config.locateFileEnabled&&!oN.config.vision&&(N={id:"locateFile",label:e("editor.locatefile"),action:function(){var M=q.tree.sm().ld()||q.rootNode;q.editor.locate(M)},visible:function(){return!q.onDrawingDir(q.tree.sm().ld())}},M.push(N)),N},q.prototype.addLocateListFileItem=function(M){var q=this,N=void 0;return oN.config.locateFileEnabled&&!oN.config.vision&&(N={id:"locateFile",label:e("editor.locatefile"),action:function(){var M=q.ld||q.tree.sm().ld()||q.rootNode;q.editor.locate(M)},visible:function(){var M=q.getFileListView().sm().ld();return!q.onDrawingDir(M)&&(!q.isAccordionMode()||!!M)}},M.push(N)),N},q.prototype.addExportItem=function(M,q){var N=this,X=this.rootDir.slice(0,-1),w={id:"export",label:e("editor.export"),action:function(){var M=[],e=q.sm();e.size()>0&&(e.each(function(q){M.push(q.url)}),N.editor.request("export",M))},visible:function(){var M=q.sm().ld();return!(!M||N.onDrawingDir(M))&&(M.fileType===X||"dir"===M.fileType)}};return M.push(w),w},q.prototype.addRenameItem=function(M,q){var N={id:"rename",label:e("editor.rename"),action:function(){var M=q.sm().ld();M&&!1!==M.a("editable")&&q.beginEditing(M)},visible:function(){var M=q.sm().ld();return!(!M||!q.isEditable(M))}};return M.push(N),N},q.prototype.addCopyItem=function(M){var q=this,N={id:"copy",label:e("editor.copy"),action:function(){q.copyFiles()},visible:function(){if(!q.getFileListView().editable)return!1;var M=q.getFileListView().sm().ld();return!(!M||!1===M.a("editable"))}};return M.push(N),N},q.prototype.addPasteItem=function(M){var q=this,N={id:"paste",label:e("editor.paste"),action:function(){q.pasteFiles()},visible:function(){if(!q.copyFileInfos.length)return!1;var M=q.tree.sm().ld();if(!M)return!1;if(oN.config.vision){if(!1===M.a("editable")&&2!==M.a("dir_type"))return!1}else if(M!==q.rootNode&&!1===M.a("editable"))return!1;return!!q.getFileListView().editable&&(!q.isAccordionMode()||!!q.ld)}};return M.push(N),N},q.prototype.copyFiles=function(){var M=this;this.copyFileInfos.length=0,this.getFileListView().sm().each(function(q){M.prepareCopyFileInfos(q)})},q.prototype.prepareCopyFileInfos=function(M,q){var N=this;if("root"!==M.fileType&&"unknow"!==M.fileType){var e={url:M.url,name:M.getName(),fileNode:M,parentInfo:q,parent_uuid:M.parent_uuid};if(this.copyFileInfos.push(e),this.editor.fireEvent("copyFile",{url:M.url}),!oN.config.copyFileByServer&&"dir"===M.fileType)return e.isDir=!0,void M.eachChild(function(M){N.prepareCopyFileInfos(M,e)});this.loadFileInfo(e)}},q.prototype.loadFileInfo=function(M){var q=M.url,N=oN.config.copyFileByServer;if(N||this.editor.requestBase64(q,function(q){M.content=q}),gM(q)){var e=KM(q);this.findFileNode(e)&&(N?M.image=!0:this.editor.requestBase64(e,function(q){M.image=q}))}},q.prototype.pasteFiles=function(){var M=this;if(oN.config.copyFileByServer){var q=[],N=this.currentDir;this.copyFileInfos.forEach(function(M){q.push(M.url),M.image&&q.push(KM(M.url))}),this.editor.request("paste",{fileList:q,destDir:N})}else this.copyFileInfos.forEach(function(q){M.pasteFileImpl(q)})},q.prototype.pasteFileImpl=function(M){var q=M.url,N=M.parentInfo,e=void 0,X=2,w=N?N.pasteURL:this.currentDir;if(M.isDir){var $=w+"/"+M.name;for(e=$;this.findFileNode(e);)e=$+" "+X++}else if(M.content){var t=w+"/"+D(M.name),E=q.substring(q.lastIndexOf("."),q.length);for(e=t+E;this.findFileNode(e);)e=t+" "+X+++E}if(e){if(M.content){var J={path:e,content:M.content,parent_uuid:M.uuid,root_dir:M.rootDir};this.editor.request("upload",J),this.editor.fireEvent("pasteFile",{url:e}),M.image&&(J.path=KM(e),J.content=M.image,this.editor.request("upload",J),this.editor.fireEvent("pasteFile",{url:J.path}))}M.isDir&&(M.pasteURL=e,this.editor.request("mkdir",e,function(M){}))}},q.prototype.enableDroppableToSymbolView=function(){var M=this.list;"accordion"===this.mode&&(M=this.accordion),M.isDroppableToSymbolView=!0},q.prototype.enableDroppableToDisplayView=function(){var M=this.list;"accordion"===this.mode&&(M=this.accordion),M.isDroppableToDisplayView=!0},q.prototype.enableDroppableToSceneView=function(){var M=this.list;"accordion"===this.mode&&(M=this.accordion),M.isDroppableToSceneView=!0},q.prototype.enableDroppableToUIView=function(){var M=this.list;"accordion"===this.mode&&(M=this.accordion),M.isDroppableToUIView=!0},q.prototype.enableDroppableToUIImage=function(){var M=this.list;"accordion"===this.mode&&(M=this.accordion),M.isDroppableToUIImage=!0},q.prototype.enableDroppableToUIRenderer=function(){var M=this.list;"accordion"===this.mode&&(M=this.accordion),M.isDroppableToUIRenderer=!0},q.prototype.getFileListView=function(){return"accordion"===this.mode?this.accordion:this.list},q.prototype.getTreeMenuItemKeyList=function(){return[]},q.prototype.initTreeMenu=function(M,q){var N=this,e=this.tree;this.getTreeMenuItemKeyList().forEach(function(M){N.$67$(M,e,q)}),M.setVisibleFunc(this._createMenuVisibleFunc(M))},q.prototype.getListMenuItemKeyList=function(){return[]},q.prototype.initListMenu=function(M,q){var N=this,e=this.list;this.getListMenuItemKeyList().forEach(function(M){N.$67$(M,e,q)}),M.setVisibleFunc(this._createMenuVisibleFunc(M))},q.prototype.getAccordionMenuItemKeyList=function(){return this.getListMenuItemKeyList()},q.prototype.initAccordionMenu=function(M,q){var N=this,e=this.accordion;this.getAccordionMenuItemKeyList().forEach(function(M){N.$67$(M,e,q)}),M.setVisibleFunc(this._createMenuVisibleFunc(M))},q.prototype._createMenuVisibleFunc=function(M){return function(q){if(!q.separator)return!0;var N=q.relation;if(!N)return!1;for(var e=0,X=N.length;e<X;e++){var w=M.getItemById(N[e]);if(w&&(!0===w.visible||void 0==w.visible||OM(w.visible)&&w.visible()))return!0}return!1}},q.prototype.addFileNode=function(M,q,N,e){var X=new jX(M,q,N,e);return this.dataModel.add(X),X},q.prototype.$67$=function(M,q,N){q._menuSeparatorRelation&&"separator"!==M&&q._menuSeparatorRelation.push(M);var e=void 0;switch(M){case"newComponent":case"newDisplayView":case"newSymbolView":e=this.addNewItem(N,q,M);break;case"delete":e=this.addDeleteItem(N,q);break;case"newFolder":e=this.addNewFolderItem(N,q);break;case"locateFile":e=q===this.tree?this.addLocateTreeFileItem(N):this.addLocateListFileItem(N);break;case"export":e=this.addExportItem(N,q);break;case"rename":e=this.addRenameItem(N,q);break;case"copy":e=this.addCopyItem(N);break;case"paste":e=this.addPasteItem(N);break;case"separator":N.push(e={separator:!0,relation:q._menuSeparatorRelation=[]})}return e},q.prototype.$48$=function(M){if(this.controlPane.getViewById("filter").getElement().value)return this.setFilter("")},q.prototype.isDrawingNode=function(M){return!(!M||"dir"===M.fileType)&&(!!(M=M.getParent())&&5===M.a("dir_type"))},q.prototype.isDrawingDir=function(M){return!(!M||"dir"!==M.fileType)&&5===M.a("dir_type")},q.prototype.onDrawingDir=function(M){return this.isDrawingDir(M)||this.isDrawingNode(M)},IN(q,[{key:"currentDir",get:function(){var M=void 0;return this.isAccordionMode()?(M=this.ld,M&&"dir"!==M.fileType&&(M=M.getParent()),M?M.url:this.accordion.dirs.length?this.accordion.dirs[this.accordion.dirs.length-1].url:this.rootDir):(M=this.tree.sm().ld(),M?M.url:this.rootDir)}},{key:"ld",get:function(){return this.getFileListView().sm().ld()}}]),q}(Ke),mX=function(M){function q(N){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];YN(this,q);var X=dN(this,M.call(this,N,"displays",e));return X.enableDroppableToDisplayView(),X.enableDroppableToUIView(),X}return rN(q,M),q.prototype.getTreeMenuItemKeyList=function(){return["locateFile","newFolder","newDisplayView","rename","delete","export"]},q.prototype.getListMenuItemKeyList=function(){return["locateFile","newFolder","newDisplayView","copy","paste","rename","delete","export"]},q.prototype.addNewItem=function(q,N,e){var X=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];return M.prototype.addNewItem.call(this,q,N,e,X)},q.prototype.$67$=function(q,N,e){return M.prototype.$67$.call(this,q,N,e)},q}(CX),OX=function(M){function q(N){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];YN(this,q);var X=dN(this,M.call(this,N,"symbols",e))
;return X.enableDroppableToDisplayView(),X.enableDroppableToSymbolView(),X.enableDroppableToSceneView(),X.enableDroppableToUIImage(),X.enableDroppableToUIRenderer(),X}return rN(q,M),q.prototype.getTreeMenuItemKeyList=function(){return["locateFile","newFolder","newSymbolView","rename","delete","export"]},q.prototype.getListMenuItemKeyList=function(){return["locateFile","newFolder","newSymbolView","copy","paste","rename","delete","export"]},q.prototype.addNewItem=function(q,N,e){var X=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];return M.prototype.addNewItem.call(this,q,N,e,X)},q.prototype.$67$=function(q,N,e){return M.prototype.$67$.call(this,q,N,e)},q}(CX),QX=function(M){function q(N){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];YN(this,q);var X=dN(this,M.call(this,N,"components",e));return X.enableDroppableToSymbolView(),X}return rN(q,M),q.prototype.getTreeMenuItemKeyList=function(){return["locateFile","newFolder","newComponent","rename","delete","export"]},q.prototype.getListMenuItemKeyList=function(){return["locateFile","newFolder","newComponent","copy","paste","rename","delete","export"]},q.prototype.$67$=function(q,N,e){return M.prototype.$67$.call(this,q,N,e)},q}(CX),sX=function(M){function q(N){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];YN(this,q);var X=dN(this,M.call(this,N,"scenes",e));return X.enableDroppableToDisplayView(),X.enableDroppableToSceneView(),X.enableDroppableToUIView(),X}return rN(q,M),q.prototype.addNewItem=function(q,N,e,X){return M.prototype.addNewItem.call(this,q,N,e,X)},q.prototype.$67$=function(q,N,e){return M.prototype.$67$.call(this,q,N,e)},q}(CX),lX=function(M){function q(N){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];YN(this,q);var X=dN(this,M.call(this,N,"models",e));return X.enableDroppableToDisplayView(),X.enableDroppableToSceneView(),X}return rN(q,M),q.prototype.$67$=function(q,N,e){return M.prototype.$67$.call(this,q,N,e)},q}(CX),YX=function(M){function q(N){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];YN(this,q);var X=dN(this,M.call(this,N,"uis",e));return X.enableDroppableToUIView(),X.enableDroppableToUIRenderer(),X}return rN(q,M),q.prototype.addNewItem=function(q,N,e,X){return M.prototype.addNewItem.call(this,q,N,e,X)},q.prototype.$67$=function(q,N,e){return M.prototype.$67$.call(this,q,N,e)},q}(CX),IX=function(M){function q(N){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];YN(this,q);var X=dN(this,M.call(this,N,"assets",e));return X.enableDroppableToDisplayView(),X.enableDroppableToSymbolView(),X.enableDroppableToSceneView(),X.enableDroppableToUIImage(),X}return rN(q,M),q.prototype.getTreeMenuItemKeyList=function(){return["locateFile","newFolder","rename","delete"]},q.prototype.getListMenuItemKeyList=function(){return["locateFile","newFolder","copy","paste","rename","delete","convert"]},q.prototype.addExportItem=function(q,N){return M.prototype.addExportItem.call(this,q,N)},q.prototype.$53$=function(M){var q=this;M.push({id:"convertToDisplay",label:e("editor.converttodisplay"),action:function(){q.editor.open(q.getFileListView().sm().ld(),!1)},visible:function(){var M=q.getFileListView().sm().ld();return!!M&&(PM(M.url)||fM(M.url))}}),M.push({id:"convertToSymbol",label:e("editor.converttosymbol"),action:function(){q.editor.open(q.getFileListView().sm().ld(),!0)},visible:function(){var M=q.getFileListView().sm().ld();return!!M&&(oN.FontConverterOptionView&&q.editor.openFont?PM(M.url)||fM(M.url)||RM(M.url)||GM(M.url):PM(M.url)||fM(M.url))}}),M.push({id:"batchConvertSVG",label:e("editor.batchconvertsvg"),action:function(){q.editor.batchConvertSVG(q.getFileListView().sm().getSelection().toArray())},visible:function(){var M=q.getFileListView().sm().ld();return!!M&&PM(M.url)}})},q.prototype.$67$=function(q,N,e){var X=M.prototype.$67$.call(this,q,N,e);return X||("convert"===q&&(X=this.$53$(e)),X)},q}(CX),rX=function(M){function q(N){YN(this,q);var e=dN(this,M.call(this));return e.editor=N,e}return rN(q,M),q.prototype.$5$=function(M){this.setGraphView(this.editor.gv)},q}(je),dX=function(M){function q(N){YN(this,q);var e=dN(this,M.call(this));e.editView=N,e.editor=N.editor,e._topCanvas=z(),e._topDiv=A(),e._view.insertBefore(e._topCanvas,e._79O||null),e._view.insertBefore(e._topDiv,e._79O||null);var X=[];return e.menu=new ne(X),e.menu.beforeShow=function(M){e._rightClickPosition=e.lp(M)},e.initMenuItems(X),e.menu.addTo(e.getView()),e.editor.menus.push(e.menu),e.setResettable(!0),e.addTopPainter(function(M){oN.config.drawDNDState?M.drawDNDState=!0:(oN.config.texureImage3D&&(M.texureImage3D=!0),M.texureImage2D=!0);var q=e.getViewRect(),N=e.editView,X=N.hoverGuideLineX,w=N.hoverGuideLineY,$=ht.Default.brighter(e.dm().a("alignmentGuideColor"));ht.Default.isDragging()||!X&&!w||(M.beginPath(),M.strokeStyle=$,M.lineWidth=1/e.getZoom(),X&&(M.moveTo(X.x,q.y),M.lineTo(X.x,q.y+q.height)),w&&(M.moveTo(q.x,w.y),M.lineTo(q.x+q.width,w.y)),M.stroke())}),e}return rN(q,M),q.prototype.reset=function(){this.fitContent(oN.config.animate,oN.config.fitPadding)},q.prototype.fitContent=function(q,N,e,X){if(N<1){var w=this.getContentRect();N=N/(1-2*N)*(this.getWidth()<this.getHeight()?w.width:w.height)}M.prototype.fitContent.call(this,q,N,e,X)},q.prototype.fitSelection=function(M,q,N){var e=this,X=e.sm(),w=null;X.size()&&(X.each(function(M){w=ht.Default.unionRect(e.getDataUIBounds(M),w)}),w&&(M&&(M<1&&(M=M/(1-2*M)*(this.getWidth()<this.getHeight()?w.width:w.height)),ht.Default.grow(w,M)),e.fitRect(w,q,N)))},q.prototype.isEditable=function(q){return!!this.editable&&M.prototype.isEditable.call(this,q)},q.prototype.isMovable=function(q){return!!this.editable&&M.prototype.isMovable.call(this,q)},q.prototype.isSelectable=function(q,N){return ht.Default.isShiftDown()?!(q instanceof ht.Block):M.prototype.isSelectable.call(this,q,N)},q.prototype.invalidateAll=function(q,N){if("imageLoaded"===N||"modelLoaded"===N){var e=this.editor.inspector;e&&(e.$34$(),e.$85$&&e.$85$())}M.prototype.invalidateAll.call(this,q,N)},q.prototype.handleDelete=function(q){this.editable&&M.prototype.handleDelete.call(this,q)},q.prototype.onGroupDoubleClicked=function(q,N,e){this.editable&&M.prototype.onGroupDoubleClicked.call(this,q,N,e)},q.prototype.onEdgeDoubleClicked=function(q,N,e){this.editable&&M.prototype.onEdgeDoubleClicked.call(this,q,N,e)},q.prototype.checkDoubleClickOnNote=function(q,N){return!!this.editable&&M.prototype.checkDoubleClickOnNote.call(this,q,N)},q.prototype.getToolTip=function(M){return oN.config.getToolTip(M,this)},q.prototype.$56$=function(M){var q=this;M.push({id:"copy",label:e("editor.copy"),action:function(){q.editor.copy()},visible:function(){return!!q.editor.ld}}),M.push({id:"paste",label:e("editor.paste"),action:function(){q.editor.paste(!1,q._rightClickPosition)},visible:function(){return q.editable&&q.editor.hasCopyInfo()}})},q.prototype.$55$=function(M){var q=this;M.push({separator:!0,visible:function(){return q.editable&&!!q.editor.ld}}),M.push({id:"bringToFront",label:e("editor.bringtofront"),action:function(){q.editor.bringToFront()},visible:function(){return q.editable&&!!q.editor.ld}}),M.push({id:"bringForward",label:e("editor.bringforward"),action:function(){q.editor.bringForward()},visible:function(){return q.editable&&!!q.editor.ld}}),M.push({id:"sendBackward",label:e("editor.sendbackward"),action:function(){q.editor.sendBackward()},visible:function(){return q.editable&&!!q.editor.ld}}),M.push({id:"sendToBack",label:e("editor.sendtoback"),action:function(){q.editor.sendToBack()},visible:function(){return q.editable&&!!q.editor.ld}})},q.prototype.initMenuItems=function(M){this.editor.addShapeSplitMenuItems(M)},q.prototype.onClosed=function(){this.menu.dispose(),E(this.editor.menus,this.menu)},q.prototype.$57$=function(M){return M&&this.copyMap[M._id]?M._id:M},q.prototype.$49$=function(M,q){return M instanceof ht.Data?this.dm().contains(M)?M:void 0:q[M]},q.prototype.getSelectWidth=function(M){return!this.isEditable(M)||M instanceof ht.Edge?M.s("select.width"):0},q.prototype.onSelectionChanged=function(M){if(1===this.sm().size()&&("set"===M.kind||"append"===M.kind)){var q=this.sm().ld();q&&document.activeElement===this.getView()&&this._dataModel.isAutoAdjustIndex()&&this.adjustIndex(q)}},q.prototype.getContentRect=function(){var q=M.prototype.getContentRect.call(this);if(!q.width||!q.height){var N=this.dm().a("width")||200,e=this.dm().a("height")||200;q={x:-N/2,y:-e/2,width:N,height:e,empty:!0}}return q},q.prototype.isDroppable=function(M,q){return!1},q.prototype.$58$=function(M){if(this.dragImage){var q=oN.config.dragImageSize,N=O(M);this.dragImage.style.left=N.x-q/2+"px",this.dragImage.style.top=N.y-q/2+"px"}},q.prototype.removeDragImage=function(){this.dragImage&&(V(this.dragImage),this.dragImage=null)},q.prototype.handleCrossDrag=function(M,q,N){var e=this,X=N.view,w=X.draggingData;if("enter"===q){if(this._topDiv.style.border="solid "+oN.config.color_select_dark+" 2px",!this.dragImage&&w){var $=void 0===w.a("dragImage")?w.getImage():w.a("dragImage");if(ht.Default.getImage($)!==ht.Default.getImage("editor.unknown")){var t=oN.config.dragImageSize;this.dragImage=ht.Default.toCanvas($,t,t,"centerUniform",w,N.view,null,ht.Default.devicePixelRatio),this.$58$(M),this.dragImage.style.opacity=oN.config.dragImageOpacity,this.dragImage.className="ht-editor-dnd-image",ht.Default.appendToScreen(this.dragImage)}}}else if("exit"===q||"cancel"===q)this._topDiv.style.border="",this.removeDragImage();else if("over"===q)this.$58$(M);else if("drop"===q)if(this._topDiv.style.border="",w){this.removeDragImage();var E=this.lp(M);X.isSelected(w)?X.sm().toSelection().each(function(q){e.onDrop?e.onDrop(X,q,E,M):X.handleDropToEditView?X.handleDropToEditView(e.editView,q,E,M):e.editor.$98$(q,E)}):this.onDrop?this.onDrop(X,w,E,M):X.handleDropToEditView?X.handleDropToEditView(this.editView,w,E,M):this.editor.$98$(w,E)}else X===this.editor.dndFromOutside&&this.editor.dropLocalFileOnView(M)},IN(q,[{key:"editable",get:function(){return this.editor.editable},set:function(M){}}]),q}(Re),aX=function(M){function q(N){return YN(this,q),dN(this,M.call(this,N))}return rN(q,M),q.prototype.handleDataModelChange=function(q){M.prototype.handleDataModelChange.call(this,q),this.editor&&this.editor.fireViewEvent(this.editView,"DataModelChanged",{event:q})},q.prototype.handleDataModelPropertyChange=function(q){M.prototype.handleDataModelPropertyChange.call(this,q),this.editor&&this.editor.fireViewEvent(this.editView,"DataModelPropertyChanged",{event:q})},q.prototype.handleDataPropertyChange=function(q){M.prototype.handleDataPropertyChange.call(this,q),this.editor&&this.editor.fireViewEvent(this.editView,"DataPropertyChanged",{event:q})},q.prototype.initMenuItems=function(q){this.$56$(q),this.$55$(q),this.addBlockItems(q),this.editor.$103$(q),M.prototype.initMenuItems.call(this,q)},q.prototype.isDroppable=function(M,q){if(this.editor.editable)return!!q.view.isDroppableToDisplayView},q.prototype.isSelectable=function(q,N){return!q._refGraph&&M.prototype.isSelectable.call(this,q,N)},q.prototype.addBlockItems=function(M){var q=this,N=function(){return q.sm().size()>0},X=function(){for(var M=0;M<q.sm().size();M++){var N=q.sm().getSelection().get(M);if(N instanceof ht.Block&&!(N instanceof ht.RefGraph))return!0}return!1};M.push({separator:!0,visible:function(){return q.editable&&(N()||X())}}),M.push({id:"block",label:e("editor.block"),action:function(){q.editor.block()},visible:function(){return q.editable&&N()}}),M.push({id:"unblock",label:e("editor.unblock"),action:function(){q.editor.unblock()},visible:function(){return q.editable&&X()}})},q}(dX),DX=function(){function M(q,N,e){YN(this,M),this.canvas=q,this.editView=N,this.type=e,this.gv=N.graphView,this.hoverLine=null,this.setUp(),this.garbageImage=ht.Default.toCanvas("Icons.ConnectGuideDeletingImage",24,24,void 0,void 0,void 0,void 0,ht.Default.devicePixelRatio)}return M.prototype.getView=function(){return this.canvas},M.prototype.setUp=function(){this.addListeners(),this.gv.sm().ms(this._handleSelectionChange,this)},M.prototype.tearDown=function(){this.removeListeners(),this.gv.sm().ums(this._handleSelectionChange,this),this.clear()},M.prototype.clear=function(){delete this.selectionBounds},M.prototype._handleSelectionChange=function(){var M=void 0;this.gv.sm().each(function(q){q instanceof ht.Node&&(M=ht.Default.unionRect(M,q.getRect()))}),this.selectionBounds=M},M.prototype.setCursor=function(M){ht.Default.isTouchable||(this.canvas.style.cursor=M)},M.prototype.checkHit=function(M){var q=this.editView,N=this.gv,e=this.existList,X=this.type,w=N.lp(M),$=N.getZoom();if(e.length){var t=1/0,E=w[X],J=void 0;if(e.forEach(function(M){var q=Math.abs(M.value-E);q<t&&(J=M,t=q)}),J&&t<6/$){var u=this.getRoundLogicalPoint(M);return this.setCursor("x"===X?"ew-resize":"ns-resize"),u[X]=J.value,q[this.hoverKey]=u,this.hoverLine=J,q.drawRuler(),q.gv.redraw(),J}}return null},M.prototype.handle_contextmenu=function(M){M.preventDefault()},M.prototype.handle_touchmove=function(M){this.handle_mousemove(M)},M.prototype.handle_mousemove=function(M){if(this.editable&&!this.editing&&!ht.Default.isDragging()){var q=this.editView;this.gv;this.checkHit(M)||(delete this.hoverLine,this.setCursor("default"),q[this.hoverKey]=this.getRoundLogicalPoint(M),q.drawRuler(),q.gv.redraw())}},M.prototype.handle_touchstart=function(M){this.handle_mousedown(M)},M.prototype.handle_mousedown=function(M){this.editable&&ht.Default.isLeftButton(M)&&(ht.Default.preventDefault(M),this.checkHit(M)||this.addGuide(this.getRoundLogicalPoint(M)),this.checkHit(M)&&(p(this,M),ht.Default.preventDefault(M),this.editing=!0,delete this.editView[this.hoverKey],this.editView.gv.redraw()))},M.prototype.handle_mouseleave=function(M){var q=this.editView,N=this.hoverKey;this.editing||ht.Default.isDragging()||(q[N]&&(delete q[N],q.iv(),this.editView.gv.redraw()),this.setCursor("default"))},M.prototype.handleWindowTouchMove=function(M){this.handleWindowMouseMove(M)},M.prototype.handleWindowMouseMove=function(M){var q=this.editView,N=this.grid;if(N){this.showGarbageTip(M);var e=q[this.hoverKey];if(this._garbageAppended||e){if(e){var X=this.hoverLine;X.value=e[this.type],N.adjustAlignmentGuide(X.id,X.value)}q.iv()}}},M.prototype.handleWindowMouseUp=function(M){this.editing=!1;var q=this.hoverLine,N=this.garbageImage,e=this.grid,X=this.existList;if(!this.containedInGv(M)){e.removeAlignmentGuide(q.id);var w=X.indexOf(q);X.splice(w,1)}N.parentNode&&N.parentNode.removeChild(N),delete this.editView[this.hoverKey],this.editView.iv(),this.update()},M.prototype.showGarbageTip=function(M){var q=this.editView,N=this.hoverKey,e=this.garbageImage,X=ht.Default.getClientPoint(M);this.containedInGv(M)?(e.parentNode&&e.parentNode.removeChild(e),q[N]=this.getRoundLogicalPoint(M)):(e.parentNode?delete this._garbageAppended:(ht.Default.appendToScreen(e),this._garbageAppended=!0),e.style.left=X.x+10+"px",e.style.top=X.y+10+"px",delete q[N])},M.prototype.containedInGv=function(M){var q=this.gv,N=this.type,e=q.getView().getBoundingClientRect(),X=e.x,w=e.y,$=e.width,t=e.height,E={x:X+$/2,y:w+t/2},J=C(M);return"x"===N?J.y=E.y:J.x=E.x,ht.Default.containsPoint(e,J)},M.prototype.addGuide=function(M){var q=(this.editView,this.type),N=this.grid,e=M[q];if(N){var X=N.addAlignmentGuide(q,e);this.editView.alignGuideMap[q].push({id:X,value:e}),this.update()}},M.prototype.getRoundLogicalPoint=function(M){var q=this.gv.lp(M),N=this.gv.getZoom();if(N>5?(q.x=parseFloat(q.x.toFixed(1)),q.y=parseFloat(q.y.toFixed(1))):(q.x=Math.round(q.x),q.y=Math.round(q.y)),ht.Default.isShiftDown(M))q.x=this.editView.getRulerNearestValue(q.x),q.y=this.editView.getRulerNearestValue(q.y);else if(!ht.Default.isCtrlDown(M)&&this.selectionBounds){var e=this.selectionBounds,X=e.x,w=e.y,$=e.width,t=e.height;if("x"===this.type){var E=Math.abs(q.x-X)*N,J=Math.abs(q.x-X-$)*N;Math.min(E,J)<=8&&(q.x=E<J?X:X+$)}else{var u=Math.abs(q.y-w)*N,g=Math.abs(q.y-w-t)*N;Math.min(u,g)<=8&&(q.y=u<g?w:w+t)}}return q},M.prototype.update=function(){this.editView.updateAlignGuide()},IN(M,[{key:"grid",get:function(){return this.gv.getEditInteractor()?this.gv.getEditInteractor().gridGuide:null}},{key:"hoverKey",get:function(){return"hoverGuideLine"+this.type.toUpperCase()}},{key:"existList",get:function(){return this.editView.alignGuideMap[this.type]}},{key:"editable",get:function(){return this.editView.editable&&this.editView.dm.a("alignmentGuideEnabled")}}]),M}();MM(DX,{ms_listener:1});var WX={width:!0,height:!0,position:!0,rotation:!0,anchor:!0,scale:!0,expanded:!0};ht.Default.getMSMap().hteditor_editview=function(M,q){Object.defineProperties(M,{dirty:{get:function(){return this.tab.a("dirty")},set:function(M){if(!ht.Default.loadingRefGraph){var q=this.dm.getHistoryManager();q&&q.isDisabled()||this.tab.a("dirty",M)}}}}),M.setRulerEnabled=function(M){this.dm.a("rulerEnabled",M)},M.isRulerEnabled=function(){return this.dm.a("rulerEnabled")},M.reload=function(){var M=this;if(M.url){var q=function(){var q={url:M.url};if(M.editor.fireViewEvent(M,"Reloading",q),q.preventDefault)return!1;M.parse(M.url)};oN.config.reloadConfirm&&M.dirty?eq(e("editor.prompt"),e("editor.reload.prompt"),q,function(){}):q()}},M.save=function(M,q){var N=this;if(!this.editable)return void(M&&M());var X=function(){M&&M(),N.editor.fireViewEvent(N,"Saved",{url:N.url}),N.editor.makeFileNodeVisible(N.url)};if(q)this._saveAs(X,q);else if(this.url)this._saveImpl(X);else{var w=this.editor._rightClickURL||this.editor[this.type+"s"].currentDir,$=e("editor.inputnew"+this.type+"name"),t=this.editor[this.type+"s"];if(t.isAccordionMode()&&t.rootDir===w)return void this.editor.showMessage(e("editor.createfolderfirst"),"error",2e3);this._saveNew(M,X,$,w)}},M._saveNew=function(M,q,N,X){var w=this,$=function(N,X,$){if("ok"===X){var t=D(N),E=$+t+"."+w.extension,J=w.editor.getFileNode(E);5===w.editor.getFileNode($.substring(0,$.length-1)).a("dir_type")?w.editor.showMessage(e("editor.errormessage.unablesavetodirectory")+$,"error"):J?eq(e("editor.filenameconflict"),E,function(){M&&M()}):(w.tab.setName(t),w.url=E,w.tab.setTag(w.url),w.editor.dataView.updateUrl(),w._saveImpl(q,!0))}else M&&M()},t={name:void 0};if(this.editor.fireViewEvent(this,"NewNameInputing",t),t.preventDefault)return!1;t.name?$(t.name,"ok",X+"/"):qq(N,this.tab.getName(),{nullable:!1,trim:!0,maxLength:oN.config.maxFileNameLength,checkFunc:oN.config.checkFileName,$38$:this.editor.$38$,path:X+"/",editor:this.editor},$)},M._saveAs=function(M,q){this.tab.setName(W(q)),this.url=q,this.tab.setTag(this.url),this.editor.dataView.updateUrl(),this._saveImpl(M)},M._saveImpl=function(M,q){var N=this,X=this.url,w={url:X};if("display"===this.type&&oN.config.settingDefaultValueBeforeSaving&&this.dm.each(function(M){if(M instanceof ht.Node){var q=ht.Default.getImage(M.getImage());q&&q.dataBindings&&q.dataBindings.forEach(function(q){var N=M.getAttrObject(),e=q.defaultValue;if(void 0!==e){var X=q.attr;N&&void 0!==N[X]||M.a(X,e)}})}}),this.editor.fireViewEvent(this,"Saving",w),w.preventDefault)return q&&(this.tab.setName(e("editor.untitled")),delete this.url,this.tab.setTag(void 0),this.editor.dataView.updateUrl()),!1;var $=this.parent_uuid,t=this.root_dir,E=this.content;this.updatePluginList&&this.updatePluginList(E),w={path:w.url,content:d(E),parent_uuid:$,root_dir:t};var J=w.content.length/1e6,u=oN.config.jsonTooLargeThreshold;J>u&&this.editor.showMessage(nq(e("editor.errormessage.file.toolarge"),J.toFixed(2),u),"error",5e3),this.editor.request("upload",w,function(w){w?(q&&N.tab.a("uuid",w.uuid),N.editor.saveImage(N.dm.a("snapshotURL")||N.g3d||N.graphView,X.substr(0,X.length-5)+".png",function(){M&&M(),N.editor.showMessage(e("editor.savedsuccessfully"),"normal",1e3),N.dirty=!1},w.uuid,w.parent_uuid,w.root_dir||w.asset_type)):(N.tab&&N.editor.mainTabView.removeTab(N.tab),delete N.tab,N.editor.showMessage(e("editor.savedfailed"),"error",1e3))})},M.parse=function(M,q){(M||q)&&(this.url=M,q?this.update(q):T(M,this.update.bind(this)))},M.update=function(M,q){var N=this;if(M){if(q){var e=d(this.content),X=M,w={undo:function(){N.updateImpl(e,!0)},redo:function(){N.updateImpl(X,!0)}};this.dm.disableHistoryManager(),this.updateImpl(M,q),this.dm.enableHistoryManager(),this.dm.addHistory(w)}else this.dm.disableHistoryManager(),this.updateImpl(M,q),this.dm.enableHistoryManager(),this.dm.clearHistoryManager();this.editor.$5$(this.editor.mainTabView.currentTab);var $=void 0;q?$="Committed":this.isOpened?$="Reloaded":($="Opened",this.isOpened=!0);var t={url:this.url,json:M};this.editor.fireViewEvent(this,$,t),q||(this.dirty=!1)}},M.$3$=function(){return this._interactionState},M.$4$=function(M,q,N,e){var X=this,w=this._interactionState;w!==M&&(this._interactionState=M,this.editor.pointsEditingMode=!1,[this.graphView,this.g3d].forEach(function(w){if(w){var $=[];if(w.getInteractors().each(function(q){q.keep?q.disabled="edit"!==M:$.push(q)}),$.forEach(function(M){M.tearDown(),w.getInteractors().remove(M)}),"edit"!==M){var t=w===X.g3d?X.create3dInteractor(q,N,e):X.createInteractor(q,N,e);t&&(t.setUp(),w.getInteractors().add(t))}w.invalidateSelection()}}),this.editor.mainToolbar.iv(),this.fp("interactionState",w,M),this.validateCanvas())},M.addData=function(M){var q=arguments.length>1&&void 0!==arguments[1]&&arguments[1],N=arguments.length>2&&void 0!==arguments[2]&&arguments[2],X=arguments.length>3&&void 0!==arguments[3]&&arguments[3];arguments[4];if(M instanceof ht.Node){var w=M.p(),$=oN.config.maxSafeInt;if(w.x>=$||w.y>=$)return void this.editor.showMessage(e("editor.errormessage.insert.unsafepoint"),"error",5e3)}var t="symbol"===this.type?"compCreated":"dataCreated",E={data:M};if(N)return void this.editor.fireViewEvent(this,t,E,!1);this.dm.beginTransaction(),q||M.getParent()||M.setParent(this.graphView.getCurrentSubGraph()),this.dm.add(M),q||(X||this.dm.sm().ss(M),this.graphView.setFocus()),this.editor.fireViewEvent(this,t,E,!1),this.dm.endTransaction(),M.__hisIndex__=this.dm.getHistoryManager().getHistoryIndex()},M.skewGrid=function(){this.dm.beginTransaction(),this.dm.a("gridAngle",2*Math.PI/3),this.dm.a("gridRotation",Math.PI/6),this.dm.endTransaction()},M.preview=function(){this.$64$("previews/"+this.type+".json",this.dm.a("previewURL")||oN.config[this.type+"PreviewURL"])},M.$64$=function(M,q){var N=this,e=this.tab.getTag();e||(e=this.type+".json"),e&&(q+=(-1===q.indexOf("?")?"?":"&")+"tag="+encodeURI(e));var X={url:q};if(this.editor.fireViewEvent(this,"Previewing",X),X.preventDefault)return!1;q=X.url;var w=this.content;w.title=this.tab.getName(),this.updatePluginList&&this.updatePluginList(w);var $=this.parent_uuid,t=this.root_dir;X={path:oN.config.vision&&e?"previews/"+e:M,content:d(w),parent_uuid:$,root_dir:t},this.editor.request("upload",X,function(M){window.open(q,q.replace(/[^\u4E00-\u9FA5A-Za-z0-9]+/g,"_")),N.editor.fireViewEvent(N,"Preview",{url:q})})},M.addInteractorPropertyChangeListener=function(M,q){var N=this.gv,e=N&&N.getEditInteractor();e&&e.mp(M,q)},M.removeInteractorPropertyChangeListener=function(M,q){var N=this.gv,e=N&&N.getEditInteractor();e&&e.ump(M,q)}};var vX=function(){function M(q,N,e,X,w,$,t){var E=this;YN(this,M),this.editor=q,this.tab=N,this.type=X,this.sceneView=w,this.parent_uuid=$,this.root_dir=t,this.extension="json",N.setView(this);var J=this.gv=this.graphView=new e(this);this._view=Z(!0,this),J.addViewListener(function(M){"validate"===M.kind&&E.validateCanvas()}),this._hRuler=z(),this._vRuler=z(),this._view.appendChild(J.getView()),this.$4$("edit"),J.isInteractive=function(M){return E.isInteractive(M)},J.addPropertyChangeListener(function(){E.iv()}),J.addInteractorListener(function(M){E.handleInteractorEvent(M)}),this.dm.sm().addSelectionChangeListener(function(M){E.iv()}),this.dm.addDataModelChangeListener(function(M){E.handleDataModelChanged(M)}),this.dm.addDataPropertyChangeListener(function(M){E.handleDataPropertyChanged(M)}),this.dm.addPropertyChangeListener(function(M){E.handleDataModelPropertyChanged(M)}),this.dm.addHierarchyChangeListener(function(M){E.handleHierarchyChanged(M)}),this.dm.layout=function(M,q){E._autoLayout||(E._autoLayout=new ht.layout.AutoLayout(J)),E._autoLayout.options=q||{};var N=J.getZoom(),e=J.tx(),X=J.ty();E.dm.beginTransaction(),E._autoLayout.setAnimate(oN.config.animate);var w=function(){var M=J.getZoom(),q=J.tx(),w=J.ty(),$={undo:function(){J.setZoom(N),J.tx(e),J.ty(X)},redo:function(){J.setZoom(M),J.tx(q),J.ty(w)}};E.dm.addHistory($),E.dm.endTransaction()};E._autoLayout.layout(M,function(){oN.config.animate?J.fitContent({finishFunc:w}):(J.fitContent(!1,oN.config.fitPadding),w())})},J.setEditable(!0),J.setEditStyle("moveDummyThreshold",oN.config.moveDummyThreshold),J.setEditStyle("smartGuideThreshold",oN.config.smartGuideThreshold),oN.SceneView&&J.setEditStyle("curveTipVisible",!1),J.getInteractors().each(function(M){M.keep=!0}),this.clear(),this.initRuler()}return M.prototype.setGridEnabled=function(M){this.dm.a("gridEnabled",M)},M.prototype.isGridEnabled=function(){return this.dm.a("gridEnabled")},M.prototype.initRuler=function(){var M=this._hRuler,q=this._vRuler,N=this.gv,e=this.type;if(this.alignGuideMap={x:[],y:[]},oN.config.gridAlignmentGuideEnabled){M.style.pointerEvents="auto",q.style.pointerEvents="auto";var X=this.dm.a("alignmentGuideColor");X||(X="symbol"===e?oN.config.symbolGridAlignmentGuideColor:oN.config.displayGridAlignmentGuideColor),N.setEditStyle("gridAlignmentGuideColor",X);new DX(this._hRuler,this,"x"),new DX(this._vRuler,this,"y");this._initMenu("x"),this._initMenu("y")}},M.prototype._initMenu=function(M){var q=this,N=new oN.ContextMenu;N.setItems([{id:"closeAll",label:e("editor.clearall"+M+"alignguides"),action:function(){q.alignGuideMap[M]=[],q.updateAlignGuide()},visible:function(){return q.alignGuideMap[M].length>0}}]);var X="x"===M?this._hRuler:this._vRuler;N.addTo(X),X._menu=N,this.editor.menus.push(N)},M.prototype.resetGrid=function(){},M.prototype.clear=function(){this.dm.beginTransaction(),this.dm.setName(void 0),this.dm.setBackground(void 0),this.dm.setHierarchicalRendering(!1),this.dm.setLayers(void 0),this.dm.clear(),this.dm.setAttrObject(void 0),this.resetGrid(),this.getGridGuide().removeAllAlignmentGuide(),this.dm.endTransaction()},M.prototype.handleInteractorEvent=function(M){var q=M.kind;"prepareMove"!==q&&"prepareEdit"!==q||!M.event.altKey?"selectPoint"===q&&(this.currentEditingPoint=void 0===M.x?null:{x:M.x,y:M.y,e:CM(M.e)?M.e:0}):(this.editor.copy(),this.editor.paste(!0),this.editor.gv.validate())},M.prototype.handleDataModelChanged=function(M){this.dirty=!0},M.prototype.handleDataPropertyChanged=function(M){if(!M.data.disableDirty){var q=M.property;"*"===q||q.indexOf("animation")>=0||(WX[q]&&this.iv(),this.dirty=!0)}},M.prototype.handleHierarchyChanged=function(M){this.dirty=!0},M.prototype.handleDataModelPropertyChanged=function(M){var q=this,N=M.property,e=M.newValue;if("a:rulerEnabled"===N)this.graphView.getEditInteractor().alignmentGuideEnabled=e,this.iv();else if("a:gridEnabled"===N)this.graphView.getEditInteractor().gridEnabled=e;else if("a:gridBlockSize"===N)this.graphView.setEditStyle("gridBlockSize",e);else if("a:gridThickLinesEvery"===N)this.graphView.setEditStyle("gridThickLinesEvery",e);else if("a:gridThickColor"===N)this.graphView.setEditStyle("gridThickColor",e);else if("a:gridLightColor"===N)this.graphView.setEditStyle("gridLightColor",e);else if("a:gridAngle"===N)this.graphView.setEditStyle("gridAngle",e);else if("a:gridRotation"===N)this.graphView.setEditStyle("gridRotation",e);else if("a:gridZoomThreshold"===N)this.graphView.setEditStyle("gridZoomThreshold",e);else if("a:anchorEnabled"===N)this.graphView.setEditStyle("anchorVisible",e);else if("a:guideLineEnabled"===N)this.graphView.setEditStyle("guideLineVisible",e);else if("a:highlightEnabled"===N)this.graphView.setEditStyle("hoverGuideVisible",e);else if("a:highlightColor"===N)this.graphView.setEditStyle("hoverGuideColor",e);else if("a:highlightBorderWidth"===N)this.graphView.setEditStyle("hoverGuideBorderWidth",e);else if("a:highlightBorderPattern"===N)this.graphView.setEditStyle("hoverGuideBorderPattern",e);else if("a:connectActionType"===N)this.graphView.setCurrentConnectActionType(e);else if("a:xAlignmentGuides"===N){var X=this.getGridGuide();X.removeAllAlignmentGuide("x"),this.alignGuideMap.x=[],e&&e.forEach(function(M){var N=X.addAlignmentGuide("x",M);q.alignGuideMap.x.push({id:N,value:M})}),this.drawRuler()}else if("a:yAlignmentGuides"===N){var w=this.getGridGuide();w.removeAllAlignmentGuide("y"),this.alignGuideMap.y=[],e&&e.forEach(function(M){var N=w.addAlignmentGuide("y",M);q.alignGuideMap.y.push({id:N,value:M})}),this.drawRuler()}else"a:alignmentGuideColor"===N?(this.graphView.setEditStyle("gridAlignmentGuideColor",e),this.drawRuler()):"a:alignmentGuideEnabled"===N&&(this.graphView.getEditInteractor().alignmentGuideEnabled=e,this.drawRuler());this.dirty=!0,this.validateCanvas()},M.prototype.onClosed=function(){this.graphView.onClosed();var M=this.editor;[this._hRuler,this._vRuler].forEach(function(q){var N=q._menu;N&&(N.dispose(),E(M.menus,N))})},M.prototype.validateCanvasLater=function(){var M=this;this._validateCanvasLater||(this._validateCanvasLater=!0,requestAnimationFrame(function(){M.validateCanvas()}))},M.prototype.validateCanvas=function(){this._validateCanvasLater=!1;var M=this.graphView._topCanvas,q=F(M);q.clearRect(0,0,M.clientWidth,M.clientHeight),this.graphView.getInteractors().each(function(M){M.$0$&&M.$0$(q)}),this.$0$(q),q.restore()},M.prototype.redraw=function(){this._lastWidth=this._lastHeight=null,this.iv()},M.prototype.validateImpl=function(){var M=this._rulerSize,q=this.isRulerEnabled(),N=this.getWidth(),e=this.getHeight();if(N!==this._lastWidth||e!==this._lastHeight||M!==this._lastRulerSize||q!==this._lastRulerEnabled){if(this._lastWidth=N,this._lastHeight=e,this._lastRulerSize=M,this._lastRulerEnabled=q,q){this._hRuler.parentNode||(this._view.appendChild(this._hRuler),this._view.appendChild(this._vRuler));var X=Math.max(0,N-M),w=Math.max(0,e-M);H(this._hRuler,M,0,X,M),H(this._vRuler,0,M,M,w),H(this.graphView,M,M,X,w),H(this.graphView._topDiv,0,0,X,w),U(this.graphView._topCanvas,X,w),U(this._hRuler,X,M),U(this._vRuler,M,w)}else this._hRuler.parentNode&&(V(this._hRuler),V(this._vRuler)),H(this.graphView,0,0,N,e),H(this.graphView._topDiv,0,0,N,e),U(this.graphView._topCanvas,N,e);this.validateCanvas()}this._hRuler.style.background=this._rulerBackground,this._vRuler.style.background=this._rulerBackground,this.drawRuler()},M.prototype.$0$=function(M){var q=this.graphView.getZoom(),N=this.graphView.tx(),e=this.graphView.ty(),X=Math.round(this.dm.a("width")||0)*q,w=Math.round(this.dm.a("height")||0)*q,$=this.graphView.getWidth(),t=this.graphView.getHeight();!oN.config.mixMaskAndBackground&&this.dm.getBackground()||X>0&&w>0&&$>0&&t>0&&(M.beginPath(),N&&M.rect(0,0,N,t),e&&$-N&&M.rect(N,0,$-N,e),$-N-X&&w&&M.rect(N+X,e,$-N-X,w),$-N&&t-e-w&&M.rect(N,e+w,$-N,t-e-w),M.fillStyle=oN.config.color_mask,M.fill())},M.prototype.drawVerticalText=function(M,q,N){M.save(),M.translate(11,N+11),M.rotate(-Math.PI/2),B(M,q,this._rulerFont,this._rulerColor,11,-11,0,this._rulerSize,"right"),M.restore()},M.prototype.getRulerNearestValue=function(M){var q=this.gv,N=q.getZoom(),e=Math.log(N)/Math.log(10),X=Math.floor(e),w=10/Math.pow(10,X)*N;return M*=N,M=Math.round(M/w)*w/N,X>1?M.toFixed(X-1):Math.round(M)},M.prototype.drawRuler=function(){if(this.isRulerEnabled()){var M=this._rulerFont,q=this._rulerSize,N=this._rulerColor,e=this.graphView,X=e.getUnionNodeRect(e.sm().getSelection()),w=e.getZoom(),$=Math.log(w)/Math.log(10),t=Math.floor($),E=100/Math.pow(10,t)*w,J=E/10,u=t>1?40+10*(t-1):40,g=Math.round(e.tx()),S=Math.round(e.ty()),b={x:-g,y:-S,width:e.getWidth(),height:e.getHeight()},h=this.dm.a("alignmentGuideColor"),y=this.dm.a("alignmentGuideEnabled"),P=ht.Default.getTextSize,f=void 0,x=void 0,n=void 0,R=void 0,G=void 0
;h||(h="symbol"===this.type?oN.config.symbolGridAlignmentGuideColor:oN.config.displayGridAlignmentGuideColor),F(this._hRuler,0,0,1,{x:0,y:0,width:b.width,height:q}).restore(),R=F(this._hRuler,0,0,1),R.lineWidth=1,R.strokeStyle=N,X&&(R.beginPath(),R.rect(X.x*w-b.x,0,X.width*w,q),R.fillStyle=oN.config.color_line,R.fill()),R.beginPath();var j=-b.x%E-E,K=void 0;for(f=j;f<=b.width;f+=E)for(R.moveTo(f,q),R.lineTo(f,0),G=f+b.x,G=t>1?(G/w).toFixed(t-1):Math.round(G/w),B(R,G,M,N,f,0,1,q,"left"),n=1;n<10;n++)K=f+n*J,G=K+b.x,G=t>1?(G/w).toFixed(t-1):Math.round(G/w),R.moveTo(K,q),5===n?(R.lineTo(K,q-10),B(R,G,M,N,K,0,1,q,"left")):(R.lineTo(K,q-4),J>u&&B(R,G,M,N,K,0,1,q,"left"));R.stroke(),y&&this.alignGuideMap&&this.alignGuideMap.x.length&&(R.beginPath(),R.strokeStyle=h,this.alignGuideMap.x.forEach(function(M){f=w*M.value-b.x,R.moveTo(f,0),R.lineTo(f,q)}),R.stroke());var p=this.hoverGuideLineX;if(y&&p){var C=w*p.x-b.x,m=P(M,p.x);R.fillStyle=oN.config.color_pane,R.fillRect(C,0,m.width,q),B(R,p.x,M,h,C,0,m.width,q,"left","middle"),R.beginPath(),R.lineWidth=2,R.moveTo(C,0),R.lineTo(C,q),R.strokeStyle=ht.Default.brighter(h),R.stroke()}R.restore(),F(this._vRuler,0,0,1,{x:0,y:0,width:q,height:b.height}).restore(),R=F(this._vRuler,0,0,1),R.lineWidth=1,R.strokeStyle=N,X&&(R.beginPath(),R.rect(0,X.y*w-b.y,q,X.height*w),R.fillStyle=oN.config.color_line,R.fill()),R.beginPath(),j=-b.y%E-E;var O=void 0;for(x=j;x<=b.height;x+=E)for(R.moveTo(q,x),R.lineTo(0,x),G=x+b.y,G=t>1?(G/w).toFixed(t-1):Math.round(G/w),this.drawVerticalText(R,G,x),n=1;n<10;n++)O=x+n*J,G=O+b.y,G=t>1?(G/w).toFixed(t-1):Math.round(G/w),R.moveTo(q,O),5===n?(R.lineTo(q-10,O),this.drawVerticalText(R,G,O)):(R.lineTo(q-4,O),J>u&&this.drawVerticalText(R,G,O));R.stroke(),y&&this.alignGuideMap&&this.alignGuideMap.y.length&&(R.beginPath(),R.strokeStyle=h,this.alignGuideMap.y.forEach(function(M){x=w*M.value-b.y,R.moveTo(0,x),R.lineTo(q,x)}),R.stroke());var Q=this.hoverGuideLineY;if(y&&Q){var s=w*Q.y-b.y,l=P(M,Q.y);R.fillStyle=oN.config.color_pane,R.fillRect(0,s,q,l.width),R.save(),R.translate(0,s),R.rotate(-Math.PI/2),B(R,Q.y,M,h,-l.width,0,l.width,q,"right"),R.restore(),R.beginPath(),R.lineWidth=2,R.moveTo(0,s),R.lineTo(q,s),R.strokeStyle=ht.Default.brighter(h),R.stroke()}R.restore()}},M.prototype.updateAlignGuide=function(){if(this.getGridGuide()){var M=this.dm,q=this.alignGuideMap,N=q.x,e=q.y;M.beginTransaction(),M.a({xAlignmentGuides:N&&N.length?N.map(function(M){return M.value}):void 0,yAlignmentGuides:e&&e.length?e.map(function(M){return M.value}):void 0}),M.endTransaction()}},M.prototype.getGridGuide=function(){return this.gv.getEditInteractor()?this.gv.getEditInteractor().gridGuide:null},M.prototype.isInteractive=function(M){return!!M.__editable__},IN(M,[{key:"editable",get:function(){return this.sceneView?this.sceneView.editable:this._editable},set:function(M){this.sceneView||M!==this._editable&&(this._editable=M,this.gv.invalidateSelection(),this.editor.mainToolbar.iv())}},{key:"currentEditingPoint",get:function(){return this._currentEditingPoint},set:function(M){var q=this._currentEditingPoint;this._currentEditingPoint=M,null==q&&M||q&&null==M?this.editor.filterProperties():this.editor.updateInspectorPropertiesLater()}},{key:"dm",get:function(){return this.graphView.dm()}}]),M}();MM(vX,{ms_v:1,ms_fire:1,ms_ac:["rulerBackground","rulerFont","rulerColor","rulerSize","guideColor"],hteditor_editview:1,_rulerFont:oN.config.smallFont,_rulerBackground:oN.config.color_pane,_rulerColor:oN.config.color_dark,_rulerSize:oN.config.rulerSize,_guideColor:oN.config.color_transparent,_interactionState:void 0});var oX=function(M){function q(N,e,X){YN(this,q);var w=N.getView(),$=dN(this,M.call(this,w.graphView));return $.tab=N,$.editView=w,$.editor=$.editView.editor,$.clazz=e,$.type=X,$._disabled=!1,$}return rN(q,M),q.prototype.beginTransaction=function(){this._isBeginTransaction||(this._isBeginTransaction=!0,this.dm.beginTransaction())},q.prototype.endTransaction=function(){this._isBeginTransaction&&(this._isBeginTransaction=!1,this.dm.endTransaction())},q.prototype.getDataAt=function(M,q){return this.gv.getDataAt(M,q)},q.prototype.getNodeAt=function(M){var q=this.getDataAt(M);return q instanceof ht.Node?q:null},q.prototype.setUp=function(){M.prototype.setUp.call(this),this.sm.cs()},q.prototype.$0$=function(M){},q.prototype.drawDiamond=function(M,q,N,e){var X=arguments.length>4&&void 0!==arguments[4]?arguments[4]:4;q=this.toPoint(q),e&&(M.fillStyle=e),N&&(M.strokeStyle=N);var w=q,$=w.x,t=w.y;M.lineWidth=1,M.beginPath(),M.moveTo($,t-X),M.lineTo($+X,t),M.lineTo($,t+X),M.lineTo($-X,t),M.closePath(),e&&M.fill(),N&&M.stroke()},q.prototype.drawRect=function(M,q,N,e){q=this.toRect(q),e&&(M.fillStyle=e),N&&(M.strokeStyle=N),M.lineWidth=1,M.beginPath(),M.rect(q.x,q.y,q.width,q.height),M.stroke(),e&&M.fill(),N&&M.stroke()},q.prototype.drawPoint=function(M,q,N,e,X){q=this.toPoint(q),X&&(M.fillStyle=X),e&&(M.strokeStyle=e),M.lineWidth=1,M.beginPath(),M.arc(q.x,q.y,N,0,2*Math.PI,!0),X&&M.fill(),e&&M.stroke()},q.prototype.drawPoints=function(M,q,N,e,X){for(var w=0;w<q.length;w++)this.drawPoint(M,q[w],N,e,X)},q.prototype.drawLine=function(M,q,N,e){q=this.toPoint(q),N=this.toPoint(N),M.lineWidth=1,M.strokeStyle=e,M.beginPath(),M.moveTo(q.x,q.y),M.lineTo(N.x,N.y),M.stroke()},q.prototype.toRect=function(M){var q=this.zoom;return{x:M.x*q+this.tx,y:M.y*q+this.ty,width:M.width*q,height:M.height*q}},q.prototype.toPoint=function(M){return{x:M.x*this.zoom+this.tx,y:M.y*this.zoom+this.ty}},q.prototype.add=function(M){this.editView.addData(M)},q.prototype.remove=function(M){this.dm.remove(M)},q.prototype.lp=function(M){return this.gv.lp(M)},q.prototype.handle_mousewheel=function(M){this.gv.handleScroll(M,M.wheelDelta)},q.prototype.handle_DOMMouseScroll=function(M){2===M.axis&&this.gv.handleScroll(M,-M.detail)},IN(q,[{key:"dm",get:function(){return this.gv.dm()}},{key:"sm",get:function(){return this.gv.dm().sm()}},{key:"zoom",get:function(){return this.gv.getZoom()}},{key:"tx",get:function(){return this.gv.tx()}},{key:"ty",get:function(){return this.gv.ty()}},{key:"disabled",get:function(){return!this.editor.editable||this._disabled},set:function(M){this._disabled=M}}]),q}(ht.graph.Interactor),HX=function(M){function q(N,e,X){return YN(this,q),dN(this,M.call(this,N,e,X))}return rN(q,M),q.prototype.tearDown=function(){M.prototype.tearDown.call(this),this.node=this.p1=this.p2=null},q.prototype.$48$=function(M){this.node?this.remove(this.node):this.editView.$4$("edit")},q.prototype.handle_mousedown=function(M){this.handle_touchstart(M)},q.prototype.handle_touchstart=function(M){NM(M),j(M)&&(this.gv.setFocus(M),this.p1=this.lp(M),this.startDragging(M))},q.prototype.handleWindowMouseMove=function(M){this.handleWindowTouchMove(M)},q.prototype.handleWindowMouseUp=function(M){this.handleWindowTouchEnd(M)},q.prototype.handleWindowTouchMove=function(M){if(NM(M),this.p1){this.p2=this.lp(M);var q=l(this.p1,this.p2);if(ht.Default.isShiftDown(M)){var N=Math.max(q.width,q.height);q.width=q.height=N}if(this.node)this.node.setRect(q);else{if(!q.width||!q.height)return;this.beginTransaction(),this.createNode(q,!1)}}},q.prototype.handleWindowTouchEnd=function(M){NM(M),this.endTransaction(),!this.node&&this.p1&&this.createNode({x:this.p1.x-25,y:this.p1.y-25,width:50,height:50},!0),oN.config.continuousCreating?this.node=this.p1=this.p2=null:this.editView.$4$("edit")},q.prototype.createNode=function(M,q){OM(this.type)?this.node=this.type(M,q):this.node=new this.clazz,q?this.node.setPosition(M.x+M.width/2,M.y+M.height/2):this.node.setRect(M),this.add(this.node)},q.prototype.$0$=function(M){this.node&&this.drawRect(M,this.node.getRect(),oN.config.color_data_border)},q}(oX),UX=function(M){function q(N,e,X){return YN(this,q),dN(this,M.call(this,N,e,X))}return rN(q,M),q.prototype.getDataAt=function(q,N){var e=this;return M.prototype.getDataAt.call(this,q,function(M){return e.gv.isSourceTargetEditable(null,M,N)})},q.prototype.tearDown=function(){M.prototype.tearDown.call(this),this._clear()},q.prototype.$48$=function(M){this.editView.__interacting__?(this._clear(),this.editView.validateCanvas(),M.__prevent__=!0):this.editView.$4$("edit")},q.prototype.drawAttachPoints=function(M,q,N){var e=this,X=this.gv.getAttachPoints(q);X&&X.forEach(function(X,w){var $=X.x,t=X.y,E=X.offsetX,J=X.offsetY;w===N?e.drawDiamond(M,q.getAttachPosition($,t,E,J),oN.config.color_select,oN.config.color_select,6):e.drawDiamond(M,q.getAttachPosition($,t,E,J),oN.config.color_select,oN.config.color_light)})},q.prototype.drawCurve=function(M,q,N){var e=this.gv.getEditInteractor();if(!e)return null;var X=e.getSubModule("Curve");if(!X)return null;X.drawEdgeHostHighlight(M,q,N),this.editView.validateCanvasLater()},q.prototype.$0$=function(M){var q=this.source,N=this.target,e=this.startPoint,X=this.endPoint;if(e&&X&&(M.strokeStyle=oN.config.color_data_border,M.beginPath(),_N(e)?e.forEach(function(q,N){M.moveTo(q.x,q.y),M.lineTo(X.x,X.y)}):(M.moveTo(e.x,e.y),M.lineTo(X.x,X.y)),M.stroke()),q&&!_N(q))if(q instanceof ht.Edge)this.drawCurve(M,q,e);else{this.drawRect(M,this.gv.getNodeRect(q),oN.config.color_data_border);var w=e.attachInfo;this.drawAttachPoints(M,q,w?w.index:void 0)}if(N)if(N instanceof ht.Edge)this.drawCurve(M,N,X.edgePosition);else{var $=this.gv.getNodeRect(N);this.drawRect(M,$,oN.config.color_data_border);var t=X.attachInfo;if(this.drawAttachPoints(M,N,t?t.index:void 0),!k()){var E=this.toPoint({x:$.x,y:$.y});M.beginPath(),M.moveTo(E.x,E.y-15-3),M.lineTo(E.x+10,E.y-15-3),M.lineTo(E.x+10,E.y-3),M.lineTo(E.x+5,E.y-7-3),M.moveTo(E.x+10,E.y-3),M.lineTo(E.x+15,E.y-7-3),M.lineWidth=1,M.strokeStyle=oN.config.color_data_border,M.stroke()}}},q.prototype.handle_mousemove=function(M){NM(M);var q=this.getDataAt(M),N={point:this.lp(M)};q&&(q instanceof ht.Edge?(N.edgePosition=this.gv.calculateEdgePosition(q,N.point),N.point=N.edgePosition.point):(N.attachInfo=this.gv.calculateAttachPoint(q,N.point),N.point=this.getAttachPosition(q,N.attachInfo))),Object.assign(N,this.toPoint(N.point)),this.editView.__interacting__?(this.target=q,this.endPoint=N):(this.source=q,this.startPoint=N),this.editView.validateCanvas()},q.prototype.handle_mousedown=function(M){this.handle_touchstart(M)},q.prototype.handle_touchstart=function(M){if(NM(M),j(M)){var q=this.source,N=this.startPoint;if(this.editView.__interacting__&&(q=this.target,N=this.endPoint),q){if(k(M)){var e=this.source;_N(e)||(e=this.source=[]),e.push(q);var X=this.startPoint;_N(X)||(X=this.startPoint=[]),X.push(N)}else{if(this.editView.__interacting__)return void this.handleWindowTouchEnd(M);this.startDragging(M)}this.editView.__interacting__=this.gv}}},q.prototype.handleWindowMouseMove=function(M){this.handleWindowTouchMove(M)},q.prototype.handleWindowMouseUp=function(M){this.handleWindowTouchEnd(M)},q.prototype.handleWindowTouchMove=function(M){this.autoScroll(M);var q=this.source,N=this.lp(M),e={point:N};delete this.target;var X=this.getDataAt(M,!0);X&&(oN.config.edgeLoop||_N(q)&&q.indexOf(X)<0||q!==X)&&(X instanceof ht.Edge?(e.edgePosition=this.gv.calculateEdgePosition(X,N),e.point=e.edgePosition.point):(e.attachInfo=this.gv.calculateAttachPoint(X,N),e.point=this.getAttachPosition(X,e.attachInfo)),this.target=X),Object.assign(e,this.toPoint(e.point)),this.endPoint=e,this.editView.validateCanvas()},q.prototype.handleWindowTouchEnd=function(M){var q=this,N=this.source,e=this.target,X=this.startPoint,w=this.endPoint,$=!1;N&&e&&(this.editor.beginTransaction(),_N(N)?N.forEach(function(M,N){return q._createEdge(M,e,X[N],w)}):this._createEdge(N,e,X,w),this.editor.endTransaction(),$=!0),$&&!oN.config.continuousCreating&&this.editView.$4$("edit"),this._clear()},q.prototype.getAttachPoint=function(M,q){var N=q?q.index:void 0;if(null===N||void 0===N)return null;var e=this.gv.getAttachPoints(M);return e&&0!==e.length?e[N]:null},q.prototype.getAttachPosition=function(M,q){var N=this.getAttachPoint(M,q);if(!N)return M instanceof ht.Edge?null:this._getNodeCenterPosition(M);var e=N.x,X=N.y,w=N.offsetX,$=N.offsetY;return M.getAttachPosition(e,X,w,$)},q.prototype._createEdge=function(M,q,N,e){var X=void 0;kN(this.type)?(X=new this.clazz(M,q),X.s("edge.type",this.type)):X=OM(this.type)?this.type(M,q):new this.clazz(M,q);var w=void 0,$=void 0;if(M instanceof ht.Edge){var t=N.edgePosition;void 0!==t.index?X.setStyle("edge.source.index",t.index):void 0!==t.percent&&X.setStyle("edge.source.percent",t.percent)}else if(w=this.getAttachPoint(M,N.attachInfo)){var E=w,J=E.x,u=E.y,g=E.offsetX,S=E.offsetY;X.s({"edge.source.anchor.x":J,"edge.source.anchor.y":u,"edge.source.offset.x":g,"edge.source.offset.y":S})}if(q instanceof ht.Edge){var b=e.edgePosition;void 0!==b.index?X.setStyle("edge.target.index",b.index):void 0!==b.percent&&X.setStyle("edge.target.percent",b.percent)}else if($=this.getAttachPoint(q,e.attachInfo)){var h=$,y=h.x,P=h.y,f=h.offsetX,x=h.offsetY;X.s({"edge.target.anchor.x":y,"edge.target.anchor.y":P,"edge.target.offset.x":f,"edge.target.offset.y":x})}return(w||$)&&X.s("edge.offset",0),this.add(X),X},q.prototype._getNodeCenterPosition=function(M){var q=M.getSize(),N=q.width,e=q.height,X=M.getAnchor();return M.getMatrix().tf(N*(.5-X.x),e*(.5-X.y))},q.prototype._clear=function(){delete this.source,delete this.target,delete this.startPoint,delete this.endPoint,this.editView.__interacting__===this.gv&&delete this.editView.__interacting__,this.editView.validateCanvas()},q}(oX),VX=function(M){function q(N,e,X,w){YN(this,q);var $=dN(this,M.call(this,N,e,X));return $.fill=w,$}return rN(q,M),q.prototype.setUp=function(){var q=this;M.prototype.setUp.call(this),this.shapeHelper.reset(),this.shapeHelper.targetNode=null,this.historyMap={},this.editor.dm.getHistoryManager().mp(this.handleHistoryChange,this),this.oldVisibleFunc=this.editor.gv.getVisibleFunc(),this.editor.gv.setVisibleFunc(function(M){return M!==q.shapeHelper.targetNode})},q.prototype.createShape=function(){if(this.shapeHelper.targetNode)return void(this.shapeHelper.targetNode.dm()||this.editor.dm.add(this.shapeHelper.targetNode));var M=this.shapeHelper.createShape(this.type,this.clazz);this.add(M),this.editor.sm.cs()},q.prototype.tearDown=function(){M.prototype.tearDown.call(this),this.editor.dm.getHistoryManager().ump(this.handleHistoryChange,this),this.editor.gv.setVisibleFunc(this.oldVisibleFunc)},q.prototype.handleHistoryChange=function(M){if("historyIndex"===M.property&&!this.shapeHelper.setting){var q=this.shapeHelper;if(q.targetNode.dm()){q.points=q.targetNode.getPoints().toArray(),q.segments=q.targetNode.getSegments().toArray();var N=this.historyMap[M.newValue];N&&(q.preCtrl=N.preCtrl,q.isBreak=N.isBreak)}else q.reset();this.editView.validateCanvas()}},q.prototype.$48$=function(M){var q=this.shapeHelper;q.isEditing3d()||(q.targetNode&&!q.isBreak?(q.preCtrl=null,q.isBreak=!0,this.editView.validateCanvas()):this.endEditing())},q.prototype.endEditing=function(){var M=this.shapeHelper,q=M.closePath,N=M.targetNode;q&&N.setClosePath&&N.setClosePath(!0),this.editView.$4$("edit"),this.editor.pointsEditingMode=!0},q.prototype.handle_mousedown=function(M){this.handle_touchstart(M)},q.prototype.isCloseStart=function(M){var q=this.shapeHelper.points,N=q[0];return!!N&&s(N,this.lp(M))<5/this.zoom},q.prototype.handle_touchstart=function(M){this.shapeHelper.setEditing3d(!1);var q=this.shapeHelper,N=q.points,e=q.segments,X=q.isBreak,w=q.preCtrl;if(NM(M),j(M)){if(this.gv.setFocus(M),K(M))this.endEditing();else{if(this.isCloseStart(M))return this.shapeHelper.closePath=!0,void this.endEditing();var $=this.judgeNextPoint(M,!0),t=N[N.length-1];if(N.length&&Math.abs(t.x-$.x)<.01&&Math.abs(t.y-$.y)<.01)return;if(w)N.push(w),N.push($),N.push($),e.push(4),this.shapeHelper.preCtrl=null;else{if(X){if(this.shapeHelper.isBreak=!1,s($,t)<5/this.zoom)return;e.push(1)}else e.push(N.length>0?2:1);N.push($)}this.shapeHelper.nextPoint=this.lp(M),this.editView.validateCanvas()}this.shapeHelper.downPoint=this.lp(M),this.startDragging(M),this._dragging=!0}},q.prototype.judgeNextPoint=function(M,q){var N=this.shapeHelper,e=N.points,X=N.isBreak,w=this.lp(M);if(this._dragging||X&&!q)return null;if(ht.Default.isShiftDown()&&e.length>0){var $=e[e.length-1],t=w.x-$.x,E=w.y-$.y,J=Math.atan2(E,t),u=ht.Default.getDistance($,w),g=J%(Math.PI/4);return J-=g,Math.abs(g)>Math.PI/8&&(g>0?J+=Math.PI/4:J-=Math.PI/4),{x:$.x+Math.cos(J)*u,y:$.y+Math.sin(J)*u}}var S=this.gv.getEditInteractor(),b=S.gridGuide.findClosest(w);return b&&(b.x&&(w.x+=b.x),b.y&&(w.y+=b.y)),w},q.prototype.handle_mousemove=function(M){this.shapeHelper.nextPoint=this.judgeNextPoint(M),this.editView.validateCanvas()},q.prototype.handle_touchend=function(M){},q.prototype.handle_mouseup=function(M){this.handle_touchend(M)},q.prototype.handleWindowTouchMove=function(M){return this.handleWindowMouseMove(M)},q.prototype.updateCtrl=function(M){var q=this.shapeHelper,N=q.points,e=q.segments,X=q.downPoint,w=N.length,$=N[w-1],t=this.lp(M),E=this.zoom,J=ht.Default.getDistance(X,t),u=e.length,g=e[u-1];if(J*E>5){if(ht.Default.isShiftDown()){var S=Math.abs;S($.x-t.x)>=S($.y-t.y)?t.y=$.y:t.x=$.x}else{var b=this.gv.getEditInteractor(),h=b.gridGuide.findClosest(t);h&&(h.x&&(t.x+=h.x),h.y&&(t.y+=h.y))}4===g?N[w-2]={x:2*$.x-t.x,y:2*$.y-t.y}:1!==g&&(e[u-1]=4,N.splice(w-1,0,N[w-2]),N.push($)),this.shapeHelper.preCtrl=t}else 4===g&&(N[w-2]=N[w-1],this.shapeHelper.preCtrl=null)},q.prototype.handleWindowMouseMove=function(M){0!==this.shapeHelper.points.length&&(this.updateCtrl(M),this.editView.validateCanvas())},q.prototype.handleWindowTouchEnd=function(M){return this.handleWindowMouseUp(M)},q.prototype.handleWindowMouseUp=function(M){if(0!==this.shapeHelper.points.length){this._dragging=!1,this.updateCtrl(M),this.shapeHelper.setting=!0,this.editor.beginTransaction(),this.createShape();var q=this.shapeHelper.points,N=this.shapeHelper.segments;this.shapeHelper.targetNode.setPoints(q),this.shapeHelper.targetNode.setSegments(N),this.editor.endTransaction(),this.historyMap[this.editor.dm.getHistoryManager().getHistoryIndex()]=this.shapeHelper.getInfo(),this.shapeHelper.setting=!1,this.shapeHelper.nextPoint=this.judgeNextPoint(M,!0)}},q.prototype.$0$=function(M){var q=this.shapeHelper,N=q.points,e=q.segments,X=(q.isBreak,q.preCtrl),w=(q.downPoint,q.nextPoint),$=[];if(N&&N.length){M.beginPath();for(var t=0,E=void 0,J=void 0,u=void 0,g=0;g<e.length;g++){var S=e[g];1===S?(E=this.toPoint(N[t++]),M.moveTo(E.x,E.y)):2===S?(E=this.toPoint(N[t++]),M.lineTo(E.x,E.y)):3===S?(E=this.toPoint(N[t++]),J=this.toPoint(N[t++]),M.quadraticCurveTo(E.x,E.y,J.x,J.y)):4===S?(E=this.toPoint(N[t++]),J=this.toPoint(N[t++]),u=this.toPoint(N[t++]),M.bezierCurveTo(E.x,E.y,J.x,J.y,u.x,u.y)):5===S&&M.closePath(),$.push(N[t-1])}if(w)if(X)E=this.toPoint(X),J=this.toPoint(w),u=this.toPoint(w),M.bezierCurveTo(E.x,E.y,J.x,J.y,u.x,u.y);else{var b=this.toPoint(w);M.lineTo(b.x,b.y)}if(M.strokeStyle=oN.config.color_data_border,M.lineWidth=1,M.stroke(),this.fill&&(M.fillStyle=oN.config.color_transparent,M.fill()),this.drawPoints(M,$,4,oN.config.color_data_border,oN.config.color_data_background),X){var h=N.length,y=N[N.length-1],P=this.zoom,f=3/P,x=6/P,n=1===h?y:{x:2*y.x-X.x,y:2*y.y-X.y};this.drawLine(M,X,n,oN.config.color_data_border),h>1&&this.drawRect(M,{x:n.x-f,y:n.y-f,width:x,height:x},oN.config.color_data_border,oN.config.color_data_background),this.drawRect(M,{x:X.x-f,y:X.y-f,width:x,height:x},oN.config.color_data_border,oN.config.color_data_background)}}},IN(q,[{key:"shapeHelper",get:function(){return this.editor.shapeHelper}}]),q}(oX),TX=function(M){function q(N,e,X,w,$,t,E,J){YN(this,q);var u=dN(this,M.call(this,N,e,aX,"display",t,E,J));u.displayTree=u.list=new($||xX)(u),u.dm.setHierarchicalRendering(!0),u.dm.enableHistoryManager(oN.config.maxUndoRedoSteps);var g=N.getFileNode(X);return u.editable=!g||!1!==g.a("editable"),t||(X?w||u.editor.fireEvent("displayViewOpening",{displayView:u,url:X}):u.editor.fireEvent("displayViewCreated",{displayView:u,json:w})),oN.config.standaloneViewCounter&&u.initIdCounter&&u.initIdCounter(),u.dm.addSerializeListener(u.handleDataModelSerializeEvent,u),u.parse(X,w),u.dirty=!1,u}return rN(q,M),q.prototype.onClosed=function(){M.prototype.onClosed.call(this),this.displayTree.onClosed()},q.prototype.handleDataModelSerializeEvent=function(){},q.prototype.handleDataModelChanged=function(M){this.dirty=!0},q.prototype.clear=function(){this.sceneView||(this.dm.beginTransaction(),M.prototype.clear.call(this),this.dm.a("connectActionType",oN.config.displayConnectActionType),this.dm.a("anchorEnabled",oN.config.displayAnchorEnabled),this.dm.a("guideLineEnabled",oN.config.displayGuideLineEnabled),this.dm.a("highlightEnabled",oN.config.displayHighlightEnabled),this.dm.a("highlightColor",oN.config.displayHighlightColor),this.dm.a("highlightBorderWidth",oN.config.displayHighlightBorderWidth),this.dm.a("highlightBorderPattern",oN.config.displayHighlightBorderPattern),this.dm.a("fontFaces",void 0),this.dm.endTransaction())},q.prototype.resetGrid=function(){this.sceneView||(this.dm.beginTransaction(),this.dm.a("rulerEnabled",oN.config.displayRulerEnabled),this.dm.a("gridEnabled",oN.config.displayGridEnabled),this.dm.a("gridBlockSize",oN.config.displayGridBlockSize),this.dm.a("gridThickLinesEvery",oN.config.displayGridThickLinesEvery),this.dm.a("gridThickColor",oN.config.displayGridThickColor),this.dm.a("gridLightColor",oN.config.displayGridLightColor),this.dm.a("gridAngle",oN.config.displayGridAngle),this.dm.a("gridRotation",oN.config.displayGridRotation),this.dm.a("gridZoomThreshold",oN.config.displayGridZoomThreshold),this.dm.a("alignmentGuideEnabled",oN.config.displayGridAlignmentGuideEnabled),this.dm.a("alignmentGuideColor",oN.config.displayGridAlignmentGuideColor),this.dm.endTransaction())},q.prototype.updateImpl=function(M,q){var N=this,e=a(M);if(this.clear(),this.dm.deserialize(e,void 0,{setId:oN.config.setId,disableInit:!0,disableOnPreDeserialize:!0,disableOnPostDeserialize:!0}),this.dirty=!!q,!q&&oN.config.fitContentForDisplayView)if(e.contentRect){var X=VN(e.contentRect);ht.Default.grow(X,oN.config.fitPadding),this.graphView.getWidth()&&this.graphView.getHeight()?this.graphView.fitRect(X,oN.config.animate):setTimeout(function(){N.graphView.fitRect(X,oN.config.animate)},600)}else this.graphView.fitContent(oN.config.animate,oN.config.fitPadding);return e},q.prototype.createInteractor=function(M,q,N){var e=new M;return e instanceof ht.Shape?new VX(this.tab,null,function(N,e){var X=new M;return X.setPoints(N),X.setSegments(e),q&&q(X),X},N):e instanceof ht.Edge?new UX(this.tab,null,function(M,N){var e=new ht.Edge(M,N);return q&&q(e),e}):e instanceof ht.Node?new HX(this.tab,null,function(N,e){var X=new M;return q&&q(X,N,e),X}):void 0},IN(q,[{key:"content",get:function(){var M=this.dm,q=M.toJSON();q.modified=(new Date).toString(),M.a("connectActionType")===oN.config.displayConnectActionType&&delete q.a.connectActionType,M.a("rulerEnabled")===oN.config.displayRulerEnabled&&delete q.a.rulerEnabled,M.a("gridEnabled")===oN.config.displayGridEnabled&&delete q.a.gridEnabled,M.a("gridBlockSize")===oN.config.displayGridBlockSize&&delete q.a.gridBlockSize,M.a("gridThickLinesEvery")===oN.config.displayGridThickLinesEvery&&delete q.a.gridThickLinesEvery,M.a("gridThickColor")===oN.config.displayGridThickColor&&delete q.a.gridThickColor,M.a("gridLightColor")===oN.config.displayGridLightColor&&delete q.a.gridLightColor,M.a("gridAngle")===oN.config.displayGridAngle&&delete q.a.gridAngle,M.a("gridRotation")===oN.config.displayGridRotation&&delete q.a.gridRotation,M.a("gridZoomThreshold")===oN.config.displayGridZoomThreshold&&delete q.a.gridZoomThreshold,M.a("anchorEnabled")===oN.config.displayAnchorEnabled&&delete q.a.anchorEnabled,M.a("guideLineEnabled")===oN.config.displayGuideLineEnabled&&delete q.a.guideLineEnabled,M.a("highlightEnabled")===oN.config.displayHighlightEnabled&&delete q.a.highlightEnabled,M.a("highlightColor")===oN.config.displayHighlightColor&&delete q.a.highlightColor,M.a("highlightBorderWidth")===oN.config.displayHighlightBorderWidth&&delete q.a.highlightBorderWidth,M.a("highlightBorderPattern")===oN.config.displayHighlightBorderPattern&&delete q.a.highlightBorderPattern,M.a("xAlignmentGuides")&&!M.a("xAlignmentGuides").length&&delete q.a.xAlignmentGuides,M.a("yAlignmentGuides")&&!M.a("yAlignmentGuides").length&&delete q.a.yAlignmentGuides,M.a("alignmentGuideEnabled")===oN.config.displayGridAlignmentGuideEnabled&&delete q.a.alignmentGuideEnabled,M.a("alignmentGuideColor")===oN.config.displayGridAlignmentGuideColor&&delete q.a.alignmentGuideColor;var N=M.a("fontFaces");!N||_N(N)&&0!==N.length&&N.map(function(M){return M.name}).join("")||delete q.a.fontFaces;var e=this.graphView.getContentRect();return M.a("width")>0&&M.a("height")>0&&(q.contentRect={x:0,y:0,width:M.a("width"),height:M.a("height")}),M.size()&&e&&e.width&&e.height&&(q.contentRect=e),q}}]),q}(vX),_X=function(M){function q(N){return YN(this,q),dN(this,M.call(this,N))}return rN(q,M),q.prototype.setDataModel=function(M){var q=this,N=q._dataModel,e=q._selectionModel;N!==M&&(N&&(N.umm(q.handleDataModelChange,q),N.umd(q.handleDataPropertyChange,q),N.removeIndexChangeListener(q.handleIndexChange,q),e||N.sm().ums(q.handleSelectionChange,q)),q._dataModel=M,M.mm(q.handleDataModelChange,q),M.md(q.handleDataPropertyChange,q),M.addIndexChangeListener(q.handleIndexChange,q),e?e._setDataModel(M):M.sm().ms(q.handleSelectionChange,q),q.fp("dataModel",N,M))},q.prototype.handleIndexChange=function(M){this.ivm()},q.prototype.handleDataPropertyChange=function(M){this.invalidateData(M.data)},q.prototype.validateModel=function(){var M=this;M._rows.clear(),M._rowMap={};var q=M._rows=M._dataModel.toDatas(M.isVisible,M),N=0,e=M.getCurrentSortFunc(),X=q.size();for(e&&q.sort(e);N<X;N++)M._rowMap[q.get(N)._id]=N},q}(Ge),kX=function(M){function q(N,e){var X=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];YN(this,q);var w=dN(this,M.call(this,e));return w.editor=N,w.editable=X,w.addTopPainter(w.drawDNDState.bind(w)),w}return rN(q,M),q.prototype.getLabelColor=function(q){return q!==this.draggingData||this.isSelected(q)?q.s("2d.visible")&&q.s("3d.visible")?M.prototype.getLabelColor.call(this,q):oN.config.color_disabled:oN.config.color_select},q.prototype.isEditable=function(M){return this.editable},q.prototype.handleDelete=function(){this.editable&&this.removeSelection()},q.prototype.handleDataDoubleSelect=function(M,q){if(this.isEditable(q)){var N=this.getIcon(q)?this.getIndent():0;this.lp(M).x>N&&this.beginEditing(q)}},q.prototype.isDroppable=function(M,q){return!1},q.prototype._clearDragInfo=function(){this.editor.dnd.hideTip(),this._dragInfo&&(this._dragInfo=null,this.redraw())},q.prototype._endDrag=function(M,q){},q.prototype._endCrossDrag=function(M,q){},q.prototype.drawDNDState=function(M){oN.config.drawDNDState?M.drawDNDState=!0:(oN.config.texureImage3D&&(M.texureImage3D=!0),M.texureImage2D=!0);var q=void 0;if(this._dragInfo&&this._dragInfo.inView?q=this._dragInfo:this._crossDragInfo&&(q=this._crossDragInfo),q){var N=this.getWidth(),e=(this.getRowHeight(),q.type,oN.config.color_select_dark);if(q.refData){var X=q.y;M.beginPath(),M.arc(4,X,3,0,2*Math.PI,!0),M.moveTo(7,X),M.lineTo(N,X),M.lineWidth=2,M.strokeStyle=e,M.stroke()}else{var w=this.getViewRect();i(M,e,w.x,w.y,w.width,w.height,2)}}},q.prototype._dragging=function(M,q){var N=this.getRowHeight(),e=this.lp(M),X=e.y/N,w=Math.floor(X);w>this.getRowSize()-1||w<0?(q.refData=null,q.type=null,q.parent=null):(q.refData=this.getRowDatas().get(w),e.y-w*N<.5*N?(q.type="up",q.y=w*N):(q.type="down",q.y=(w+1)*N)),this.autoScroll(M),this.redraw()},q.prototype.$1$=function(){var M="";if(this.draggingData&&(M=this.getLabel(this.draggingData),this.isSelected(this.draggingData))){var q=this.sm().size();M+=q>1?" (+"+q+") ":""}return M},q.prototype.handleDragAndDrop=function(M,q){if(this.editable){if("prepare"===q)return void this._clearDragInfo();"begin"===q&&(this._dragInfo={tip:this.$1$(),view:this});var N=this._dragInfo;if(N){var e=this.editor.dnd;if("begin"===q||"between"===q){return this.getView().contains(m(M))?(N.inView=!0,this._dragging(M,N),e.clearDropView(M,N)):(N.inView&&this.redraw(),N.inView=!1,e.crossDrag(M,N)),void e.showTip(N.tip,M)}return"end"===q?(N.inView?this._endDrag(M,N):e.crossDrop(M,N),void this._clearDragInfo()):"cancel"===q?(N.inView||e.crossCancel(M,N),void this._clearDragInfo()):void 0}}},q.prototype.handleCrossDrag=function(M,q,N){if(this.editable)return"exit"===q||"cancel"===q?(this._crossDragInfo=null,void this.redraw()):"enter"===q||"over"===q?(this._crossDragInfo||(this._crossDragInfo={}),void this._dragging(M,this._crossDragInfo)):"drop"===q?(this._endCrossDrag(M,N),this._crossDragInfo=null,void this.redraw()):void 0},q}(_X);MM(kX,{hteditor_list_rename:1,getEditRect:function(M){var q=this.getIcon(M)?this.getIndent():0;return{x:q,y:this.ty()+this.getRowIndex(M)*this.getRowHeight(),width:Math.max(1,this.getWidth()-q),height:this.getRowHeight()}}});var ZX=function(M){function q(N){YN(this,q);var e=dN(this,M.call(this,N.editor,N.dm));return e.symbolView=N,e.graphView=N.graphView,e.nodeIcon=LM(e),e.initMenu(),e.initStudio&&e.initStudio(),N.dm.addDataPropertyChangeListener(function(M){M.data.editorIcon=null}),e.enableToolTip(),e}return rN(q,M),q.prototype.getToolTip=function(M){if(this._highlightData&&this._badgeType)return this._badgeType;var q=this.editor.gv;return q&&q.isDebugTipShowing()?oN.config.getToolTip(M,this):void 0},q.prototype.onDataDoubleClicked=function(M,q){this.editor.fitSelection()},q.prototype.onPropertyChanged=function(q){"filter"===q.property&&this.ivm(),M.prototype.onPropertyChanged.call(this,q)},q.prototype.handleDataPropertyChange=function(q){!this._filter||"displayName"!==q.property&&"s:text"!==q.property&&"s:type"!==q.property&&"s:image"!==q.property?M.prototype.handleDataPropertyChange.call(this,q):this.ivm()},q.prototype.isVisible=function(M){if("__renderHTML__"===M.getTag())return!1;if(!this._filter)return!0;var q=this.getVisibleFunc();if(q&&!q(M))return!1;if(oN.config.symbolListVisibleFunc)return oN.config.symbolListVisibleFunc(M,this._filter);var N=this.getLabel(M),e=(this._filter+"").toLowerCase();return null!=N&&(N=(N+"").toLowerCase(),N.indexOf(e)>=0)},q.prototype.validate=function(){this.graphView.validate(),M.prototype.validate.call(this)},q.prototype.validateModel=function(){var q=this;M.prototype.validateModel.call(this),oN.config.filterSymbolViewEnabled&&this.graphView.setVisibleFunc(function(M){return q.isVisible(M)})},q.prototype.getIcon=function(M){return M instanceof Pe?"editor.restore.state":M instanceof ht.Text?M.getIcon():M instanceof ht.Shape?(M.editorIcon||(M.editorIcon=FM(M)),M.editorIcon):M instanceof ht.Node?this.nodeIcon:null},q.prototype.isDroppable=function(M,q){return!1},q.prototype._endCrossDrag=function(M,q){},q.prototype._endDrag=function(M,q){var N=this;this.editor.beginTransaction();var e=q.type,X=q.refData;if(this.isSelected(this.draggingData)){var w=this.getRowOrderSelection();"down"===e&&w.reverse(),w.each(function(M){N._dropData(M,e,X)})}else this._dropData(this.draggingData,e,X),this.sm().ss(this.draggingData);this.editor.endTransaction()},q.prototype._dropData=function(M,q,N){if(N){var e=this.dm().getDatas(),X=e.indexOf(N);"down"===q&&X++,e.indexOf(M)<X&&X--,this.dm().moveToIndex(M,X)}else this.dm().bringToFront(M)},q.prototype.initMenu=function(){this.menu=new ne;var M=[];this.initMenuItems(M),this.menu.setItems(M),this.menu.addTo(this.getView()),this.editor.menus.push(this.menu)},q.prototype.onClosed=function(){E(this.editor.menus,this.menu)},q.prototype.initMenuItems=function(M){var q=this;M.push.apply(M,[{id:"copy",label:e("editor.copy"),action:function(){q.editor.copy()},visible:function(){return!!q.editor.ld}},{id:"paste",label:e("editor.paste"),action:function(){q.editor.paste()},visible:function(){return q.editable&&q.editor.hasCopyInfo()}},{id:"delete",label:e("editor.delete"),action:function(){q.editor.delete()},visible:function(){return q.editable&&!!q.editor.ld}},"separator",{
id:"bringToFront",label:e("editor.bringtofront"),action:function(){q.editor.bringToFront()},visible:function(){return q.editable&&!!q.editor.ld}},{id:"bringForward",label:e("editor.bringforward"),action:function(){q.editor.bringForward()},visible:function(){return q.editable&&!!q.editor.ld}},{id:"sendBackward",label:e("editor.sendbackward"),action:function(){q.editor.sendBackward()},visible:function(){return q.editable&&!!q.editor.ld}},{id:"sendToBack",label:e("editor.sendtoback"),action:function(){q.editor.sendToBack()},visible:function(){return q.editable&&!!q.editor.ld}}]),this.editor.addShapeSplitMenuItems(M)},IN(q,[{key:"editable",get:function(){return this.editor.editable},set:function(M){}}]),q}(kX);MM(ZX,{ms_ac:["filter"]});var zX=function(M){function q(N){return YN(this,q),dN(this,M.call(this,N))}return rN(q,M),q.prototype.handleDataModelChange=function(q){M.prototype.handleDataModelChange.call(this,q),this.editor&&this.editor.fireViewEvent(this.editView,"DataModelChanged",{event:q})},q.prototype.handleDataModelPropertyChange=function(q){M.prototype.handleDataModelPropertyChange.call(this,q),this.editor&&this.editor.fireViewEvent(this.editView,"DataModelPropertyChanged",{event:q})},q.prototype.handleDataPropertyChange=function(q){M.prototype.handleDataPropertyChange.call(this,q),this.editor&&this.editor.fireViewEvent(this.editView,"DataPropertyChanged",{event:q})},q.prototype.isDroppable=function(M,q){if(this.editor.editable)return!!q.view.isDroppableToSymbolView},q.prototype.isPixelPerfect=function(M){return!0},q.prototype.initMenuItems=function(q){this.$56$(q),this.$55$(q),this.editor.$103$(q),M.prototype.initMenuItems.call(this,q)},q.prototype.isVisible=function(q){var N=this.editor.symbolStatePane.currentState,e=this.getState(q);return(void 0===e||e===N)&&M.prototype.isVisible.call(this,q)},q.prototype.getState=function(M){var q=M.s("state");return q||this.editor.symbolStatePane.currentState},q}(dX),AX=function(M){function q(N,e,X){YN(this,q);var w=dN(this,M.call(this));return w.setIcon("editor.func"),w.setImage("editor.func"),w.parse(N,e,X),w}return rN(q,M),q.prototype.toLabel=function(){return this.getDisplayName()||e("editor.comptype.func")},q.prototype.getClass=function(){return q},q.prototype.parse=function(M,q,N){M&&(this.a("type",M.type),vM(this,M,q,N))},q.prototype.toJSON=function(){var M={};return M.type=this.a("type"),oM(this,M),M},IN(q,[{key:"compType",get:function(){return"function"}}]),q}(ht.Node),cX=function(M){function q(N,e,X){YN(this,q);var w=dN(this,M.call(this));return w.s({border_color:oN.config.color_dark,border_width:1}),w.setImage("border_image"),w.parse(N,e,X),w}return rN(q,M),q.prototype.getClass=function(){return q},q.prototype.toLabel=function(){return this.getDisplayName()||e("editor.comptype.border")},q.prototype.parse=function(M,q,N){M&&(HM(this,"type",M.type,"border"),HM(this,"border_color",M.color,oN.config.color_dark),HM(this,"border_width",M.width,1),vM(this,M,q,N))},q.prototype.toJSON=function(){var M={};return rM(this,M,"type","type",void 0),rM(this,M,"border_color","color",void 0),rM(this,M,"border_width","width",void 0),oM(this,M),M},IN(q,[{key:"compType",get:function(){return this.s("type")}}]),q}(ht.Node),BX=function(M){function q(N,e,X){YN(this,q);var w=dN(this,M.call(this));return w.setSize(100,100),w.setImage("pieChart_image"),w.s({"chart.label":!1,"chart.label.color":ht.Default.labelColor,"chart.label.font":ht.Default.labelFont,"chart.hollw":!1,"chart.start.angle":0,"chart.values":[],"chart.colors":void 0}),w.parse(N,e,X),w}return rN(q,M),q.prototype.getClass=function(){return q},q.prototype.toLabel=function(){return this.getDisplayName()||e("editor.comptype.piechart")},q.prototype.parse=function(M,q,N){M&&(HM(this,"chart.type",M.type,"pieChart"),HM(this,"chart.label",M.label,!1),HM(this,"chart.label.color",M.labelColor,ht.Default.labelColor),HM(this,"chart.label.font",M.labelFont,ht.Default.labelFont),HM(this,"chart.hollow",M.hollow,!1),HM(this,"chart.start.angle",M.startAngle,0),HM(this,"chart.values",M.values,[]),HM(this,"chart.colors",M.colors,void 0),vM(this,M,q,N))},q.prototype.toJSON=function(){var M={};return rM(this,M,"chart.type","type",void 0),rM(this,M,"chart.label","label",!1),rM(this,M,"chart.label.color","labelColor",ht.Default.labelColor),rM(this,M,"chart.label.font","labelFont",ht.Default.labelFont),rM(this,M,"chart.hollow","hollow",!1),rM(this,M,"chart.start.angle","startAngle",0),rM(this,M,"chart.values","values",[]),rM(this,M,"chart.colors","colors",void 0),oM(this,M),M},IN(q,[{key:"compType",get:function(){return this.s("chart.type")}}]),q}(ht.Node),LX=function(M){function q(N,e,X){YN(this,q);var w=dN(this,M.call(this));return w.setSize(100,100),w.setImage("columnChart_image"),w.s({"chart.label":!1,"chart.label.color":ht.Default.labelColor,"chart.label.font":ht.Default.labelFont,"chart.series":[],"chart.min.value":0,"chart.max.value":void 0}),w.parse(N,e,X),w}return rN(q,M),q.prototype.getClass=function(){return q},q.prototype.toLabel=function(){return this.getDisplayName()||e("editor.comptype.columnchart")},q.prototype.parse=function(M,q,N){M&&(HM(this,"chart.type",M.type,void 0),HM(this,"chart.label",M.label,!1),HM(this,"chart.label.color",M.labelColor,ht.Default.labelColor),HM(this,"chart.label.font",M.labelFont,ht.Default.labelFont),HM(this,"chart.series",M.series,[]),HM(this,"chart.min.value",M.minValue,0),HM(this,"chart.max.value",M.maxValue,void 0),vM(this,M,q,N))},q.prototype.toJSON=function(){var M={};return rM(this,M,"chart.type","type",void 0),rM(this,M,"chart.label","label",!1),rM(this,M,"chart.label.color","labelColor",ht.Default.labelColor),rM(this,M,"chart.label.font","labelFont",ht.Default.labelFont),rM(this,M,"chart.series","series",[]),rM(this,M,"chart.min.value","minValue",0),rM(this,M,"chart.max.value","maxValue",void 0),oM(this,M),M},IN(q,[{key:"compType",get:function(){return this.s("chart.type")}}]),q}(ht.Node),iX=function(M){function q(N,e,X){YN(this,q);var w=dN(this,M.call(this));return w.setSize(100,100),w.setImage("lineChart_image"),w.s({"chart.label":!1,"chart.label.color":ht.Default.labelColor,"chart.label.font":ht.Default.labelFont,"chart.series":[],"chart.min.value":0,"chart.max.value":void 0,"chart.line.point":!1,"chart.line.width":2,"chart.line.3d":!1}),w.parse(N,e,X),w}return rN(q,M),q.prototype.getClass=function(){return q},q.prototype.toLabel=function(){return this.getDisplayName()||e("editor.comptype.linechart")},q.prototype.parse=function(M,q,N){M&&(HM(this,"chart.type",M.type,void 0),HM(this,"chart.label",M.label,!1),HM(this,"chart.label.color",M.labelColor,ht.Default.labelColor),HM(this,"chart.label.font",M.labelFont,ht.Default.labelFont),HM(this,"chart.series",M.series,[]),HM(this,"chart.min.value",M.minValue,0),HM(this,"chart.max.value",M.maxValue,void 0),HM(this,"chart.line.point",M.linePoint,!1),HM(this,"chart.line.width",M.lineWidth,2),HM(this,"chart.line.3d",M.line3d,!1),vM(this,M,q,N))},q.prototype.toJSON=function(){var M={};return rM(this,M,"chart.type","type",void 0),rM(this,M,"chart.label","label",!1),rM(this,M,"chart.label.color","labelColor",ht.Default.labelColor),rM(this,M,"chart.label.font","labelFont",ht.Default.labelFont),rM(this,M,"chart.series","series",[]),rM(this,M,"chart.min.value","minValue",0),rM(this,M,"chart.max.value","maxValue",void 0),rM(this,M,"chart.line.point","linePoint",!1),rM(this,M,"chart.line.width","lineWidth",2),rM(this,M,"chart.line.3d","line3d",!1),oM(this,M),M},IN(q,[{key:"compType",get:function(){return this.s("chart.type")}}]),q}(ht.Node),FX={rect:ge,circle:ge,oval:ge,roundRect:ge,star:ge,nStar:ge,triangle:ge,hexagon:ge,pentagon:ge,diamond:ge,rightTriangle:ge,parallelogram:ge,pentagram:ge,trapezoid:ge,polygon:ge,arc:ge,image:be,shape:Se,text:he,border:cX,pieChart:BX,oneDimensionalColumnChart:LX,columnChart:LX,percentageColumnChart:LX,stackedColumnChart:LX,lineChart:iX,comp:fe,clip:ye,restore:Pe,endClip:Pe};oN.toDatas=function(M,q){var N=[];return M.forEach(function(M){var e=PN(M);if(e){var X=qN(e),w=NN(X,q);if(w){if(N.push(w),M.attribs){var $={};M.attribs.forEach(function(M){var q=M.attr,N=$[q]||0;$[q]=N+1,N>0&&(q=q+"_"+N),M.hidden||(w.a(q+".text",M.text),w.a(q+".visible",void 0!==M.text),w.a(q+".cadRotation",M.rotation||0));var e=M.startPoint;(M.halign||M.valign)&&(e=M.endPoint),w.a(q+".x",e.x),w.a(q+".y",e.y)})}}else N.push(null)}else N.push(null)}),N};var Mw=function(M){function q(N,e,X,w,$,t){YN(this,q);var E=dN(this,M.call(this,N,e,zX,"symbol",void 0,$,t));E.graphView.vectorDataBindingDisabled=!0,E.graphView.getLabel=function(){return null},E.graphView.setVisibleFunc(function(M){return!(M instanceof Pe)}),E.list=E.symbolList=new ZX(E),E.dm.a({name:void 0,comps:[],width:100,height:100,boundExtend:0,fitSize:!1,scrollable:!1,interactive:!1,disableSelectedBorder:!1,pixelPerfect:!0,clip:!1,visible:!0,color:void 0,blendMode:"multiply",opacity:1});var J=oN.config.customProperties.symbol;J&&J.length&&J.forEach(function(M){E.dm.a(M.property,M.defaultValue)}),E.dm.addIndexChangeListener(function(){E.dirty=!0}),E.dirty=!1,E.dm.enableHistoryManager(oN.config.maxUndoRedoSteps);var u=E.dm.getHistoryManager(),g=u.isPropertyUndoable;u.isPropertyUndoable=function(M,q){return!(q instanceof fe&&"image"===M)&&g.apply(this,arguments)};var S=["a:renderHTML","a:width","a:height","f:dataBindings"];E.dm.mp(function(M){S.indexOf(M.property)>=0&&E.updateRenderNode()}),E.parse(X,w);var b=N.getFileNode(X);return E.editable=!b||!1!==b.a("editable"),X?w||E.editor.fireEvent("symbolViewOpening",{symbolView:E,url:X}):E.editor.fireEvent("symbolViewCreated",{symbolView:E,json:w}),E}return rN(q,M),q.prototype.clear=function(){this.dm.beginTransaction(),M.prototype.clear.call(this),this.dm.a("connectActionType",oN.config.symbolConnectActionType),this.dm.a("anchorEnabled",oN.config.symbolAnchorEnabled),this.dm.a("guideLineEnabled",oN.config.symbolGuideLineEnabled),this.dm.a("highlightEnabled",oN.config.symbolHighlightEnabled),this.dm.a("highlightColor",oN.config.symbolHighlightColor),this.dm.a("highlightBorderWidth",oN.config.symbolHighlightBorderWidth),this.dm.a("highlightBorderPattern",oN.config.symbolHighlightBorderPattern),this.dm.setAutoAdjustIndex(!1),this.dm.endTransaction()},q.prototype.resetGrid=function(){this.dm.beginTransaction(),this.dm.a("rulerEnabled",oN.config.symbolRulerEnabled),this.dm.a("gridEnabled",oN.config.symbolGridEnabled),this.dm.a("gridBlockSize",oN.config.symbolGridBlockSize),this.dm.a("gridThickLinesEvery",oN.config.symbolGridThickLinesEvery),this.dm.a("gridThickColor",oN.config.symbolGridThickColor),this.dm.a("gridLightColor",oN.config.symbolGridLightColor),this.dm.a("gridAngle",oN.config.symbolGridAngle),this.dm.a("gridRotation",oN.config.symbolGridRotation),this.dm.a("gridZoomThreshold",oN.config.symbolGridZoomThreshold),this.dm.a("alignmentGuideEnabled",oN.config.symbolGridAlignmentGuideEnabled),this.dm.a("alignmentGuideColor",oN.config.symbolGridAlignmentGuideColor),this.dm.endTransaction()},q.prototype.onClosed=function(){M.prototype.onClosed.call(this),this.list.onClosed(),this.renderIframeImage&&(this.iframe.src="about:blank",delete this.renderIframeImage,delete this.iframe)},q.prototype.updateImpl=function(M,q){var N=this;this._updating=!0;var e=this.dm,X=a(M),w=this.editor.symbolStatePane;w.symbolViewUpdating=!0,this.clear(),e.setBackground(X.background),e.a("previewURL",X.previewURL),e.a("snapshotURL",X.snapshotURL),e.dataBindings=X.dataBindings,this.attrObject=X.attrObject,e.a("xAlignmentGuides",X.xAlignmentGuides),e.a("yAlignmentGuides",X.yAlignmentGuides),null!=X.rulerEnabled&&e.a("rulerEnabled",X.rulerEnabled),null!=X.gridEnabled&&e.a("gridEnabled",X.gridEnabled),null!=X.gridBlockSize&&e.a("gridBlockSize",X.gridBlockSize),null!=X.gridThickLinesEvery&&e.a("gridThickLinesEvery",X.gridThickLinesEvery),null!=X.gridThickColor&&e.a("gridThickColor",X.gridThickColor),null!=X.gridLightColor&&e.a("gridLightColor",X.gridLightColor),null!=X.gridAngle&&e.a("gridAngle",X.gridAngle),null!=X.gridRotation&&e.a("gridRotation",X.gridRotation),null!=X.gridZoomThreshold&&e.a("gridZoomThreshold",X.gridZoomThreshold),null!=X.anchorEnabled&&e.a("anchorEnabled",X.anchorEnabled),null!=X.guideLineEnabled&&e.a("guideLineEnabled",X.guideLineEnabled),null!=X.highlightEnabled&&e.a("highlightEnabled",X.highlightEnabled),null!=X.highlightColor&&e.a("highlightColor",X.highlightColor),null!=X.highlightBorderWidth&&e.a("highlightBorderWidth",X.highlightBorderWidth),void 0!==X.highlightBorderPattern&&e.a("highlightBorderPattern",X.highlightBorderPattern),void 0!==X.alignmentGuideEnabled&&e.a("alignmentGuideEnabled",X.alignmentGuideEnabled),void 0!==X.alignmentGuideColor&&e.a("alignmentGuideColor",X.alignmentGuideColor),void 0!==X.animation&&e.a("animation",X.animation),X.hasOwnProperty("connectActionType")&&e.a("connectActionType",X.connectActionType),zN.forEach(function(M){e.a(M,X[M])}),e.a({name:X.name,renderHTML:X.renderHTML,layoutAttach:X.layoutAttach,layoutProperties:X.layoutProperties,comps:zM(X.comps,[]),width:zM(X.width,100),height:zM(X.height,100),boundExtend:zM(X.boundExtend,0),fitSize:zM(X.fitSize,!1),scrollable:zM(X.scrollable,!1),interactive:zM(X.interactive,!1),disableSelectedBorder:zM(X.disableSelectedBorder,!1),pixelPerfect:zM(X.pixelPerfect,!0),clip:zM(X.clip,!1),visible:zM(X.visible,!0),color:zM(X.color,void 0),blendMode:zM(X.blendMode,"multiply"),opacity:zM(X.opacity,1),attachPoints:zM(X.attachPoints,void 0),attachStyle:zM(X.attachStyle,void 0),cacheRule:zM(X.cacheRule,!1),textureCache:zM(X.textureCache,!1),state:zM(X.state,void 0),stateEnum:zM(X.stateEnum,void 0),comps_func:AM(X.comps),width_func:AM(X.width),height_func:AM(X.height),fitSize_func:AM(X.fitSize),scrollable_func:AM(X.scrollable),interactive_func:AM(X.interactive),disableSelectedBorder_func:AM(X.disableSelectedBorder),pixelPerfect_func:AM(X.pixelPerfect),visible_func:AM(X.visible),color_func:AM(X.color),blendMode_func:AM(X.blendMode),opacity_func:AM(X.opacity),attachPoints_func:AM(X.attachPoints),attachStyle_func:AM(X.attachStyle),cacheRule_func:AM(X.cacheRule),textureCache_func:AM(X.textureCache),state_func:AM(X.state)});var $=oN.config.customProperties.symbol;$&&$.length&&$.forEach(function(M){e.a(M.property,zM(X[M.property],M.defaultValue))}),e.a("comps").forEach(function(M){PN(M,N)}),w.symbolViewUpdating=!1,this.updateRenderNode(),this.dirty=!!q,!q&&oN.config.fitContentForSymbolView&&this.graphView.fitContent(oN.config.animate,oN.config.fitPadding),w.updateTable(),this._updating=!1},q.prototype.createRenderIframeImage=function(){var M=this;if(!M.renderIframeImage){var q=M.iframe=document.createElement("iframe");q.style.border="none",q.style.outline="none",M.renderIframeImage={comps:[],renderHTML:function(M,N,e){return e._iframe||(e._iframe=q,e._iframe.layoutHTML=function(){N.layoutHTML(M,q,!0)}),e._iframe}}}return M.renderIframeImage},q.prototype.updateRenderNode=function(){if(oN.config.renderHTMLPreviewEnabled){var M=this.dm,q=M.a("renderHTML"),N=M.getDataByTag("__renderHTML__");if(!q)return void(N&&N.removeFromDataModel());var e=this.createRenderIframeImage();this.addValue(e,"width"),this.addValue(e,"height"),N||(N=new ht.Node,N.setTag("__renderHTML__"),N.s({"2d.selectable":!1}),N.setImage(e),this.dm.add(N));var X=d({renderHTML:q,dataBindings:M.dataBindings,comps:[],width:100,height:100},0,!0);sessionStorage.setItem("renderHTMLPreview",X),this.iframe.src="renderHTMLPreview.html?ts="+Date.now(),N.setRect({x:0,y:0,width:e.width,height:e.height})}},q.prototype.addValue=function(M,q,N){var e=this.dm.a(q);WM(M,q,this.dm.a(q+"_func"),e,N)},q.prototype.createInteractor=function(M,q,N){var X=this,w=FX[M];return"shape"===M?new VX(this.tab,null,function(N,e){var $={type:"shape",background:null,borderColor:oN.config.color_data_border,borderWidth:1};q&&q($,N,e);var t=new w($);return t.setPoints(N),t.setSegments(e),X.editor.fireEvent("compInited",{type:M,data:t,symbolView:X.editor.symbolView}),t},N):new HX(this.tab,null,function(N,$){var t=void 0;t="arc"===M?{type:M,rect:[N.x,N.y,N.width,N.height],background:oN.config.color_data_background,borderWidth:1,borderColor:oN.config.color_data_border,arcFrom:0,arcTo:4.1888}:"border"===M?{type:M,rect:[N.x,N.y,N.width,N.height],border:1,color:oN.config.color_data_border}:"text"===M?{type:M,rect:[N.x,N.y,N.width,N.height],text:e("editor.text")}:"comp"===M||"image"===M?$?{rect:[N.x+N.width/2,N.y+N.height/2,-1,-1]}:{rect:[N.x,N.y,N.width,N.height]}:"pieChart"===M?{type:"pieChart",values:[10,20,40,60,80],colors:["#7EB6EA","#434348","#93EB82","#F5A262","#8087E6"]}:"oneDimensionalColumnChart"===M?{type:"columnChart",series:[{values:[10,20,40,60,80],colors:["#7EB6EA","#434348","#93EB82","#F5A262","#8087E6"]}]}:"columnChart"===M?{type:"columnChart",series:[{values:[30,40,60,70,80],color:"#7EB6EA"},{values:[20,40,50,80,90],color:"#434348"}]}:"lineChart"===M?{type:"lineChart",series:[{values:[10,40,30,60,70],color:"#7EB6EA"}]}:{type:M,rect:[N.x,N.y,N.width,N.height],background:oN.config.color_data_background,borderWidth:1,borderColor:oN.config.color_data_border},q&&q(t,N,$);var E=new w(t);return X.editor.fireEvent("compInited",{type:M,data:E,symbolView:X.editor.symbolView}),E})},IN(q,[{key:"attrObject",set:function(M){var q=this.editor.rightBottomTabView.getTabModel().sm();this._attrObject=M,this.editor.dataViewTab&&q.co(this.editor.dataViewTab)&&this.editor.dataView.updateContent()},get:function(){return this._attrObject}},{key:"content",get:function(){var M=this,q=this.graphView.getEditInteractor(),N=(q.gridGuide,this.dm),e=this.attrObject,X={modified:(new Date).toString()};void 0!==e&&(X.attrObject=e),N.getBackground()&&(X.background=N.getBackground()),N.dataBindings&&(X.dataBindings=a(d(N.dataBindings),{ignoreDataModel:1})),N.a("previewURL")&&(X.previewURL=N.a("previewURL")),N.a("snapshotURL")&&(X.snapshotURL=N.a("snapshotURL")),N.a("connectActionType")!==oN.config.symbolConnectActionType&&(X.connectActionType=N.a("connectActionType")),N.a("rulerEnabled")!==oN.config.symbolRulerEnabled&&(X.rulerEnabled=N.a("rulerEnabled")),N.a("gridEnabled")!==oN.config.symbolGridEnabled&&(X.gridEnabled=N.a("gridEnabled")),N.a("gridBlockSize")!==oN.config.symbolGridBlockSize&&(X.gridBlockSize=N.a("gridBlockSize")),N.a("gridThickLinesEvery")!==oN.config.symbolGridThickLinesEvery&&(X.gridThickLinesEvery=N.a("gridThickLinesEvery")),N.a("gridThickColor")!==oN.config.symbolGridThickColor&&(X.gridThickColor=N.a("gridThickColor")),N.a("gridLightColor")!==oN.config.symbolGridLightColor&&(X.gridLightColor=N.a("gridLightColor")),N.a("gridAngle")!==oN.config.symbolGridAngle&&(X.gridAngle=N.a("gridAngle")),N.a("gridRotation")!==oN.config.symbolGridRotation&&(X.gridRotation=N.a("gridRotation")),N.a("gridZoomThreshold")!==oN.config.symbolGridZoomThreshold&&(X.gridZoomThreshold=N.a("gridZoomThreshold")),N.a("anchorEnabled")!==oN.config.symbolAnchorEnabled&&(X.anchorEnabled=N.a("anchorEnabled")),N.a("guideLineEnabled")!==oN.config.symbolGuideLineEnabled&&(X.guideLineEnabled=N.a("guideLineEnabled")),N.a("highlightEnabled")!==oN.config.symbolHighlightEnabled&&(X.highlightEnabled=N.a("highlightEnabled")),N.a("highlightColor")!==oN.config.symbolHighlightColor&&(X.highlightColor=N.a("highlightColor")),N.a("highlightBorderWidth")!==oN.config.symbolHighlightBorderWidth&&(X.highlightBorderWidth=N.a("highlightBorderWidth")),N.a("highlightBorderPattern")!==oN.config.symbolHighlightBorderPattern&&(X.highlightBorderPattern=N.a("highlightBorderPattern")),N.a("xAlignmentGuides")&&N.a("xAlignmentGuides").length&&(X.xAlignmentGuides=N.a("xAlignmentGuides")),N.a("yAlignmentGuides")&&N.a("yAlignmentGuides").length&&(X.yAlignmentGuides=N.a("yAlignmentGuides")),N.a("cacheRule")&&this.addValue(X,"cacheRule"),N.a("textureCache")&&this.addValue(X,"textureCache"),null!=N.a("alignmentGuideEnabled")&&N.a("alignmentGuideEnabled")!==oN.config.symbolGridAlignmentGuideEnabled&&(X.alignmentGuideEnabled=N.a("alignmentGuideEnabled")),N.a("alignmentGuideColor")&&N.a("alignmentGuideColor")!==oN.config.symbolGridAlignmentGuideColor&&(X.alignmentGuideColor=N.a("alignmentGuideColor")),N.a("stateEnum")&&N.a("stateEnum").length&&(X.stateEnum=N.a("stateEnum"),this.addValue(X,"state")),zN.forEach(function(M){N.a(M)&&(X[M]=N.a(M))}),N.a("renderHTML")&&(X.renderHTML=N.a("renderHTML")),N.a("layoutAttach")&&(X.layoutAttach=N.a("layoutAttach")),N.a("layoutProperties")&&(X.layoutProperties=N.a("layoutProperties")),N.a("animation")&&(X.animation=N.a("animation")),this.addValue(X,"width"),this.addValue(X,"height"),this.addValue(X,"boundExtend",0),this.addValue(X,"fitSize",!1),this.addValue(X,"scrollable",!1),this.addValue(X,"interactive",!1),this.addValue(X,"disableSelectedBorder",!1),this.addValue(X,"pixelPerfect",!0),this.addValue(X,"name"),this.addValue(X,"clip",!1),this.addValue(X,"visible",!0),this.addValue(X,"color"),this.addValue(X,"blendMode","multiply"),this.addValue(X,"opacity",1),this.addValue(X,"attachPoints"),this.addValue(X,"attachStyle");var w=oN.config.customProperties.symbol,$=!!oN.config.saveSymbolCustomPropertyDefaultValue;w&&w.length&&w.forEach(function(q){$?M.addValue(X,q.property):M.addValue(X,q.property,q.defaultValue)});var t=[];return N.a("comps_func")?X.comps={values:t,func:N.a("comps_func")}:X.comps=t,N.each(function(M){if("__renderHTML__"!==M.getTag()){var q=M.toJSON();delete q.renderLayer,t.push(q)}}),X}}]),q}(vX),qw=function(M){function q(N){YN(this,q);var X=dN(this,M.call(this));X.editor=N,X.getTabModel().sm().ms(function(){var M=X.currentTab;X.editor.$5$(M),oN.config.uisVisible&&(M&&M._isUI?(M.getView().redraw(!0),N.mainSplitView.setStatus("cr")):M&&M.noInspector?N.mainSplitView.setStatus("cr"):N.mainSplitView.setStatus("normal")),X.editor.fireEvent("mainTabSelectionChanged",{newTab:M})});var w=function(){return!!X.getTabModel().size()};return X.menu=new ne([{id:"closeTab",label:e("editor.closetab"),action:function(){X.closeTab()},visible:w},{id:"closeOtherTabs",label:e("editor.closeothertabs"),action:function(){X.closeOtherTabs()},visible:w},{id:"closeTabsToTheRight",label:e("editor.closetabstotheright"),action:function(){X.closeTabsToTheRight()},visible:w},{id:"closeAllTabs",label:e("editor.closealltabs"),action:function(){X.closeTabs(X.tabs)},visible:w},{separator:!0,visible:function(){return X._rightClickTab&&w()}},{id:"showInExplorer",label:e("editor.showinexplorer"),action:function(){var M=X._rightClickTab||X.currentTab;X.editor.selectFileNode(M.getTag())},visible:function(){return X._rightClickTab&&w()}}]),X.menu.beforeShow=function(M){X._rightClickTab=X.getTabAt(M)},X.menu.addTo(X.getTitleDiv()),X.editor.menus.push(X.menu),X.addTitleTipHandler(),X}return rN(q,M),q.prototype.drawCloseIcon=function(q,N,e,X){q.a("dirty")?(N.fillStyle=e,N.beginPath(),N.arc(X.x+X.width/2,X.y+X.height/2,3,0,2*Math.PI,!0),N.fill()):M.prototype.drawCloseIcon.call(this,q,N,e,X)},q.prototype.open=function(M){if(M){var q=M.fileType,N="display"===q,e="symbol"===q,X="ui"===q,w="scene"===q&&oN.SceneView;if(N||e||w||X){var $=M.url,t=this.getTabModel().getDataByTag($);if(!t){if(oN.SceneView&&w&&this.hasTooManyOpenScenes())return;t=new ht.Tab,t.setTag($),t.setClosable(!0),t.setName(D(M.getName())),t.a("uuid",M.uuid),N?(t.setIcon("editor.display"),new TX(this.editor,t,$,void 0,void 0,void 0,M.parent_uuid,M.root_dir)):e?(t.setIcon("editor.symbol"),new Mw(this.editor,t,$,void 0,M.parent_uuid,M.root_dir)):w?(t.setIcon("editor.scene"),new oN.SceneView(this.editor,t,$,void 0,M.parent_uuid,M.root_dir)):X&&(t.setIcon("editor.ui-tab"),t._isUI=!0,new oN.UIView(this.editor,t,$,void 0,M.parent_uuid,M.root_dir)),this.editor.addTab(t),this.editor.fireEvent("fileNodeOpened",{url:$})}this.getTabModel().sm().ss(t)}}},q.prototype.newDisplayView=function(M){var q=new ht.Tab;q.setClosable(!0),q.setIcon("editor.display"),q.setName(M||e("editor.untitled"));var N=new TX(this.editor,q);return this.editor.addTab(q,!0),N},q.prototype.newSymbolView=function(M){var q=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],N=new ht.Tab;N.setClosable(!0),N.setIcon("editor.symbol"),N.setName(M||e("editor.untitled"));var X=new Mw(this.editor,N);return this.editor.addTab(N,!0),q&&this.editor.zoomToFit(),X},q.prototype.newUIView=function(M){var q=new ht.Tab;q._isUI=!0,q.setClosable(!0),q.setIcon("editor.ui-tab"),q.setName(M||e("editor.untitled"));var N=new oN.UIView(this.editor,q);return this.editor.addTab(q,!0),N},q.prototype.$99$=function(M){var q=this;this.getTabModel().each(function(N){if(!N._isUI){var e=N.getView(),X=e.graphView;X&&X.invalidateAll();var w=e.g3d;if(w)if(M){w.deleteTexture(M);var $=void 0,t=q.editor.getFileNode(M);t&&($=t.getFileUUID(),w.deleteTexture($));var E=w.getBatchInfoMap();for(var J in E)w.invalidateBatch(J);w.dm().each(function(M){w.invalidateCachedTexture(M,!1)})}else w.redraw()}})},q.prototype.updateUIRefs=function(M){ht.ui&&delete ht.ui._uiRendererLoadedMap,this.getTabModel().each(function(q){if(q._isUI){q.getView().handleFileChanged(M)}})},q.prototype.reload=function(){this.currentTab&&this.currentTab.getView().reload()},q.prototype.save=function(M,q){this.currentTab&&this.currentTab.getView().save(M,q)},q.prototype.saveAll=function(M){var q=this.tabs,N=-1,e=function(){N++,N<q.length?q[N].getView().save(e):M()};e()},q.prototype.preview=function(){this.currentTab&&this.currentTab.getView().preview()},q.prototype.selectTab=function(M){M&&this.getTabModel().sm().ss(M)},q.prototype.onTabClosing=function(M,q){return this.closeTab(M),!1},q.prototype.closeTab=function(M,q,N){(M=M||this._rightClickTab||this.currentTab)&&this.closeTabs([M],q,N)},q.prototype.closeOtherTabs=function(M,q){var N=this._rightClickTab||this.currentTab;this.closeTabs(this.tabs.filter(function(M){return M!==N}),M,q)},q.prototype.closeTabsToTheRight=function(M,q){var N=this._rightClickTab||this.currentTab;if(N){var e=this.tabs.indexOf(N);this.closeTabs(this.tabs.slice(e+1),M,q)}},q.prototype.closeAllTabs=function(M,q){this.closeTabs(this.tabs,M,q)},q.prototype.closeTabs=function(M,q,N){var e=this,X=void 0,w=function($){if("cancel"!==$&&M.length){var t=M.shift(0);void 0===X&&(X=e.tabs.indexOf(t)-1),e.$65$(t,w,N)}else{q&&q();var E=e.tabs.length;!e.currentTab&&E&&((void 0===X||X<0)&&(X=0),X>E-1&&(X=E-1),e.selectTab(e.tabs[X]))}};w(),this._rightClickTab=null},q.prototype.removeTab=function(M){var q=M.getView(),N={url:q.url};this.editor.fireViewEvent(q,"Closing",N),N.preventDefault||(q.onClosed(),this.getTabModel().remove(M),this.editor.fireEvent("tabClosed",{tab:M}),this.editor.fireViewEvent(q,"Closed",N))},q.prototype.$65$=function(M,q,N){var X=this,w=M.getView();if(!N&&w.dirty&&w.editable){var $={tab:M};if(this.editor.fireEvent("tabPrompting",$),"notSave"===$.action)this.removeTab(M),q&&q("notSave");else if("save"===$.action)w.save(function(){X.removeTab(M),q&&q("save")});else if("cancel"===$.action)q&&q("cancel");else{var t=[{label:e("editor.notsave"),action:function(){J.hide(),X.removeTab(M),q&&q("notSave")}},{label:e("editor.save"),action:function(){w.save(function(){J.hide(),X.removeTab(M),q&&q("save")})}},{label:e("editor.cancel"),action:function(){J.hide(),q&&q("cancel")}}],E=Xq();E.innerHTML=e("editor.savechange");var J=this.editor.tabPromptingDialog=new DN({title:M.getName(),contentPadding:20,width:260,draggable:!0,content:E,buttons:t});J.$48$=t[2].action,J.$47$=t[1].action,J.show(this.editor.$38$)}}else this.removeTab(M),q&&q()},q.prototype.addTitleTipHandler=function(){},IN(q,[{key:"currentTab",get:function(){return this.getTabModel().sm().ld()}},{key:"tabs",get:function(){return this.getTabModel().getRoots().toArray()}}]),q}(Ce),Nw=function(M){function q(N){YN(this,q);var e=dN(this,M.call(this));e.setHPadding(8),e.editor=N,e.buttons={};var X=e._items=[];return e.addAlignItems(X),e.addSearchItem(X),e.addLastItem(X),e.updateItems(),e}return rN(q,M),q.prototype.addAlignItems=function(M){M.push(this.createItem("distributeHorizontal")),M.push(this.createItem("distributeVertical")),M.push(this.createItem("alignLeft")),M.push(this.createItem("alignHorizontal")),M.push(this.createItem("alignRight")),M.push(this.createItem("alignTop")),M.push(this.createItem("alignVertical")),M.push(this.createItem("alignBottom"))},q.prototype.addLastItem=function(M){var q=22,N=[q,q,q,q,q,q,q,q,.1];J(oN.config.compactFilter)||(this.addCompactItem(M),N.push(q)),this.addRow(M,N)},q.prototype.createItem=function(M){var q=this,N="editor.align."+M.toLocaleLowerCase();return this.buttons[M]=Jq(null,e(N),N,function(){q[M]()})},q.prototype.updateItems=function(){var M=this.buttons;if(this.dataModel){var q=this.selection;q.length>2?(M.distributeHorizontal.setDisabled(!1),M.distributeVertical.setDisabled(!1),M.alignLeft.setDisabled(!1),M.alignHorizontal.setDisabled(!1),M.alignRight.setDisabled(!1),M.alignTop.setDisabled(!1),M.alignVertical.setDisabled(!1),M.alignBottom.setDisabled(!1)):q.length>1?(M.distributeHorizontal.setDisabled(!0),M.distributeVertical.setDisabled(!0),M.alignLeft.setDisabled(!1),M.alignHorizontal.setDisabled(!1),M.alignRight.setDisabled(!1),M.alignTop.setDisabled(!1),M.alignVertical.setDisabled(!1),M.alignBottom.setDisabled(!1)):(M.distributeHorizontal.setDisabled(!0),M.distributeVertical.setDisabled(!0),M.alignLeft.setDisabled(!0),M.alignHorizontal.setDisabled(!0),M.alignRight.setDisabled(!0),M.alignTop.setDisabled(!0),M.alignVertical.setDisabled(!0),M.alignBottom.setDisabled(!0))}else M.distributeHorizontal.setDisabled(!0),M.distributeVertical.setDisabled(!0),M.alignLeft.setDisabled(!0),M.alignHorizontal.setDisabled(!0),M.alignRight.setDisabled(!0),M.alignTop.setDisabled(!0),M.alignVertical.setDisabled(!0),M.alignBottom.setDisabled(!0)},q.prototype.$5$=function(M){if(this.dataModel&&this.dataModel.sm().ums(this.updateItems,this),this.editor.hasInspector(M)){var q=M.getView();this.dataModel=q.dm,this.dataModel.sm().ms(this.updateItems,this)}else this.dataModel=null;this.updateItems()},q.prototype.getUnionRect=function(M){return this.editor.gv?this.editor.gv.getUnionNodeRect(M):null},q.prototype.isSelected=function(M){return this.dataModel&&this.dataModel.sm().contains(M)},q.prototype.hasSelectedGroupParent=function(M){return M instanceof ht.Group&&(!!this.isSelected(M)||this.hasSelectedGroupParent(M.getParent()))},q.prototype.hasSelectedHost=function(M){var q=this,N=function(e){return e!==M&&(e instanceof ht.Node&&(!!q.isSelected(e)||N(e.getHost())))};return N(M.getHost())},q.prototype.distributeHorizontal=function(){if(this.editor.editable){this.editor.beginTransaction();var M=this.editor.gv,q=this.selection,N=this.getUnionRect(q);if(M&&N){q.sort(function(q,N){return M.getNodeRect(q).x-M.getNodeRect(N).x});var e={},X=0;q.forEach(function(q){var N=M.getNodeRect(q);e[q._id]=N,X+=N.width});var w=(N.width-X)/(q.length-1),$=N.x;q.forEach(function(q){var N=M.getNodeRect(q);q.translate($-N.x,0),$+=N.width+w})}this.editor.endTransaction()}},q.prototype.distributeVertical=function(){if(this.editor.editable){this.editor.beginTransaction();var M=this.editor.gv,q=this.selection,N=this.getUnionRect(q);if(M&&N){q.sort(function(q,N){return M.getNodeRect(q).y-M.getNodeRect(N).y});var e={},X=0;q.forEach(function(q){var N=M.getNodeRect(q);e[q._id]=N,X+=N.height});var w=(N.height-X)/(q.length-1),$=N.y;q.forEach(function(q){var N=M.getNodeRect(q);q.translate(0,$-N.y),$+=N.height+w})}this.editor.endTransaction()}},q.prototype.alignLeft=function(){if(this.editor.editable){this.editor.beginTransaction();var M=this.editor.gv,q=this.selection,N=this.getUnionRect(q);M&&N&&q.forEach(function(q){var e=M.getNodeRect(q);q.translate(N.x-e.x,0)}),this.editor.endTransaction()}},q.prototype.alignHorizontal=function(){if(this.editor.editable){this.editor.beginTransaction();var M=this.editor.gv,q=this.selection,N=this.getUnionRect(q);M&&N&&q.forEach(function(q){var e=M.getNodeRect(q);q.translate(N.x+N.width/2-e.x-e.width/2,0)}),this.editor.endTransaction()}},q.prototype.alignRight=function(){if(this.editor.editable){this.editor.beginTransaction();var M=this.editor.gv,q=this.selection,N=this.getUnionRect(q);M&&N&&q.forEach(function(q){var e=M.getNodeRect(q)
;q.translate(N.x+N.width-e.x-e.width,0)}),this.editor.endTransaction()}},q.prototype.alignTop=function(){if(this.editor.editable){this.editor.beginTransaction();var M=this.editor.gv,q=this.selection,N=this.getUnionRect(q);M&&N&&q.forEach(function(q){var e=M.getNodeRect(q);q.translate(0,N.y-e.y)}),this.editor.endTransaction()}},q.prototype.alignVertical=function(){if(this.editor.editable){this.editor.beginTransaction();var M=this.editor.gv,q=this.selection,N=this.getUnionRect(q);M&&N&&q.forEach(function(q){var e=M.getNodeRect(q);q.translate(0,N.y+N.height/2-e.y-e.height/2)}),this.editor.endTransaction()}},q.prototype.alignBottom=function(){if(this.editor.editable){this.editor.beginTransaction();var M=this.editor.gv,q=this.selection,N=this.getUnionRect(q);M&&N&&q.forEach(function(q){var e=M.getNodeRect(q);q.translate(0,N.y+N.height-e.y-e.height)}),this.editor.endTransaction()}},q.prototype.addSearchItem=function(M){var q=this;this.searchField=new ht.widget.TextField;var N=this.searchField.getElement();N.onkeyup=function(M){R(M)&&(N.value=""),q.editor.filterProperties()},M.push(this.searchField)},q.prototype.addCompactItem=function(M){var q=this,N=uq("editor.filter",function(){return oN.config.commonAndAdvancedFilterMode?!q.editor.inspectorCompact:q.editor.inspectorCompact}),X=function(){q.editor.inspectorCompact=!q.editor.inspectorCompact},w=e(oN.config.commonAndAdvancedFilterMode?"editor.commonadvanced":"editor.compactdetail");M.push(Jq(null,w,N,X))},IN(q,[{key:"selection",get:function(){var M=this,q=[];return this.dataModel&&this.dataModel.sm().each(function(N){N instanceof ht.Node&&(M.hasSelectedGroupParent(N.getParent())||M.hasSelectedHost(N)||q.push(N))}),q}},{key:"filter",get:function(){return this.searchField.getElement().value}}]),q}(WN),ew=function(M){function q(N){YN(this,q);var e=dN(this,M.call(this));return e.editor=N,e.initForm(),e.visible=!1,e.$5$(),e.oopsImageJSON=ht.Default.getImage("editor.oops"),e.oopsImage=ht.Default.toCanvas(e.oopsImageJSON,e.oopsImageJSON.width,e.oopsImageJSON.height,"fill",null,null,null,ht.Default.devicePixelRatio).toDataURL(),e}return rN(q,M),q.prototype.initForm=function(){var M=this,q=this.codeEditor=new vN({language:"json",lineNumbers:"off",readOnly:!0,minimap:{enabled:!1}});this.addRow([{id:"content",element:q}],[.1],.1),this.addRow([{id:"url",textField:{editable:!1}},{id:"edit",button:{onClicked:function(){M.editor.editable&&(M.editing=!M.editing)}}},{id:"commit",button:{label:e("editor.commit"),onClicked:function(){M.commit()}}}],[.1,50,50]),this.getView().style.background=oN.config.color_pane,this.editing=!1},q.prototype.commit=function(){this.editor.editable&&(this.currentView.update(this.content,!0),this.editing=!1)},q.prototype.$66$=function(M){var q=this;this.visible&&!this.editing&&(M&&"*"===M.property||(this._updateContentLater&&clearTimeout(this._updateContentLater),this._updateContentLater=setTimeout(function(){q.updateContent()},100)))},q.prototype.updateContent=function(){this.visible&&!this.editing&&(this._updateContentLater=null,this.content=this.currentView?d(this.currentView.content,void 0,!1):"")},q.prototype.updateUrl=function(){this.v("url",this.tab&&this.tab.getTag()||"")},q.prototype.$5$=function(M){this.editing=!1,this.dataModel&&(this.dataModel.removeDataModelChangeListener(this.$66$,this),this.dataModel.removeDataPropertyChangeListener(this.$66$,this),this.dataModel.removePropertyChangeListener(this.$66$,this)),this.editor.hasInspector(M)?(this.currentView=M.getView(),this.dataModel=this.currentView.dm,this.dataModel.addDataModelChangeListener(this.$66$,this),this.dataModel.addDataPropertyChangeListener(this.$66$,this),this.dataModel.addPropertyChangeListener(this.$66$,this),this.setDisabled(!1)):(this.currentView=null,this.dataModel=null,this.setDisabled(!0)),this.tab=M,this.updateUrl(),this.$66$()},IN(q,[{key:"editing",get:function(){return this._editing},set:function(M){this._editing!==M&&(this._editing=M,this.getViewById("edit").setLabel(e(M?"editor.cancel":"editor.edit")),this.getViewById("commit").setDisabled(!M),this.getViewById("content").setEditable(M),M||this.$66$())}},{key:"visible",get:function(){return this._visible},set:function(M){this._visible!==M&&(this._visible=M,M?this.updateContent():this.editing||(this.content=""))}},{key:"content",get:function(){return this.v("content")},set:function(M){this.setDisabled(!1),this.v("content",M)}}]),q}(WN);oN.DataView=ew;var Xw=function(M){function q(N){YN(this,q);var e=dN(this,M.call(this));e.editor=N,e._emptyDataModel=new ht.DataModel,e.centerPane=new xe,e.setCenterView(e.centerPane),e.controlPane=new WN,e.controlPane.addRow([{id:"filter",textField:{}}],[.1,ht.Default.isTouchable?32:18]),e.setBottomView(e.controlPane),e.setBottomHeight(ht.Default.widgetRowHeight+8);var X=e.controlPane.getViewById("filter"),w=X.setValue;X.setValue=function(M){w.call(X,M),e.updateCenterView(M)};var $=!1,t=e.input=X.getElement();return t.addEventListener("compositionstart",function(){return $=!0}),t.addEventListener("compositionend",function(){$=!1,e.updateCenterView(t.value)}),t.addEventListener("keyup",function(M){!$&&e.list&&e.updateCenterView(t.value)}),e}return rN(q,M),q.prototype.$5$=function(M){this.tab=M,this.list=M?M.getView().list:null,this.controlPane.v("filter",this.list?this.list.getFilter()||"":"")},q.prototype.initFilterList=function(){var M=this,q=this._filterListView=new Ge;q.setFilter=function(M){var q=this._filter;this._filter=M,this.fp("filter",q,M),this.ivm()},q.getFilter=function(){return this._filter},q.isVisible=function(q){if("__renderHTML__"===q.getTag())return!1;if(!this._filter)return!0;var N=this.getVisibleFunc();if(N&&!N(q))return!1;var e=this.getLabel(q);if(null==e)return!1;var X=(this._filter+"").toLowerCase();return e=(e+"").toLowerCase(),M.match(e,X)}},q.prototype.match=function(M,q){return M.indexOf(q)>=0},q.prototype.updateCenterView=function(M){var q=this.list;q&&(q instanceof Oe&&M&&(q=this._filterListView),this.centerPane.getCenterView()!==q&&this.centerPane.setCenterView(q),this.list&&this.list.setFilter(M),q===this._filterListView&&this._filterListView.setFilter(M))},q.prototype.$48$=function(M){if(this.input.value)return this.updateCenterView(this.input.value=""),!0},IN(q,[{key:"list",get:function(){return this._list},set:function(M){if(this._list=M,this.centerPane.setCenterView(M),!(M&&M instanceof Oe))return void(this._filterListView&&this._filterListView.dm(this._emptyDataModel));this._filterListView||this.initFilterList(),this._filterListView.getLabel=M.getLabel,this._filterListView.getIcon=M.getIcon,this._filterListView.graphView=M.graphView,this._filterListView.dm(M.dm())}}]),q}(xe),ww=function(M){function q(N){YN(this,q);var X=dN(this,M.call(this));X.editor=N,X._layerNames=[],X.setDisabled(!0),X.tableModel=new ht.DataModel,X.tablePane=new pe(X.tableModel),X.tableView=X.tablePane.getTableView(),X.tableView.setEditable(!0);var w=X.tableView.isCellEditable;X.tableView.isCellEditable=function(M,q,e){return!!N.editable&&(("name"!==q.getTag()||!M._static)&&w.apply(this,arguments))},X.tablePane.getView().style.border=oN.config.color_line+" solid 1px",X.tablePane.addColumns([X.$73$("name",e("editor.name"),100),X.$73$("visible",e("editor.visible"),50),X.$73$("selectable",e("editor.selectable"),50),X.$73$("movable",e("editor.movable"),50),X.$73$("editable",e("editor.editable"),50)]),X.addRow([X.tablePane],[.1],.1);var $=[Jq(null,e("editor.add"),"editor.add",function(){X.editor.editable&&(X.addLayer(e("editor.untitled"),!0,!0,!0,!0),X.updateLayers())}),Jq(null,e("editor.delete"),"editor.delete",function(){X.editor.editable&&X.tableView.sm().size()&&(X.dataModel.beginTransaction(),X.removeSelectionLayers(),X.updateLayers(),X.dataModel.endTransaction())}),null,Jq(null,e("editor.bringtofront"),"editor.top",function(){X.editor.editable&&X.tableView.sm().size()&&(X.tableModel.moveSelectionToTop(),X.updateLayers())}),Jq(null,e("editor.bringforward"),"editor.up",function(){X.editor.editable&&X.tableView.sm().size()&&(X.tableModel.moveSelectionUp(),X.updateLayers())}),Jq(null,e("editor.sendbackward"),"editor.down",function(){X.editor.editable&&X.tableView.sm().size()&&(X.tableModel.moveSelectionDown(),X.updateLayers())}),Jq(null,e("editor.sendtoback"),"editor.bottom",function(){X.editor.editable&&X.tableView.sm().size()&&(X.tableModel.moveSelectionToBottom(),X.updateLayers())})],t=function(){return this.isPressed()?oN.config.color_select:oN.config.color_dark};return $.forEach(function(M){M instanceof ht.widget.Button&&(M.getIconColor=t)}),X.addRow($,[20,20,.1,20,20,20,20]),X}return rN(q,M),q.prototype.getLayer=function(M){for(var q=this.tableModel.getDatas(),N=0,e=q.size();N<e;N++){var X=q.get(N);if(X.a("name")===M)return X}return null},q.prototype.addLayer=function(M,q,N,e,X){!1!==q&&(q=!0),!1!==N&&(N=!0),!1!==e&&(e=!0),!1!==X&&(X=!0);var w=new ht.Data;return w.a({name:M,visible:q,selectable:N,movable:e,editable:X}),this.tableModel.add(w),w},q.prototype.removeSelectionLayers=function(){var M=[];this.tableModel.sm().toSelection(function(q){return!q._static&&(M.push(q.a("name")),!0)}).forEach(function(M){return M.removeFromDataModel()});var q=this.currentLayer;this.dataModel.each(function(N){var e=N.getLayer();e!==q&&M.indexOf(e)>=0&&N.setLayer(q)})},q.prototype.selectLayer=function(M){var q=this.getLayer(M);q&&this.tableModel.sm().ss(q)},q.prototype.$73$=function(M,q,N){var e=this;return{name:M,tag:M,accessType:"attr",width:N,displayName:q,align:"center",editable:!0,sortable:!1,setValue:function(q,N,X){X!==q.a(M)&&(q.a(M,X),e.updateLayers())}}},q.prototype.$5$=function(M){this.dataModel&&this.dataModel.removePropertyChangeListener(this.handleDataModelPropertyChange,this);var q=this.editor.displayView||this.editor.sceneView;q?(this.dataModel=q.dm,this.dataModel.addPropertyChangeListener(this.handleDataModelPropertyChange,this),this.setDisabled(!1)):(this.dataModel=null,this.setDisabled(!0)),this.updateTable(),this.updateInspector()},q.prototype.handleDataModelPropertyChange=function(M){"layers"===M.property&&(this.updateTable(),this.updateInspector())},q.prototype.updateLayers=function(){if(this.dataModel){var M=this.tableModel.size()?[]:null;M&&this.tableModel.getRoots().forEach(function(q){M.push({name:q.a("name"),visible:q.a("visible"),selectable:q.a("selectable"),movable:q.a("movable"),editable:q.a("editable")})}),this.isSettingLayers=!0;var q=this.dataModel,N=!0;null==q.getLayers()&&1===M.length&&"0"===M[0].name&&(N=!1);var e=q.getHistoryManager(),X=!1;!N&&e&&(X=e.isDisabled(),e.setDisabled(!0)),q.setLayers(M),!N&&e&&e.setDisabled(X),this.isSettingLayers=!1,this.updateInspector()}},q.prototype.updateTable=function(){var M=this;if(!this.isSettingLayers&&(this.tableModel.clear(),this.dataModel)){var q=this.dataModel.getLayers();q&&q.forEach(function(q){mM(q)?M.addLayer(q.name+"",q.visible,q.selectable,q.movable,q.editable):M.addLayer(q+"",!0,!0,!0,!0)});var N=this.getLayer("0");N||(N=this.addLayer("0",!0,!0,!0,!0),this.tableModel.moveToIndex(N,0),this.updateLayers()),N._static=!0}},q.prototype.updateInspector=function(){var M=this;if(this.dataModel){var q=this.dataModel.getLayers(),N=this.editor.inspector;this._layerNames=[],q&&q.forEach(function(q){M._layerNames.push(mM(q)?q.name:q)}),N&&N.filterPropertiesLater()}},IN(q,[{key:"currentLayer",get:function(){var M=this.tableModel.sm().ld();if(M)return M.a("name");var q=this.tableModel.getRoots();return q.size()?(M=q.get(q.size()-1),M.a("name")):ht.Data.prototype._layer}},{key:"layerNames",get:function(){return this._layerNames}}]),q}(WN),$w={},tw=function(M){function q(N){YN(this,q);var X=dN(this,M.call(this));X.editor=N,X.symbolViewUpdating=!1;var w=X.tableModel=new ht.DataModel,$=X.tablePane=new pe(w),t=X.tableView=$.getTableView();w.mm(X.handleUpdate,X),w.md(X.handleTableDataPropertyChange,X),w.sm().ms(X.handleTableSelectionChange,X);var E=t.getLabelColor;t.getLabelColor=function(M){return!1===M.s("editable")?oN.config.color_disabled:E.call(this,M)},t.isEditable=function(){return N.editable},t.isCellEditable=function(M,q){return"isDefault"===q.getName()?N.editable:!1!==M.s("editable")&&N.editable},$.getView().style.border=oN.config.color_line+" solid 1px",$.addColumns([{name:"stateName",displayName:e("editor.state"),accessType:"attr",editable:!0,valueType:"string",tag:"stateName"},{name:"stateDisplayName",displayName:e("editor.name"),accessType:"attr",editable:!0,valueType:"string",tag:"stateDisplayName"},{name:"isDefault",displayName:e("editor.default"),accessType:"attr",valueType:"boolean",editable:!0,width:48,setValue:function(M,q,N,e){X.setDefaultState(M.a("stateName"))}}]),$.addViewListener(function(M){if("beginValidate"===M.kind){var q=$.getColumnModel(),N=$.getWidth(),e=(N-80)/2;q.getDataByTag("stateName").setWidth(e),q.getDataByTag("stateDisplayName").setWidth(e)}}),X.addRow([X.tablePane],[.1],.1);var J=[Jq(null,e("editor.add"),"editor.add",function(){if(X.editor.editable){var M=X.addState(null,null,!1,!0);X.tableModel.sm().ss(M)}}),Jq(null,e("editor.delete"),"editor.delete",function(){X.editor.editable&&X.removeState()}),null,Jq(null,e("editor.bringtofront"),"editor.top",function(){X.editor.editable&&X.tableView.sm().size()&&X.tableModel.moveSelectionToTop()}),Jq(null,e("editor.bringforward"),"editor.up",function(){X.editor.editable&&X.tableView.sm().size()&&X.tableModel.moveSelectionUp()}),Jq(null,e("editor.sendbackward"),"editor.down",function(){X.editor.editable&&X.tableView.sm().size()&&X.tableModel.moveSelectionDown()}),Jq(null,e("editor.sendtoback"),"editor.bottom",function(){X.editor.editable&&X.tableView.sm().size()&&X.tableModel.moveSelectionToBottom()})],u=function(){return this.isPressed()?oN.config.color_select:oN.config.color_dark};return J.forEach(function(M){M instanceof ht.widget.Button&&(M.getIconColor=u)}),X.addRow(J,[20,20,.1,20,20,20,20]),X._index=0,X}return rN(q,M),q.prototype.handleUpdate=function(){if(!this.updatingClear){var M=[],q=void 0;this.tableModel.each(function(N){var e=N.a("stateName");if(N.a("isDefault")&&(q=e),N.s("editable")){var X=N.a("stateDisplayName"),w={};w.value=e,X&&(w.label=X),M.push(w)}}),this.isSettingState=!0,this.editor.dm.a({stateEnum:M,state:q}),this.editor.inspector.filterPropertiesLater(),this.editor.inspector.updateProperties(),this.isSettingState=!1}},q.prototype.handleTableDataPropertyChange=function(M){if("a:stateName"!==M.property||this.renameRollback)this.handleUpdate();else{var q=M.oldValue,N=M.newValue;this.isStateExist(N,M.data)?(this.editor.showMessage(e("editor.statenameexist"),"error"),this.renameRollback=!0,M.data.a("stateName",q),this.renameRollback=!1):N?(this.editor.dm.each(function(M){q===M.s("state")&&M.s("state",N)}),this.handleUpdate(),this.editor.rightBottomTabView.iv()):(this.editor.showMessage(e("editor.statenameempty"),"error"),this.renameRollback=!0,M.data.a("stateName",q),this.renameRollback=!1)}},q.prototype.handleTableSelectionChange=function(){this.editor.symbolView&&(this.editor.rightBottomTabView.iv(),this.editor.symbolView.graphView.invalidateAll())},q.prototype.addState=function(M,q){var N=arguments.length>2&&void 0!==arguments[2]&&arguments[2],e=arguments[3],X=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],w=arguments[5],$=this.currentState,t=this.tableView.dm(),E=new ht.Data;if(!M){for(;this.isStateExist("state"+this._index);)this._index++;M="state"+this._index}if(E.a({stateName:M,isDefault:N,stateDisplayName:q}),E.s("editable",X),t.add(E),(N||w)&&t.sm().ss(E),e&&oN.config.isCopyCompsWhenNewState&&$){var J=this.dataModel.toDatas(function(M){return M.s("state")===$});if(J.size()){var u=this.dataModel.sm();u.cs(),J.each(function(M){u.as(M)}),this.editor.copy(),this.editor.paste(!0),u.each(function(q){q.s("state",M)})}}return E},q.prototype.removeState=function(){var M=this,q=M.editor,N=M.tableModel.sm().getSelection(),X=N.toArray(function(M){return M.s("editable")});if(X.length){var w=[],$=[],t=M.editor.dm;X.forEach(function(M){var q=M.a("stateName"),N=t.toDatas(function(M){return q===M.s("state")}).toArray();N.length&&(w.push(M),$.push.apply($,N))});var E=function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0]&&q.beginTransaction(),X.forEach(function(q){M.tableModel.remove(q)}),q.endTransaction()};w.length?q.showConfirm(void 0,nq(e("editor.retaincompafterdelete"),w.map(function(M){return M.a("stateName")}).join(",")),function(){q.beginTransaction(),$.forEach(function(M){M.s("state",void 0)}),E()},function(){q.beginTransaction();for(var M=$.length,N=M-1;N>=0;N--)t.remove($[N]);E()}):E(!0)}},q.prototype.handleDataModelPropertyChange=function(M){"a:stateEnum"!==M.property&&"a:state"!==M.property||this.updateTable()},q.prototype.handleDataModelChange=function(M){var q=this.currentState;if(!this.symbolViewUpdating){if("add"===M.kind){var N=M.data.s("state");q?M.data.s("state",q):N&&!this.isStateExist(N)&&M.data.s("state",void 0)}this.updateTableLater()}},q.prototype.updateTable=function(){var M=this;if(!this.isSettingState&&this.dataModel){$w={},this.updatingClear=!0;var q=this.tableModel.sm().ld(),N=q?q.a("stateName"):null;this.tableModel.clear();var e=this.dataModel.a("state"),X=[];this.getNestState(this.editor.symbolView.content.comps,X),X.forEach(function(q){M.addState(q.value,q.label,q.value===e,!1,!1)});var w=this.dataModel.a("stateEnum");w&&w.forEach(function(q){$w[q.value]=1,M.addState(q.value,q.label,q.value===e,!1,!0,q.value===N)}),this.updatingClear=!1}},q.prototype.updateTableLater=function(){var M=this;this._updateTableTimer&&clearTimeout(this._updateTableTimer),this._updateTableTimer=setTimeout(function(){delete M._updateTableTimer,M.updateTable()},100)},q.prototype.getNestState=function(M,q){var N=this;M.forEach(function(M){if("image"===M.type){var e=ht.Default.getImage(M.name);if(e&&e.comps){var X=e.stateEnum;X&&X.forEach(function(M){$w[M.value]||(q.push(M),$w[M.value]=1)}),N.getNestState(e.comps,q)}else if(!e)return void N.updateTableLater()}})},q.prototype.isStateExist=function(M,q){for(var N=this.tableModel.toDatas(function(M){return M!==q}),e=N.size(),X=0;X<e;X++)if(M===N.get(X).a("stateName"))return!0},q.prototype.setDefaultState=function(M){this.tableModel.each(function(q){q.a("isDefault",q.a("stateName")===M)})},q.prototype.$5$=function(M){var q=this;this.dataModel&&(this.dataModel.ump(this.handleDataModelPropertyChange,this),this.dataModel.umm(this.handleDataModelChange,this),this.dataModel._lastState=this.currentState);var N=this.editor.symbolView;if(N?(this.dataModel=N.dm,this.dataModel.mp(this.handleDataModelPropertyChange,this),this.dataModel.mm(this.handleDataModelChange,this)):this.dataModel=null,this.updateTable(),N){var e=this.dataModel._lastState;void 0!==e?this.tableModel.each(function(M){M.a("stateName")===e&&q.tableModel.sm().ss(M)}):this.tableModel.sm().cs()}},q.prototype.getAllStateEnum=function(){var M=[];return this.tableModel.each(function(q){var N=q.a("stateName"),e=q.a("stateDisplayName"),X={};X.value=N,e&&(X.label=e),M.push(X)}),M},IN(q,[{key:"currentState",get:function(){var M=this.tableModel.sm().ld();return M?M.a("stateName"):void 0}}]),q}(WN),Ew=function(M){function q(N){YN(this,q);var e=dN(this,M.call(this));return e.editor=N,e.editor.menus.push(e),e.setItems(e.createItems()),e}return rN(q,M),q.prototype.createItems=function(M){return M?"file"===M?[this.createItem("newDisplayView",e("editor.newdisplayview"),"newDisplayView",oN.config.displaysVisible),this.createItem("newSymbolView",e("editor.newsymbolview"),"newSymbolView",oN.config.symbolsVisible),this.createItem("newComponent",e("editor.newcomponent"),"newComponent",oN.config.componentsVisible)]:void 0:[{id:"file",label:e("editor.file"),items:this.createItems("file")}]},q.prototype.createItem=function(M,q,N){var e=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],X=void 0;OM(N)?X=N:kN(N)&&(X=this.editor[N])&&(X=X.bind(this.editor));var w={id:M,label:q,visible:!(!X||!e)};return X&&(w.action=function(){X()}),w},q}(ne),Jw=function(M){function q(N){YN(this,q);var e=dN(this,M.call(this));return e.editor=N,e.initMenu(),e.$68$(),e.enableToolTip(),e}return rN(q,M),q.prototype.$5$=function(){this.iv()},q.prototype.initMenu=function(){var M=this;this.editor.mainMenu=new Ew(this.editor);var q=function(q){var N=M.editor.mainMenu;N.isShowing()&&!N.getView().contains(q.target)&&N.hide()};window.addEventListener("touchstart",q,!1),window.addEventListener("mousedown",q,!1)},q.prototype.$68$=function(){var M=[];this.$67$(M),this.createEditItem(M),this.createDisplayItems(M),this.createSymbolItems(M),this.createSceneItems(M),this.setItems(M)},q.prototype.$67$=function(M){var q=this,N=wq("menu",e("editor.menu"),"editor.menu");N.action=function(M,N,e){if(!q.editor.mainMenu.isShowing()){var X=q.getItemInfoAt(e);q.editor.mainMenu.showOnView(q,X.startX,q.getHeight()-5),e.preventDefault(),e.stopPropagation()}},M.push(N)},q.prototype.createEditItem=function(M){var q=this,N=function(){return q.editor.currentView&&"edit"===q.editor.currentView.$3$()},X=wq("edit",e("editor.edit"),"editor.edit",N);X.visible=function(){return(!q.editor.currentView||!q.editor.currentView.getPreferredSize)&&q.editor.editable},X.action=function(){var M=q.editor.currentView;M&&M.$4$("edit")},M.push(X)},q.prototype.createDisplayItems=function(M){var q=this,N=function(M){return function(N){"Node"===M||"SubGraph"===M||("Edge"===M?N.s({"edge.width":1,"edge.color":oN.config.color_data_border}):"Group"===M?N.setExpanded(!0):"arc"===M?N.s({shape:M,"shape.background":oN.config.color_data_background,"shape.border.width":1,"shape.border.color":oN.config.color_data_border,"shape.arc.from":0,"shape.arc.to":4.1888}):"Shape"===M?N.s({"shape.background":null,"shape.border.color":oN.config.color_data_border,"shape.border.width":1}):"Text"===M?(N.s("text",e("editor.text")),N.setSize(0,0)):N.s({shape:M,"shape.background":oN.config.color_data_background,"shape.border.width":1,"shape.border.color":oN.config.color_data_border})),q.editor.fireEvent("dataInited",{type:M,data:N,displayView:q.editor.displayView})}};M.push(this.editor.createDisplayItem("Shape",e("editor.shape"),"editor.display.shape",ht.Shape,N("Shape"))),M.push(this.editor.createDisplayItem("Oval",e("editor.oval"),"editor.display.oval",ht.Node,N("oval"))),M.push(this.editor.createDisplayItem("RoundRect",e("editor.roundrect"),"editor.display.roundrect",ht.Node,N("roundRect"))),M.push(this.editor.createDisplayItem("Rect",e("editor.rect"),"editor.display.rect",ht.Node,N("rect"))),M.push(this.editor.createDisplayItem("Polygon",e("editor.polygon"),"editor.display.polygon",ht.Node,N("polygon"))),M.push(this.editor.createDisplayItem("Triangle",e("editor.triangle"),"editor.display.triangle",ht.Node,N("triangle"))),M.push(this.editor.createDisplayItem("Star",e("editor.star"),"editor.display.star",ht.Node,N("star"))),M.push(this.editor.createDisplayItem("Arc",e("editor.arc"),"editor.display.arc",ht.Node,N("arc"))),M.push(this.editor.createDisplayItem("Text",e("editor.text"),"editor.display.text",ht.Text,N("Text"))),M.push(this.editor.createDisplayItem("Node",e("editor.node"),"editor.display.node",ht.Node,N("Node"))),M.push(this.editor.createDisplayItem("Group",e("editor.group"),"editor.display.group",ht.Group,N("Group"))),M.push(this.editor.createDisplayItem("SubGraph",e("editor.subgraph"),"editor.display.subgraph",ht.SubGraph,N("SubGraph"))),M.push(this.editor.createDisplayItem("Edge",e("editor.edge"),"editor.display.edge",ht.Edge,N("Edge")))},q.prototype.createSymbolItems=function(M){M.push(this.editor.createSymbolItem("shape",e("editor.shape"),"editor.symbol.shape","shape")),M.push(this.editor.createSymbolItem("oval",e("editor.oval"),"editor.symbol.oval","oval")),M.push(this.editor.createSymbolItem("roundRect",e("editor.roundrect"),"editor.symbol.roundrect","roundRect")),M.push(this.editor.createSymbolItem("rect",e("editor.rect"),"editor.symbol.rect","rect")),M.push(this.editor.createSymbolItem("polygon",e("editor.polygon"),"editor.symbol.polygon","polygon")),M.push(this.editor.createSymbolItem("triangle",e("editor.triangle"),"editor.symbol.triangle","triangle")),M.push(this.editor.createSymbolItem("star",e("editor.star"),"editor.symbol.star","star")),M.push(this.editor.createSymbolItem("arc",e("editor.arc"),"editor.symbol.arc","arc")),M.push(this.editor.createSymbolItem("text",e("editor.text"),"editor.symbol.text","text")),M.push(this.editor.createSymbolItem("border",e("editor.border"),"editor.symbol.border","border")),M.push(this.editor.createSymbolItem("piechart",e("editor.piechart"),"editor.symbol.piechart","pieChart")),M.push(this.editor.createSymbolItem("onedimensionalcolumnchart",e("editor.onedimensionalcolumnchart"),"editor.symbol.onedimensionalcolumnchart","oneDimensionalColumnChart")),M.push(this.editor.createSymbolItem("columnchart",e("editor.columnchart"),"editor.symbol.columnchart","columnChart")),M.push(this.editor.createSymbolItem("linechart",e("editor.linechart"),"editor.symbol.linechart","lineChart"))},q.prototype.createSceneItems=function(M){},q}(me),uw=function(M){function q(N){YN(this,q);var e=dN(this,M.call(this));return e.editor=N,e.$68$(),e.enableToolTip(),e.setStickToRight(!0),e}return rN(q,M),q.prototype.handleGraphViewPropertyChange=function(M){"zoom"===M.property&&this.$69$()},q.prototype.handleDataModelPropertyChange=function(M){this.iv()},q.prototype.$69$=function(){var M="",q=this.graphView;if(q){var N=100*q.getZoom();M=N<10?N.toFixed(3):N<100?N.toFixed(2):N<1e3?N.toFixed(1):parseInt(N)}this.label.innerHTML=M},q.prototype.$5$=function(M){if(this.dm&&this.dm.removePropertyChangeListener(this.handleDataModelPropertyChange,this),this.graphView&&this.graphView.removePropertyChangeListener(this.handleGraphViewPropertyChange,this),M){var q=M.getView();this.dm=q.dm,this.dm&&this.dm.addPropertyChangeListener(this.handleDataModelPropertyChange,this),this.graphView=q.graphView,this.isUI=M._isUI,this.graphView&&this.graphView.addPropertyChangeListener(this.handleGraphViewPropertyChange,this)}else this.dm=null,this.graphView=null,this.isUI=null;this.iv(),this.$69$()},q.prototype.$68$=function(){var M=this,q=void 0,N=function(){return!!M.graphView},X=function(){return!(!M.graphView&&!M.isUI)},w=[];q=wq("undo",e("editor.undo"),"editor.undo"),q.action=function(){M.editor.undo()},q.visible=X,w.push(q),q=wq("redo",e("editor.redo"),"editor.redo"),q.action=function(){M.editor.redo()},q.visible=X,w.push(q),w.push({separator:!0,visible:X}),oN.SceneView&&(q=wq("debug",e("editor.debug"),"editor.debug",function(){return M.editor.isDebugTipShowing()}),q.action=function(){M.editor.toggleDebugTip()},q.visible=N,w.push(q)),q=wq("rulers",e("editor.showrulers"),"editor.rulers",function(){return M.editor.isRulerEnabled()}),q.action=function(){M.editor.toggleRulerEnabled()},q.visible=N,w.push(q),q=wq("grid",e("editor.showgrid"),"editor.grid",function(){return M.editor.isGridEnabled()}),q.action=function(){M.editor.toggleGridEnabled()},q.visible=N,w.push(q),w.push({separator:!0,visible:N}),q=wq("save",e("editor.save"),"editor.save"),q.action=function(){M.editor.save()},q.visible=X,w.push(q),q=wq("preview",e("editor.preview"),"editor.preview"),q.action=function(){M.editor.preview()},q.visible=X,w.push(q),q=wq("reload",e("editor.reload"),"editor.reload"),q.action=function(){M.editor.reload()},q.visible=X,w.push(q),w.push({separator:!0,visible:X}),w.push(this.createZoomItem(N)),q=wq("zoomToFit",e("editor.zoomtofit"),"editor.zoomtofit"),q.action=function(){M.editor.zoomToFit()},q.visible=N,w.push(q),w.push({separator:!0,visible:N}),q=wq("toggleLeft",e("editor.toggleleft"),"editor.toggleleft"),q.action=function(){M.editor.toggleLeft()},w.push(q),q=wq("toggleRight",e("editor.toggleright"),"editor.toggleright"),q.action=function(){M.editor.toggleRight()},w.push(q),this.setItems(w)},q.prototype.createZoomItem=function(M){var q=this,N=this.label=ht.Default.createDiv(!0);N.style.font=this.getLabelFont(),N.style.color=this.getLabelColor(),N.style.cursor="ew-resize",N.style.width="40px",N.style.height=ht.Default.widgetRowHeight+"px",N.style.lineHeight=ht.Default.widgetRowHeight+"px",N.style.whiteSpace="nowrap",N.style.textAlign="center";var e=function(M){M.preventDefault();var N=q.editor.gv;if(N){K(M)&&q.editor.zoomReset();var e=N.getZoom(),X=C(M).x,w=function(M){M.preventDefault();var q=C(M).x-X;N.setZoom(e*(1+.005*q))};window.addEventListener("mousemove",w,!1),window.addEventListener("touchmove",w,!1);var $=function(M){M.preventDefault(),window.removeEventListener("mousemove",w,!1),window.removeEventListener("touchmove",w,!1),window.removeEventListener("mouseup",$,!1),window.removeEventListener("touchend",$,!1)};window.addEventListener("mouseup",$,!1),window.addEventListener("touchend",$,!1)}};return N.addEventListener("mousedown",e,!1),N.addEventListener("touchstart",e,!1),{id:"zoom",unfocusable:!0,element:N,visible:M}},q}(me),gw=function(M){function q(){var N=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=N.functionName,X=N.functionValue,w=N.argList,$=N.codeEditorConfig;YN(this,q);var t=dN(this,M.call(this));t._functionName=e||"",t.commentRowHeight=18;var E=t.raws=[],J=t.addRow([{id:"comment",element:t.createCommentGraph()}],[.1],90);return E.push(J),J=t.addRow([{id:"head",element:"function() {"}],[.1]),E.push(J),J=t.addRow([{id:"function",element:xq($)}],[.1],.1),E.push(J),J=t.addRow(["}"],[.1]),E.push(J),t.updateContent(X,w),t}return rN(q,M),q.prototype.setArguments=function(M){this._argList=M,this.setFormRows()},q.prototype.getArguments=function(){return this._argList},q.prototype.updateContent=function(M,q){this.setArguments(q),this.setFunctionValue(M)},q.prototype.stringifyFunction=function(M){return this._argList?g(M):u(M)},q.prototype.setFunctionValue=function(M){this.v("function",this.stringifyFunction(M))},q.prototype.getFunctionValue=function(){return this.parseFunction(this.v("function"))},q.prototype.parseFunction=function(M){if(M){var q=this.getFunctionHead();return M=M.trim(),q?M=""+q+M+"}":M.startsWith("function")||(M="function() {\n"+M+"\n}"),S(M)}},q.prototype.getFunctionHead=function(){var M=this._argList;if(M){_N(M[0])&&(M=M.map(function(M){return M[1]}));var q="function("+(_N(M)?M.join(", "):M)+") {";return this._functionName&&(q=this._functionName+": "+q),q}},q.prototype.setFormRows=function(){var M=this,q=this.raws,N=this._argList;if(4===M.getRows().length&&V(this.commentGraph.getView()),N){_N(N[0])?(M._rows=q,this.commentNode.a("dataSource",N.map(function(M){var q=M.slice(0);return q[2]&&(q[2]=e(q[2])),q})),this.setCommentCollapse(!1)):M._rows=q.slice(1)}else M._rows=[q[2]];4===M.getRows().length&&M._contentDiv.appendChild(this.commentGraph.getView()),M.iv(),N&&M.v("head",this.getFunctionHead())},q.prototype.createCommentGraph=function(){var M=this,q=this.commentGraph=new ht.graph.GraphView;q.setRectSelectable(!1),q.setPannable(!1),q.getSelectWidth=function(){return 0},q.setZoomable(!1),q.setMovableFunc(function(){return!1}),q.setScrollBarVisible(!1);var N=q.dm(),e=this.commentNode=new ht.Node;return N.add(e),e.setImage("editor.function.comment"),e.s({fullscreen:"fill","fullscreen.gap":0,interactive:!0,pixelPerfect:!1,onEnter:function(M,q){q.a("background",oN.config.color_pane_dark)},onLeave:function(M,q){q.a("background",null)},onUp:function(q,N){var e=!N.a("collapse");M.setCommentCollapse(e)}}),e.a({collapse:!1,rowHeight:this.commentRowHeight}),q},q.prototype.setCommentCollapse=function(M){this.commentNode.a("collapse",M),this.getRows()[0].height=this.commentRowHeight*(M?1:this._argList.length+2),this.iv()},q.prototype.hasTextFocus=function(){return this.getItemById("function").element.hasTextFocus()},q}(WN),Sw=function(){},bw=function(M){function q(N){YN(this,q);var X=dN(this,M.call(this));X.editor=N,X._errorMsg=null,X.$71$(),X.$70$(),X.$72$(),X.splitView=new Ke(X.inspectorPane,X.graphView,"v",-200),X.mainSplitView=new Ke(X.funcPane,X.splitView,"h",-360),X._eventData=new ht.Data;var w=[];return w.push({label:e("editor.refresh"),action:function(){X.refresh()}}),w.push({label:e("editor.ok"),action:function(){X.ok()}}),w.push({label:e("editor.cancel"),
action:function(){X.hide()}}),X.setConfig({closable:!0,draggable:!0,width:oN.config.componentViewSize.width,height:oN.config.componentViewSize.height,contentPadding:0,resizeMode:"wh",maximizable:!0,content:X.mainSplitView,buttons:w,buttonsAlign:"right"}),X}return rN(q,M),q.prototype.$48$=function(){this.funcPane.hasTextFocus()||this.hide()},q.prototype.$47$=function(){this.ok()},q.prototype.$71$=function(){var M=this;ht.Default.setCompType("_editingCompType_",{func:function(){}}),this.graphView=new Re,this.initOverviewNode(),this.graphView.mi(function(q){"doubleClickData"!==q.kind&&"doubleClickBackground"!==q.kind||M.graphView.fitContent(oN.config.animate,oN.config.fitPadding)});var q=this;ht.Default.drawCompType=function(M,N,X,w,$,t){var E="_editingCompType_"===w.type;try{E&&q.beforeDrawCompType(N),M(N,X,w,$,t),E&&q.afterDrawCompType(N)}catch(M){E&&(q.afterDrawCompType(N),q._errorMsg=e("editor.compfunctionerror")),console.error(M.stack||M)}}},q.prototype.initOverviewNode=function(){var M=this.node,q=this.graphView.dm();M&&q.contains(M)&&q.remove(M);var N=this.node=new ht.Node;N.setImage({width:100,height:100,fitSize:!0,comps:[{type:"_editingCompType_"}]}),q.add(N),q.sm().ss(N)},q.prototype.beforeDrawCompType=function(M){var q=this._restoreFlag;q||(q=this._restoreFlag=M.createLinearGradient(0,0,10,10),q.addColorStop(0,"black"),q.addColorStop(0,"black")),M.fillStyle=q,M.save(),M.fillStyle="#000000"},q.prototype.afterDrawCompType=function(M){if(M.restore(),M.fillStyle!==this._restoreFlag){for(var q=0;M.fillStyle!==this._restoreFlag&&(M.restore(),!(++q>=20)););M.fillStyle="black",this._errorMsg=e("editor.complosssaveorrestore")}else this._errorMsg=null},q.prototype.$72$=function(){this.funcPane=new gw({argList:[["CanvasRenderingContext2D","g","editor.comment.canvasrenderingcontext2d"],["Rect","rect","editor.comment.componentrect"],["Object","comp","editor.comment.component"],["ht.Node","data","editor.comment.node"],["View","view","editor.comment.view"]]})},q.prototype.$70$=function(){var M=this,q=oN.config.indent;this.inspectorPane=new WN;var N=Jq(e("editor.eventhandlers"),null,null,function(){M.editor.eventView.open([M._eventData],null,M.resetEventButtonLabelColor.bind(M))});this.eventButton=N,this.inspectorPane.addRow([e("editor.name"),{id:"name",textField:{}},{element:e("editor.events"),align:"right"},{element:N}],[q,.1,q,.1]),this.inspectorPane.addRow([e("editor.width"),{id:"width",textField:{}},{element:e("editor.height"),align:"right"},{id:"height",textField:{}}],[q,.1,q,.1]),this.inspectorPane.addRow([e("editor.background"),{id:"background",colorPicker:{editor:this.editor,instant:!0,onValueChanged:function(q,N){M.graphView.dm().setBackground(N)}}},e("editor.path"),{id:"path",textField:{editable:!1}}],[q,.1,q,.1]),this.inspectorPane.addRow([e("editor.snapshoturl"),{id:"snapshotURL",textField:{}}],[q,.1]),this.createTable()},q.prototype.$73$=function(M,q,N,e){var X=this,w={name:M,tag:M,accessType:"attr",width:N,displayName:q,align:"center",enum:e,editable:!0};return"defaultValue"===M&&(w.getColorPicker=function(M){return"Color"===M.a("valueType")?{editor:X.editor}:null}),w},q.prototype.createTable=function(){var M=this,q=this.tableModel=new ht.DataModel;this.tablePane=new pe(this.tableModel),this.tableView=this.tablePane.getTableView(),this.tableView.setEditable(!0),this.tableView.isEditable=function(){return M.editable},this.tablePane.getView().style.border=oN.config.color_line+" solid 1px",this.tablePane.addColumns([this.$73$("property",e("editor.property"),150),this.$73$("valueType",e("editor.valuetype"),80,{values:oN.consts.valueTypes,labels:oN.consts.valueTypeLabels}),this.$73$("defaultValue",e("editor.defaultvalue"),90),this.$73$("name",e("editor.name"),80),this.$73$("group",e("editor.group"),80),this.$73$("description",e("editor.description"),120),this.$73$("extraInfo",e("editor.extrainfo"),100)]),this.$74$(),this.initExtraInfoColumn(),this.initI18nColumns(),this.inspectorPane.addRow([this.tablePane],[.1],.1);var N=[Jq(null,e("editor.add"),"editor.add",function(){if(M.editable){var N=new ht.Data;N.a({property:"property",valueType:"String"});var e=void 0,X=q.sm().ld();X&&(e=q.getRoots().indexOf(X)+1),q.add(N,e),q.sm().ss(N),setTimeout(function(){M.tableView.tx(0),mq(M.tableView,N,M.tableView.getColumnModel().getDataByTag("property"))},100)}}),Jq(null,e("editor.delete"),"editor.delete",function(){M.editable&&M.tableView.removeSelection()}),null,Jq(null,e("editor.bringtofront"),"editor.top",function(){M.editable&&M.tableView.sm().size()&&M.tableModel.moveSelectionToTop()}),Jq(null,e("editor.bringforward"),"editor.up",function(){M.editable&&M.tableView.sm().size()&&M.tableModel.moveSelectionUp()}),Jq(null,e("editor.sendbackward"),"editor.down",function(){M.editable&&M.tableView.sm().size()&&M.tableModel.moveSelectionDown()}),Jq(null,e("editor.sendtoback"),"editor.bottom",function(){M.editable&&M.tableView.sm().size()&&M.tableModel.moveSelectionToBottom()})],X=function(){return this.isPressed()?oN.config.color_select:oN.config.color_dark};N.forEach(function(M){M instanceof ht.widget.Button&&(M.getIconColor=X)}),this.inspectorPane.addRow(N,[20,20,.1,20,20,20,20])},q.prototype.$74$=function(){var M=this,q=this.tableView.getColumnModel().getDataByTag("defaultValue");q.getValue=function(M,q,N){var e=M.a("defaultValue");return"Angle"===M.a("valueType")&&e&&(e=e/Math.PI*180),e},q.setValue=function(M,q,N,e){"Angle"===M.a("valueType")&&(N=N*Math.PI/180),M.a("defaultValue",N)},q.getEnumValues=function(M){var q=M?oN.config.valueTypes[M.a("valueType")]:null;return q&&"enum"===q.type?q.values:null},q.getEnumLabels=function(M){var q=M?oN.config.valueTypes[M.a("valueType")]:null;return q&&"enum"===q.type?q.labels:null},q.getEnumIcons=function(M){var q=M?oN.config.valueTypes[M.a("valueType")]:null;return q&&"enum"===q.type?q.icons:null},q.getEnumDropDownWidth=function(M){var q=M?oN.config.valueTypes[M.a("valueType")]:null;return q&&"enum"===q.type?q.dropDownWidth:null},q.getValueType=function(M){var q=M?oN.config.valueTypes[M.a("valueType")]:null;return q?q.type:null},q.isCellEditable=function(q,N,X,w){var $=q.a("valueType"),t=q?oN.config.valueTypes[$]:null,E=t?t.type:null,J=q.a("extraInfo"),u=oN.config.handleDefaultVauleColumnEdit,g=function(M){q.a("defaultValue",M)};if(u&&u(g,t,E,J))return!1;if("function"===E){var S=e("editor.function")+" "+(q.a("property")||"");return M.editor.functionView.open(q.a("defaultValue"),g,S,J&&J.arguments),!1}if("multiline"===E)return M.editor.textView.open(q.a("defaultValue"),g,q.a("property")||"&nbsp;"),!1;if("font"===E)return M.editor.fontView.open(q.a("defaultValue"),g,q.a("property")||"&nbsp;"),!1;if("object"===E||"custom"===E||"stringArray"===E||"objectArray"===E||"numberArray"===E&&"DashPattern"!==$||"colorArray"===E||"gradientPackArray"===E){var b=e("editor.object")+" "+(q.a("property")||"");return M.editor.objectView.open(q.a("defaultValue"),g,b,null,"object"===E&&J&&J.objectProperties),!1}return"dataModel"!==E||(M.editor.dataModelView.open(q.a("defaultValue"),g,M.editable,J),!1)};var N=this.tableView,X=N.drawCell;this.tableView.editor=this.editor,q.getItemEditor=function(M){var q=M.a("valueType"),N=M?oN.config.valueTypes[q]:null;if(N){if("gradientPack"===N.type)return EX;if("DashPattern"===q)return de}return null},this.tableView.drawCell=function(M,N,e,w,$,t,E,J){var u=N?oN.config.valueTypes[N.a("valueType")]:null;if(w===q&&u&&"gradientPack"===u.type){var g=N.a("defaultValue");if(!g)return;var S=void 0,b=!1;_N(g)&&g.length>1?(S=Iq(M,g,{x:$,y:t,width:E,height:J}),b=!0):S=g,M.fillStyle=S,M.fillRect($,t,E,J),b&&M.restore()}else X.call(this,M,N,e,w,$,t,E,J)}},q.prototype.initExtraInfoColumn=function(){var M=this;this.tableView.getColumnModel().getDataByTag("extraInfo").isCellEditable=function(q,N,X,w){var $=e("editor.extrainfo")+" "+(q.a("property")||"");return M.editor.objectView.open(q.a("extraInfo"),function(M){q.a("extraInfo",M)},$),!1}},q.prototype.initI18nColumns=function(){var M=this;["name","group"].forEach(function(q){var N=M.tableView.getColumnModel().getDataByTag(q);N.getValue=function(M,N,X){var w=M.a(q);return M._editing_?w:e(w)},N.setValue=function(M,N,e,X){M.a(q,e),delete M._editing_},N.isCellEditable=function(M,q,N,e){return M._editing_=1,!0}})},q.prototype.open=function(M,q){var N=this;this.fileNode=M,this.initOverviewNode(),M?T(M.url,function(q){N.update(M.url,M.path,D(M.getName()),q,M.a("editable"))}):this.update(void 0,q||this.editor.components.currentDir,e("editor.untitled"))},q.prototype.update=function(M,q,N,X,w){if(this.editable=!1!==w,this._eventData.setAttrObject({}),X){if(X=a(X),this.setTitle(e("editor.editcomponent")),this.node.setWidth(X.width||100),this.node.setHeight(X.height||100),this.inspectorPane.v("width",this.node.getWidth()),this.inspectorPane.v("height",this.node.getHeight()),this.inspectorPane.v("snapshotURL",X.snapshotURL||""),this.inspectorPane.v("background",X.background||null),this.inspectorPane.getViewById("name").setEditable(!1),this.inspectorPane.v("name",N||""),this.inspectorPane.v("path",q||""),this.funcPane.setFunctionValue(X.func),this.tableModel.clear(),X.properties)for(var $ in X.properties){var t=X.properties[$],E=new ht.Data;E.a({property:$,valueType:t.valueType,defaultValue:t.defaultValue,name:t.name,group:t.group,description:t.description,extraInfo:t.extraInfo}),this.tableModel.add(E)}if(this._eventData=new ht.Data,X.events)for(var J in X.events)this._eventData.a(J,X.events[J]);this.refresh(),this.show(this.editor.$38$),this.url=M,this.editor.fireEvent("componentViewOpened",{componentView:this,url:M,json:X})}else this.setTitle(e("editor.newcomponent")),this.node.setWidth(100),this.node.setHeight(100),this.inspectorPane.v("width",this.node.getWidth()),this.inspectorPane.v("height",this.node.getHeight()),this.inspectorPane.v("snapshotURL",""),this.inspectorPane.getViewById("name").setEditable(!0),this.inspectorPane.v("name",N),this.inspectorPane.v("path",q),this.funcPane.setFunctionValue(),this.tableModel.clear(),this.refresh(),this.show(this.editor.$38$),this.url=M,this.editor.fireEvent("componentViewCreated",{componentView:this});this.resetEventButtonLabelColor()},q.prototype.$76$=function(M){var q={};return this.tableModel.getRoots().each(function(N){q[N.a("property")]={valueType:N.a("valueType"),defaultValue:M?DM(N.a("defaultValue")):N.a("defaultValue"),name:N.a("name"),group:N.a("group"),description:N.a("description"),extraInfo:N.a("extraInfo")}}),q},q.prototype.refresh=function(M){ht.Default.setCompType("_editingCompType_",{func:this.funcPane.getFunctionValue()||Sw,properties:this.$76$()}),this.node.setWidth(parseFloat(this.inspectorPane.v("width"))),this.node.setHeight(parseFloat(this.inspectorPane.v("height"))),this.node.iv(),this.graphView.fitContent(oN.config.animate,oN.config.fitPadding);var q=function(N){"validate"===N.kind&&(M&&M(!this._errorMsg),this._errorMsg&&this.editor.showMessage(this._errorMsg,"error"),this.graphView.removeViewListener(q,this))};this.graphView.addViewListener(q,this)},q.prototype.createEvents=function(){var M=this._eventData,q=null;return zN.forEach(function(N){M.a(N)&&(q||(q={}),q[N]=M.a(N))}),q},q.prototype.resetEventButtonLabelColor=function(){for(var M=!1,q=0;q<zN.length;q++)if(this._eventData.a(zN[q])){M=!0;break}this.eventButton.setLabelColor(M?oN.config.color_select:ht.Default.labelColor)},q.prototype.ok=function(){var M=this;if(!this.editable)return void this.hide();var q=this.inspectorPane.v("name").trim(),N=this.inspectorPane.v("path");if(!this.url){var X=this.editor.components;if(X.isAccordionMode()&&X.rootDir===N)return void this.editor.showMessage(e("editor.createfolderfirst"),"error",2e3)}var w=this.url||N+"/"+q+".json",$=!this.url&&this.editor.getFileNode(w);if(!q)return void eq(null,e("editor.inputempty"),function(){});if($)return void eq(e("editor.filenameconflict"),w,function(){});if(q.length>oN.config.maxFileNameLength)return void eq(null,e("editor.inputmax"),function(){});if(oN.config.checkFileName&&!(q=oN.config.checkFileName(q,w)))return void eq(null,e("editor.invalidfilename"),function(){});gM(q)&&(q=D(q));var t=this.content,E={componentView:this,url:w,json:d(t)};this.editor.fireEvent("componentViewSaving",E),E.preventDefault||(E={path:E.url,content:E.json},oN.config.vision&&(E.root_dir=this.editor.components.rootDir,E.parent_uuid=this.editor.components.tree.sm().ld().uuid),this.refresh(function(e){e&&M.editor.request("upload",E,function(e){(oN.config.vision?e&&e.uuid:!0===e)&&(M.refresh(),M.graphView.sm().cs(),M.graphView.validate(),M.editor.saveImage(t.snapshotURL||M.graphView,N+"/"+q+".png",function(){M.editor.fireEvent("componentViewSaved",E)},e.uuid,e.parent_uuid,e.root_dir),M.hide(),M.editor.selectFileNode(E.path),E={componentView:M,url:E.path,json:E.content})})}))},IN(q,[{key:"content",get:function(){var M=this.inspectorPane,q={modified:(new Date).toString(),width:parseFloat(M.v("width")),height:parseFloat(M.v("height")),func:this.funcPane.getFunctionValue()||Sw},N=M.v("snapshotURL"),e=M.v("background"),X=this.createEvents();return this.tableModel.size()&&(q.properties=this.$76$(!0)),X&&(q.events=X),N&&(q.snapshotURL=N),e&&(q.background=e),q}}]),q}(DN),hw=460,yw=230,Pw=function(M){function q(N){YN(this,q);var X=dN(this,M.call(this));X.editor=N;var w=[];w.push(e("editor.binding")),w.push({id:"compProperty",textField:{editable:!1}}),w.push({element:e("editor.type"),align:"right"}),w.push({id:"type",comboBox:{values:["attr","func"],onValueChanged:function(M,q){var N="func"===q,e=N?ht.Default.labelColor:oN.config.color_disabled;X.getViewById("func").setEditable(N),X.getItemById("head").color=e,X.getItemById("end").color=e,X.getViewById("property").setDisabled(N),N&&X.getViewById("property").setValue(""),X.iv()}}}),w.push({element:e("editor.property"),align:"right"});var $={id:"property"};oN.config.dataBindingsForSymbol.getComboBoxValues?$.comboBox={editable:!!oN.config.dataBindingsForSymbol.comboBoxEditable}:$.textField={},w.push($);var t=[50,90,40,60,60,.1];if(oN.config.dataBindingsForSymbol.onButtonClicked){var E=Jq("...",void 0,void 0,function(){X.smartClose=!1,oN.config.dataBindingsForSymbol.onButtonClicked(X,X.v("compProperty"),X.editor)});w.push(E),t.push(20)}if(X.addRow(w,t),!oN.config.dataBindingsForSymbol.getComboBoxValues){X.getItemById("property").element.getElement().addEventListener("keydown",function(M){ht.Default.isEnter(M)&&X.hide(!0)})}X.addLine(),X.addRow([{id:"head",element:""}],[.1]),X.addRow([{id:"func",element:xq()}],[.1],.1),X.addRow([{id:"end",element:"}"},{button:{label:e("editor.ok"),onClicked:function(){X.hide(!0)}}},{button:{label:e("editor.cancel"),onClicked:function(){X.hide()}}}],[.1,50,50]),X.setWidth(hw),X.setHeight(yw),X.getView().className="ht-editor-databinding",X.getView().style.background=oN.config.color_pane,X.getView().style.border=oN.config.color_pane_dark+" solid 1px",X.getView().style.boxShadow="0px 0px 3px "+ht.Default.toolTipShadowColor,X.getView().style.overflow="visible";var J=X.handleWindowClick.bind(X);return window.addEventListener("mousedown",J,!1),window.addEventListener("touchstart",J,!1),X}return rN(q,M),q.prototype.handleWindowClick=function(M){if(this.smartClose&&this.getView().parentNode&&!this.button.getView().contains(M.target)){var q=this.getViewById("type");if(!q.getListView().getView().contains(M.target)){if((q=this.getViewById("property"))instanceof ht.widget.ComboBox){if(q.getListView().getView().contains(M.target))return;if(q.getInput()&&q.getInput().contains(M.target))return}this.getView().contains(M.target)||this.hide()}}},q.prototype.toggle=function(M,q,N,e,X,w){this.getView().parentNode?this.hide():this.show(M,q,N,e,X,w)},q.prototype.show=function(M,q,N,e,X,w){var $=this;oN.config.dataBindingsForSymbol.getComboBoxValues?oN.config.dataBindingsForSymbol.getComboBoxValues(function(t){$.getViewById("property").setValues(t),$.showImpl(M,q,N,e,X,w)}):this.showImpl(M,q,N,e,X,w)},q.prototype.showImpl=function(M,q,N,e,X,w){if(!this.getView().parentNode){this.smartClose=!0;var $=M.getView().getBoundingClientRect(),t=(this.getView().style,Q());ht.Default.appendToScreen(this),$.bottom+yw+1>t.height?this.getView().style.top=t.top+$.top-yw-1+"px":this.getView().style.top=t.top+$.bottom+1+"px",this.getView().style.left=t.left+$.right-hw+"px",this.iv(),this.button=M,this.name=q,this.inspector=e,this.setter=w,this.v("compProperty",N||q);var E=void 0,J=!1;this.inspector.global?"clip"===q?(E=X?X():this.inspector.dataModel.a("clip"),this.v("head","function(g, width, height, data, view, image) {"),J=!0):(E=X?X():this.inspector.dataModel.a(q+"_func"),this.v("head","function(data, view) {")):(E=X?X():this.inspector.data.a(q),this.inspector.data instanceof AX&&"type"===q?(this.v("head","function(g, rect, comp, data, view) {"),J=!0):this.v("head","function(data, view) {"));kN(E)?(BN.test(E)?(this.v("type","attr"),this.v("property",E.slice(5))):(this.v("type","attr"),this.v("property",E)),this.v("func","")):OM(E)?(this.v("type","func"),this.v("property",""),this.v("func",g(E))):(this.v("type","attr"),this.v("property",""),this.v("func","")),J?(this.v("type","func"),this.v("property",""),this.getViewById("type").setDisabled(!0)):this.getViewById("type").setDisabled(!1)}},q.prototype.hide=function(){var M=this,q=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.getView().parentNode&&(V(this.getView()),q)){var N=this.v("type"),e=this.v("property"),X=void 0;if("func"===N){var w=this.v("func").trim();(w||this.inspector.data instanceof AX&&"type"===this.name)&&(X=S(this.v("head")+"\n"+w+"\n}"))}else e&&"attr"===N&&(X="attr@"+e);this.setter?this.setter(X):this.inspector.global?"clip"===this.name?this.inspector.dataModel.a("clip",X):this.inspector.dataModel.a(this.name+"_func",X):this.inspector.setValue(function(q,N){q.a(M.name,N)},X)}},q.prototype.$48$=function(){"func"===this.v("type")&&this.getItemById("func").element.hasTextFocus()||this.hide()},q}(WN),fw=function(M){function q(N){YN(this,q);var X=dN(this,M.call(this));X.editor=N,X.createTabView();var w=[];return w.push({label:e("editor.ok"),action:function(){X.ok()}}),w.push({label:e("editor.cancel"),action:function(){X.hide()}}),X.setConfig({title:e("editor.eventhandlers"),closable:!0,draggable:!0,width:oN.config.eventViewSize.width,height:oN.config.eventViewSize.height,contentPadding:6,resizeMode:"wh",maximizable:!0,content:X.tabView,buttons:w,buttonsAlign:"right"}),X.setModal(!1),X}return rN(q,M),q.prototype.$48$=function(){this.hide()},q.prototype.$47$=function(){this.ok()},q.prototype.ok=function(M){var q=this;this.target&&(this.editor.beginTransaction(),zN.forEach(function(N){var e=q[N+"FormPane"],X=e.getFunctionValue();if("data"===q.inspectorType||"data3d"===q.inspectorType){var w=M?null:X;q.target.forEach(function(M){M.s(N,w)})}else{var $=M?null:X;q.target.forEach(function(M){M.a(N,$)})}}),this.editor.endTransaction()),this.callback&&this.callback(),this.hide()},q.prototype.createTabView=function(){var M=this,q=this.tabView=new Ce;zN.forEach(function(N){var X=M[N+"FormPane"]=new gw({functionName:N});M[N+"Tab"]=q.add(e("editor.event."+N.toLowerCase()),X)}),q.getTabModel().sm().ss(q.getTabModel().getDatas().get(0))},q.prototype.open=function(M,q,N){var e=this;M&&M.length&&(this.target=M,this.inspectorType=q,this.callback=N,zN.forEach(function(N){var X=e[N+"FormPane"];"data"===q||"data3d"===q?X.updateContent(M[M.length-1].s(N),[["Event","event","editor.comment.event"],["ht.Node","data","editor.comment.node"],"data3d"===q?["ht.graph3d.Graph3dView","view","editor.comment.graph3dview"]:["ht.graph.GraphView","view","editor.comment.graphview"]]):X.updateContent(M[M.length-1].a(N),[["Event","event","editor.comment.event"],["ht.Node","data","editor.comment.node"],["View","view","editor.comment.view"],["Point","point","editor.comment.componentpoint"],["Number","width","editor.comment.componentwidth"],["Number","height","editor.comment.componentheight"]])}),this.show(this.editor.$38$))},q.prototype.hide=function(){M.prototype.hide.call(this),this.target=this.inspectorType=this.callback=void 0},q}(DN);oN.EventView=fw;var xw=function(M){function q(N){YN(this,q);var X=dN(this,M.call(this));X.editor=N,X.formPane=new gw;var w=[];return w.push({label:e("editor.ok"),action:function(){X.ok()}}),w.push({label:e("editor.cancel"),action:function(){X.hide()}}),X.setConfig({title:e("editor.function"),closable:!0,draggable:!0,width:oN.config.functionViewSize.width,height:oN.config.functionViewSize.height,contentPadding:6,resizeMode:"wh",maximizable:!0,content:X.formPane,buttons:w,buttonsAlign:"right"}),X.setModal(!1),X}return rN(q,M),q.prototype.$48$=function(){this.formPane.hasTextFocus()||this.hide()},q.prototype.$47$=function(){this.ok()},q.prototype.ok=function(){this.setValue&&this.setValue(this.formPane.getFunctionValue()),this.hide()},q.prototype.open=function(M,q,N,e,X){this.setValue=q,this.setTitle(N),this.formPane.updateContent(M,e),this.callback=X,this.show(this.editor.$38$)},q}(DN);ht.Default.setCompType("editor.comp.function.comment",{width:300,height:100,func:function(M,q,N,e,X){var w=q.x,$=q.y,t=q.width,E=q.height,J=N.getValue("dataSource"),u=N.getValue("collapse"),g=N.getColor("background"),S=N.getValue("font"),b=N.getColor("notes.color"),h=N.getColor("param.color"),y=N.getValue("param.visible"),P=N.getColor("type.color"),f=N.getColor("propertyName.color"),x=N.getColor("comment.color")||b,n=N.getValue("rowHeight")||ht.Default.getTextSize(S,"1").height;if(M.save(),g&&(M.fillStyle=g,M.fillRect(w,$,t,E)),M.beginPath(),M.rect(w,$,t,E),M.clip(),u)B(M,"/** ...",S,b,w,$,t,n,"left","middle");else{B(M,"/**",S,b,w,$,t,n,"left","middle");var R=M.measureText("/").width;J.forEach(function(q,N){var e=R;B(M,"*",S,b,w+e,$+(N+1)*n,t,n,"left","middle"),e+=M.measureText("* ").width,y&&(B(M,"@param",S,h,w+e,$+(N+1)*n,t,n,"left","middle"),e+=M.measureText("@param  ").width),B(M,"{"+q[0]+"}",S,P,w+e,$+(N+1)*n,t,n,"left","middle"),e+=M.measureText("{"+q[0]+"}  ").width,B(M,q[1],S,f,w+e,$+(N+1)*n,t,n,"left","middle"),e+=M.measureText(q[1]+"  ").width,B(M,q[2],S,x,w+e,$+(N+1)*n,t,n,"left","middle")}),B(M,"*/",S,b,w+R,$+(J.length+1)*n,t,n,"left","middle")}M.restore()},properties:{dataSource:{valueType:"Object",defaultValue:[]},font:{valueType:"Font",defaultValue:"12px sans-serif, Arial"},collapse:{valueType:"Boolean"},rowHeight:{valueType:"PositiveNumber",defaultValue:20},background:{valueType:"Color"},"notes.color":{valueType:"Color",defaultValue:"rgb(143,153,204)"},"param.color":{valueType:"Color",defaultValue:"rgb(13,171,214)"},"type.color":{valueType:"Color",defaultValue:"rgb(125,195,125)"},"propertyName.color":{valueType:"Color",defaultValue:"rgb(175,77,232)"},"comment.color":{valueType:"Color",defaultValue:"rgb(143,153,204)"}}}),I("editor.function.comment",{width:300,height:100,fitSize:!0,comps:[{type:"editor.comp.function.comment",rect:[0,0,300,100],dataSource:{func:"attr@dataSource"},rowHeight:{func:"attr@rowHeight"},background:{func:"attr@background"},collapse:{func:"attr@collapse"},"param.visible":{func:"attr@paramVisible",value:!0}}]});var nw=function(q){function N(M){YN(this,N);var e=dN(this,q.call(this));return e.editor=M,e.init(),e.initForm(),e}return rN(N,q),N.prototype.init=function(){var M=this;this.formPane=new WN,this.formPane.addRow([{id:"object",element:xq()}],[.1],.1);var q=[];q.push({label:e("editor.ok"),action:function(){M.ok()}}),q.push({label:e("editor.cancel"),action:function(){M.hide()}}),this.setConfig({title:e("editor.object"),closable:!0,draggable:!0,width:oN.config.objectViewSize.width,height:oN.config.objectViewSize.height,contentPadding:6,resizeMode:"wh",maximizable:!0,content:this.formPane,buttons:q,buttonsAlign:"right"}),this.setModal(!1)},N.prototype.$48$=function(){this.formPane.getItemById("object").element.hasTextFocus()||this.hide()},N.prototype.$47$=function(){this.ok()},N.prototype.getValue=function(){return M(this.formPane.v("object"))},N.prototype.stringify=function(M,q){var N=this,e=Date.prototype.toJSON;Date.prototype.toJSON=function(){return"__ht__date"+this.getTime()},this._funcMap={};var X=JSON.stringify(M,function(M,q){if("function"==typeof q){var e=Math.random().toString().substring(3,16)+Date.now();return N._funcMap[e]=q,e}return q},null==q?2:q);return Date.prototype.toJSON=e,X},N.prototype.initForm=function(){var M=this,q=this.tabView=new ht.widget.TabView,N=this.jsonTab=new ht.Tab,X=this.formTab=new ht.Tab;N.setName(e("editor.data")),X.setName(e("editor.settings")),q.getTabModel().add(X),q.getTabModel().add(N),q.getTabModel().sm().ms(function(e){if(q.getTabModel().sm().ld()===N){M.inspector.endEdit();var X=M.stringify(M.getDataValue());if(X){var w=M._funcMap;for(var $ in w)X=X.replace('"'+$+'"',oN.stringifyFunction(w[$]))}M.formPane.v("object",X)}else M.updateData(M.getValue())});var w=this.inspector=new oN.Inspector(this.editor,"dataModel","data");this.dataModel=new ht.DataModel,this.dataModel.md(function(M){w.$34$(M)});var $=new ht.Data;this.dataModel.add($),this.dataModel.enableHistoryManager(),this.dataModel.getHistoryManager().mp(function(q){M._updatingData||"historyIndex"!==q.property||M.saveValue(!0)}),X.setView(w),w.dataModel=this.dataModel,w.actionLabelDataBindingEnabled=!1,w.addCustomProperties=function(){},w.setVPadding(8),w.getValue=function(M){return this.data?M(this.data):void 0},w.setValue=function(M,q,N){!this._updating&&this.data&&(M(this.data,N?N():q),this.$34$())},w.handleObjectViewOpen=function(q,N,e,X,w,$){M.saveValue(!1,M._infoQueue.length-1),M.initUIAndValue(q,e,X,w,$,N)};var t=w.addLabel;w.addLabel=function(M,q,N,e,X,w){w&&(w.accessType="tip"),t.apply(this,arguments)},X.setView(w),this.splitView=new ht.widget.SplitView;var E=this.mainBorderPane=new ht.widget.BorderPane,J=this.leftBorderPane=new ht.widget.BorderPane;E.setCenterView(J);var u=this.getConfig();u.content=E,this.setConfig(u),J.setBottomHeight(30),this.navForm=new ht.widget.FormPane,this.navForm.setVPadding(0),this.navForm.getView().style.backgroundColor="rgba(247,247,247)",this._infoQueue=[]},N.prototype.resetProperties=function(M){var q=this;this.inspector.clear(),this.inspector.updateHandlers=[],this._updatingData=!0;var N=this.inspector.data,e=oN.config.dataBindings.onButtonClicked;oN.config.dataBindings.onButtonClicked=null,this.objectProperties.forEach(function(e){if(!e.viewer){if(M){var X=e,w=X.property;N.a(w,M[w])}e=VN(e),e.accessType="a",e.group&&q.inspector.addTitle(e.group),e.bindable=!0,q.inspector.addCustomProperty(e)}}),oN.config.dataBindings.onButtonClicked=e,this.inspector.$46$=this.inspector._rows,this.inspector.filterPropertiesLater(),this._updatingData=!1},N.prototype.resetInspectorData=function(){this._updatingData=!0,this.dataModel.clear();var M=this.data=new ht.Data;this.dataModel.add(M),this.dataModel.getHistoryManager().clear(),this.inspector.data=M},N.prototype.updateData=function(M){var q=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.resetInspectorData();var N=this.inspector.data;M&&(this.objectProperties.forEach(function(q){var e=q.property;N.a(e,M[e])}),this.inspector.$34$()),this._updatingData=!1,q&&this.viewer&&this.viewer.update&&this.viewer.update(this.editor,M,this.splitView.getRightView())},N.prototype.getDataValue=function(){var M=this,q={},N=this.data;return this.objectProperties.forEach(function(e){var X=e.defaultValue,w=e.property,$=e.extraInfo,t=void 0;if(!$||!(!1===$.visible||OM($.visible)&&!1===$.visible(M.inspector))){t=N.a(w);var E=null==t?X:t;void 0!==E&&(q[w]=E)}}),q},N.prototype.restoreTo=function(M){this.saveValue(!0,M);var q=this._infoQueue[M],N=q.value,e=q.title,X=q.callback,w=q.objectProperties,$=q.arrayPropertyIndex,t=q.setValue;this._infoQueue=M?this._infoQueue.slice(0,M):[],this.initUIAndValue(N,e,X,w,$,t)},N.prototype.initUIAndValue=function(M,q,N,e,X,w){var $=this;this.callback=N,this.objectProperties=OM(e)?e():e;var t=this.tabView,E=this.formPane,J=this.splitView,u=this.jsonTab,g=this.formTab,S=this.navForm,b=this.leftBorderPane,h=this.mainBorderPane;h.setCenterView(null);var y=b;if(this._infoQueue.length||(this.viewer=null),e){for(var P=this.objectProperties.length,f=null,x=void 0,n=0;n<P;n++)if(this.objectProperties[n].viewer){x=this.objectProperties[n].viewer;break}x&&x.init&&(f=x.init(this.editor,M))&&(this.viewerIndex=this._infoQueue.length,this.viewer=x,J.setRightView(f)),this.viewer?(y=J,J.setLeftView(b)):this.viewer||(J.setLeftView(null),J.setRightView(null)),this.resetProperties(M),u.setView(E),t.select(g),this.updateData(M,!!f),b.setCenterView(t)}else J.setLeftView(null),b.setCenterView(E);if(h.setCenterView(y),this.pushInfo(M,q,N,e,X,w),M=this.stringify(M)){this._funcMap;for(var R in this._funcMap)M=M.replace('"'+R+'"',oN.stringifyFunction(this._funcMap[R]))}E.v("object",M);var G=this._infoQueue.length;if(this._infoQueue.length>1){var j=S,K=[];b.setBottomView(j),j.clear();for(var p=0;p<G;p++){var C=this._infoQueue[p],m=C.propertyName;null!=C.index&&(m=m+"["+C.index+"]"),K.push(m),p!==G-1&&K.push(">")}j.addRow(K.map(function(M,q){return q%2||q===K.length-1?M:oN.createButton(M,null,null,function(){$.restoreTo(q/2)})}),K.map(function(M,q){return q%2?12:ht.Default.getTextSize(ht.Default.labelFont,M).width}),30)}else b.setBottomView(null)},N.prototype.open=function(M,q,N,e,X,w){this.resetInspectorData(),this._updatingData=!1,this._infoQueue=[],this.setTitle(N),this.oldValue=M,this.initUIAndValue(M,N,e,X,w,q),this.show(this.editor.$38$)},N.prototype.pushInfo=function(M,q,N,e,X,w){var $=void 0,t=void 0;if(X){var E=X.split("=");$=E[0],t=E[1]}else{var J=q.replace(/\s/g,"");$=J.substring(J.indexOf("-")+1)}this._infoQueue.push({value:M,title:q,callback:N,objectProperties:e,propertyName:$,arrayPropertyIndex:X,index:t,setValue:w})},N.prototype.saveValue=function(M){var q=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,N=this._infoQueue[q],e=this.computValue(q);if(M&&N.setValue&&N.setValue(e),this.viewer&&this.viewer.update){var X=e;q!==this.viewerIndex&&(X=this.computValue(this.viewerIndex)),this.viewer.update(this.editor,X,this.splitView.getRightView())}},N.prototype.computValue=function(){var M=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,q=this.tabView.getTabModel().sm().ld(),N=void 0;N=this.objectProperties&&q===this.formTab?this.getDataValue():this.getValue();for(var e=this._infoQueue.length;--e>=M;){var X=this._infoQueue[e],w=this._infoQueue[e+1],$=w?w.propertyName:null;X.value||(X.value={}),$?null!=w.index?X.value[$][w.index]=N:X.value[$]=N:X.value=N,N=X.value}return VN(N)},N.prototype.ok=function(){(this._infoQueue.length>1||!this.tabView.getView().parentNode||this.tabView.getTabModel().sm().ld()!==this.formTab)&&this.saveValue(!0),this.hide()},N.prototype.onHidden=function(){q.prototype.onHidden.call(this),this._updatingData=!0,this.dataModel.getHistoryManager().clear(),this._updatingData=!1},N.prototype.canUndo=function(){return this.dataModel&&this.dataModel.getHistoryManager().canUndo()},N.prototype.canRedo=function(){return this.dataModel&&this.dataModel.getHistoryManager().canRedo()},N}(DN),Rw=function(M){function q(N){YN(this,q);var X=dN(this,M.call(this));X.editor=N,X.commentRowHeight=18,X.formPane=new WN,X.formPane.addRow([{id:"comment",element:X.createCommentGraph()}],[.1],90),X.formPane.addRow([{id:"text",element:xq({value:"",language:"text",minimap:{enabled:!1}})}],[.1],.1),X.$46$=X.formPane.getRows();var w=[];return w.push({label:e("editor.ok"),action:function(){X.ok()}}),w.push({label:e("editor.cancel"),action:function(){X.hide()}}),X.setConfig({closable:!0,draggable:!0,width:oN.config.textViewSize.width,height:oN.config.textViewSize.height,contentPadding:6,resizeMode:"wh",maximizable:!0,content:X.formPane,buttons:w,buttonsAlign:"right"}),X.setModal(!1),X}return rN(q,M),q.prototype.$48$=function(){this.hide()},q.prototype.$47$=function(){this.ok()},q.prototype.ok=function(){this.setValue&&this.setValue(this.formPane.v("text").replace(/\r/g,"")),this.hide()},q.prototype.open=function(M,q,N,e,X){this.setValue=q,this.setTitle(N),this.setFormatterTip(X),this.formPane.v("text",M||""),this.callback=e,
this.show(this.editor.$38$)},q.prototype.setFormatterTip=function(M){this._formatterTip=M,this.setFormRows()},q.prototype.setFormRows=function(){var M=this.formPane,q=this.$46$,N=this._formatterTip;2===M.getRows().length&&V(this.commentGraph.getView()),N&&_N(N)?(M._rows=q,this.commentNode.a("dataSource",N.map(function(M){var q=M.slice(0);return q[1]&&(q[1]=e(q[1])),q})),this.setCommentCollapse(!1)):M._rows=[q[1]],2===M.getRows().length&&M._contentDiv.appendChild(this.commentGraph.getView()),M.iv()},q.prototype.createCommentGraph=function(){var M=this,q=this.commentGraph=new ht.graph.GraphView;q.setRectSelectable(!1),q.setPannable(!1),q.getSelectWidth=function(){return 0},q.setZoomable(!1),q.setMovableFunc(function(){return!1}),q.setScrollBarVisible(!1);var N=q.dm(),e=this.commentNode=new ht.Node;return N.add(e),e.setImage("editor.function.comment"),e.a("param.visible",!1),e.s({fullscreen:"fill","fullscreen.gap":0,interactive:!0,pixelPerfect:!1,onEnter:function(M,q){q.a("background",oN.config.color_pane_dark)},onLeave:function(M,q){q.a("background",null)},onUp:function(q,N){var e=!N.a("collapse");M.setCommentCollapse(e)}}),e.a({collapse:!1,paramVisible:!1,rowHeight:this.commentRowHeight}),q},q.prototype.setCommentCollapse=function(M){this.commentNode.a("collapse",M),this.formPane.getRows()[0].height=this.commentRowHeight*(M?1:this._formatterTip.length+2),this.iv()},q}(DN),Gw=function(){function M(){YN(this,M)}return M.prototype.init=function(){var M=this.baseFonts=["monospace","sans-serif","serif"],q=this.testString="mmmmmmmmmmlli",N=this.testSize="72px",e=this.h=document.getElementsByTagName("body")[0],X=this.s=document.createElement("span");X.style.fontSize=N,X.innerHTML=q;var w=this.defaultWidth={},$=this.defaultHeight={};for(var t in M)X.style.fontFamily=M[t],e.appendChild(X),w[M[t]]=X.offsetWidth,$[M[t]]=X.offsetHeight,e.removeChild(X);this.initialized=!0},M.prototype.detect=function(M){this.initialized||this.init();var q=!1,N=this.baseFonts,e=this.s,X=this.h,w=this.defaultWidth,$=this.defaultHeight;for(var t in N){e.style.fontFamily=M+","+N[t],X.appendChild(e);var E=e.offsetWidth!=w[N[t]]||e.offsetHeight!=$[N[t]];X.removeChild(e),q=q||E}return q},M}(),jw=function(M){function q(N){YN(this,q);var e=dN(this,M.call(this));return e.editor=N,e}return rN(q,M),q.prototype.init=function(){var M=this;this._detector=new Gw;var q=this.borderPane=new xe,N=this.rightBorder=new xe,X=this.previewGraph=new ht.graph.GraphView,w=this.listView=new Ge,$=this.formPane=new WN;w.getView().style.borderRight="2px solid #f7f7f7",w.getLabelFont=function(M){return"14px "+M.getName()},q.setLeftView(w),q.setCenterView(N),q.setLeftWidth(180),N.setBottomView(X),N.setBottomHeight(120),N.setCenterView($),X.adjustTranslateX=function(){return 0},X.adjustTranslateY=function(){return 0},X.handleScroll=function(){return!1},X.setScrollBarVisible(!1);var t=this.textNode=new ht.Text;t.s({"2d.selectable":!1,text:oN.config.fontPreview}),t.setAnchor(0,0),t.setSize(2e3,120),t.p(4,4),X.dm().add(t);$.setVPadding(32),$.setVGap(18),$.setHGap(0),$.addRow([{element:e("editor.font.style"),align:"right"},"",{id:"normal",button:this.createStyleButton(e("editor.font.normal"))},{id:"bold",button:this.createStyleButton(e("editor.font.bold"))},{id:"oblique",button:this.createStyleButton(e("editor.font.oblique"))},{id:"obliqueBold",button:this.createStyleButton(e("editor.font.obliquebold"))}],[60,8,.1,.1,.1,.1],32),$.addRow([{element:e("editor.font.size"),align:"right"},"",{id:"fontSize",slider:{max:72,min:12,step:1,onValueChanged:function(q,N){$.getItemById("fontSizeLabel").element=N+"",$.iv(),M._handleFontChange()}}},{id:"fontSizeLabel",element:"12"}],[60,8,.1,20],32),$.addRow([{element:e("editor.output"),align:"right"},"",{id:"fontOutput",textField:{editable:!1,value:this.getFontString()}}],[60,8,.1],32);var E=[];E.push({label:e("editor.ok"),action:function(){M.ok()}}),E.push({label:e("editor.cancel"),action:function(){M.hide()}}),this.initFontList(),this.setConfig({closable:!0,draggable:!0,width:oN.config.fontViewSize.width,height:oN.config.fontViewSize.height,contentPadding:6,resizeMode:"wh",maximizable:!0,content:q,buttons:E,buttonsAlign:"right"}),this._init=!0,this.setModal(!1)},q.prototype.createStyleButton=function(M){var q=this;return{label:M,groupId:"fontStyle",labelSelectColor:oN.config.color_select,labelColor:"#2c2c2c",borderSelectColor:"red",background:"rgb(247,247,247)",selectBackground:"rgb(247,247,247)",togglable:!0,borderColor:null,onClicked:function(M){q._handleFontChange()}}},q.prototype.initFontList=function(){var M=this,q=this.listView,N=q.getView().style,e=q.dm(),X=this._detector,w=oN.config.fontList,$=oN.config.ignoreFontDetection;return q.sm().ms(function(q){M._handleFontChange(q)}),w.forEach(function(M){if($||ht.Default.getFontFaceMap()[M]||X.detect(M)){var q=new ht.Node;q.setIcon(null),q.setName(M),e.add(q)}}),e.sm().setSelectionMode("multiple"),N.background="white",q},q.prototype.reloadCustomFonts=function(){var M=this.listView.dm();if(M.toDatas(function(M){return!!M.a("custom")}).forEach(function(M){return M.removeFromDataModel()}),!(this.editor.componentView&&this.editor.componentView.isShowing()||!this.editor.dm)){var q=this.editor.dm.a("fontFaces");_N(q)&&q.length&&q.forEach(function(q){if(q&&q.name&&q.url){var N=new ht.Node;N.setIcon(null),N.setName(q.name),N.a("custom",!0),M.add(N,0)}})}},q.prototype.$48$=function(){this.hide()},q.prototype.$47$=function(){this.ok()},q.prototype._handleFontChange=function(){this.textNode.s("text.font",this.getFontString()),this.formPane.v("fontOutput",this.getFontString())},q.prototype.getFontString=function(){var M=this.listView,q=this.formPane,N=M.sm().getSelection().toArray(),e="",X=N.map(function(M){return M.getName()});return X.length||(X=["arial"]),["bold","oblique","obliqueBold"].forEach(function(M,N){q.getItemById(M).element.isSelected()&&(0===N?e="bold ":1===N?e="italic ":2===N&&(e="italic bold "))}),""+e+q.getValue("fontSize")+"px "+X.join(", ")},q.prototype.ok=function(){this.setValue&&this.setValue(this.getFontString()),this.hide()},q.prototype.analysisFontString=function(){var M=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ht.Default.labelFont;"string"!=typeof M&&(M=ht.Default.labelFont);var q=M.split(/px\s+/);q.length<2&&(q=ht.Default.labelFont.split(/px\s+/));var N=q[0].split(/\s+/),e=q[1].split(",").map(function(M){return M.trim()}),X=/\d+/,w=void 0,$=void 0,t=void 0;N.forEach(function(M){"bold"===M?w=!0:"oblique"===M||"italic"===M?$=!0:X.test(M)&&(t=parseInt(M))}),this.setFormValue(t,e,w,$)},q.prototype.setFormValue=function(M,q,N,e){var X=this.listView,w=this.formPane;X.sm().cs(),X.dm().each(function(M){q.forEach(function(q){M.getName().toLowerCase()===q.toLowerCase()&&X.sm().as(M)})});var $=0;N&&e?$=3:N?$=1:e&&($=2),["normal","bold","oblique","obliqueBold"].forEach(function(M,q){w.getItemById(M).element.setSelected($===q)}),w.getItemById("fontSizeLabel").element=M+"",w.setValue("fontSize",M)},q.prototype.open=function(M,q,N,e){this._init||this.init(),this.reloadCustomFonts(),this.setValue=q,this.setTitle(N),this.analysisFontString(M),this.callback=e,this.show(this.editor.$38$)},q}(DN),Kw=300,pw=230,Cw=function(q){function N(M){YN(this,N);var X=dN(this,q.call(this));X.editor=M,X.addRow([{id:"content",element:xq()}],[.1],.1),X.addRow([null,{button:{label:e("editor.ok"),onClicked:function(){X.hide(!0)}}},{button:{label:e("editor.cancel"),onClicked:function(){X.hide()}}}],[.1,50,50]),X.setWidth(Kw),X.setHeight(pw),X.getView().className="ht-editor-styleicons",X.getView().style.background=oN.config.color_pane,X.getView().style.border=oN.config.color_pane_dark+" solid 1px",X.getView().style.boxShadow="0px 0px 3px "+ht.Default.toolTipShadowColor,X.getView().style.overflow="visible";var w=function(M){!X.getView().parentNode||X.button.getView().contains(M.target)||X.getView().contains(M.target)||X.hide()};return window.addEventListener("mousedown",w,!1),window.addEventListener("touchstart",w,!1),X}return rN(N,q),N.prototype.toggle=function(M,q){this.getView().parentNode?this.hide():this.show(M,q)},N.prototype.show=function(M,q){if(!this.getView().parentNode){var N=M.getView().getBoundingClientRect(),e=(this.getView().style,Q());ht.Default.appendToScreen(this),this.getView().style.top=e.top+N.top+"px",this.getView().style.left=e.left+N.left-Kw-4+"px",this.iv(),this.button=M,this.data=q;var X=q.s("icons");this.v("content",X?d(X,void 0,!1):"")}},N.prototype.hide=function(){var q=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.getView().parentNode&&(V(this.getView()),q&&this.data.s("icons",M(this.v("content"))))},N}(WN),mw=function(){function M(q){var N=this;YN(this,M),this.editor=q;var e=this.container=ht.Default.createDiv(),X=this.wrap=ht.Default.createDiv(),w=e.style;w.pointerEvents="none",w.position="absolute",w.left=0,w.right=0,w.top=0,w.bottom=0,e.appendChild(X),w=X.style,w.width="500px",w.position="absolute",w.left="50%",w.bottom="20px",w.marginLeft="-300px",w.pointerEvents="none",this._cache=[],this._visibleCount=0,this.layoutContainer(),window.addEventListener("resize",function(){N.layoutContainer()})}return M.prototype.layoutContainer=function(){var M=this.container,q=ht.Default.getWindowInfo(),N=M.style;N.width=q.width+"px",N.height=q.height+"px"},M.prototype.createMessage=function(M){var q=this._cache.pop();if(!q){q=document.createElement("div");var N=q.style;N.boxSizing="border-box",N.padding=0,N.color="rgb(247,247,247)",N.margin="5px auto",N.textAlign="center",N.fontSize="14px",N.borderRadius="3px",N.height=0,N.overflow="hidden",N.pointerEvents="none",N.boxShadow="rgba(0,0,0,0.1) 1px 1px 2px",N.webkitTransition="0.3s all",N.mozTransition="0.3s all",N.msTransition="0.3s all",N.oTransition="0.3s all",N.transition="0.3s all"}return q.innerHTML=M,q},M.prototype.show=function(M){var q=this,N=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"normal",e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2e3,X=this.createMessage(M);this.wrap.appendChild(X),this._visibleCount||ht.Default.appendToScreen(this.container),this._visibleCount++,X.style.backgroundImage="normal"===N?"linear-gradient(rgba(95, 156, 210, 0.8),rgba(112, 193, 244, 0.3))":"linear-gradient(rgba(242,83,75,0.8),rgba(242,83,75,0.3))",setTimeout(function(){X.style.height="",X.style.padding="6px 12px",q.hideLater(X,e)},10)},M.prototype.hideLater=function(M,q){var N=this;setTimeout(function(){M.style.height=0,M.style.padding=0,setTimeout(function(){if(N.wrap.removeChild(M),N._cache.push(M),!--N._visibleCount){N.container.parentNode.removeChild(N.container)}},500)},q)},M}(),Ow=function(M){function q(N){YN(this,q);var e=dN(this,M.call(this));return e.editor=N,e}return rN(q,M),q.prototype.init=function(){var M=this,q=this.dm=new ht.DataModel,N=this.gv=new ht.graph.GraphView(q),X=this.rightFormPane=new WN,w=this.splitView=new Ke(N,X,"h",.6),$=this.targetNode=new ht.Node;$.setAnchor(0,0),$.p(0,0),$.s("2d.selectable",!1),N.dm().add($),N.setEditable(!0),N.addBottomPainter(function(M){var q=this.getViewRect();M.fillStyle="#cbd3d8",M.fillRect(q.x,q.y,q.width,q.height);var N=$.getRect();M.fillStyle="#fff",M.fillRect(N.x,N.y,N.width,N.height)});var t=[{label:e("editor.ok"),action:function(){M.editor.dm.a("attachPoints",M.toPointsData()),M.hide()}},{label:e("editor.cancel"),action:function(){M.hide()}}];this.setConfig({title:"\u5438\u9644\u70b9",content:w,closable:!0,draggable:!0,maximizable:!0,resizeMode:"wh",buttons:t,width:oN.config.attachPointsViewSize.width,height:oN.config.attachPointsViewSize.height}),this.$80$(),q.md(function(M){if("position"===M.property&&M.data!==$){var q=M.data,N=q.a("offsetX"),e=q.a("offsetY"),X=M.newValue.x-N,w=M.newValue.y-e;q.a({x:parseFloat((X/$.getWidth()).toFixed(2)),y:parseFloat((w/$.getHeight()).toFixed(2))})}}),N.mp(function(M){if("zoom"===M.property){var e=1/N.getZoom();q.each(function(M){M!==$&&M.setScale(e,e)})}}),this._init=!0},q.prototype.$80$=function(){var M=this,q=new pe(this.dm),N=this.tableView=q.getTableView();N.isVisible=function(q){return q!==M.targetNode},N.setEditable(!0),q.getView().style.border=oN.config.color_line+" solid 1px",q.addColumns([this.$73$("x",e("editor.attach.x"),70,function(q,N,e,X){var w=M.targetNode.getWidth();q.setX(w*e+(q.a("offsetX")||0))}),this.$73$("y",e("editor.attach.y"),70,function(q,N,e,X){var w=M.targetNode.getHeight();q.setY(w*e+(q.a("offsetY")||0))}),this.$73$("offsetX",e("editor.attach.offsetX"),70,function(q,N,e,X){q.a("offsetX",e);var w=M.targetNode.getWidth();q.setX(w*q.a("x")+e)}),this.$73$("offsetY",e("editor.attach.offsetY"),70,function(q,N,e,X){q.a("offsetY",e);var w=M.targetNode.getHeight();q.setY(w*q.a("y")+e)})]);var X=oN.config.customAttachPointsColumns;if(X&&X.length){var w=this.customColumns=X.map(function(q){return M.$73$(q.name,q.displayName,q.width||70,q.setter,"string")});q.addColumns(w)}this.rightFormPane.addRow([q],[.1],200),this.rightFormPane.addRow([{button:{icon:"editor.add",toolTip:e("editor.add"),onClicked:function(){M.add()}}},{button:{icon:"editor.delete",toolTip:e("editor.delete"),onClicked:function(){M.remove()}}}],[20,20],20)},q.prototype.add=function(){var M=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,q=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,N=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,e=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,X=arguments[4],w=new ht.Node,$=1/this.gv.getZoom();if(w.setImage("editor.attachPoint"),w.setScale($,$),w.a({x:M,y:q,offsetX:N,offsetY:e}),w.s({"2d.editable":!1}),X)for(var t in X)"x"!==t&&"y"!==t&&"offsetX"!==t&&"offsetY"!==t&&w.a(t,X[t]);var E=this.targetNode.getWidth(),J=this.targetNode.getHeight();return w.p(M*E+N,q*J+e),this.gv.dm().add(w),w},q.prototype.remove=function(){for(var M=this.dm.sm().getSelection().toArray(),q=M.length-1;q>=0;q--)this.dm.remove(M[q])},q.prototype.$73$=function(M,q,N,e){var X=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"number";return{name:M,tag:M,width:N,displayName:q,align:"center",editable:!0,valueType:X,getValue:function(q){return q.a(M)},setValue:e}},q.prototype.toPointsData=function(){var M=this;return this.dm.toDatas(function(q){return q!==M.targetNode}).toArray().map(function(q){var N={x:q.a("x"),y:q.a("y")};return q.a("offsetX")&&(N.offsetX=q.a("offsetX")),q.a("offsetY")&&(N.offsetY=q.a("offsetY")),M.customColumns&&M.customColumns.forEach(function(M){var e=q.a(M.name);e&&(N[M.name]=e)}),N})},q.prototype.$48$=function(){this.hide()},q.prototype.createNodeByPointData=function(){var M=this,q=this.editor.dm.a("attachPoints");q&&q.forEach(function(q){M.add(q.x,q.y,q.offsetX,q.offsetY,q)})},q.prototype.show=function(q){this._init||this.init(),this.dm.clear(),this.dm.add(this.targetNode),this.targetNode.setImage(q),this.createNodeByPointData(),M.prototype.show.call(this,this.editor.$38$),this.gv.fitContent(!0)},q}(DN),Qw=function(M){function q(N,e){return YN(this,q),dN(this,M.call(this,N,e,"display",!0))}return rN(q,M),q.prototype.initForm=function(){this.addCustomProperties(),this.$11$(),this.addHighlightProperties(),this.$77$()},q.prototype.isTitleVisible=function(q){return!!this.inspectorFilter.isDisplayTitleVisible(this.editor,q.title)&&M.prototype.isTitleVisible.call(this,q)},q.prototype.isPropertyVisible=function(q){return!!this.inspectorFilter.isDisplayPropertyVisible(this.editor,q.keys&&q.keys.name)&&M.prototype.isPropertyVisible.call(this,q)},q.prototype.$11$=function(){this.addTitle("TitleBasic");var M=[];this.addLabelInput(M,e("editor.previewurl"),function(M){return M.a("previewURL")},function(M,q){M.a("previewURL",q)}),this.addNameRow(M,"previewURL","a"),M=[],this.addLabelImage(M,e("editor.snapshoturl"),function(M){return M.a("snapshotURL")},function(M,q){M.a("snapshotURL",q)}),this.addNameRow(M,"snapshotURL","a"),M=[],this.addLabelColor(M,e("editor.background"),function(M){return M.getBackground()},function(M,q){M.setBackground(q)}),this.addNameRow(M,"background","p"),M=[],this.addLabelInput(M,e("editor.width"),function(M){return M.a("width")},function(M,q){M.a("width",q)},"number",1),this.addNameRow(M,"width","a"),M=[],this.addLabelInput(M,e("editor.height"),function(M){return M.a("height")},function(M,q){M.a("height",q)},"number",1),this.addNameRow(M,"height","a"),M=[];var q=[["Obejct","json","editor.comment.json"],["ht.DataModel","dm","editor.comment.datamodel"],["ht.graph.GraphView","view","editor.comment.graphview"]];this.addLabelFunction(M,e("editor.onpredeserialize"),function(M){return M.a("onPreDeserialize")},function(M,q){M.a("onPreDeserialize",q)},"onPreDeserialize",q),this.addNameRow(M,"onPreDeserialize","a"),M=[],q=[["Obejct","json","editor.comment.json"],["ht.DataModel","dm","editor.comment.datamodel"],["ht.graph.GraphView","view","editor.comment.graphview"],["ht.List","datas","editor.comment.datas"]],this.addLabelFunction(M,e("editor.onpostdeserialize"),function(M){return M.a("onPostDeserialize")},function(M,q){M.a("onPostDeserialize",q)},"onPostDeserialize",q),this.addNameRow(M,"onPostDeserialize","a"),M=[],this.addLabelComboBox(M,e("editor.connectactiontype"),function(M){return M.a("connectActionType")},function(M,q){M.a("connectActionType",q)},oN.consts.displayConnectActionTypes,oN.consts.displayConnectActionTypeLabels),this.addNameRow(M,"connectActionType","a"),M=[],this.addLabelCheckBox(M,e("editor.hierarchicalrendering"),function(M){return M.isHierarchicalRendering()},function(M,q){M.setHierarchicalRendering(q)}),this.addNameRow(M,"hierarchicalRendering","p"),M=[],this.addLabelCheckBox(M,e("editor.zoomable"),function(M){return null==M.a("zoomable")||M.a("zoomable")},function(M,q){M.a("zoomable",q)}),this.addNameRow(M,"zoomable","a"),M=[],this.addLabelCheckBox(M,e("editor.pannable"),function(M){return null==M.a("pannable")||M.a("pannable")},function(M,q){M.a("pannable",q)}),this.addNameRow(M,"pannable","a"),M=[],this.addLabelCheckBox(M,e("editor.rectselectable"),function(M){return null==M.a("rectSelectable")||M.a("rectSelectable")},function(M,q){M.a("rectSelectable",q)}),this.addNameRow(M,"rectSelectable","a"),M=[],this.addLabelCheckBox(M,e("editor.fitcontent"),function(M){return null!=M.a("fitContent")&&M.a("fitContent")},function(M,q){M.a("fitContent",q)}),this.addNameRow(M,"fitContent","a"),this.addLayoutProperties()},q.prototype.addLayoutProperties=function(){var M=[e("editor.layout")];this.$79$(M,"circular"),this.$79$(M,"symmetric"),this.$79$(M,"hierarchical"),this.$79$(M,"towardnorth"),this.$79$(M,"towardsouth"),this.$79$(M,"towardeast"),this.$79$(M,"towardwest"),this.addRow(M,[this.indent,.1,.1,.1,.1,.1,.1,.1]).keys={name:"layouts"}},q.prototype.$79$=function(M,q){var N=this,X=function(){N.editor.editable&&N.dataModel&&N.dataModel.layout(q)};return this.addButton(M,null,e("editor.layout."+q),"editor.layout."+q+".state",X)},q}(JX),sw={visible:"Boolean",selectable:"Boolean",movable:"Boolean",editable:"Boolean",opacity:"Opacity",clipPercentage:"Percentage",clipDirection:"ClipDirection",shadow:"Boolean",shadowColor:"Color",shadowBlur:"PositiveNumber",shadowOffsetX:"PositiveNumber",shadowOffsetY:"PositiveNumber",type:"String",background:"Color",repeatImage:"String",repeatImageStretch:"Stretch",repeatImageRotation:"Angle",borderWidth:"PositiveNumber",borderColor:"Color",border3d:"Boolean",border3dColor:"Color",border3dAccuracy:"PositiveNumber",borderCap:"CapStyle",borderJoin:"JoinStyle",gradient:"Gradient",gradientColor:"Color",dash:"Boolean",dashOffset:"Number",dashColor:"Color",dashWidth:"PositiveNumber",dash3d:"Boolean",dash3dColor:"Color",dash3dAccuracy:"PositiveNumber",borderWidthAbsolute:"Boolean",fillClipPercentage:"Percentage",fillClipDirection:"ClipDirection",depth:"Number",cornerRadius:"CornerRadius",polygonSide:"Int",arcFrom:"Number",arcTo:"Number",arcClose:"Boolean",arcOval:"Boolean",displayName:"String",scaleX:"Number",scaleY:"Number",anchorX:"Number",anchorY:"Number",rotation:"Angle",color:"Color",width:"PositiveNumber",label:"Boolean",labelColor:"Color",labelFont:"String",minValue:"Number",maxValue:"Number",linePoint:"Boolean",lineWidth:"PositiveNumber",line3d:"Boolean",text:"Multiline",align:"Align",vAlign:"VAlign",closePath:"Boolean",fillRule:"FillRule",name:"Image",stretch:"Stretch",values:"NumberArray",colors:"ColorArray",hollow:"Boolean",layoutV:"String",layoutH:"String",borderGradientPack:"GradientPack",vertical:"Boolean",verticalGap:"Number",wrap:"Boolean",letterGap:"Number",gradientPack:"GradientPack",font:"Font",outlineColor:"GradientPack",outlineWidth:"Number"},lw=function(M){function q(N,e){return YN(this,q),dN(this,M.call(this,N,e,"symbol",!0))}return rN(q,M),q.prototype.initForm=function(){this.addCustomProperties(),this.addControlProperties(),this.$11$(),this.addHighlightProperties(),this.$77$(),this.addDataBindingProperties()},q.prototype.isTitleVisible=function(q){return!!this.inspectorFilter.isSymbolTitleVisible(this.editor,q.title)&&M.prototype.isTitleVisible.call(this,q)},q.prototype.isPropertyVisible=function(q){return!!this.inspectorFilter.isSymbolPropertyVisible(this.editor,q.keys&&q.keys.name)&&M.prototype.isPropertyVisible.call(this,q)},q.prototype.$11$=function(){var M=this.indent,q=void 0;this.addTitle("TitleBasic"),q=[],this.addLabelInput(q,e("editor.previewurl"),function(M){return M.a("previewURL")},function(M,q){M.a("previewURL",q)}),this.addLabelImage(q,e("editor.snapshoturl"),function(M){return M.a("snapshotURL")},function(M,q){M.a("snapshotURL",q)}),this.addNameRow(q,"previewURL.snapshotURL",void 0,void 0,[M,this.w20,M,.1,20]),q=[],this.addLabelColor(q,e("editor.background"),function(M){return M.getBackground()},function(M,q){M.setBackground(q)}),this.addLabelComboBox(q,e("editor.connectactiontype"),function(M){return M.a("connectActionType")},function(M,q){M.a("connectActionType",q)},oN.consts.symbolConnectActionTypes,oN.consts.symbolConnectActionTypeLabels),this.addNameRow(q,"background.connectActionType",void 0,void 0,this.w1w1),q=[],this.addLabelInput(q,e("editor.width"),function(M){return M.a("width")},function(M,q){M.a("width",q)},"number",1),this.addFuncRow(q,"width"),q=[],this.addLabelInput(q,e("editor.height"),function(M){return M.a("height")},function(M,q){M.a("height",q)},"number",1),this.addFuncRow(q,"height"),q=[],this.addLabelInput(q,e("editor.boundextend"),function(M){return M.a("boundExtend")},function(M,q){M.a("boundExtend",q)},"number",1),this.addFuncRow(q,"boundExtend"),this.addStateProperty(),this.addAttachPointsProperties(),q=[],this.addLabelComboBox(q,e("editor.blendmode"),function(M){return M.a("blendMode")},function(M,q){M.a("blendMode",q)},["multiply","override","override_rgb","override_a"],[e("editor.blendmode.multiply"),e("editor.blendmode.override"),e("editor.blendmode.override_rgb"),e("editor.blendmode.override_a")]),this.addFuncRow(q,"blendMode")},q.prototype.addEventsAndRenderHTMLProperties=function(){var M=this,q=[];this.addEventProperties(q);var N=function(){M.editor.functionView.open(M.getValue(function(M){return M.a("renderHTML")}),function(q){M.setValue(function(M,q){return M.a("renderHTML",q)},q)},e("editor.renderhtml"),[["ht.Node","data","editor.comment.renderhtmlnode"],["ht.graph.GraphView","gv","editor.comment.graphview"],["Object","cache","editor.comment.renderhtmlcache"]])},X=this.addButton(q,e("editor.renderhtml"),null,null,N,!0);this.updateHandlers.push(function(){if(!q.hidden){var N=M.getValue(function(M){return M.a("renderHTML")});X.setLabelColor(N?oN.config.color_select:ht.Default.labelColor)}}),this.addNameRow(q,"eventHandlers.renderhtml",void 0,void 0,[this.indent,.1,.1])},q.prototype.addControlProperties=function(){var M=this;this.addTitle("TitleControl"),this.addEventsAndRenderHTMLProperties();var q=[];if(this.addLabelCheckBox(q,e("editor.visible"),function(M){return M.a("visible")},function(M,q){M.a("visible",q)}),this.addFuncRow(q,"visible"),q=[],this.addLabelCheckBox(q,e("editor.clip"),function(M){return M.a("clip")},function(M,q){M.a("clip",q)}).onValueChanged=function(q,N){M.dataModel&&(N?M.dataModel.a("clip")||M.dataModel.a("clip",!0):M.dataModel.a("clip",!1))},this.addFuncRow(q,"clip"),q=[],this.addLabelCheckBox(q,e("editor.scrollable"),function(M){return M.a("scrollable")},function(M,q){M.a("scrollable",q)}),this.addFuncRow(q,"scrollable"),q=[],this.addLabelCheckBox(q,e("editor.interactive"),function(M){return M.a("interactive")},function(M,q){M.a("interactive",q)}),this.addFuncRow(q,"interactive"),q=[],this.addLabelCheckBox(q,e("editor.disableselectedborder"),function(M){return M.a("disableSelectedBorder")},function(M,q){M.a("disableSelectedBorder",q)}),this.addFuncRow(q,"disableSelectedBorder"),q=[],this.addLabelCheckBox(q,e("editor.pixelperfect"),function(M){return M.a("pixelPerfect")},function(M,q){M.a("pixelPerfect",q)}),this.addFuncRow(q,"pixelPerfect"),q=[],this.addLabelCheckBox(q,e("editor.cacherule"),function(M){return M.a("cacheRule")},function(M,q){M.a("cacheRule",q)}),this.addFuncRow(q,"cacheRule"),q=[],this.addLabelCheckBox(q,e("editor.texturecache"),function(M){return M.a("textureCache")},function(M,q){M.a("textureCache",q)}),this.addFuncRow(q,"textureCache"),q=[],this.addLabelCheckBox(q,e("editor.fitsize"),function(M){return M.a("fitSize")},function(M,q){M.a("fitSize",q)}),this.addFuncRow(q,"fitSize"),oN.SceneView){q=[];var N=function(){M.editor.symbolLayoutView.open(M.getValue(function(M){return M.a("layoutAttach")}),M.getValue(function(M){return M.a("layoutProperties")}),function(q){M.beginTransaction(),M.setValue(function(M,q){return M.a("layoutAttach",q)},q.func),M.setValue(function(M,q){return M.a("layoutProperties",q)},q.properties),M.endTransaction()})};this.addLabel(q,e("editor.layout"));var X=this.addButton(q,e("editor.layoutattach"),null,null,N,!0);this.addRow(q,this.w1),this.updateHandlers.push(function(){if(!q.hidden){var N=M.getValue(function(M){return M.a("layoutAttach")});X.setLabelColor(N?oN.config.color_select:ht.Default.labelColor)}})}},q.prototype.addDataBindingProperties=function(){this.addTitle("TitleDataBinding"),this.$80$(),this.$81$()},q.prototype.$73$=function(M,q,N,e,X){var w=this,$={name:M,tag:M,width:N,displayName:q,align:"center",enum:e,editable:!0,valueType:X,getValue:function(q){var N=q.dataBinding[M];return"bindable"===M&&null==N&&(N=!0),N},setValue:function(q,N,e,X){q.dataBinding[M]!==e&&w.modifyDataBindings(function(){"valueType"===M&&delete q.dataBinding.defaultValue,q.dataBinding[M]=e})}};return"defaultValue"===M&&($.getColorPicker=function(M){return"Color"===M.dataBinding.valueType?{editor:w.editor}:null}),$},q.prototype.$74$=function(){var M=this,q=this.tableView.getColumnModel().getDataByTag("defaultValue");q.getValue=function(M,q,N){var e=M.dataBinding.defaultValue;return"Angle"===M.dataBinding.valueType&&e&&(e=e/Math.PI*180),e},q.setValue=function(q,N,e,X){M.modifyDataBindings(function(){"Angle"===q.dataBinding.valueType&&(e=e*Math.PI/180),q.dataBinding.defaultValue=e})},q.getEnumValues=function(M){var q=M?oN.config.valueTypes[M.dataBinding.valueType]:null;return q&&"enum"===q.type?q.values:null},q.getEnumLabels=function(M){var q=M?oN.config.valueTypes[M.dataBinding.valueType]:null;return q&&"enum"===q.type?q.labels:null},q.getEnumIcons=function(M){var q=M?oN.config.valueTypes[M.dataBinding.valueType]:null;return q&&"enum"===q.type?q.icons:null},q.getEnumDropDownWidth=function(M){var q=M?oN.config.valueTypes[M.dataBinding.valueType]:null;return q&&"enum"===q.type?q.dropDownWidth:null},q.getValueType=function(M){var q=M?oN.config.valueTypes[M.dataBinding.valueType]:null;return q?q.type:null},q.isCellEditable=function(q,N,X,w){var $=q.dataBinding.valueType,t=oN.config.valueTypes[$],E=t?t.type:null,J=q.dataBinding.extraInfo,u=oN.config.handleDefaultVauleColumnEdit,g=function(N){M.modifyDataBindings(function(){q.dataBinding.defaultValue=N,M.tableView.redraw()})};if(u&&u(g,t,E,J))return!1;if("function"===E){var S=e("editor.function")+" "+(q.dataBinding.attr||"");return M.editor.functionView.open(q.dataBinding.defaultValue,g,S,J&&J.arguments),!1}if("multiline"===E)return M.editor.textView.open(q.dataBinding.defaultValue,g,q.dataBinding.attr||"&nbsp;"),!1;if("font"===E)return M.editor.fontView.open(q.dataBinding.defaultValue,g,q.dataBinding.attr||"&nbsp;"),!1;if("object"===E||"stringArray"===E||"custom"===E||"objectArray"===E||"numberArray"===E&&"DashPattern"!==$||"colorArray"===E||"gradientPackArray"===E){var b=e("editor.object")+" "+(q.dataBinding.attr||"");return M.editor.objectView.open(q.dataBinding.defaultValue,g,b,null,"object"===E&&J&&J.objectProperties),!1}return"dataModel"!==E||(M.editor.dataModelView.open(q.dataBinding.defaultValue,g,M.editor.editable,J),!1)};var N=this.tableView,X=N.drawCell;N.editor=this.editor,q.getItemEditor=function(M){var q=M.dataBinding.valueType,N=M?oN.config.valueTypes[q]:null;if(N){if("gradientPack"===N.type)return EX;if("DashPattern"===q)return de}return null},this.tableView.drawCell=function(M,N,e,w,$,t,E,J){var u=N?oN.config.valueTypes[N.dataBinding.valueType]:null;if(w===q&&u&&"gradientPack"===u.type){var g=N.dataBinding.defaultValue;if(!g)return;var S=void 0,b=!1;_N(g)&&g.length>1?(S=Iq(M,g,{x:$,y:t,width:E,height:J}),b=!0):S=g,M.fillStyle=S,M.fillRect($,t,E,J),b&&M.restore()}else X.call(this,M,N,e,w,$,t,E,J)}},q.prototype.initExtraInfoColumn=function(){var M=this;this.tableView.getColumnModel().getDataByTag("extraInfo").isCellEditable=function(q,N,X,w){var $=e("editor.object")+" "+(q.dataBinding.attr||"");return M.editor.objectView.open(q.dataBinding.extraInfo,function(N){M.modifyDataBindings(function(){q.dataBinding.extraInfo=N,M.tableView.redraw()})},$),!1}},q.prototype.initI18nColumn=function(){var M=this;["name","group"].forEach(function(q){var N=M.tableView.getColumnModel().getDataByTag(q);N.getValue=function(M,N,X){var w=M.dataBinding[q];return M._editing_?w:e(w)},N.setValue=function(N,e,X,w){delete N._editing_,N.dataBinding[q]!==X&&M.modifyDataBindings(function(){N.dataBinding[q]=X})},N.isCellEditable=function(M,q,N,e){return M._editing_=1,!0}})},q.prototype.$80$=function(){var M=this,q=this.tableModel=new ht.DataModel,N=this.tablePane=new pe(q),X=this.tableView=N.getTableView();X.setEditable(!0),X.isEditable=function(){return M.editor.editable},N.getView().style.border=oN.config.color_line+" solid 1px",N.addColumns([this.$73$("attr",e("editor.attr"),90),this.$73$("valueType",e("editor.valuetype"),80,{values:oN.consts.valueTypes,labels:oN.consts.valueTypeLabels}),this.$73$("defaultValue",e("editor.defaultvalue"),90),this.$73$("name",e("editor.name"),80),this.$73$("group",e("editor.group"),80),this.$73$("bindable",e("editor.bindable"),50,void 0,"boolean"),this.$73$("fixed",e("editor.fixed"),40,void 0,"boolean"),this.$73$("description",e("editor.description"),120),this.$73$("extraInfo",e("editor.extrainfo"),100)]),this.$74$(),this.initExtraInfoColumn(),this.initI18nColumn();var w=[N];this.addRow(w,[.1],"120+0.1");var $=null;this.updateHandlers.push(function(){if(!w.hidden&&M.dataModel&&(!$||M.dataModel.dataBindings!==$)){$=M.dataModel.dataBindings;var N=q.sm().toSelection().toArray();if(q.clear(),M.dataModel.dataBindings){var e=void 0;M.dataModel.dataBindings.forEach(function(X,w){var $=new ht.Data;$.dataBinding=X,q.add($),w===M.newDataBindingIndex&&(M.tableView.sm().ss($),e=$,delete M.newDataBindingIndex,delete M.addingDataBindingByButton);for(var t=0;t<N.length;t++)if(aM(N[t].dataBinding,X)){E(N,N[t]),q.sm().as($);break}}),setTimeout(function(){e&&(M.tableView.tx(0),mq(M.tableView,e,M.tableView.getColumnModel().getDataByTag("attr")))},100)}}})},q.prototype.modifyDataBindings=function(M){var q=VN(this.dataModel.dataBindings);M();var N=VN(this.dataModel.dataBindings);this.dataModel.dataBindings=N,this.dataModel.fp("f:dataBindings",q,N)},q.prototype.$82$=function(M,q,N,e,X,w,$,t){var E=new ht.Data;E.dataBinding={attr:M||"",valueType:q||"String",defaultValue:N,name:e,description:X,group:w,extraInfo:$},t&&(E.dataBinding.fixed=!0);var J={symbolView:this.editor.symbolView,dataBinding:E.dataBinding};if(this.editor.fireEvent("dataBindingAdding",J),J.preventDefault)return!1;E.dataBinding=J.dataBinding,
this.dataModel.dataBindings||(this.dataModel.dataBindings=[]);var u=this.tableModel.sm().ld(),g=void 0;if(u){var S=this.tableModel.getRoots().indexOf(u);this.dataModel.dataBindings.splice(S+1,0,E.dataBinding),g=S+1}else this.dataModel.dataBindings.push(E.dataBinding),g=this.tableModel.size();this.addingDataBindingByButton&&(this.newDataBindingIndex=g)},q.prototype.add=function(){var M=this;this.modifyDataBindings(function(){M.addingDataBindingByButton=!0,M.$82$()})},q.prototype.delete=function(){var M=this;this.tableView.sm().ld()&&this.modifyDataBindings(function(){M.tableView.sm().each(function(q){E(M.dataModel.dataBindings,q.dataBinding)})})},q.prototype.reorder=function(){var M=this;this.dataModel.dataBindings=[],this.tableModel.getRoots().each(function(q){M.dataModel.dataBindings.push(q.dataBinding)})},q.prototype.import=function(){var M=this;this.modifyDataBindings(function(){oN.config.clearDataBindingsBeforeImporting&&(M.dataModel.dataBindings=(M.dataModel.dataBindings||[]).filter(function(M){return M.fixed}));var q=M.editor.symbolView.content,N={};M.prefixStack=[],q.dataBindings&&q.dataBindings.forEach(function(M){N[M.attr]=!0}),M.addCompDataBinding(q,N),M.prefixStack=[]})},q.prototype.addCompDataBinding=function(M,q,N){var e=this,X=void 0;for(var w in M)if("comps"!==w){var $=M[w];mM($)&&this.addPropertyDataBinding(null,w,$,q)}N&&M.dataBindings&&M.dataBindings.forEach(function(M){var N=M.attr,X=M.valueType,w=M.defaultValue,$=M.name,t=M.description,E=M.group,J=M.extraInfo;N=e.currentPrefix+N,q[N]||(e.$82$(N,X,w,$,t,E,J),q[N]=!0)}),M.comps&&M.comps.forEach(function(M){var N=M.prefix;N&&e.prefixStack.push(N);for(var w in M){var $=M[w];mM($)&&e.addPropertyDataBinding(M,w,$,q)}"image"===M.type&&(X=ht.Default.getImage(M.name))&&e.addCompDataBinding(X,q,!0),N&&e.prefixStack.pop()})},q.prototype.addPropertyDataBinding=function(M,q,N,e){if(kN(N.func)&&BN.test(N.func)){var X=this.currentPrefix+N.func.slice(5);if(!e[X]){var w=void 0,$=void 0,t=void 0,E=void 0,J=void 0;if(M&&(gM(M.type)||kN(M.type)&&M.type.startsWith(cN))){var u=ht.Default.getCompType(M.type);if(u){var g=u.properties[q];g?(w=g.valueType,$=g.name,t=g.description,E=g.extraInfo,J=g.group):w=sw[q]}}else w=sw[q],["text","roundRect"].includes(M.type)&&"CornerRadius"===w&&(E={uvMode:!0});this.$82$(X,w,void 0,$,t,J,E),e[X]=!0}}else{var S={};fq(N,S);for(var b in S)e[b]||this.$82$(b,sw[S[b]])}},q.prototype.$81$=function(){var M=this,q=function(){return this.isPressed()?oN.config.color_select:oN.config.color_dark},N=oN.config.importDataBindingsButtonVisible?Jq(null,e("editor.import"),"editor.import",function(){M.editor.editable&&M.import()}):null,X=[Jq(null,e("editor.add"),"editor.add",function(){M.editor.editable&&M.add()}),Jq(null,e("editor.delete"),"editor.delete",function(){M.editor.editable&&M.delete()}),N,null,Jq(null,e("editor.bringtofront"),"editor.top",function(){M.editor.editable&&M.tableView.sm().size()&&M.modifyDataBindings(function(){M.tableModel.moveSelectionToTop(),M.reorder()})}),Jq(null,e("editor.bringforward"),"editor.up",function(){M.editor.editable&&M.tableView.sm().size()&&M.modifyDataBindings(function(){M.tableModel.moveSelectionUp(),M.reorder()})}),Jq(null,e("editor.sendbackward"),"editor.down",function(){M.editor.editable&&M.tableView.sm().size()&&M.modifyDataBindings(function(){M.tableModel.moveSelectionDown(),M.reorder()})}),Jq(null,e("editor.sendtoback"),"editor.bottom",function(){M.editor.editable&&M.tableView.sm().size()&&M.modifyDataBindings(function(){M.tableModel.moveSelectionToBottom(),M.reorder()})})];X.forEach(function(M){M instanceof ht.widget.Button&&(M.getIconColor=q)}),this.addRow(X,[20,20,20,.1,20,20,20,20])},q.prototype.addAttachPointsProperties=function(){var M=this,q=[],N=function(){M.editor.attachPointsView.show(M.editor.symbolView.content)};this.addLabel(q,e("editor.attach.points"));var X=this.addButton(q,e("editor.attach.edit"),null,null,N,!0);this.addFuncRow(q,"attachPoints"),this.updateHandlers.push(function(){if(!q.hidden){var N=M.getValue(function(M){return M.a("attachPoints")});X.setLabelColor(N&&N.length?oN.config.color_select:ht.Default.labelColor)}}),q=[],this.addLabelComboBox(q,e("editor.attach.style"),function(M){return M.a("attachStyle")||"close"},function(M,q){M.a("attachStyle",q)},["close","strict"],[e("editor.attach.close"),e("editor.attach.strict")]),this.addFuncRow(q,"attachStyle")},q.prototype.addStateProperty=function(){var M=this;if(oN.SceneView){var q=[];this.addLabel(q,e("editor.state"));var N=new ht.widget.ComboBox;N.onValueChanged=function(){M.editor.dm.a("state",N.getValue())},this.updateHandlers.push(function(){if(!q.hidden){var e=M.editor.dm.a("state"),X=M.editor.symbolStatePane.getAllStateEnum(),w=[],$=[];X&&X.length&&(w=X.map(function(M){return M.value}),$=X.map(function(M){return M.label||M.value}),w.unshift(void 0),$.unshift("")),N.setValues(w),N.setLabels($),N.getValue()!==e&&N.setValue(e)}}),q.push(N),this.addFuncRow(q,"state")}},IN(q,[{key:"currentPrefix",get:function(){var M=this.prefixStack,q="";return M&&M.length&&(q=M.join(".")+"."),q}}]),q}(JX),Yw=function(M){function q(N,e){return YN(this,q),dN(this,M.call(this,N,e,"data"))}return rN(q,M),q.prototype.isTitleVisible=function(q){return!!this.inspectorFilter.isDataTitleVisible(this.editor,this.data,q.title)&&M.prototype.isTitleVisible.call(this,q)},q.prototype.isPropertyVisible=function(q){return!!this.inspectorFilter.isDataPropertyVisible(this.editor,this.data,q.keys&&q.keys.accessType,q.keys&&q.keys.name)&&M.prototype.isPropertyVisible.call(this,q)},q.prototype.addDBInput=function(M,q,N,e,X){var w=[];return this.addLabelInput(w,q,b(M,N),h(M,N),e,X),this.addDBRow(w,M,N)},q.prototype.addDBLabel=function(M,q,N){var e=[];return this.addLabelLabel(e,q,b(M,N),h(M,N)),this.addDBRow(e,M,N)},q.prototype.addDBCheckBox=function(M,q,N){var e=[];return this.addLabelCheckBox(e,q,b(M,N),h(M,N)),this.addDBRow(e,M,N)},q.prototype.addDBImage=function(M,q,N){var e=[];return this.addLabelImage(e,q,b(M,N),h(M,N)),this.addDBRow(e,M,N)},q.prototype.addDBColor=function(M,q,N){var e=[],X=function(q,e){"shape.background"===N&&q.s("shape.gradient.pack")&&q.s("shape.gradient.pack",void 0),h(M,N)(q,e)};return this.addLabelColor(e,q,b(M,N),X),this.addDBRow(e,M,N)},q.prototype.addDBFont=function(M,q,N){var e=[];return this.addLabelFont(e,q,b(M,N),h(M,N)),this.addDBRow(e,M,N)},q.prototype.addDBDashPattern=function(M,q,N){var e=[];return this.addLabelDashPattern(e,q,b(M,N),h(M,N)),this.addDBRow(e,M,N)},q.prototype.addDBPattern=function(M,q,N){var e=[];return this.addLabelInput(e,q,b(M,N),h(M,N),"pattern"),this.addDBRow(e,M,N)},q.prototype.addDBRotation=function(M,q,N){var e=[];return this.addLabelRotation(e,q,b(M,N),h(M,N)),this.addDBRow(e,M,N)},q.prototype.addDBAlign=function(M,q,N){var e=[];return this.addLabelAlign(e,q,b(M,N),h(M,N)),this.addDBRow(e,M,N)},q.prototype.addDBVAlign=function(M,q,N){var e=[];return this.addLabelVAlign(e,q,b(M,N),h(M,N)),this.addDBRow(e,M,N)},q.prototype.addDBOrientation=function(M,q,N){var e=[];return this.addLabelOrientation(e,q,b(M,N),h(M,N)),this.addDBRow(e,M,N)},q.prototype.addDBComboBox=function(M,q,N,e,X,w){var $=[];return this.addLabelComboBox($,q,b(M,N),h(M,N),e,X,w),this.addDBRow($,M,N)},q.prototype.addDBStretch=function(M,q,N){var e=[];return this.addLabelStretch(e,q,b(M,N),h(M,N)),this.addDBRow(e,M,N)},q.prototype.addDBZeroToOne=function(M,q,N){var e=[];return this.addLabelRange(e,q,b(M,N),h(M,N),0,1,.01,"number"),this.addDBRow(e,M,N)},q.prototype.addDBPosition=function(M,q,N){var e=[];return this.addLabelPosition(e,q,b(M,N),h(M,N)),this.addDBRow(e,M,N)},q.prototype.addDBRange=function(M,q,N,e,X,w,$){var t=[];return this.addLabelRange(t,q,b(M,N),h(M,N),e,X,w,$),this.addDBRow(t,M,N)},q.prototype.addDBCornerRadius=function(M,q,N){var e=[];return this.addLabelCornerRadius(e,q,b(M,N),h(M,N),void 0,!0,!1),this.addDBRow(e,M,N)},q.prototype.addDBGradient=function(M,q,N,e){var X=[];return this.addLabelGradient(X,M,q,N,e),this.addDBRow(X,"s",q)},q.prototype.addDBGradientPack=function(M,q,N){var e=[];return this.addLabelGradientPack(e,q,b(M,N),h(M,N)),this.addDBRow(e,"s",N)},q.prototype.addDBBodyColorProperty=function(){this.addDBColor("s",e("editor.bodycolor"),"body.color")},q.prototype.addDBOpacityProperty=function(){this.addDBZeroToOne("s",e("editor.opacity"),"opacity")},q.prototype.$83$=function(){var M=[];return this.addLabelIcons(M),this.addDBRow(M,"s","icons")},q.prototype.addDBData=function(M,q,N,e){var X=[];return this.addLabelData(X,q,b(M,N),e||h(M,N)),this.addDBRow(X,M,N)},q.prototype.addDBMultiline=function(M,q,N){var e=[];return this.addLabelMultiline(e,q,b(M,N),h(M,N)),this.addDBRow(e,M,N)},q.prototype.$27$=function(){var M=this;this.addTitle("TitleBasic");var q=[];this.addLabelInput(q,e("editor.classname"),function(M){return M.getClassName()}),this.addRow(q,this.w1).keys={accessType:"p",name:"className"},this.addDBInput("p",e("editor.name"),"displayName"),q=[],this.addLabelInput(q,e("editor.tag"),b("p","tag"),function(q,N){if(oN.config.checkTagConflicts&&N)for(var X=M.dataModel,w=X.getDatas(),$=w.size()-1;$>=0;$--){var t=w.get($);if(t!==q&&t.getTag()===N)return M.editor.showMessage(nq(e("editor.errormessage.tagalreadyexists"),N),"error"),void M.$34$()}q.setTag(N)}),this.addDBRow(q,"p","tag"),this.addDBImage("p",e("editor.icon"),"icon"),this.addDBData("p",e("editor.parent"),"parent")},q.prototype.$29$=function(){this.addTitle("TitleLabel"),this.addDBMultiline("s",e("editor.content"),"label"),this.addDBFont("s",e("editor.font"),"label.font"),this.addDBColor("s",e("editor.color"),"label.color"),this.addDBColor("s",e("editor.background"),"label.background"),this.addDBPosition("s",e("editor.position"),"label.position"),this.addDBInput("s",e("editor.offsetx"),"label.offset.x","number",1),this.addDBInput("s",e("editor.offsety"),"label.offset.y","number",1),this.addDBInput("s",e("editor.maxlength"),"label.max","number",1),this.addDBRotation("s",e("editor.rotation"),"label.rotation"),this.addDBZeroToOne("s",e("editor.opacity"),"label.opacity"),this.addDBRange("s",e("editor.scale"),"label.scale",.01,100,.1,"number"),this.addDBAlign("s",e("editor.align"),"label.align"),this.addDBCheckBox("s",e("editor.fixed"),"label.position.fixed")},q.prototype.$30$=function(){this.addTitle("TitleNote"),this.addDBMultiline("s",e("editor.content"),"note"),this.addDBFont("s",e("editor.font"),"note.font"),this.addDBColor("s",e("editor.color"),"note.color"),this.addDBColor("s",e("editor.background"),"note.background"),this.addDBInput("s",e("editor.borderwidth"),"note.border.width","number",1),this.addDBColor("s",e("editor.bordercolor"),"note.border.color"),this.addDBPosition("s",e("editor.position"),"note.position"),this.addDBInput("s",e("editor.offsetx"),"note.offset.x","number",1),this.addDBInput("s",e("editor.offsety"),"note.offset.y","number",1),this.addDBZeroToOne("s",e("editor.opacity"),"note.opacity"),this.addDBRange("s",e("editor.scale"),"note.scale",.01,100,.1,"number"),this.addDBInput("s",e("editor.maxlength"),"note.max","number",1),this.addDBAlign("s",e("editor.align"),"note.align"),this.addDBCheckBox("s",e("editor.toggleable"),"note.toggleable"),this.addDBCheckBox("s",e("editor.expanded"),"note.expanded")},q.prototype.addDBLayer=function(){var M=[];this.addLabelLayer(M);var q=this.addDBRow(M,"p","layer");return q.items.tag="layer",q},q.prototype.addDBGray=function(){this.addDBCheckBox("s",e("editor.gray"),"2d.gray")},q.prototype.addDBClipPercentage=function(M,q,N){var e=b(M,N),X=h(M,N),w=[];this.addLabelClipPercentage(w,q,e,X,void 0,b(M,N.replace("percentage","direction"))),this.addDBRow(w,M,N)},q.prototype.$19$=function(){this.addTitle("TitleShadow"),this.addDBCheckBox("s",e("editor.shadow"),"shadow2"),this.addDBColor("s",e("editor.color"),"shadow2.color"),this.addDBRange("s",e("editor.shadowblur"),"shadow2.blur",0,void 0,1,"number"),this.addDBRange("s",e("editor.shadowoffsetx"),"shadow2.offset.x",0,void 0,1,"number"),this.addDBRange("s",e("editor.shadowoffsety"),"shadow2.offset.y",0,void 0,1,"number")},q}(JX),Iw={TitleShapeBackground:!0,TitleShapeForeground:!0,TitleShapeBorder:!0,TitleShapeDash:!0},rw=function(M){function q(N,e){return YN(this,q),dN(this,M.call(this,N,e))}return rN(q,M),q.prototype.initForm=function(){this.addCustomProperties(),this.addControlProperties(),this.addLayoutProperties(),this.$27$(),this.$91$(),this.$28$(),this.$29$(),this.$30$(),this.$25$()},q.prototype.addControlProperties=function(){this.addTitle("TitleControl"),this.addEventProperties(),this.addDBComboBox("s",e("editor.movemode"),"2d.move.mode",[void 0,"x","y"],["",e("editor.horizontal"),e("editor.vertical")]),this.addDBCheckBox("s",e("editor.ingroup"),"ingroup"),this.addDBCheckBox("s",e("editor.visible"),"2d.visible"),this.addDBCheckBox("s",e("editor.selectable"),"2d.selectable"),this.addDBCheckBox("s",e("editor.movable"),"2d.movable"),this.addDBCheckBox("s",e("editor.editable"),"2d.editable"),this.addDBCheckBox("s",e("editor.pixelperfect"),"pixelPerfect")},q.prototype.$27$=function(){M.prototype.$27$.call(this),this.addDBGray(),this.addDBLayer(),this.addDBInput("p",e("editor.tooltip"),"toolTip"),this.addDBBodyColorProperty(),this.addDBOpacityProperty(),this.$83$(),this.addDBState(),this.$84$()},q.prototype.addActionLabelNodeImage=function(M){this.addLabelNodeImage(M,{accessType:"p",name:"image"})},q.prototype.addLabelNodeImage=function(M,q){var N=this;M.forceToUpdate=!0,this.addLabelImage(M,e("editor.image"),function(M){var q=M.getImage(),e=ht.Default.getImage(q);return N.$85$(mM(e)?e.dataBindings:null,e),q},function(M,q){M.setImage&&(kN(q)&&q.endsWith("[...]")||M.setImage(q))},q),this.addButton(M,null,e("editor.resetsize"),"editor.resetsize.state",function(M){M instanceof ht.Node&&M.setSize(-1,-1)})},q.prototype.$91$=function(){this.addDBStretch("s",e("editor.stretch"),"image.stretch").items.tag="imageRelative",this.addDBComboBox("s",e("editor.shape"),"shape",oN.consts.shapes,oN.consts.shapeLabels,oN.consts.shapeIcons);var M=[];this.addLabelNodeImage(M),this.imageRow=this.addDBRow(M,"p","image"),this.imageRow.items.tag="imageRelative"},q.prototype.addLayoutProperties=function(){var M=this;this.addTitle("TitleLayout"),this.addDBInput("p",e("editor.posx"),"x","number",1),this.addDBInput("p",e("editor.posy"),"y","number",1),this.addDBInput("p",e("editor.width"),"width","number",1),this.addDBInput("p",e("editor.height"),"height","number",1),this.addDBRotation("p",e("editor.rotation"),"rotation");var q=[],N=void 0;this.addLabelInput(q,e("editor.scalex"),b("p","scaleX"),h("p","scaleX"),"number",.01),this.addButton(q,null,e("editor.flipx"),"editor.flipx",function(M){M instanceof ht.Node&&M.setScaleX(-M.getScaleX())}),this.addDBRow(q,"p","scaleX"),q=[],this.addLabelInput(q,e("editor.scaley"),b("p","scaleY"),h("p","scaleY"),"number",.01),this.addButton(q,null,e("editor.flipy"),"editor.flipy",function(M){M instanceof ht.Node&&M.setScaleY(-M.getScaleY())}),this.addDBRow(q,"p","scaleY"),q=[],this.addLabelInput(q,e("editor.anchorx"),function(M){return M.getAnchor().x},function(M,q){M instanceof ht.Node&&M.setAnchor(q,M.getAnchor().y,!0)},"number",.01),this.addDBRow(q,"p","anchorX"),q=[],this.addLabelInput(q,e("editor.anchory"),function(M){return M.getAnchor().y},function(M,q){M instanceof ht.Node&&M.setAnchor(M.getAnchor().x,q,!0)},"number",.01),this.addDBRow(q,"p","anchorY"),this.addDBData("p",e("editor.host"),"host",function(M,q){!M.s("fullscreen")&&M instanceof ht.Node&&(null==q||q instanceof ht.Node)&&M.setHost(q)}).items.tag="host",this.addUpdateHandler(function(){M.updateSymbolLayoutProperties()}),oN.config.layoutEnabled&&(this.addDBComboBox("s",e("editor.fullscreen"),"fullscreen",oN.consts.fullscreenValues,oN.consts.fullscreenLabels).items.tag="fullscreen",this.addDBComboBox("s",e("editor.fullscreen.lock"),"fullscreen.lock",oN.consts.fullscreenLockValues,oN.consts.fullscreenLockLabels).items.tag="fullscreenDetail",this.addDBInput("s",e("editor.fullscreen.gap"),"fullscreen.gap","number",1).items.tag="fullscreenDetail",this.addNameRow([null,{element:this.addLayoutView()},null],"layoutView",void 0,100,[.1,100,.1]).items.tag="nodeLayout",N=this.addDBComboBox("s",e("editor.nodeLayout.h"),"layout.h",oN.consts.hLayoutValues,oN.consts.hLayoutLabels),N.items.tag="nodeLayout",this.layoutVRow=N=this.addDBComboBox("s",e("editor.nodeLayout.v"),"layout.v",oN.consts.vLayoutValues,oN.consts.vLayoutLabels),N.items.tag="nodeLayout")},q.prototype.addLayoutView=function(){var M=this,q=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100,N=this.layoutGv=new ht.graph.GraphView,e=this.layoutNode=new ht.Node,X=!1;return e.setImage("editor.layout.helper"),e.a("selectColor",oN.config.color_select),e.setSize(q,q),N.dm().add(e),N.tx(q/2),N.ty(q/2),N.handleScroll=function(){},N.handlePinch=function(){},N.setScrollBarVisible(!1),N.setRectSelectable(!1),N.setPannable(!1),N.setMovableFunc(function(){return!1}),N.dm().md(function(q){X||(M.beginTransaction(),M.dataModel.sm().getSelection().each(function(M){"a:layout.v"===q.property?M.s("layout.v",q.newValue):"a:layout.h"===q.property&&M.s("layout.h",q.newValue)}),M.endTransaction())}),this.addUpdateHandler(function(){var q=M.data;X=!0,e.a({"layout.v":q.s("layout.v"),"layout.h":q.s("layout.h")}),X=!1}),N},q.prototype.$84$=function(){this.addDBClipPercentage("s",e("editor.clippercentage"),"clip.percentage"),this.addDBComboBox("s",e("editor.clipdirection"),"clip.direction",oN.consts.clipDirections,oN.consts.clipDirectionLabels)},q.prototype.$28$=function(){this.$19$(),this.$24$(),this.addShapeForegroundProperties(),this.$32$(),this.addShapeDashProperties()},q.prototype.$24$=function(){this.addTitle("TitleShapeBackground"),this.addDBColor("s",e("editor.background"),"shape.background"),this.addDBGradient(e("editor.gradient"),"shape.gradient","shape.background","shape.gradient.color"),this.addDBColor("s",e("editor.gradientcolor"),"shape.gradient.color"),this.addDBGradientPack("s",e("editor.gradient.pack"),"shape.gradient.pack"),this.addDBImage("s",e("editor.repeatimage"),"shape.repeat.image"),this.addDBClipPercentage("s",e("editor.clippercentage"),"shape.fill.clip.percentage"),this.addDBComboBox("s",e("editor.clipdirection"),"shape.fill.clip.direction",oN.consts.clipDirections,oN.consts.clipDirectionLabels)},q.prototype.addShapeForegroundProperties=function(){this.addTitle("TitleShapeForeground"),this.addDBColor("s",e("editor.foreground"),"shape.foreground"),this.addDBGradient(e("editor.gradient"),"shape.foreground.gradient","shape.foreground","shape.foreground.gradient.color"),this.addDBColor("s",e("editor.gradientcolor"),"shape.foreground.gradient.color"),this.addDBClipPercentage("s",e("editor.clippercentage"),"shape.foreground.clip.percentage"),this.addDBComboBox("s",e("editor.clipdirection"),"shape.foreground.clip.direction",oN.consts.clipDirections,oN.consts.clipDirectionLabels)},q.prototype.$32$=function(){this.addTitle("TitleShapeBorder"),this.addDBRange("s",e("editor.width"),"shape.border.width",0,void 0,1,"number"),this.addDBCheckBox("s",e("editor.widthabsolute"),"shape.border.width.absolute"),this.addDBDashPattern("s",e("editor.pattern"),"shape.border.pattern"),this.addDBColor("s",e("editor.color"),"shape.border.color"),this.addDBGradientPack("s",e("editor.gradient.pack"),"shape.border.gradient.pack"),this.addDBCheckBox("s",e("editor.threed"),"shape.border.3d"),this.addDBColor("s",e("editor.threedcolor"),"shape.border.3d.color"),this.addDBComboBox("s",e("editor.join"),"shape.border.join",oN.consts.joins,oN.consts.joinLabels),this.addDBComboBox("s",e("editor.cap"),"shape.border.cap",oN.consts.caps,oN.consts.capLabels),this.$23$()},q.prototype.$23$=function(){this.addDBInput("s",e("editor.depth"),"shape.depth","int",1).items.tag="shapeDepth",this.addDBRange("s",e("editor.sides"),"shape.polygon.side",3,void 0,1,"int").items.tag="shapeSide",this.addDBCornerRadius("s",e("editor.radius"),"shape.corner.radius").items.tag="shapeRadius",this.addDBCheckBox("s",e("editor.arcoval"),"shape.arc.oval").items.tag="shapeArc",this.addDBCheckBox("s",e("editor.closed"),"shape.arc.close").items.tag="shapeArc",this.addDBRotation("s",e("editor.arcfrom"),"shape.arc.from").items.tag="shapeArc",this.addDBRotation("s",e("editor.arcto"),"shape.arc.to").items.tag="shapeArc",this.addDBRange("s",e("editor.sides"),"shape.star.side",3,void 0,1,"int").items.tag="nStar",this.addDBRange("s",e("editor.radius"),"shape.corner.radius",0,void 0,.01,"number").items.tag="nStar",this.addDBRange("s",e("editor.ratio"),"shape.star.ratio",.05,1,1e-4,"number").items.tag="nStar",this.addDBCheckBox("s",e("editor.regular"),"shape.regular").items.tag="shapeRegular"},q.prototype.addShapeDashProperties=function(){this.addTitle("TitleShapeDash"),this.addDBDashPattern("s",e("editor.pattern"),"shape.dash.pattern"),this.addDBCheckBox("s",e("editor.dash"),"shape.dash"),this.addDBColor("s",e("editor.color"),"shape.dash.color"),this.addDBInput("s",e("editor.offset"),"shape.dash.offset","number",1),this.addDBInput("s",e("editor.width"),"shape.dash.width","number",1),this.addDBCheckBox("s",e("editor.threed"),"shape.dash.3d"),this.addDBColor("s",e("editor.threedcolor"),"shape.dash.3d.color")},q.prototype.$34$=function(q){if(this._updateDataBindingsLater&&this.$86$(),q){if("s:shape"===q.property||"host"===q.property||"s:fullscreen"===q.property)return void this.filterPropertiesLater();if("s:select.type"===q.property&&("shadow"===q.oldValue||"shadow"===q.newValue))return void this.filterPropertiesLater()}M.prototype.$34$.call(this,q)},q.prototype.isTitleVisible=function(q){return!(!(!this.data||this.data instanceof ht.Shape||this.data.s("shape"))&&Iw[q.title])&&M.prototype.isTitleVisible.call(this,q)},q.prototype.isPropertyVisible=function(q){if(this.data){var N=q.items.tag;if(N)if("selectShadow"===N){if("shadow"!==this.data.s("select.type"))return!1}else if("shapeDepth"===N){if("rect"!==this.data.s("shape"))return!1}else if("shapeSide"===N){if("polygon"!==this.data.s("shape"))return!1}else if("shapeRadius"===N){if("roundRect"!==this.data.s("shape"))return!1}else if("shapeArc"===N){if("arc"!==this.data.s("shape"))return!1}else if("nStar"===N){if("nStar"!==this.data.s("shape"))return!1}else if("shapeRegular"===N){var e=this.data.s("shape");if("polygon"!==e&&"nStar"!==e)return!1}else if("imageRelative"===N){if(this.data.s("shape"))return!1}else if("layer"===N){if(!this.editor.layerPane.layerNames.length)return!1}else if("fullscreen"===N){if(this.data.getHost())return!1}else if("fullscreenDetail"===N){if(!this.data.s("fullscreen"))return!1}else if("host"===N){if(this.data.s("fullscreen"))return!1}else if("nodeLayout"===N){if(!this.data.getHost())return!1}else if("vectorLayout"===N){var X=this.data.getAttaches();if(!X||!X.size())return!1}}return M.prototype.isPropertyVisible.call(this,q)},q.prototype.$85$=function(M,q){var N=this;this.dataBindings!==M&&(this.$45$=M,this.pendingImage=q,this._updateDataBindingsLater||(this._updateDataBindingsLater=!0,requestAnimationFrame(function(){N._updateDataBindingsLater&&N.$86$()})))},q.prototype.$86$=function(){var M=this;if(this._updateDataBindingsLater=!1,this.dataBindings===this.$45$)return this.$45$=null,void(this.pendingImage=null);if(this._rows=this.$46$,this.removeRows(this.$44$),this.dataBindingHandlers&&this.dataBindingHandlers.length&&this.dataBindingHandlers.forEach(this.removeUpdateHandler,this),this.$44$=[],this.dataBindingHandlers=[],this.dataBindings=this.$45$,this.dataBindings){var q=this.updateHandlers.length,N={},e={},X={};this.pendingImage.comps.forEach(function(M){if(gM(M.type)){var q=ht.Default.getCompType(M.type);if(q)for(var w in q.properties)N[w]=q.properties[w].defaultValue}fq(M,e,X)});for(var w in e)void 0===X[w]&&(X[w]=N[e[w]]);var $=void 0,t=this._rows.indexOf(this.imageRow)+1;this.dataBindings.forEach(function(q){if(q.group&&$!==q.group){$=q.group;var N=M.addTitle($,{index:t});N.items.tag="imageRelative",M.$44$.push(N),t++}M.$87$(q,t,X)&&t++}),this.dataBindingHandlers=this.updateHandlers.slice(q)}this.$46$=this._rows,this.filterProperties()},q.prototype.$87$=function(M,q,N,$,E){var J=this,u=[],g=M.attr,S=oN.config.valueTypes[M.valueType];if(!S)return this.editor.fireEvent("error",{message:"Wrong value type:"+M.valueType}),!1;var b=e(M.name)||g,h=function(q){var e=q.a(g);if(void 0===e&&(e=N[g]),void 0===e&&(e=M.defaultValue),J.$45$===J.dataBindings&&e instanceof ht.DataModel){var X=q.getAttrObject();X&&X[g]||(e=VN(e),X||(X=q._attrObject={}),X[g]=e)}return e},y=function(M,q){M.a(g,q)},P=M.extraInfo,f=void 0,x=void 0,n=void 0;P&&P.enum&&(f=P.enum.values,x=t(P.enum.labels,P.enum.i18nLabels),n=P.enum.icons);var R=null==M.bindable||M.bindable,G=oN.SceneView&&R,j=void 0;if(P&&P.buildUI)j=P.buildUI(this,u,b,h,y,P),G=j&&j.actionLabel;else if(f)G?this.addActionLabelComboBox(u,b,"a",g,f,x,n,h,y):this.addLabelComboBox(u,b,h,y,f,x,n);else if("int"===S.type||"number"===S.type)S.angle?G?this.addActionLabelRotation(u,b,"a",g,S.min,S.max,S.step,h,y):this.addLabelRotation(u,b,h,y,S.min,S.max,S.step):G?this.addActionLabelRange(u,b,"a",g,S.min,S.max,S.step,S.type,h,y):this.addLabelRange(u,b,h,y,S.min,S.max,S.step,S.type);else if("color"===S.type)G?this.addActionLabelColor(u,b,"a",g,h,y):this.addLabelColor(u,b,h,y);else if("boolean"===S.type)G?this.addActionLabelCheckBox(u,b,"a",g,h,y):this.addLabelCheckBox(u,b,h,y);else if("enum"===S.type)G?this.addActionLabelComboBox(u,b,"a",g,S.values,S.labels,S.icons,h,y):this.addLabelComboBox(u,b,h,y,S.values,S.labels,S.icons);else if("multiline"===S.type)G?this.addActionLabelMultiline(u,b,"a",g,h,y,P):this.addLabelMultiline(u,b,h,y,P);else if("font"===S.type)G?this.addActionLabelFont(u,b,"a",g,h,y):this.addLabelFont(u,b,h,y);else if("image"===S.type)G?this.addActionLabelImage(u,b,"a",g,h,y):this.addLabelImage(u,b,h,y);else if("url"===S.type)G?this.addActionLabelURL(u,b,"a",g,void 0,h,y):this.addLabelURL(u,b,h,y);else if("colorArray"===S.type)G?this.addActionLabelArray(u,b,"a",g,"color",h,y,P):this.addLabelArray(u,b,h,y,"color",P);else if("gradientPackArray"===S.type)G?this.addActionLabelArray(u,b,"a",g,"gradientPack",h,y,P):this.addLabelArray(u,b,h,y,"gradientPack",P);else if("numberArray"===S.type)if("DashPattern"===M.valueType)G?this.addActionLabelDashPattern(u,b,"a",g,h,y):this.addLabelDashPattern(u,b,h,y);else if("CornerRadius"===M.valueType){var K=P&&P.uvMode;G?this.addActionLabelCornerRadius(u,b,"a",g,h,y,K,!K):this.addLabelCornerRadius(u,b,h,y,void 0,K,!K)}else G?this.addActionLabelArray(u,b,"a",g,"number",h,y,P):this.addLabelArray(u,b,h,y,"number",P);else if("stringArray"===S.type)G?this.addActionLabelArray(u,b,"a",g,"string",h,y,P):this.addLabelArray(u,b,h,y,"string",P);else if("objectArray"===S.type)G?this.addActionLabelArray(u,b,"a",g,"object",h,y,P):this.addLabelArray(u,b,h,y,"object",P,{property:g});else if("function"===S.type)G?this.addActionLabelFunction(u,b,"a",g,g,P&&P.arguments,h,y):this.addLabelFunction(u,b,h,y,g,P&&P.arguments);else if("object"===S.type)G?this.addActionLabelObject(u,b,"a",g,g,h,y,P&&P.objectProperties):this.addLabelObject(u,b,h,y,g,P&&P.objectProperties);else if("custom"===S.type)j=S.buildUI(this,u,b,h,y,P),G=j&&j.actionLabel;else if("dataModel"===S.type)G?this.addActionLabelDataModel(u,b,"a",g,g,P,h,y):this.addLabelDataModel(u,b,h,y,g,P);else if("gradientPack"===S.type)G?this.addActionLabelGradientPack(u,b,"a",g,h,y):this.addLabelGradientPack(u,b,h,y,g);else{var p=void 0;P&&P.formatterTip&&(p=this.fomatterTipToToolTip(P.formatterTip)),G?this.addActionLabelInput(u,b,"a",g,void 0,void 0,void 0,h,y,void 0,p):this.addLabelInput(u,b,h,y,void 0,void 0,void 0,void 0,p)}var C=this.addDBRow(u,"a",g,{index:q},X(j,S),w(j,S),R&&!G);return P&&(C.visible=P.visible,C.onPropertyChanged=P.onPropertyChanged),$||($=this.$44$),$.push(C),null!==E&&(u.tag=E||"imageRelative"),!0},q.prototype.$25$=function(){this.addTitle("TitleSelect"),this.addDBColor("s",e("editor.color"),"select.color"),this.addDBInput("s",e("editor.width"),"select.width","number",1),this.addDBInput("s",e("editor.padding"),"select.padding","number",1),this.addDBComboBox("s",e("editor.selecttype"),"select.type",oN.consts.selectTypes,oN.consts.selectTypeLabels,oN.consts.selectTypeIcons),this.addDBInput("s",e("editor.shadowblur"),"shadow.blur","number",1).items.tag="selectShadow",this.addDBInput("s",e("editor.shadowoffsetx"),"shadow.offset.x","number",1).items.tag="selectShadow",this.addDBInput("s",e("editor.shadowoffsety"),"shadow.offset.y","number",1).items.tag="selectShadow"},q.prototype.updateSymbolLayoutProperties=function(){var M=this,q=this.data.getHost(),N=void 0,e=void 0;if(q&&q.getImage&&(N=q.getImage())&&(N=ht.Default.getImage(N),mM(N)&&(e=N.layoutProperties)),this.layoutProperties!==e){if(this._rows=this.$46$,this.removeRows(this.layoutPropertiesRows),this.layoutPropertiesHandlers&&this.layoutPropertiesHandlers.length&&this.layoutPropertiesHandlers.forEach(this.removeUpdateHandler,this),this.layoutPropertiesRows=[],this.layoutPropertiesHandlers=[],this.layoutProperties=e,this.layoutProperties){var X=this.updateHandlers.length,w=void 0,$=this._rows.indexOf(this.layoutVRow)+1;this.layoutProperties.forEach(function(q){if(q.group&&w!==q.group){w=q.group;var N=M.addTitle(w,{index:$});N.items.tag="layoutRelative",M.layoutPropertiesRows.push(N),$++}M.$87$(q,$,{},M.layoutPropertiesRows,"layoutRelative")&&$++}),this.layoutPropertiesHandlers=this.updateHandlers.slice(X)}this.$46$=this._rows}},q}(Yw),dw={"h.v":!0,"v.h":!0,ortho:!0,flex:!0,"extend.east":!0,"extend.west":!0,"extend.north":!0,"extend.south":!0,ortho2:!0,flex2:!0,"extend.north2":!0,"extend.south2":!0,"extend.west2":!0,"extend.east2":!0,"v.h2":!0,"h.v2":!0},aw={"extend.east":!0,"extend.west":!0,"extend.north":!0,"extend.south":!0,"extend.north2":!0,"extend.south2":!0,"extend.west2":!0,"extend.east2":!0},Dw=function(M){function q(N,e){return YN(this,q),dN(this,M.call(this,N,e))}return rN(q,M),q.prototype.initForm=function(){this.$26$(),this.addCustomProperties(),this.addControlProperties(),this.$27$(),this.addDBGray(),this.$88$(),this.addEdgeEndpointProperties(),this.$90$(),this.$29$(),this.$30$(),this.$25$()},q.prototype.addControlProperties=function(){this.addTitle("TitleControl"),this.addEventProperties(),this.addDBCheckBox("s",e("editor.visible"),"2d.visible"),this.addDBCheckBox("s",e("editor.selectable"),"2d.selectable"),this.addDBCheckBox("s",e("editor.editable"),"2d.editable"),this.addDBCheckBox("s",e("editor.independent"),"edge.independent"),this.addDBCheckBox("s",e("editor.toggleable"),"edge.toggleable")},q.prototype.isTitleVisible=function(q){return!("TitleEditingPoint"===q.title&&!this.editor.pointsEditingMode)&&M.prototype.isTitleVisible.call(this,q)},q.prototype.$34$=function(q){if(q){var N=q.property;if("s:edge.type"===N||"source"===N||"target"===N||"s:select.type"===N)return void this.filterPropertiesLater()}M.prototype.$34$.call(this,q)},q.prototype.isPropertyVisible=function(q){if(this.data){var N=q.items.tag;if(N){var e=this.data.s("edge.type");if("edgeRipple"===N){if("ripple"!==e)return!1}else if("edgeRadius"===N){if(!dw[e])return!1}else if("edgeOrtho"===N){if("ortho"!==e&&"ortho2"!==e)return!1}else if("edgeFlex"===N){if("flex"!==e&&"flex2"!==e)return!1}else if("edgeExtend"===N){if(!aw[e])return!1}else if("layer"===N){if(!this.editor.layerPane.layerNames.length)return!1}else{if(!("edgeSourceIsEdge"!==N||this.data.getSource()instanceof ht.Edge))return!1;if(!("edgeTargetIsEdge"!==N||this.data.getTarget()instanceof ht.Edge))return!1;if(!("edgeSourceIsNode"!==N||this.data.getSource()instanceof ht.Node))return!1;if("edgeTargetIsNode"===N&&!(this.data.getTarget()instanceof ht.Node))return!1}}}return M.prototype.isPropertyVisible.call(this,q)},q.prototype.$27$=function(){M.prototype.$27$.call(this),this.addDBLayer(),this.addDBInput("p",e("editor.tooltip"),"toolTip"),this.addDBOpacityProperty(),this.$83$()},q.prototype.$25$=function(){this.addTitle("TitleSelect"),this.addDBColor("s",e("editor.color"),"select.color"),this.addDBInput("s",e("editor.width"),"select.width","number",1);var M=[]
;this.addLabelCheckBox(M,e("editor.shadow"),function(M){return"shadow"===M.s("select.type")},function(M,q){M.s("select.type",q?"shadow":null)}),this.addDBRow(M,"s","select.type"),this.addDBInput("s",e("editor.shadowblur"),"shadow.blur","number",1),this.addDBInput("s",e("editor.shadowoffsetx"),"shadow.offset.x","number",1),this.addDBInput("s",e("editor.shadowoffsety"),"shadow.offset.y","number",1)},q.prototype.$88$=function(){this.addTitle("TitleEdgeBasic"),this.addDBInput("s",e("editor.width"),"edge.width","number",1),this.addDBCheckBox("s",e("editor.widthabsolute"),"edge.width.absolute"),this.addDBDashPattern("s",e("editor.pattern"),"edge.pattern"),this.addDBColor("s",e("editor.color"),"edge.color"),this.addDBCheckBox("s",e("editor.threed"),"edge.3d"),this.addDBColor("s",e("editor.threedcolor"),"edge.3d.color"),this.addDBComboBox("s",e("editor.join"),"edge.join",oN.consts.joins,oN.consts.joinLabels),this.addDBComboBox("s",e("editor.cap"),"edge.cap",oN.consts.caps,oN.consts.capLabels),this.addDBInput("s",e("editor.group"),"edge.group"),this.addDBInput("s",e("editor.offset"),"edge.offset","number",1),this.addDBInput("s",e("editor.gap"),"edge.gap","number",1),this.addDBComboBox("s",e("editor.type"),"edge.type",oN.consts.edgeTypes,oN.consts.edgeTypeLabels),this.addDBInput("s",e("editor.radius"),"edge.corner.radius","number",1).items.tag="edgeRadius",this.addDBZeroToOne("s",e("editor.ortho"),"edge.ortho").items.tag="edgeOrtho",this.addDBInput("s",e("editor.flex"),"edge.flex","number",1).items.tag="edgeFlex",this.addDBInput("s",e("editor.extend"),"edge.extend","number",1).items.tag="edgeExtend",this.addDBInput("s",e("editor.ripplesize"),"edge.ripple.size","int",1).items.tag="edgeRipple",this.addDBInput("s",e("editor.ripplelength"),"edge.ripple.length","number",1).items.tag="edgeRipple",this.addDBInput("s",e("editor.rippleelevation"),"edge.ripple.elevation","number",1).items.tag="edgeRipple",this.addDBCheckBox("s",e("editor.rippleboth"),"edge.ripple.both").items.tag="edgeRipple",this.addDBCheckBox("s",e("editor.ripplestraight"),"edge.ripple.straight").items.tag="edgeRipple",this.addDBCheckBox("s",e("editor.center"),"edge.center");var M=[],q=function(M,q){M instanceof ht.Edge&&M.toggle()};q.once=!0,this.addLabelCheckBox(M,e("editor.expanded"),function(M){return M.s("edge.expanded")},q),this.addDBRow(M,"s","edge.expanded")},q.prototype.$90$=function(){this.addTitle("TitleEdgeDash"),this.addDBCheckBox("s",e("editor.dash"),"edge.dash"),this.addDBDashPattern("s",e("editor.pattern"),"edge.dash.pattern"),this.addDBColor("s",e("editor.color"),"edge.dash.color"),this.addDBInput("s",e("editor.offset"),"edge.dash.offset","number",1),this.addDBInput("s",e("editor.width"),"edge.dash.width","number",1),this.addDBCheckBox("s",e("editor.threed"),"edge.dash.3d"),this.addDBColor("s",e("editor.threedcolor"),"edge.dash.3d.color")},q.prototype.addEdgeEndpointProperties=function(){this.addTitle("TitleEdgeEndpoint"),this.addDBData("p",e("editor.sourcedata"),"source",function(M,q){M instanceof ht.Edge&&(null==q||q instanceof ht.Node||q instanceof ht.Edge)&&(M.setSource(q),M.s("edge.source.percent",.5))}),this.addDBData("p",e("editor.targetdata"),"target",function(M,q){M instanceof ht.Edge&&(null==q||q instanceof ht.Node||q instanceof ht.Edge)&&(M.setTarget(q),M.s("edge.target.percent",.5))});var M=void 0;M=this.addDBZeroToOne("s",e("editor.sourcepercent"),"edge.source.percent"),M.items.tag="edgeSourceIsEdge",M=this.addDBRange("s",e("editor.sourceindex"),"edge.source.index",-1,void 0,1,"int"),M.items.tag="edgeSourceIsEdge",M=this.addDBPosition("s",e("editor.sourceposition"),"edge.source.position"),M.items.tag="edgeSourceIsNode",M=this.addDBInput("s",e("editor.sourceoffsetx"),"edge.source.offset.x","number",1),M.items.tag="edgeSourceIsNode",M=this.addDBInput("s",e("editor.sourceoffsety"),"edge.source.offset.y","number",1),M.items.tag="edgeSourceIsNode",M=this.addDBInput("s",e("editor.sourceanchorx"),"edge.source.anchor.x","number",.01),M.items.tag="edgeSourceIsNode",M=this.addDBInput("s",e("editor.sourceanchory"),"edge.source.anchor.y","number",.01),M.items.tag="edgeSourceIsNode",M=this.addDBZeroToOne("s",e("editor.targetpercent"),"edge.target.percent"),M.items.tag="edgeTargetIsEdge",M=this.addDBRange("s",e("editor.targetindex"),"edge.target.index",-1,void 0,1,"int"),M.items.tag="edgeTargetIsEdge",M=this.addDBPosition("s",e("editor.targetposition"),"edge.target.position"),M.items.tag="edgeTargetIsNode",M=this.addDBInput("s",e("editor.targetoffsetx"),"edge.target.offset.x","number",1),M.items.tag="edgeTargetIsNode",M=this.addDBInput("s",e("editor.targetoffsety"),"edge.target.offset.y","number",1),M.items.tag="edgeTargetIsNode",M=this.addDBInput("s",e("editor.targetanchorx"),"edge.target.anchor.x","number",.01),M.items.tag="edgeTargetIsNode",M=this.addDBInput("s",e("editor.targetanchory"),"edge.target.anchor.y","number",.01),M.items.tag="edgeTargetIsNode"},q}(Yw),Ww=function(M){function q(N,e){return YN(this,q),dN(this,M.call(this,N,e))}return rN(q,M),q.prototype.initForm=function(){this.addCustomProperties(),this.addControlProperties(),this.addLayoutProperties(),this.$27$(),this.$91$(),this.$31$(),this.$93$(),this.$92$(),this.$28$(),this.$29$(),this.$30$(),this.$25$()},q.prototype.$34$=function(q){if(q&&"s:group.type"===q.property)return void this.filterPropertiesLater();M.prototype.$34$.call(this,q)},q.prototype.isTitleVisible=function(q){return(!this.data||!this.data.s("group.type")||"TitleGroupTitle"!==q.title)&&M.prototype.isTitleVisible.call(this,q)},q.prototype.isPropertyVisible=function(q){if(this.data){var N=q.items.tag;if(N&&"groupDepth"===N){var e=this.data.s("group.type");if(e&&"rect"!==e)return!1}}return M.prototype.isPropertyVisible.call(this,q)},q.prototype.$31$=function(){this.addTitle("TitleGroupBasic"),this.addDBComboBox("s",e("editor.type"),"group.type",[void 0,"rect","oval","circle","roundRect"],["",e("editor.grouptype.rect"),e("editor.grouptype.oval"),e("editor.grouptype.circle"),e("editor.grouptype.roundrect")]),this.addDBPosition("s",e("editor.position"),"group.position"),this.addDBColor("s",e("editor.background"),"group.background"),this.addDBGradient(e("editor.gradient"),"group.gradient","group.background","group.gradient.color"),this.addDBColor("s",e("editor.gradientcolor"),"group.gradient.color"),this.addDBImage("s",e("editor.image"),"group.image"),this.addDBStretch("s",e("editor.stretch"),"group.image.stretch"),this.addDBImage("s",e("editor.repeatimage"),"group.repeat.image"),this.addDBCheckBox("s",e("editor.toggleable"),"group.toggleable"),this.addDBCheckBox("p",e("editor.expanded"),"expanded"),this.addDBInput("s",e("editor.depth"),"group.depth","number",1).items.tag="groupDepth"},q.prototype.$93$=function(){this.addTitle("TitleGroupTitle"),this.addDBLabel("s",e("editor.content"),"label"),this.addDBFont("s",e("editor.font"),"group.title.font"),this.addDBColor("s",e("editor.color"),"group.title.color"),this.addDBColor("s",e("editor.background"),"group.title.background"),this.addDBAlign("s",e("editor.align"),"group.title.align"),this.addDBOrientation("s",e("editor.valuetype.orientation"),"group.title.orientation"),this.addDBCheckBox("s",e("editor.splitline"),"group.splitLine")},q.prototype.$92$=function(){this.addTitle("TitleGroupBorder"),this.addDBInput("s",e("editor.width"),"group.border.width","number",1),this.addDBDashPattern("s",e("editor.pattern"),"group.border.pattern"),this.addDBColor("s",e("editor.color"),"group.border.color"),this.addDBComboBox("s",e("editor.join"),"group.border.join",oN.consts.joins,oN.consts.joinLabels),this.addDBComboBox("s",e("editor.cap"),"group.border.cap",oN.consts.caps,oN.consts.capLabels),this.addDBInput("s",e("editor.radius"),"group.border.radius","number",1),this.addDBInput("s",e("editor.padding"),"group.padding","number",1),this.addDBInput("s",e("editor.paddingleft"),"group.padding.left","number",1),this.addDBInput("s",e("editor.paddingright"),"group.padding.right","number",1),this.addDBInput("s",e("editor.paddingtop"),"group.padding.top","number",1),this.addDBInput("s",e("editor.paddingbottom"),"group.padding.bottom","number",1)},q}(rw),vw=function(M){function q(N,e){return YN(this,q),dN(this,M.call(this,N,e))}return rN(q,M),q.prototype.initForm=function(){this.$26$(),this.addCustomProperties(),this.addControlProperties(),this.addLayoutProperties(),this.$27$(),this.$28$(),this.$29$(),this.$30$(),this.$25$()},q.prototype.isTitleVisible=function(q){return!("TitleEditingPoint"===q.title&&!this.editor.pointsEditingMode)&&M.prototype.isTitleVisible.call(this,q)},q.prototype.$23$=function(){this.addDBCheckBox("p",e("editor.closed"),"closePath"),this.addDBColor("s",e("editor.outlinecolor"),"border.color"),this.addDBInput("s",e("editor.outlinewidth"),"border.width","number",1)},q.prototype.$24$=function(){M.prototype.$24$.call(this),this.addDBComboBox("s",e("editor.fillrule"),"shape.fill.rule",oN.consts.fillRules,oN.consts.fillRuleLabels)},q.prototype.$25$=function(){this.addTitle("TitleSelect"),this.addDBColor("s",e("editor.color"),"select.color"),this.addDBInput("s",e("editor.width"),"select.width","number",1);var M=[];this.addLabelCheckBox(M,e("editor.shadow"),function(M){return"shadow"===M.s("select.type")},function(M,q){M.s("select.type",q?"shadow":null)}),this.addDBRow(M,"s","select.type"),this.addDBInput("s",e("editor.shadowblur"),"shadow.blur","number",1),this.addDBInput("s",e("editor.shadowoffsetx"),"shadow.offset.x","number",1),this.addDBInput("s",e("editor.shadowoffsety"),"shadow.offset.y","number",1)},q}(rw),ow=function(M){function q(N,e){return YN(this,q),dN(this,M.call(this,N,e))}return rN(q,M),q.prototype.addControlProperties=function(){M.prototype.addControlProperties.call(this),this.addDBCheckBox("p",e("editor.clickthroughenabled"),"clickThroughEnabled");var q=[];this.addLabelCheckBox(q,e("editor.syncsize"),function(M){return M.isSyncSize()},function(M,q){M instanceof ht.Block&&(M.setSyncSize(q),M instanceof ht.RefGraph&&(M.p(0,0),M.setRotation(0),M.setAnchor(.5,.5),M.setScale(1,1),M.setSize(20,20),M.setRef(M.getRef())))}),this.addDBRow(q,"p","syncSize")},q.prototype.addDBGray=function(){},q.prototype.addDBBodyColorProperty=function(){},q.prototype.addDBOpacityProperty=function(){},q.prototype.$91$=function(){},q.prototype.$28$=function(){},q.prototype.$84$=function(){},q.prototype.$19$=function(){},q}(rw),Hw=function(M){function q(N,e){return YN(this,q),dN(this,M.call(this,N,e))}return rN(q,M),q.prototype.$27$=function(){M.prototype.$27$.call(this),this.addDBRef()},q.prototype.addDBRef=function(){var M=this,q=[],N=function(M){return M.getRef()},X=function(M,q){M instanceof ht.RefGraph&&(M.p(0,0),M.setRotation(0),M.setAnchor(.5,.5),M.setScale(1,1),M.setSize(20,20),M.setRef(q))},w=function(q,N){var e=N.view.draggingData;return!!e&&(M.editor.url!==e.url&&"display"===e.fileType)};return this.addLabelURL(q,e("editor.ref"),N,X,w),this.addDBRow(q,"p","ref")},q.prototype.addDBGray=function(){},q}(ow),Uw=function(M){function q(N,e){return YN(this,q),dN(this,M.call(this,N,e))}return rN(q,M),q.prototype.initForm=function(){this.addCustomProperties(),this.addControlProperties(),this.addLayoutProperties(),this.$27$(),this.$21$(),this.addTextBorderProperties(),this.$25$(),this.$19$()},q.prototype.$21$=function(){this.addTitle("TitleText"),this.addDBMultiline("s",e("editor.content"),"text"),this.addDBAlign("s",e("editor.align"),"text.align"),this.addDBVAlign("s",e("editor.valign"),"text.vAlign"),this.addDBColor("s",e("editor.color"),"text.color"),this.addDBGradientPack("s",e("editor.gradient.pack"),"text.gradient.pack"),this.addDBCheckBox("s",e("editor.textwrap"),"text.wrap"),this.addDBCheckBox("s",e("editor.vertical"),"text.vertical"),this.addDBRange("s",e("editor.lettergap"),"text.letter.gap",0,void 0,1,"number"),this.addDBRange("s",e("editor.vertical.gap"),"text.vertical.gap",0,void 0,1,"number"),this.addDBRange("s",e("editor.stroke.width"),"text.border.width",0,void 0,1,"number"),this.addDBGradientPack("s",e("editor.stroke.color"),"text.border.color"),this.addDBComboBox("s",e("editor.textdecoration"),"text.decoration",oN.consts.textDecorationValues,oN.consts.textDecorationLabels),this.addDBFont("s",e("editor.font"),"text.font"),this.addDBGradientPack("s",e("editor.background"),"text.background")},q.prototype.addTextBorderProperties=function(){this.addTitle("TitleBorder"),this.addDBRange("s",e("editor.width"),"text.outline.width",0,void 0,1,"number"),this.addDBGradientPack("s",e("editor.color"),"text.outline.color"),this.addDBCornerRadius("s",e("editor.radius"),"text.corner.radius")},q}(rw),Vw=function(M){function q(N,e){return YN(this,q),dN(this,M.call(this,N,e,"comp"))}return rN(q,M),q.prototype.initForm=function(){this.addCustomProperties(),this.addControlProperties(),this.addLayoutProperties(),this.$11$(),this.$19$()},q.prototype.isTitleVisible=function(q){return!!this.inspectorFilter.isCompTitleVisible(this.editor,this.data?this.data.compType:null,q.title)&&M.prototype.isTitleVisible.call(this,q)},q.prototype.isPropertyVisible=function(q){return!!this.inspectorFilter.isCompPropertyVisible(this.editor,this.data?this.data.compType:null,q.keys&&q.keys.name)&&M.prototype.isPropertyVisible.call(this,q)},q.prototype.addControlProperties=function(){this.addTitle("TitleControl"),this.addEventProperties(),this.addStyleCheckBox(e("editor.visible"),"2d.visible","visible"),this.addStyleCheckBox(e("editor.selectable"),"2d.selectable","selectable"),this.addStyleCheckBox(e("editor.movable"),"2d.movable","movable"),this.addStyleCheckBox(e("editor.editable"),"2d.editable","editable"),this.addStyleCheckBox(e("editor.pixelperfect"),"pixelPerfect","pixelPerfect")},q.prototype.$11$=function(){this.addTitle("TitleBasic"),this.$13$(),this.$14$(),this.addStyleInput(e("editor.prefix"),"prefix","prefix"),this.$18$(),this.addStyleZeroToOne(e("editor.opacity"),"opacity","opacity"),this.addStyleCheckBox(e("editor.gray"),"2d.gray","gray"),this.addStyleComboBox(e("editor.compositeoperation"),"composite",[void 0,"source-in","source-out","source-atop","destination-over","destination-in","destination-out","destination-atop","lighter","copy","xor","multiply","screen","overlay","darken","lighten","color-dodge","color-burn"]),this.addState()},q.prototype.addState=function(){var M=this,q=[],N=new ht.widget.ComboBox,X=b("s","state"),w=h("s","state");this.addLabel(q,e("editor.state"),X,w),N.onValueChanged=function(){M.setValue(w,N.getValue())},this.updateHandlers.push(function(){if(!q.hidden){var e=M.getValue(X),w=M.editor.symbolStatePane.getAllStateEnum();if(w&&w.length){var $=w.map(function(M){return M.value}),t=w.map(function(M){return M.label||M.value});$.unshift(void 0),t.unshift(""),N.setValues($),N.setLabels(t),N.getValue()!==e&&N.setValue(e)}}}),q.push(N);var $=this.addFuncRow(q,"state");return $.visible=function(){var q=M.editor.symbolStatePane.getAllStateEnum();return q&&q.length},$},q.prototype.$12$=function(){var M=[];this.addLabelInput(M,e("editor.area"),function(M){return"["+N(M.p().x-M.getWidth()*M.getAnchor().x)+","+N(M.p().y-M.getHeight()*M.getAnchor().y)+","+N(M.getWidth())+","+N(M.getHeight())+"]"}),this.addFuncRow(M,"rect")},q.prototype.$13$=function(){var M=[];this.addLabelInput(M,e("editor.type"),function(M){return M.compType}),this.addRow(M,this.w1).keys={name:"type"}},q.prototype.$14$=function(){var M=[];this.addLabelInput(M,e("editor.name"),function(M){return M.getDisplayName()},function(M,q){M.setDisplayName(q)}),this.addFuncRow(M,"displayName")},q.prototype.$15$=function(){var M=[];this.addLabelInput(M,e("editor.rotation"),function(M){return 180/Math.PI*M.getRotation()},function(M,q){M instanceof ht.Node&&M.setRotation(q*Math.PI/180)},"number",1),this.addFuncRow(M,"rotation")},q.prototype.$16$=function(){var M=[];this.addLabelInput(M,e("editor.anchorx"),function(M){return M.getAnchor().x},function(M,q){M instanceof ht.Node&&M.setAnchor(q,M.getAnchor().y,!0)},"number",.01),this.addFuncRow(M,"anchorX"),M=[],this.addLabelInput(M,e("editor.anchory"),function(M){return M.getAnchor().y},function(M,q){M instanceof ht.Node&&M.setAnchor(M.getAnchor().x,q,!0)},"number",.01),this.addFuncRow(M,"anchorY")},q.prototype.$17$=function(){var M=[];this.addLabelInput(M,e("editor.scalex"),function(M){return M.getScale().x},function(M,q){M instanceof ht.Node&&M.setScale(q,M.getScale().y)},"number",.01),this.addFuncRow(M,"scaleX"),M=[],this.addLabelInput(M,e("editor.scaley"),function(M){return M.getScale().y},function(M,q){M instanceof ht.Node&&M.setScale(M.getScale().x,q)},"number",.01),this.addFuncRow(M,"scaleY")},q.prototype.$18$=function(){this.addStyleClipPercentage(e("editor.clippercentage"),"clip.percentage","clipPercentage"),this.addStyleComboBox(e("editor.clipdirection"),"clip.direction",oN.consts.clipDirections,oN.consts.clipDirectionLabels,null,"clipDirection")},q.prototype.$19$=function(){this.addTitle("TitleShadow"),this.addStyleCheckBox(e("editor.shadow"),"shadow2","shadow"),this.addStyleColor(e("editor.shadowcolor"),"shadow2.color","shadowColor"),this.addStyleInput(e("editor.shadowblur"),"shadow2.blur","number",1,"shadowBlur"),this.addStyleInput(e("editor.shadowoffsetx"),"shadow2.offset.x","number",1,"shadowOffsetX"),this.addStyleInput(e("editor.shadowoffsety"),"shadow2.offset.y","number",1,"shadowOffsetY")},q.prototype.$20$=function(){var M=[];return this.addLabelInput(M,e("editor.posx"),function(M){return M.p().x},function(M,q){M instanceof ht.Node&&M.p(q,M.p().y)},"number",1),this.addLabelInput(M,e("editor.posy"),function(M){return M.p().y},function(M,q){M instanceof ht.Node&&M.p(M.p().x,q)},"number",1),this.addRow(M,this.w1w1).keys={name:"position"},M=[],this.addLabelInput(M,e("editor.width"),function(M){return M.getWidth()},function(M,q){M instanceof ht.Node&&M.setWidth(q)},"number",1),this.addLabelInput(M,e("editor.height"),function(M){return M.getHeight()},function(M,q){M instanceof ht.Node&&M.setHeight(q)},"number",1),this.addRow(M,this.w1w1).keys={name:"size"},M},q.prototype.addStyleColor=function(M,q,N,e){var X=[];return this.addLabelColor(X,M,function(M){return M.s(q)},function(M,N){"shape.background"===q&&M.s("shape.gradient.pack")&&M.s("shape.gradient.pack",void 0),M.s(q,N)}),this.addFuncRow(X,q,N,e)},q.prototype.addStyleFunction=function(M,q,N,e,X){var w=[];return this.addLabelFunction(w,M,function(M){return M.s(q)},function(M,N){M.s(q,N)},N,e),this.addFuncRow(w,q,N,X)},q.prototype.addStyleDataModel=function(M,q,N,e,X){var w=[];return this.addLabelDataModel(w,M,function(M){return M.s(q)},function(M,N){M.s(q,N)},N,e),this.addFuncRow(w,q,N,X)},q.prototype.addStyleObject=function(M,q,N,e,X){var w=[];return this.addLabelObject(w,M,function(M){return M.s(q)},function(M,N){M.s(q,N)},N,X&&X.objectProperties),this.addFuncRow(w,q,N,e)},q.prototype.addStyleLabel=function(M,q,N,e){var X=[];return this.addLabelInput(X,M,function(M){var N=M.s(q);return N&&N.replace&&(N=N.replace(/\n/g,"\\n")),N},function(M,N){N&&N.replace&&(N=N.replace(/\\n/g,"\n")),M.s(q,N)}),this.addFuncRow(X,q,N,e)},q.prototype.addStyleArray=function(M,q,N,e,X,w){var $=[];return this.addLabelArray($,M,function(M){return M.s(q)},function(M,N){M.s(q,N)},e,w,{property:q}),this.addFuncRow($,q,N,X)},q.prototype.addStyleMultiline=function(M,q,N,e,X){var w=[];return this.addLabelMultiline(w,M,function(M){return M.s(q)},function(M,N){M.s(q,N)},void 0,X),this.addFuncRow(w,q,N,e)},q.prototype.addStyleFont=function(M,q,N,e){var X=[];return this.addLabelFont(X,M,function(M){return M.s(q)},function(M,N){M.s(q,N)}),this.addFuncRow(X,q,N,e)},q.prototype.addStyleTextArea=function(M,q,N,e){var X=[];return this.addLabelTextArea(X,M,function(M){return M.s(q)},function(M,N){M.s(q,N)}),this.addFuncRow(X,q,N,e)},q.prototype.addStyleInput=function(M,q,N,e,X,w,$){var t=[];return this.addLabelInput(t,M,function(M){return M.s(q)},function(M,N){M.s(q,N)},N,e,void 0,void 0,$),this.addFuncRow(t,q,X,w)},q.prototype.addStyleCheckBox=function(M,q,N,e){var X=[];return this.addLabelCheckBox(X,M,function(M){return M.s(q)},function(M,N){M.s(q,N)}),this.addFuncRow(X,q,N,e)},q.prototype.addStyleAlign=function(M,q,N,X){var w=[];return this.addLabelComboBox(w,M,function(M){return M.s(q)||"center"},function(M,N){M.s(q,N)},["left","center","right"],[e("editor.align.left"),e("editor.align.center"),e("editor.align.right")]),this.addFuncRow(w,q,N,X)},q.prototype.addStyleVAlign=function(M,q,N,X){var w=[];return this.addLabelComboBox(w,M,function(M){return M.s(q)||"bottom"},function(M,N){M.s(q,N)},["top","middle","bottom"],[e("editor.valign.top"),e("editor.valign.middle"),e("editor.valign.bottom")]),this.addFuncRow(w,q,N,X)},q.prototype.addStyleStretch=function(M,q,N,X,w){var $=["fill","uniform","centerUniform"],t=[e("editor.stretch.fill"),e("editor.stretch.uniform"),e("editor.stretch.centeruniform")],E="fill";w&&($.unshift(void 0),t.unshift(""),E=void 0);var J=[];return this.addLabelComboBox(J,M,function(M){return M.s(q)||E},function(M,N){M.s(q,N)},$,t),this.addFuncRow(J,q,N,X)},q.prototype.addStyleComboBox=function(M,q,N,e,X,w,$){var t=[];return this.addLabelComboBox(t,M,function(M){return M.s(q)},function(M,N){M.s(q,N)},N,e,X),this.addFuncRow(t,q,w,$)},q.prototype.addStyleImage=function(M,q,N,e){var X=[];return this.addLabelImage(X,M,function(M){return M.s(q)},function(M,N){M.s(q,N)}),this.addFuncRow(X,q,N,e)},q.prototype.addStyleURL=function(M,q,N,e){var X=[];return this.addLabelURL(X,M,function(M){return M.s(q)},function(M,N){M.s(q,N)}),this.addFuncRow(X,q,N,e)},q.prototype.addStylePattern=function(M,q,N,e){var X=[];return this.addLabelPattern(X,M,function(M){return M.s(q)},function(M,N){M.s(q,N)}),this.addFuncRow(X,q,N,e)},q.prototype.addStyleDashPattern=function(M,q,N,e){var X=[];return this.addLabelDashPattern(X,M,function(M){return M.s(q)},function(M,N){M.s(q,N)}),this.addFuncRow(X,q,N,e)},q.prototype.addStyleZeroToOne=function(M,q,N){return this.addStyleRange(M,q,0,1,.01,N)},q.prototype.addStylePosition=function(M,q,N){return this.addStyleRange(M,q,1,55,1,N)},q.prototype.addStyleRange=function(M,q,N,e,X,w){var $=[];return this.addLabelInput($,M,function(M){var N=M.s(q);return null==N?e:N},function(M,X){void 0!==e&&X>e&&(X=e),void 0!==N&&X<N&&(X=N),M.s(q,X)},"number",X),this.addFuncRow($,q,w)},q.prototype.addStyleRotation=function(M,q,N,e,X,w){var $=[];return this.addLabelInput($,M,function(M){var N=M.s(q);return null==N?X:180/Math.PI*N},function(M,N){N=N*Math.PI/180,void 0!==X&&N>X&&(N=X),void 0!==e&&N<e&&(N=e),M.s(q,N)},"number",w||1),this.addFuncRow($,q,N)},q.prototype.addStyleGradient=function(M,q,N,e,X){var w=[];return this.addLabelGradient(w,M,q,N,e),this.addFuncRow(w,q,X)},q.prototype.addStyleGradientPack=function(M,q,N,e){var X=[];return this.addLabelGradientPack(X,M,function(M){return M.s(q)},function(M,N){M.s(q,N)}),this.addFuncRow(X,q,N,e)},q.prototype.addLayoutProperties=function(){var M=this;this.addTitle("TitleLayout"),this.$12$(),this.$20$(),this.$15$(),this.$16$(),this.$17$();var q=function(M){return!!M.getValue(function(M){return M.dm()&&M.dm().a("fitSize")})},N=this.layoutGv=new ht.graph.GraphView,X=this.layoutNode=new ht.Node,w=!1;if(X.setImage("editor.layout.helper"),X.a("selectColor",oN.config.color_select),N.dm().add(X),N.tx(50),N.ty(50),N.handleScroll=function(){},N.handlePinck=function(){},N.setScrollBarVisible(!1),N.setRectSelectable(!1),N.setPannable(!1),N.setMovableFunc(function(){return!1}),N.dm().md(function(q){w||(M.beginTransaction(),M.dataModel.sm().getSelection().each(function(M){"a:layout.v"===q.property?M.s("layout.v",q.newValue):"a:layout.h"===q.property&&M.s("layout.h",q.newValue)}),M.endTransaction())}),oN.config.layoutEnabled){this.addRow(["",{element:N},""],[.1,100,.1],100).visible=q,this.addUpdateHandler(function(q,N){var e=M.data;w=!0,X.a({"layout.v":e.s("layout.v"),"layout.h":e.s("layout.h")}),w=!1});var $=[];this.addLabelComboBox($,e("editor.nodeLayout.h"),function(M){return M.s("layout.h")},function(M,q){M.s("layout.h",q)},oN.consts.hLayoutValues,oN.consts.hLayoutLabels),this.addFuncRow($,"layout.h").visible=q,$=[],this.addLabelComboBox($,e("editor.nodeLayout.v"),function(M){return M.s("layout.v")},function(M,q){M.s("layout.v",q)},oN.consts.vLayoutValues,oN.consts.vLayoutLabels),this.addFuncRow($,"layout.v").visible=q}},q.prototype.addStyleClipPercentage=function(M,q,N){var e=[],X=q.replace("percentage","direction");this.addLabelClipPercentage(e,M,function(M){return M.s(q)},function(M,N){return M.s(q,N)},void 0,function(M){return M.s(X)}),this.addFuncRow(e,q,N)},q.prototype.addStyleCornerRadius=function(M,q,N,e,X){var w=!(arguments.length>5&&void 0!==arguments[5])||arguments[5],$=[];return this.addLabelCornerRadius($,M,function(M){return M.s(q)},function(M,N){return M.s(q,N)},void 0,X,w),this.addFuncRow($,q,N,e)},q}(JX),Tw=function(M){function q(N,e){return YN(this,q),dN(this,M.call(this,N,e))}return rN(q,M),q.prototype.$34$=function(q){if(q&&"s:shape"===q.property)return void this.filterPropertiesLater();M.prototype.$34$.call(this,q)},q.prototype.isTitleVisible=function(q){if(this.data){var N=this.data.s("shape");if("TitleArc"===q.title&&"arc"!==N)return!1}return M.prototype.isTitleVisible.call(this,q)},q.prototype.isPropertyVisible=function(q){if(this.data){var N=q.items.tag;if(N){var e=this.data.s("shape");if("shapeDepth"===N&&"rect"!==e)return!1;if("shapeCornerRadius"===N&&"roundRect"!==e&&"polygon"!==e)return!1;if("shapePolygonSide"===N&&"polygon"!==e)return!1;if("shapeRegular"===N&&"polygon"!==e&&"nStar"!==e)return!1;if("nStar"===N&&"nStar"!==e)return!1}}return M.prototype.isPropertyVisible.call(this,q)},q.prototype.initForm=function(){M.prototype.initForm.call(this),this.$36$(),this.$37$(),this.addDashProperties(),this.addArcProperties()},q.prototype.$13$=function(){this.addStyleComboBox(e("editor.type"),"shape",oN.consts.shapes.slice(1),oN.consts.shapeLabels.slice(1),oN.consts.shapeIcons.slice(1),"type")},q.prototype.$36$=function(){this.addTitle("TitleBackground"),this.addStyleColor(e("editor.background"),"shape.background","background"),this.addStyleImage(e("editor.repeatimage"),"shape.repeat.image","repeatImage"),this.addStyleStretch(e("editor.stretch"),"shape.repeat.image.stretch","repeatImageStretch",void 0,!0),this.addStyleRotation(e("editor.rotation"),"shape.repeat.image.rotation","repeatImageRotation"),this.addStyleGradientPack(e("editor.gradient.pack"),"shape.gradient.pack","gradientPack"),this.addStyleGradient(e("editor.gradient"),"shape.gradient","shape.background","shape.gradient.color","gradient"),this.addStyleColor(e("editor.gradientcolor"),"shape.gradient.color","gradientColor"),this.addStyleClipPercentage(e("editor.clippercentage"),"shape.fill.clip.percentage","fillClipPercentage"),this.addStyleComboBox(e("editor.clipdirection"),"shape.fill.clip.direction",oN.consts.clipDirections,oN.consts.clipDirectionLabels,null,"fillClipDirection"),this.addStyleInput(e("editor.depth"),"shape.depth","int",1,"depth").items.tag="shapeDepth"},q.prototype.$37$=function(){this.addTitle("TitleBorder"),this.addStyleRange(e("editor.width"),"shape.border.width",0,void 0,1,"borderWidth"),this.addStyleCheckBox(e("editor.widthabsolute"),"shape.border.width.absolute","borderWidthAbsolute"),this.addStyleColor(e("editor.color"),"shape.border.color","borderColor"),this.addStyleGradientPack(e("editor.gradient.pack"),"shape.border.gradient.pack","borderGradientPack"),this.addStyleDashPattern(e("editor.pattern"),"shape.border.pattern","borderPattern"),this.addStyleCheckBox(e("editor.threed"),"shape.border.3d","border3d"),this.addStyleColor(e("editor.threedcolor"),"shape.border.3d.color","border3dColor"),this.addStyleComboBox(e("editor.cap"),"shape.border.cap",oN.consts.caps,oN.consts.capLabels,null,"borderCap"),this.addStyleComboBox(e("editor.join"),"shape.border.join",oN.consts.joins,oN.consts.joinLabels,null,"borderJoin"),this.addStyleCornerRadius(e("editor.radius"),"shape.corner.radius","cornerRadius",void 0,!0,!1).items.tag="shapeCornerRadius",this.addStyleRange(e("editor.sides"),"shape.polygon.side",3,void 0,1,"polygonSide").items.tag="shapePolygonSide",this.addStyleRange(e("editor.sides"),"shape.star.side",3,void 0,1,"starSide").items.tag="nStar",this.addStyleRange(e("editor.radius"),"shape.corner.radius",0,void 0,.01,"cornerRadius").items.tag="nStar",this.addStyleRange(e("editor.ratio"),"shape.star.ratio",.05,1,1e-4,"starRatio").items.tag="nStar",this.addStyleCheckBox(e("editor.regular"),"shape.regular","regular").items.tag="shapeRegular"},q.prototype.addDashProperties=function(){this.addTitle("TitleDash"),this.addStyleCheckBox(e("editor.dash"),"shape.dash","dash"),this.addStyleDashPattern(e("editor.pattern"),"shape.dash.pattern","dashPattern"),this.addStyleColor(e("editor.color"),"shape.dash.color","dashColor"),this.addStyleInput(e("editor.offset"),"shape.dash.offset","number",1,"dashOffset"),this.addStyleInput(e("editor.width"),"shape.dash.width","number",1,"dashWidth"),this.addStyleCheckBox(e("editor.threed"),"shape.dash.3d","dash3d"),this.addStyleColor(e("editor.threedcolor"),"shape.dash.3d.color","dash3dColor")},q.prototype.addArcProperties=function(){this.addTitle("TitleArc"),this.addStyleCheckBox(e("editor.arcoval"),"shape.arc.oval","arcOval"),this.addStyleCheckBox(e("editor.closed"),"shape.arc.close","arcClose"),this.addStyleRotation(e("editor.arcfrom"),"shape.arc.from","arcFrom"),this.addStyleRotation(e("editor.arcto"),"shape.arc.to","arcTo")},q}(Vw),_w=function(M){function q(N,e){return YN(this,q),dN(this,M.call(this,N,e))}return rN(q,M),q.prototype.initForm=function(){M.prototype.initForm.call(this),this.addTitle("TitleImage");var q=[];this.addLabelImage(q,e("editor.name"),function(M){return M.s("image")},function(M,q){kN(q)&&q.endsWith("[...]")||M.s("image",q)}),this.addButton(q,null,e("editor.resetsize"),"editor.resetsize.state",function(M){M instanceof ht.Node&&M.setSize(-1,-1)}),this.addFuncRow(q,"image","name"),this.addStyleColor(e("editor.color"),"body.color","color"),this.addStyleStretch(e("editor.stretch"),"image.stretch","stretch")},q}(Vw),kw=function(M){function q(N,e){return YN(this,q),dN(this,M.call(this,N,e))}return rN(q,M),q.prototype.initForm=function(){M.prototype.initForm.call(this),this.$43$()},q.prototype.$43$=function(){this.addTitle("TitleBorder"),this.addStyleInput(e("editor.width"),"border_width","number",1,"border"),this.addStyleColor(e("editor.color"),"border_color","color")},q}(Vw),Zw=function(M){function q(N,e){return YN(this,q),dN(this,M.call(this,N,e))}return rN(q,M),q.prototype.initForm=function(){M.prototype.initForm.call(this),this.addBasicChartProperties()},q.prototype.addBasicChartProperties=function(){this.addTitle("TitleChart"),this.addStyleCheckBox(e("editor.text"),"chart.label","label"),this.addStyleColor(e("editor.color"),"chart.label.color","labelColor"),this.addStyleFont(e("editor.font"),"chart.label.font","labelFont")},q}(Vw),zw=function(M){function q(N,e){return YN(this,q),dN(this,M.call(this,N,e))}return rN(q,M),q.prototype.initForm=function(){M.prototype.initForm.call(this),this.addPieChartProperties()},q.prototype.addBasicChartProperties=function(){M.prototype.addBasicChartProperties.call(this),this.addStyleRotation(e("editor.rotation"),"chart.start.angle","startAngle"),this.addStyleCheckBox(e("editor.hollow"),"chart.hollow","hollow")},q.prototype.createChartIndexColumn=function(M){var q=this;return{name:M,width:50,align:"center",editable:!0,sortable:!1,clickable:!1,getValueType:function(M){return"chart.values"===M.getTag()?"number":"color"},getValue:function(N){if(q.data){var e=q.data.s(N.getTag());return e?e[M]:void 0}},setValue:function(N,e,X,w){var $=N.getTag(),t=function(q,N){var e=yq(q.s($));e[M]=N,"chart.values"===$?bq(e):hq(e),q.s($,e)};q.setValue(t,X)}}},q.prototype.addPieChartProperties=function(){var M=this,q=this.tableModel=new ht.DataModel,N=this.tablePane=new pe(q),X=this.tableView=N.getTableView();N.getTableHeader().setMovable(!1),X.setEditable(!0),X.isEditable=function(){return M.editor.editable},N.getView().style.border=oN.config.color_line+" solid 1px";var w=[N]
;this.addRow(w,[.1],ht.Default.widgetRowHeight+4*X.getRowHeight()).keys={name:"chartTable"};var $=new ht.Data,t=new ht.Data;$.setTag("chart.values"),t.setTag("chart.colors"),q.add($),q.add(t),this.updateHandlers.push(function(){if(!w.hidden&&M.data){X.getColumnModel().clear(),N.addColumns([{name:e("editor.length"),width:50,align:"center",editable:!0,sortable:!1,clickable:!1,valueType:"int",getValue:function(q){if(!M.data)return 0;var N=M.data.s("chart.values");return N?N.length:0},setValue:function(q,N,e,X){var w=function(M,q){if(q>=0){var N=yq(M.s("chart.values"),q);bq(N),M.s("chart.values",N),N=yq(M.s("chart.colors"),q),hq(N),M.s("chart.colors",N)}};M.setValue(w,e)}},{tag:"binding",name:e("editor.binding"),width:50,align:"center",editable:!0,sortable:!1,clickable:!1,isCellEditable:function(q,e,X,w){var $="chart.values"===q.getTag()?"values":"colors";return M.editor.funcView.toggle(N,q.getTag(),$,M),!1},drawCell:function(q,N,e,X,w,$,t,E,J){var u=!!M.data.a(N.getTag());L(q,ht.Default.getImage(u?"editor.bind":"editor.unbind"),"centerUniform",w,$,t,E,N,J,u&&!e?oN.config.color_select:oN.config.color_dark)}}]);for(var q=M.data.s("chart.values"),$=q?q.length:0,t=0;t<$;t++)N.addColumns([M.createChartIndexColumn(t)])}})},q}(Zw),Aw=function(M){function q(N,e){return YN(this,q),dN(this,M.call(this,N,e))}return rN(q,M),q.prototype.initForm=function(){M.prototype.initForm.call(this),this.addOneDimensionalProperties()},q.prototype.createChartIndexColumn=function(M){var q=this;return{name:M,width:50,align:"center",editable:!0,sortable:!1,clickable:!1,getValueType:function(M){return"values"===M.getTag()?"number":"color"},getValue:function(N){if(q.data){var e=zM(q.data.s("chart.series"));if(e&&e[0]){var X=zM(e[0][N.getTag()]);return X?X[M]:void 0}}},setValue:function(N,e,X,w){var $=N.getTag(),t=function(q,N){var e=q.s("chart.series");if(e){var X=VN(e),w=zM(X);if(w[0]){var t=zM(w[0][$]);t&&t[M]!==N&&(t[M]=N,"values"===$?bq(t):hq(t),q.s("chart.series",X))}}};q.setValue(t,X)}}},q.prototype.addOneDimensionalProperties=function(){var M=this,q=this.tableModel=new ht.DataModel,N=this.tablePane=new pe(q),X=this.tableView=N.getTableView();N.getTableHeader().setMovable(!1),X.setEditable(!0),X.isEditable=function(){return M.editor.editable},N.getView().style.border=oN.config.color_line+" solid 1px";var w=[N];this.addRow(w,[.1],ht.Default.widgetRowHeight+4*X.getRowHeight()).keys={name:"chartTable"};var $=new ht.Data,t=new ht.Data;$.setTag("values"),t.setTag("colors"),q.add($),q.add(t),this.updateHandlers.push(function(){if(!w.hidden&&M.data){X.getColumnModel().clear(),N.addColumns([{name:e("editor.length"),width:50,align:"center",editable:!0,sortable:!1,clickable:!1,valueType:"int",getValue:function(q){if(!M.data)return 0;var N=zM(M.data.s("chart.series"));if(!N)return 0;if(!N[0])return 0;var e=zM(N[0].values);return e?e.length:0},setValue:function(q,N,e,X){var w=function(M,q){if(q>=0){var N=M.s("chart.series"),e=N?VN(N):[],X=zM(e);X[0]||(X[0]={});var w=X[0];w.values||(w.values=[]),w.colors||(w.colors=[]);var $=zM(w.values),t=zM(w.colors);q===$.length&&q===t.length||($.length=q,t.length=q,bq($),hq(t),M.s("chart.series",e))}};M.setValue(w,e)}},{tag:"binding",name:e("editor.binding"),width:50,align:"center",editable:!0,sortable:!1,clickable:!1,isCellEditable:function(q,e,X,w){var $=q.getTag(),t=function(){return nN(M.data,$)},E=function(q){M.setValue(function(M,N){var e=M.s("chart.series");if(e){var X=VN(e),w=zM(X);if(w[0]){var t=zM(w[0][$]);w[0][$]=q?{value:t,func:q}:t,M.s("chart.series",X)}}},q)};return M.editor.funcView.toggle(N,$,$,M,t,E),!1},drawCell:function(q,N,e,X,w,$,t,E,J){var u=!!nN(M.data,N.getTag());L(q,ht.Default.getImage(u?"editor.bind":"editor.unbind"),"centerUniform",w,$,t,E,N,J,u&&!e?oN.config.color_select:oN.config.color_dark)}}]);for(var q=xN(M.data,"values"),$=q?q.length:0,t=0;t<$;t++)N.addColumns([M.createChartIndexColumn(t)])}})},q}(Zw),cw=function(M){function q(N,e){return YN(this,q),dN(this,M.call(this,N,e))}return rN(q,M),q.prototype.initForm=function(){M.prototype.initForm.call(this),this.addSeriesChartProperties()},q.prototype.addSeriesChartProperties=function(){var M=this,q=[],N=function(M){var q=M.s("chart.series");return q?q.length:0},X=function(M,q){if(q>=0){var N=M.s("chart.series"),e=N?VN(N):[],X=zM(e);if(X.length!==q){X.length=q;for(var w=void 0,$=0;$<q;$++){X[$]||(X[$]={});var t=X[$];t.values||(t.values=[]),t.color||(t.color=ht.Color.chart[$%ht.Color.chart.length]);var E=zM(t.values);zM(t.colors);0===$?w=E.length:E.length=w,bq(E)}M.s("chart.series",e)}}};this.addLabelInput(q,e("editor.series"),N,X,"int",1),N=function(M){var q=M.s("chart.series");if(q){var N=q[0];if(N){var e=zM(N.values);return e?e.length:0}}return 0},X=function(M,q){if(q>=0){var N=M.s("chart.series"),e=N?VN(N):[],X=zM(e);if(X.length){for(var w=0;w<X.length;w++){X[w]||(X[w]={});var $=X[w];$.values||($.values=[]);var t=zM($.values);if(t.length===q)return;$.color||($.color=ht.Color.chart[w%ht.Color.chart.length]);zM($.colors);t.length=q,bq(t)}M.s("chart.series",e)}}},this.addLabelInput(q,e("editor.length"),N,X,"int",1),this.addRow(q,this.w1w1).keys={name:"chartSeries"};var w=this.tableModel=new ht.DataModel,$=this.tablePane=new pe(w),t=this.tableView=$.getTableView();$.getTableHeader().setMovable(!1),t.setEditable(!0),t.isEditable=function(){return M.editor.editable},$.getView().style.border=oN.config.color_line+" solid 1px";var E=[$];this.addRow(E,[.1],160).keys={name:"chartTable"},this.updateHandlers.push(function(){if(!E.hidden&&M.data){w.clear(),t.getColumnModel().clear();var q=M.data.s("chart.series");if(q)for(var N=0;N<q.length;N++){var X=new ht.Data;X.serie=q[N],X.index=N,w.add(X)}if($.addColumns([{name:e("editor.index"),width:50,align:"center",sortable:!1,clickable:!1,valueType:"int",getValue:function(M){return M.index}},{tag:"binding",name:e("editor.colorbinding"),width:50,align:"center",editable:!0,sortable:!1,clickable:!1,isCellEditable:function(q,N,e,X){var w=q.index,t=function(){return AM(q.serie.color)},E=function(q){M.setValue(function(M,N){var e=M.s("chart.series");if(e){var X=VN(e),$=zM(X),t=$[w];if(t){var E=zM(t.color);t.color=q?{value:E,func:q}:E,M.s("chart.series",X)}}},q)};return M.editor.funcView.toggle($,"values","values",M,t,E),!1},drawCell:function(M,q,N,e,X,w,$,t,E){var J=!!AM(q.serie.color);L(M,ht.Default.getImage(J?"editor.bind":"editor.unbind"),"centerUniform",X,w,$,t,q,E,J&&!N?oN.config.color_select:oN.config.color_dark)}},{name:e("editor.color"),width:50,align:"center",editable:!0,sortable:!1,clickable:!1,valueType:"color",getValue:function(M){return zM(M.serie.color)},setValue:function(q,N,e,X){var w=q.index,$=zM(q.serie.color);if(e&&$!==e){var t=function(M,q){var N=M.s("chart.series");if(N){var e=VN(N),X=zM(e),$=X[w];if($){var t=AM($.color);$.color=t?{value:q,func:t}:q,M.s("chart.series",e)}}};M.setValue(t,e)}}},{tag:"binding",name:e("editor.valuebinding"),width:50,align:"center",editable:!0,sortable:!1,clickable:!1,isCellEditable:function(q,N,e,X){var w=q.index,t=function(){return AM(q.serie.values)},E=function(q){M.setValue(function(M,N){var e=M.s("chart.series");if(e){var X=VN(e),$=zM(X),t=$[w];if(t){var E=zM(t.values);t.values=q?{value:E,func:q}:E,M.s("chart.series",X)}}},q)};return M.editor.funcView.toggle($,"values","values",M,t,E),!1},drawCell:function(M,q,N,e,X,w,$,t,E){var J=!!AM(q.serie.values);L(M,ht.Default.getImage(J?"editor.bind":"editor.unbind"),"centerUniform",X,w,$,t,q,E,J&&!N?oN.config.color_select:oN.config.color_dark)}}]),q){var J=q[0];if(J){var u=zM(J.values);if(u)for(var g=0;g<u.length;g++)$.addColumns([M.createChartIndexColumn(g)])}}}})},q.prototype.createChartIndexColumn=function(M){var q=this;return{name:M,width:50,align:"center",editable:!0,sortable:!1,clickable:!1,valueType:"number",getValue:function(q){var N=zM(q.serie.values);return N?N[M]:void 0},setValue:function(N,e,X,w){var $=N.index,t=function(q,N){var e=q.s("chart.series");if(e){var X=VN(e),w=zM(X);if(w[$]){var t=zM(w[$].values);t&&t[M]!==N&&(t[M]=N,q.s("chart.series",X))}}};q.setValue(t,X)}}},q}(Zw),Bw=function(M){function q(N,e){return YN(this,q),dN(this,M.call(this,N,e))}return rN(q,M),q.prototype.addBasicChartProperties=function(){M.prototype.addBasicChartProperties.call(this),this.addStyleComboBox(e("editor.type"),"chart.type",oN.consts.columnChartTypes,oN.consts.columnChartTypeLabels,null,"type")},q.prototype.$13$=function(){},q}(cw),Lw=function(M){function q(N,e){return YN(this,q),dN(this,M.call(this,N,e))}return rN(q,M),q.prototype.initForm=function(){M.prototype.initForm.call(this)},q}(cw),iw=function(M){function q(N,e){return YN(this,q),dN(this,M.call(this,N,e))}return rN(q,M),q.prototype.initForm=function(){this.$26$(),M.prototype.initForm.call(this)},q.prototype.isTitleVisible=function(q){return!("TitleEditingPoint"===q.title&&!this.editor.pointsEditingMode)&&M.prototype.isTitleVisible.call(this,q)},q.prototype.$13$=function(){var M=[];this.addLabelInput(M,e("editor.type"),function(M){return M.compType}),this.addRow(M,this.w1).keys={name:"type"}},q.prototype.$36$=function(){M.prototype.$36$.call(this),this.addStyleComboBox(e("editor.fillrule"),"shape.fill.rule",oN.consts.fillRules,oN.consts.fillRuleLabels,null,"fillRule")},q.prototype.$37$=function(){M.prototype.$37$.call(this);var q=[];this.addLabelCheckBox(q,e("editor.closed"),function(M){return M.isClosePath()},function(M,q){M instanceof ht.Shape&&M.setClosePath(q)}),this.addFuncRow(q,"name")},q}(Tw),Fw=function(M){function q(N,e){return YN(this,q),dN(this,M.call(this,N,e))}return rN(q,M),q.prototype.initForm=function(){M.prototype.initForm.call(this),this.addTitle("TitleText"),this.addStyleMultiline(e("editor.text"),"text","text"),this.addStyleAlign(e("editor.align"),"text.align","align"),this.addStyleVAlign(e("editor.valign"),"text.vAlign","vAlign"),this.addStyleColor(e("editor.color"),"text.color","color"),this.addStyleGradientPack(e("editor.gradient.pack"),"text.gradient.pack","gradientPack"),this.addStyleCheckBox(e("editor.textwrap"),"text.wrap","wrap"),this.addStyleCheckBox(e("editor.vertical"),"text.vertical","vertical"),this.addStyleInput(e("editor.lettergap"),"text.letter.gap","number",1,"letterGap"),this.addStyleInput(e("editor.vertical.gap"),"text.vertical.gap","number",1,"verticalGap"),this.addStyleRange(e("editor.stroke.width"),"text.border.width",0,void 0,1,"borderWidth"),this.addStyleGradientPack(e("editor.stroke.color"),"text.border.color","borderColor"),this.addStyleComboBox(e("editor.textdecoration"),"text.decoration",oN.consts.textDecorationValues,oN.consts.textDecorationLabels,null,"decoration"),this.addStyleFont(e("editor.font"),"text.font","font"),this.addStyleGradientPack(e("editor.background"),"text.background","background"),this.addTitle("TitleBorder"),this.addStyleRange(e("editor.width"),"text.outline.width",0,void 0,1,"outlineWidth"),this.addStyleGradientPack(e("editor.color"),"text.outline.color","outlineColor"),this.addStyleCornerRadius(e("editor.radius"),"text.corner.radius","cornerRadius",void 0,!0)},q.prototype.$19$=function(){this.addTitle("TitleShadow"),this.addStyleCheckBox(e("editor.shadow"),"shadow2","shadow"),this.addStyleColor(e("editor.shadowcolor"),"shadow2.color","shadowColor"),this.addStyleInput(e("editor.shadowblur"),"shadow2.blur","number",1,"shadowblur"),this.addStyleInput(e("editor.shadowoffsetx"),"shadow2.offset.x","number",1,"shadowOffsetX"),this.addStyleInput(e("editor.shadowoffsety"),"shadow2.offset.y","number",1,"shadowOffsetYs")},q}(Vw),M$=function(M){function q(N,e){return YN(this,q),dN(this,M.call(this,N,e))}return rN(q,M),q.prototype.$13$=function(){var M=[];this.addLabelInput(M,e("editor.type"),function(M){return"function"}),this.addFuncRow(M,"type")},q}(Vw),q$=function(M){function q(N,e){return YN(this,q),dN(this,M.call(this,N,e))}return rN(q,M),q.prototype.initForm=function(){M.prototype.initForm.call(this),this.addComponent()},q.prototype.$13$=function(){},q.prototype.addComponent=function(){var M=this;this.addTitle("TitleComponent");var q=[];q.forceToUpdate=!0;var N=function(M,q){return!!q.view.draggingData&&"component"===q.view.draggingData.fileType};this.addLabelURL(q,e("editor.type"),function(q){var N=q.s("type");return M.$42$(q.properties),N},function(M,q){M.s("type",q)},N);var X=new ht.widget.Image;X.vectorDataBindingDisabled=!0,this.updateHandlers.push(function(){if(!q.hidden){var N=M.data?M.data.s("type"):null;M.$42$(M.data.properties);var e=null;if(N){if(kN(N)&&!gM(N)&&N.startsWith("ht.")){var w=ZN(N);w&&w.snapshotURL&&(e=w.snapshotURL)}e||(e=KM(N))}X.setIcon(e),X.compType=N}});var w=X.getView();w.style.cursor="pointer";var $=function(q){q.preventDefault(),K(q)?M.editor.open(X.compType):M.editor.selectFileNode(X.compType,"components")};w.addEventListener("mousedown",$,!1),w.addEventListener("touchstart",$,!1),q.push(X),this.addFuncRow(q,"type")},q.prototype.$42$=function(M){var q=this;this.properties!==M&&(this.pendingProperties=M,this._updateComponentLater||(this._updateComponentLater=!0,requestAnimationFrame(function(){q.$60$()})))},q.prototype.$60$=function(){if(this._updateComponentLater=!1,this.properties===this.pendingProperties)return void(this.pendingProperties=null);if(this._rows=this.$46$,this.removeRows(this.$35$),this.propertiesHandlers&&this.propertiesHandlers.length&&this.propertiesHandlers.forEach(this.removeUpdateHandler,this),this.$35$=[],this.properties=this.pendingProperties,this.properties){var M=this.updateHandlers.length,q=void 0;for(var N in this.properties){var e=this.properties[N];if(e.group&&q!==e.group){q=e.group;var X=this.addTitle(q);this.$35$.push(X)}this.addProperty(N,e)}this.propertiesHandlers=this.updateHandlers.slice(M)}this.$46$=this._rows,this.filterProperties()},q.prototype.addProperty=function(M,q){var N=oN.config.valueTypes[q.valueType];if(!N)return this.editor.fireEvent("error",{message:"Wrong value type:"+q.valueType}),!1;var $=e(q.name)||M,E=q.extraInfo,J=void 0,u=void 0,g=void 0;E&&E.enum&&(J=E.enum.values,u=t(E.enum.labels,E.enum.i18nLabels),g=E.enum.icons);var S=void 0;if(E&&E.buildUI){var b=function(q){return q.s(M)},h=function(q,N){q.s(M,N)},y=[];S=E.buildUI(this,y,$,b,h,E),this.addFuncRow(y,M,M,X(S,N),w(S,N))}else if(J)this.addStyleComboBox($,M,J,u,g,M);else if("int"===N.type||"number"===N.type){var P=(N.max,N.min,function(q){return q.s(M)}),f=function(q,N){q.s(M,N)},x=[];N.angle?this.addLabelRotation(x,$,P,f,N.min,N.max,N.step):this.addLabelRange(x,$,P,f,N.min,N.max,N.step,N.type),this.addFuncRow(x,M,M,X(S,N))}else if("color"===N.type)this.addStyleColor($,M,M,X(S,N));else if("boolean"===N.type)this.addStyleCheckBox($,M,M,X(S,N));else if("enum"===N.type)this.addStyleComboBox($,M,N.values,N.labels,N.icons,M);else if("multiline"===N.type)this.addStyleMultiline($,M,M,X(S,N),E);else if("font"===N.type)this.addStyleFont($,M,M,X(S,N));else if("image"===N.type)this.addStyleImage($,M,M,X(S,N));else if("url"===N.type)this.addStyleURL($,M,M,X(S,N));else if("colorArray"===N.type)this.addStyleArray($,M,M,"color",X(S,N),E);else if("gradientPackArray"===N.type)this.addStyleArray($,M,M,"gradientPack",X(S,N),E);else if("numberArray"===N.type)"DashPattern"===q.valueType?this.addStyleDashPattern($,M,M,X(S,N)):"CornerRadius"===q.valueType?this.addStyleCornerRadius($,M,M,X(S,N)):this.addStyleArray($,M,M,"number",X(S,N),E);else if("stringArray"===N.type)this.addStyleArray($,M,M,"string",X(S,N),E);else if("objectArray"===N.type)this.addStyleArray($,M,M,"object",X(S,N),E);else if("function"===N.type){var n=void 0;E&&E.arguments&&(n=E.arguments),this.addStyleFunction($,M,M,n,X(S,N))}else if("dataModel"===N.type)this.addStyleDataModel($,M,M,E,X(S,N));else if("custom"===N.type){var R=function(q){return q.s(M)},G=function(q,N){q.s(M,N)},j=[];S=N.buildUI(this,j,$,R,G,E),this.addFuncRow(j,M,M,X(S,N),w(S,N))}else if("object"===N.type)this.addStyleObject($,M,M,X(S,N),E);else if("gradientPack"===N.type)this.addStyleGradientPack($,M,M,X(S,N));else{var K=void 0;E&&E.formatterTip&&(K=this.fomatterTipToToolTip(E.formatterTip)),this.addStyleInput($,M,null,null,M,X(S,N),K)}var p=this._rows[this._rows.length-1];return p&&E&&(p.visible=E.visible,p.onPropertyChanged=E.onPropertyChanged),this.$35$.push(p),!0},q}(Vw),N$=function(M){function q(N,e){return YN(this,q),dN(this,M.call(this,N,e))}return rN(q,M),q.prototype.initForm=function(){this.$26$(),this.addTitle("TitleBasic"),this.$13$(),this.$14$()},q.prototype.isTitleVisible=function(q){return!("TitleEditingPoint"===q.title&&!this.editor.pointsEditingMode)&&M.prototype.isTitleVisible.call(this,q)},q}(Vw),e$=function(M){function q(N,e){return YN(this,q),dN(this,M.call(this,N,e))}return rN(q,M),q.prototype.initForm=function(){this.addTitle("TitleBasic"),this.$13$(),this.$14$()},q}(Vw),X$=function(M){function q(N){YN(this,q);var e=dN(this,M.call(this));return e.editor=N,e.getView().style.background=oN.config.color_pane,e}return rN(q,M),q.prototype.handleDataModelPropertyChange=function(M){var q=this.inspector;q&&q.global&&q.$34$(M)},q.prototype.handleDataModelChange=function(M){var q=this.inspector;q&&q.global&&q.$34$()},q.prototype.handleDataPropertyChange=function(M){if("*"!==M.property&&"material"!==M.property){var q=this.inspector;q&&!q.global&&q.data===M.data&&q.$34$(M)}},q.prototype.handleSelectionChange=function(M){this.updateInspectorLater()},q.prototype.handleGraphViewInteractorChange=function(M){var q=this.inspector;q&&("pointsEditingMode"===M.property?q.filterPropertiesLater():"shapePointStatus"===M.property&&q.editingPointButtons&&q.editingPointButtons.forEach(function(q){q.setSelected(q.statusValue===M.newValue),q.setBorderColor(q.isSelected()?oN.config.color_line:null)}))},q.prototype.$5$=function(M){this.inspector&&this.inspector.endEdit(),this.dataModel&&(this.dataModel.removeDataModelChangeListener(this.handleDataModelChange,this),this.dataModel.removePropertyChangeListener(this.handleDataModelPropertyChange,this),this.dataModel.removeDataPropertyChangeListener(this.handleDataPropertyChange,this),this.dataModel.sm().ums(this.handleSelectionChange,this),this.currentView.removeInteractorPropertyChangeListener(this.handleGraphViewInteractorChange,this)),this.editor.hasInspector(M)?(this.currentView=M.getView(),this.dataModel=this.currentView.dm,this.dataModel.addDataModelChangeListener(this.handleDataModelChange,this),this.dataModel.addPropertyChangeListener(this.handleDataModelPropertyChange,this),this.dataModel.addDataPropertyChangeListener(this.handleDataPropertyChange,this),this.dataModel.sm().ms(this.handleSelectionChange,this),this.currentView.addInteractorPropertyChangeListener(this.handleGraphViewInteractorChange,this),this.g3d=this.currentView.g3d):M&&!M._isUI||(this.dataModel=null,this.currentView=null,this.g3d=null),this.updateInspector()},q.prototype.getDataInspector=function(M){return M instanceof ht.Shape?this.htShapeInspector:M instanceof ht.Edge?this.htEdgeInspector:M instanceof ht.Group?this.htGroupInspector:M instanceof ht.Text?this.htTextInspector:M instanceof ht.RefGraph?this.htRefGraphInspector:M instanceof ht.Block?this.htBlockInspector:M instanceof ht.Node?this.htNodeInspector:this.htDataInspector},q.prototype.getCompInspector=function(M){if(M instanceof ye)return this.clipInspector;if(M instanceof Pe)return this.restoreInspector;if(M instanceof ge)return this.basicInspector;if(M instanceof cX)return this.borderInspector;if(M instanceof be)return this.imageInspector;if(M instanceof BX)return this.pieChartInspector;if(M instanceof LX){var q=zM(M.s("chart.series"));return q&&q.length<=1&&q[0].colors?this.oneDimensionalColumnChartInspector:this.columnChartInspector}return M instanceof iX?this.lineChartInspector:M instanceof Se?this.shapeInspector:M instanceof he?this.textInspector:M instanceof AX?this.funcTypeInspector:M instanceof fe?this.compTypeInspector:null},q.prototype.updateInspectorLater=function(){var M=this;this._updateInspectorlater||(this._updateInspectorlater=!0,requestAnimationFrame(function(){M.updateInspector()}))},q.prototype.updateInspector=function(){var M=null;if(this.dataModel){var q=this.dataModel.sm().ld();if(q){var N=q.getClassName();N&&(M=this[N.replace(/\./g,"_")+"_Inspector"]),M||(this.currentView instanceof Mw?M=this.getCompInspector(q):this.currentView instanceof TX?M=this.getDataInspector(q):this.currentView instanceof oN.SceneView&&(M=this.getData3dInspector(q)))}else this.currentView instanceof Mw?M=this.symbolInspector:this.currentView instanceof TX?M=this.displayInspector:this.currentView instanceof oN.SceneView&&(M=this.sceneInspector)}this.inspector=M,this.postUpdateInspector()},q.prototype.postUpdateInspector=function(){this.inspector&&this.inspector.filterProperties(),this._updateInspectorlater=!1},IN(q,[{key:"basicInspector",get:function(){return this._basicInspector||(this._basicInspector=new Tw(this.editor,"basic")),this._basicInspector}},{key:"borderInspector",get:function(){return this._borderInspector||(this._borderInspector=new kw(this.editor,"border")),this._borderInspector}},{key:"clipInspector",get:function(){return this._clipInspector||(this._clipInspector=new N$(this.editor,"clip")),this._clipInspector}},{key:"restoreInspector",get:function(){return this._restoreInspector||(this._restoreInspector=new e$(this.editor,"restore")),this._restoreInspector}},{key:"imageInspector",get:function(){return this._imageInspector||(this._imageInspector=new _w(this.editor,"image")),this._imageInspector}},{key:"pieChartInspector",get:function(){return this._pieChartInspector||(this._pieChartInspector=new zw(this.editor,"pieChart")),this._pieChartInspector}},{key:"oneDimensionalColumnChartInspector",get:function(){return this._oneDimensionalColumnChartInspector||(this._oneDimensionalColumnChartInspector=new Aw(this.editor,"oneDimensionalColumnChartInspector")),this._oneDimensionalColumnChartInspector}},{key:"columnChartInspector",get:function(){return this._columnChartInspector||(this._columnChartInspector=new Bw(this.editor,"columnChart")),this._columnChartInspector}},{key:"lineChartInspector",get:function(){return this._lineChartInspector||(this._lineChartInspector=new Lw(this.editor,"lineChart")),this._lineChartInspector}},{key:"shapeInspector",get:function(){return this._shapeInspector||(this._shapeInspector=new iw(this.editor,"shape")),this._shapeInspector}},{key:"textInspector",get:function(){return this._textInspector||(this._textInspector=new Fw(this.editor,"text")),this._textInspector}},{key:"funcTypeInspector",get:function(){return this._funcTypeInspector||(this._funcTypeInspector=new M$(this.editor,"func")),this._funcTypeInspector}},{key:"compTypeInspector",get:function(){return this._compTypeInspector||(this._compTypeInspector=new q$(this.editor,"comp")),this._compTypeInspector}},{key:"htShapeInspector",get:function(){return this._htShapeInspector||(this._htShapeInspector=new vw(this.editor,"Shape")),this._htShapeInspector}},{key:"htBlockInspector",get:function(){return this._htBlockInspector||(this._htBlockInspector=new ow(this.editor,"Block")),this._htBlockInspector}},{key:"htRefGraphInspector",get:function(){return this._htRefGraphInspector||(this._htRefGraphInspector=new Hw(this.editor,"RefGraph")),this._htRefGraphInspector}},{key:"htGroupInspector",get:function(){return this._htGroupInspector||(this._htGroupInspector=new Ww(this.editor,"Group")),this._htGroupInspector}},{key:"htEdgeInspector",get:function(){return this._htEdgeInspector||(this._htEdgeInspector=new Dw(this.editor,"Edge")),this._htEdgeInspector}},{key:"htNodeInspector",get:function(){return this._htNodeInspector||(this._htNodeInspector=new rw(this.editor,"Node")),this._htNodeInspector}},{key:"htTextInspector",get:function(){return this._htTextInspector||(this._htTextInspector=new Uw(this.editor,"Text")),this._htTextInspector}},{key:"htDataInspector",get:function(){return this._htDataInspector||(this._htDataInspector=new Yw(this.editor,"Data")),this._htDataInspector}},{key:"displayInspector",get:function(){return this._displayInspector||(this._displayInspector=new Qw(this.editor,"display")),this._displayInspector}},{key:"symbolInspector",get:function(){return this._symbolInspector||(this._symbolInspector=new lw(this.editor,"symbol")),this._symbolInspector}},{key:"inspector",get:function(){return this.getCenterView()},set:function(M){var q=this.getCenterView();M?(M.currentView=this.currentView,M.dataModel=this.dataModel,this.dataModel&&(M.data=this.dataModel.sm().ld()),M.g3d=this.g3d,this.getCenterView()!==M&&this.setCenterView(M)):this.setCenterView(null),M===q||null==M&&null==q||this.editor.fireEvent("inspectorUpdated",{inspector:M,oldInspector:q})}}]),q}(xe),w$=function(){function M(q){YN(this,M),this.editor=q}return M.prototype.showTip=function(M,q){this.tip.innerHTML=M,this.tip.parentNode!==document.body&&ht.Default.appendToScreen(this.tip);var N=O(q);this.tip.style.left=N.x+15+"px",this.tip.style.top=N.y+"px"},M.prototype.hideTip=function(){V(this.tip)},M.prototype.clearDropView=function(M,q){this._dropView&&(this._dropView.handleCrossDrag(M,"exit",q),this._dropView=null)},M.prototype.crossDrag=function(M,q){var N=this._dropView,e=this.$94$(M,q);N!==e?(N&&N.handleCrossDrag(M,"exit",q),e&&e.handleCrossDrag(M,"enter",q)):e&&e.handleCrossDrag(M,"over",q),this._dropView=e},M.prototype.crossDrop=function(M,q){this._dropView&&(this._dropView.handleCrossDrag(M,"drop",q),this._dropView=null)},M.prototype.crossCancel=function(M,q){this._dropView&&(this._dropView.handleCrossDrag(M,"cancel",q),this._dropView=null)},M.prototype.$94$=function(M,q){for(var N=m(M);N&&(!N._ht||!N._ht.isDroppable||q&&!N._ht.isDroppable(M,q));)N=N.parentNode;return N?N._ht:null},IN(M,[{key:"tip",get:function(){if(!this._tip){this._tip=A(),this._tip.className="ht-editor-dnd-tip";var M=this._tip.style;M.whiteSpace="nowrap",M.color=oN.config.color_light,M.background=oN.config.color_transparent,M.font=ht.Default.labelFont,M.padding="4px",M.borderRadius="4px",M.position="absolute",M.zIndex=1e4}return this._tip}}]),M}(),$$=function(){function M(q,N){YN(this,M),this.editor=q,this.dnd=q.dnd,this._dragInfo={view:this},N&&(N.addEventListener("dragenter",this.handle_dragenter.bind(this),!1),N.addEventListener("dragover",this.handle_dragover.bind(this),!1),N.addEventListener("dragleave",this.handle_dragleave.bind(this),!1),N.addEventListener("drop",this.handle_drop.bind(this),!1),N.addEventListener("dragexit",this.handle_dragexit.bind(this),!1),N.addEventListener("dragend",this.handle_dragend.bind(this),!1)),this.isDroppableToDisplayView=!0,this.isDroppableToSymbolView=!0,this.isDroppableToSceneView=!0}return M.prototype.handle_dragenter=function(M){NM(M),M.stopPropagation(),this.dnd.crossDrag(M,this._dragInfo)},M.prototype.handle_dragover=function(M){NM(M),M.stopPropagation(),this.dnd.crossDrag(M,this._dragInfo)},M.prototype.handle_dragleave=function(M){NM(M),M.stopPropagation(),this.dnd.crossCancel(M,this._dragInfo)},M.prototype.handle_dragexit=function(M){NM(M),M.stopPropagation(),this.dnd.crossCancel(M,this._dragInfo)},M.prototype.handle_dragend=function(M){NM(M),M.stopPropagation(),this.dnd.crossCancel(M,this._dragInfo)},M.prototype.handle_drop=function(M){NM(M),M.stopPropagation(),this.dnd.crossDrop(M,this._dragInfo)},M}(),t$=function(M){function q(N){YN(this,q);var e=dN(this,M.call(this));return e.editor=N,e.editable=!0,e}return rN(q,M),q.prototype.init=function(){var M=this;this.$72$(),this.$70$();var q=new Ke(this.funcPane,this.inspectorPane,"h",.5);this.setConfig({title:e("editor.layoutattach"),closable:!0,draggable:!0,width:oN.config.attachPointsViewSize.width,height:oN.config.attachPointsViewSize.height,resizeMode:"wh",maximizable:!0,content:q,buttons:[{label:e("editor.ok"),action:function(){M.ok()}},{label:e("editor.cancel"),action:function(){M.hide()}}],buttonsAlign:"right"})},q.prototype.$72$=function(){this.funcPane=new gw({argList:[["ht.Node","host","editor.comment.symbollayouthost"]]})},q.prototype.$73$=function(M,q,N,e){return{name:M,tag:M,accessType:"attr",width:N,displayName:q,align:"center",enum:e,editable:!0}},q.prototype.$70$=function(){var M=this;this.inspectorPane=new WN,this.tableModel=new ht.DataModel,this.tablePane=new pe(this.tableModel),this.tableView=this.tablePane.getTableView(),this.tableView.setEditable(!0),this.tableView.isEditable=function(){return M.editable},this.tablePane.getView().style.border=oN.config.color_line+" solid 1px",this.tablePane.addColumns([this.$73$("attr",e("editor.property"),90),this.$73$("valueType",e("editor.valuetype"),80,{values:oN.consts.valueTypes,labels:oN.consts.valueTypeLabels}),this.$73$("defaultValue",e("editor.defaultvalue"),90),this.$73$("name",e("editor.name"),80),this.$73$("group",e("editor.group"),80),this.$73$("description",e("editor.description"),120),this.$73$("extraInfo",e("editor.extrainfo"),100)]),this.$74$(),this.initExtraInfoColumn(),this.initI18nColumns(),this.inspectorPane.addRow([this.tablePane],[.1],.1),this.inspectorPane.addRow([{button:{toolTip:e("editor.add"),icon:"editor.add",onClicked:function(){M.editable&&M.addProperties({attr:"layout."},!0)}}},{button:{toolTip:e("editor.delete"),icon:"editor.delete",onClicked:function(){M.editable&&M.tableView.removeSelection()}}},null,{button:{icon:"editor.top",toolTip:e("editor.bringtofront"),onClicked:function(){M.editable&&M.tableView.sm().size()&&M.tableModel.moveSelectionToTop()}}},{button:{icon:"editor.up",toolTip:e("editor.bringforward"),onClicked:function(){M.editable&&M.tableView.sm().size()&&M.tableModel.moveSelectionUp()}}},{button:{icon:"editor.down",toolTip:e("editor.sendbackward"),onClicked:function(){M.editable&&M.tableView.sm().size()&&M.tableModel.moveSelectionDown()}}},{button:{icon:"editor.bottom",toolTip:e("editor.sendtoback"),onClicked:function(){M.editable&&M.tableView.sm().size()&&M.tableModel.moveSelectionToBottom()}}}],[20,20,.1,20,20,20,20])},q.prototype.$74$=function(){var M=this,q=this.tableView.getColumnModel().getDataByTag("defaultValue");q.getValue=function(M,q,N){var e=M.a("defaultValue");return"Angle"===M.a("valueType")&&e&&(e=e/Math.PI*180),e},q.setValue=function(M,q,N,e){"Angle"===M.a("valueType")&&(N=N*Math.PI/180),M.a("defaultValue",N)},q.getEnumValues=function(M){var q=M?oN.config.valueTypes[M.a("valueType")]:null;return q&&"enum"===q.type?q.values:null},q.getEnumLabels=function(M){var q=M?oN.config.valueTypes[M.a("valueType")]:null;return q&&"enum"===q.type?q.labels:null},q.getEnumIcons=function(M){var q=M?oN.config.valueTypes[M.a("valueType")]:null;return q&&"enum"===q.type?q.icons:null},q.getEnumDropDownWidth=function(M){var q=M?oN.config.valueTypes[M.a("valueType")]:null;return q&&"enum"===q.type?q.dropDownWidth:null},q.getValueType=function(M){var q=M?oN.config.valueTypes[M.a("valueType")]:null;return q?q.type:null},q.isCellEditable=function(q,N,X,w){var $=q?oN.config.valueTypes[q.a("valueType")]:null,t=$?$.type:null,E=q.a("extraInfo"),J=oN.config.handleDefaultVauleColumnEdit,u=function(M){q.a("defaultValue",M)};if(J&&J(u,$,t,E))return!1;if("function"===t){var g=e("editor.function")+" "+(q.a("property")||"");return M.editor.functionView.open(q.a("defaultValue"),u,g,E&&E.arguments),!1}if("multiline"===t)return M.editor.textView.open(q.a("defaultValue"),u,q.a("property")||"&nbsp;"),!1;if("font"===t)return M.editor.fontView.open(q.a("defaultValue"),u,q.a("property")||"&nbsp;"),!1;if("object"===t||"custom"===t||"stringArray"===t||"objectArray"===t||"numberArray"===t||"colorArray"===t){var S=e("editor.object")+" "+(q.a("property")||"");return M.editor.objectView.open(q.a("defaultValue"),u,S,null,"object"===t&&E&&E.objectProperties),!1}return!0}},q.prototype.initExtraInfoColumn=function(){var M=this;this.tableView.getColumnModel().getDataByTag("extraInfo").isCellEditable=function(q,N,X,w){var $=e("editor.extrainfo")+" "+(q.a("property")||"");return M.editor.objectView.open(q.a("extraInfo"),function(M){q.a("extraInfo",M)},$),!1}},q.prototype.initI18nColumns=function(){var M=this;["name","group"].forEach(function(q){var N=M.tableView.getColumnModel().getDataByTag(q);N.getValue=function(M,N,X){var w=M.a(q);return M._editing_?w:e(w)},
N.setValue=function(M,N,e,X){M.a(q,e),delete M._editing_},N.isCellEditable=function(M,q,N,e){return M._editing_=1,!0}})},q.prototype.addProperties=function(M,q){var N=this,e=M.attr,X=M.valueType,w=M.defaultValue,$=M.name,t=M.description,E=M.extraInfo,J=M.group,u=new ht.Data;u.a({attr:e||"",valueType:X||"String",defaultValue:w,name:$,description:t,extraInfo:E,group:J}),this.tableModel.add(u),this.tableModel.sm().ss(u),q&&setTimeout(function(){N.tableView.tx(0),mq(N.tableView,u,N.tableView.getColumnModel().getDataByTag("attr"),e)},100)},q.prototype.update=function(M,q){var N=this;this.funcPane.setFunctionValue(M),this.tableModel.clear(),q&&q.forEach(function(M){N.addProperties(M)})},q.prototype.open=function(M,q,N){this._init||this.init(),this.setValue=N,this.update(M,q),this.show(this.editor.$38$)},q.prototype.ok=function(){var M=this.setValue,q={func:this.funcPane.getFunctionValue()};this.tableModel.size()&&(q.properties=[],this.tableModel.eachByHierarchical(function(M){q.properties.push(VN(M.getAttrObject()))})),M(q),this.hide()},q}(DN),E$=function(){function M(q){YN(this,M),this.editor=q,this.editing3d=!1,this.targetNode=null,this.reset()}return M.prototype.reset=function(){this.points=[],this.segments=[],this.isBreak=!1,this.nextPoint=null,this.closePath=!1,this.preCtrl=null,this.drawPoint=null,this.downPoint=null,this.shape=null,this.setting=!1},M.prototype.setShape=function(M){this.shape=M},M.prototype.setPoint=function(M,q){this.points[M]=q},M.prototype.setSegment=function(M,q){this.segments[M]=q},M.prototype.setEditing3d=function(M){this.editing3d=M},M.prototype.isEditing3d=function(){return this.editing3d},M.prototype.getInfo=function(){return{isBreak:this.isBreak,nextPoint:this.nextPoint,closePath:this.closePath,preCtrl:this.preCtrl,drawPoint:this.drawPoint,downPoint:this.downPoint}},M.prototype.setInfo=function(M){this.isBreak=M.isBreak,this.nextPoint=M.nextPoint,this.closePath=M.closePath,this.preCtrl=M.preCtrl,this.drawPoint=M.drawPoint,this.downPoint=M.downPoint},M.prototype.createShape=function(M,q){var N=void 0;return OM(M)?N=M([],[]):(N=new q,N.setPoints([]),N.setSegments([])),this.targetNode=N,N},M}(),J$=function(M){function q(N){var X=arguments.length>1&&void 0!==arguments[1]?arguments[1]:300,w=arguments.length>2&&void 0!==arguments[2]?arguments[2]:500;YN(this,q);var $=dN(this,M.call(this));return $.editor=N,$.setConfig({title:e("editor.choosedirectory"),closable:!0,draggable:!0,width:X,height:w,contentPadding:6,resizeMode:"wh",maximizable:!0,content:$.initContent(),buttons:[{label:e("editor.ok"),action:function(){$.ok()}},{label:e("editor.cancel"),action:function(){$.hide()}}],buttonsAlign:"right"}),$}return rN(q,M),q.prototype.ok=function(){var M=this.tree.sm().ld();M&&this.onOk&&this.onOk(M),this.hide()},q.prototype.$48$=function(){this.hide()},q.prototype.$47$=function(){this.ok()},q.prototype.show=function(q,N,e){M.prototype.show.call(this),this.onOk=e,this.filter="";var X=q.tree.dm(),w=this.tree;w.dm()!==X&&this.tree.dm(X),this.tree.setRootData(X.getRoots().get(0));var $=N.length;N.lastIndexOf("/")===$-1&&(N=N.substr(0,$-1));var t=q.findFileNode(N);t&&w.sm().ss(t),w.expand(w.getRootData())},q.prototype.hide=function(){M.prototype.hide.call(this),this.tree.sm().cs(),this.tree.collapseAll()},q.prototype.initContent=function(){var M=this,q=this._treeForm=new ht.widget.FormPane,N=this._tree=new ht.widget.TreeView;N.setSelectionModelShared(!1),N.setRootVisible(!0),N.sm().setSelectionMode("single"),N.getLabel=function(M){return e("url:"+M.url,!0)||M.label||M.getName()},N.getIcon=oN.FileTree.prototype.getIcon.bind(N),N.hasExpandedChild=oN.FileTree.prototype.hasExpandedChild.bind(N),N.getToggleIcon=oN.FileTree.prototype.getToggleIcon.bind(N),N.isVisible=function(q){return!(!1===q.a("visible")||M._visibleFunc&&!1===M._visibleFunc(q)||"root"!==q.fileType&&"dir"!==q.fileType||M._fileVisibleMap&&!M._fileVisibleMap[q.uuid])},q.addRow([{id:"filter",textField:{}}],[.1],28),q.addRow([{element:N}],[.1],.1);var X=q.getViewById("filter").getElement();return X.onkeyup=function(q){q.isComposing||(ht.Default.isEsc(q)&&(X.value=""),M._filterFunc())},X.addEventListener("compositionstart",function(q){M._isComposing=!0}),X.addEventListener("compositionend",function(q){M._isComposing=!1,M._filterFunc()}),q},q.prototype._filterFunc=function(){if(!this._isComposing){var M=this.tree,q=this.filter;if(q){var N=this._fileVisibleMap={};M.dm().eachByDepthFirst(function(e){if("dir"===e.fileType){var X=M.getLabel(e);oN.matchString(X,q)&&(N[e.uuid]=!0);var w=e.getParent();w&&N[e.uuid]&&(N[w.uuid]=!0)}}),this._cloneExpandMap||(this._cloneExpandMap=ht.Default.clone(M._expandMap)),M.expandAll()}else this._fileVisibleMap=void 0,this._cloneExpandMap&&(M._expandMap=this._cloneExpandMap),this._cloneExpandMap=void 0;M.ivm()}},IN(q,[{key:"tree",get:function(){return this._tree}},{key:"filter",get:function(){return this._treeForm.v("filter")||""},set:function(M){this._treeForm.v("filter",M),this._filterFunc()}}]),q}(DN);oN.ChooseDirectoryDialog=J$;var u$=function(){function M(q){var N=this;YN(this,M),this.params=q||{},this.$38$=this.params.$38$,this._eventNotifier=new ht.Notifier;var e=ht.Default.getClass(oN.config.serviceClass)||hX;this.$39$=new e(function(M){N.handleServiceEvent(M),N.fireEvent(M.type,M)},this),this.emptyFunc=function(){}}return M.prototype.addEventListener=function(M,q,N){this._eventNotifier.add(M,q,N)},M.prototype.removeEventListener=function(M,q){this._eventNotifier.remove(M,q)},M.prototype.fireViewEvent=function(M,q,N){var e=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];N=N||{},M.sceneView?(e&&(q="sceneView"+q),N.sceneView=M.sceneView):"symbol"===M.type?(e&&(q="symbolView"+q),N.symbolView=M):"display"===M.type?(e&&(q="displayView"+q),N.displayView=M):"scene"===M.type&&(e&&(q="sceneView"+q),N.sceneView=M),this.fireEvent(q,N)},M.prototype.fireEvent=function(M,q){try{q=q||{},oN.config.handleEvent&&oN.config.handleEvent(this,M,q);var N="on"+M.charAt(0).toUpperCase()+M.slice(1);oN.config[N]&&oN.config[N](this,q),this.params&&this.params[N]&&this.params[N](this,q),this._eventNotifier.fire({editor:this,type:M,params:q})}catch(M){console.error("Paste error, ",M)}},M.prototype.handleServiceEvent=function(M){if("connected"===M.type)this.init&&(this.init(),this.init=null);else if("fileChanged"===M.type){var q=M.path;this.updateUIRefs(q);var N=Y(q),e=this.getFileNode(q);e&&(N=Y(e.getFileUUID())||N),N&&this.$99$(q),eM(q)?this.requestDisplays():XM(q)?this.requestSymbols():wM(q)?this.requestComponents():$M(q)?this.requestScenes():tM(q)?this.requestModels():EM(q)?this.requestUIs():JM(q)&&this.requestAssets()}else"download"===M.type?this.downloadFile(M.path):"confirm"===M.type&&this.requestImport(M.path)},M.prototype.init=function(){this._inspectorCompact=!J(oN.config.compactFilter),this.menus=[],this.cloneInfo={type:null,funcArray:[],jsonArray:[]},this.shapeHelper=new E$(this),this.initSID(),this.$6$(),this.requestResources(),this.$38$&&this.$38$.addEventListener("keydown",this.handleKeydown.bind(this),!1),this.dnd=new w$(this),this.dndFromOutside=new $$(this,this.mainPane.getView()),this.fireEvent("editorCreated"),this.fireEvent("mainMenuCreated"),this.fireEvent("mainToolbarCreated"),this.fireEvent("rightToolbarCreated");var M=this.params.open||q("hteditor")||oN.config.open;if(M){var N=oN.config.paramHandlers[M];if(N&&!N(this))return;gM(M)?this._pendingOpenJSON=M:"newdisplay"===M?this.newDisplayView():"newsymbol"===M?this.newSymbolView():"newcomponent"===M&&this.newComponent()}},M.prototype.$6$=function(){this.mainTabView=new qw(this),this.funcView=new Pw(this),this.eventView=new fw(this),this.functionView=new xw(this),this.objectView=new nw(this),this.textView=new Rw(this),this.fontView=new jw(this),this.iconsView=new Cw(this),this.componentView=new bw(this),this.messageView=new mw(this),this.attachPointsView=new Ow(this),this.symbolLayoutView=new t$(this),this.$7$(),this.$8$(),this.$10$(),this.$9$(),this.leftSplitView=new Ke(this.leftTopTabView,this.mainTabView,"h",oN.config.leftSplitViewPosition),this.rightSplitView=new Ke(this.rightTopBorderPane,this.rightBottomTabView,"v",oN.config.rightSplitViewPosition),this.mainSplitView=new Ke(this.leftSplitView,this.rightSplitView,"h",oN.config.mainSplitViewPosition),this.mainPane=new xe,this.mainPane.setTopView(this.topBorderPane),this.mainPane.setCenterView(this.mainSplitView),Sq(this.mainPane,this.$38$),this.mainPane.validateImpl(),this.initPaletteColors()},M.prototype.initSID=function(){var M=window.location.href.match("sid=([0-9a-z-]*)");M&&(this.sid=M[1])},M.prototype.requestResources=function(){this.requestDisplays(),this.requestSymbols(),this.requestComponents(),this.requestScenes(),this.requestModels(),this.requestUIs(),this.requestAssets()},M.prototype.$7$=function(){var M=this;this.mainToolbar=new Jw(this),this.rightToolbar=new uw(this),this.topBorderPane=new xe,this.topBorderPane.setCenterView(this.mainToolbar),this.topBorderPane.setRightView(this.rightToolbar),this.topBorderPane.setHeight(28),this.rightToolbar.onSumWidthChanged=function(){M.topBorderPane.setRightWidth(M.rightToolbar.getSumWidth())}},M.prototype.$8$=function(){this.displays=new mX(this,oN.config.displaysEditable),this.symbols=new OX(this,oN.config.symbolsEditable),this.components=new QX(this,oN.config.componentsEditable),this.scenes=new sX(this,oN.config.scenesEditable),this.models=new lX(this,oN.config.modelsEditable),this.uis=new YX(this,oN.config.uisEditable),this.assets=new IX(this,oN.config.assetsEditable),this.leftTopTabView=new Ce,this.scenesTab=this.leftTopTabView.add(e("editor.scenes"),this.scenes,!1,oN.config.scenesVisible),this.displaysTab=this.leftTopTabView.add(e("editor.displays"),this.displays,!1,oN.config.displaysVisible),this.symbolsTab=this.leftTopTabView.add(e("editor.symbols"),this.symbols,!1,oN.config.symbolsVisible),this.componentsTab=this.leftTopTabView.add(e("editor.components"),this.components,!1,oN.config.componentsVisible),this.modelsTab=this.leftTopTabView.add(e("editor.models"),this.models,!1,oN.config.modelsVisible),this.uisTab=this.leftTopTabView.add(e("editor.uis"),this.uis,!1,oN.config.uisVisible),this.assetsTab=this.leftTopTabView.add(e("editor.assets"),this.assets,!1,oN.config.assetsVisible),this.leftTopTabView.select(oN.config.scenesVisible?this.scenesTab:this.displaysTab),this.leftTopTabView.onTabChanged=function(M,q){if(q){var N=q.getView();0===N.tree.sm().size()&&N.tree.sm().ss(N.rootNode),q.getView().list.doLayout()}}},M.prototype.$9$=function(){this.inspectorTool=new Nw(this),this.inspectorPane=new X$(this),this.rightTopBorderPane=new xe,this.rightTopBorderPane.setTopView(this.inspectorTool),this.rightTopBorderPane.setCenterView(this.inspectorPane),this.rightTopBorderPane.setTopHeight(ht.Default.widgetHeaderHeight+6)},M.prototype.$10$=function(){var M=this;this.listPane=new Xw(this),this.layerPane=new ww(this),this.overview=new rX(this),this.dataView=new ew(this),this.symbolStatePane=new tw(this),oN.BatchView&&(this.batchView=new oN.BatchView(this));var q=this.rightBottomTabView=new Ce;this.listPaneTab=this.rightBottomTabView.add(e("editor.list"),this.listPane,!0),oN.config.layerEnabled&&(this.layerTab=this.rightBottomTabView.add(e("editor.layer"),this.layerPane,!1,!1)),oN.config.symbolStateEnabled&&(this.symbolStateTab=this.rightBottomTabView.add(e("editor.state"),this.symbolStatePane,!1,!1)),oN.config.overviewEnabled&&(this.overviewTab=this.rightBottomTabView.add(e("editor.overview"),this.overview)),oN.config.batchViewEnabled&&oN.BatchView&&(this.batchViewTab=this.rightBottomTabView.add(e("editor.batch"),this.batchView,!1,!1)),oN.config.dataViewEnabled&&(this.dataViewTab=this.rightBottomTabView.add(e("editor.data"),this.dataView));var N=this.rightBottomTabView.getTabModel().sm();N.ms(function(){var q=N.ld();q&&(M.dataView.visible=q.getView()===M.dataView,M.overview.setAutoUpdate(q.getView()===M.overview))}),q.getLabel=function(q){var N=q.toLabel();if(q===M.symbolStateTab){var e=M.symbolStatePane.tableModel.sm().ld();if(e){var X=e.a("stateDisplayName")||e.a("stateName");return N+(X?" - "+X:"")}}return N}},M.prototype.newFolder=function(M){var q=this,N=this.explorer;if(N){var X=M.sm().ld();M!==M.explorer.list||X&&"dir"===X.fileType||(X=M.explorer.tree.sm().ld()),X&&!N.isAccordionMode()||(X=M.explorer.rootNode);qq(e("editor.inputnewfoldername"),"",{nullable:!1,trim:!0,maxLength:oN.config.maxFileNameLength,checkFunc:oN.config.checkFileName,$38$:this.$38$,path:(X?X.url:N.rootDir)+"/",editor:this},function(M,N,w){if("ok"===N){var $=w+M;if(q.getFileNode($))return void eq(e("editor.filenameconflict"),$,function(){});q.request("mkdir",oN.config.vision?{dir:$,parent_uuid:X.uuid,root_dir:X.rootDir}:$,function(M){})}})}},M.prototype.getFileNode=function(M){for(var q=this.leftTopTabView.getTabModel().getDatas(),N=0;N<q.size();N++){var e=q.get(N);if(e.getView()instanceof CX){var X=e.getView().findFileNode(M);if(X)return X}}return null},M.prototype.selectFileNode=function(M,q){for(var N=this,e=this.leftTopTabView.getTabModel().getDatas(),X=0;X<e.size();X++){var w=e.get(X);if(w.isVisible()&&w.getView()instanceof CX){var $=function(){var e=w.getView();if(q&&e.rootDir!==q)return"continue";var X=e.findFileNode(M);return X?(N.leftTopTabView.getTabModel().sm().ss(w),e.isAccordionMode()?("dir"===X.fileType?e.accordion.sm().ss(X):(X.getParent().expanded=!0,e.accordion.sm().ss(X)),e.accordion.ivm()):"dir"===X.fileType||"root"===X.fileType?(e.tree.sm().ss(X),setTimeout(function(){e.tree.makeVisible(X)},500)):(e.tree.sm().ss(X.getParent()),e.list.sm().ss(X),setTimeout(function(){e.tree.makeVisible(X.getParent()),e.list.makeVisible(X)},500)),delete N._pendingSelectURL,{v:void 0}):void 0}();switch($){case"continue":continue;default:if("object"==typeof $)return $.v}}}this._pendingSelectURL=M},M.prototype.makeFileNodeVisible=function(M){for(var q=this.leftTopTabView.getTabModel().getDatas(),N=0;N<q.size();N++){var e=q.get(N),X=e.getView();if(X instanceof CX){var w=X.findFileNode(M);if(w){var $=w.getParent();X.tree.sm().ss($),X.tree.makeVisible($),X.list.makeVisible(w)}}}},M.prototype.renameFile=function(M,q,N){var X=this;if(!M||M.$33$||!1===M.a("editable")||!q)return!1;var w=q,$=0;gM(M.getName())&&!gM(q)&&(q+=".json",$=5),SM(M.getName())&&!SM(q)&&(q+=".htb",$=4);var t=M.path+"/"+q;if(!(q=oN.config.checkFileName(q,t)))return eq(e("editor.invalidinput"),w,function(){}),!1;if(q.length>oN.config.maxFileNameLength+$)return eq(e("editor.inputmax"),q,function(){}),!1;if(M.getName()===q)return!1;if(this.getFileNode(t))return eq(e("editor.filenameconflict"),t,function(){}),!1;M.$33$=t;var E={old:M.url,new:M.$33$,fileType:M.fileType};gM(E.old)&&this.request("rename",{old:KM(E.old),new:KM(E.new),fileType:"asset"},function(M){}),SM(E.old)&&this.request("rename",{old:pM(E.old),new:pM(E.new),fileType:"asset"},function(M){}),this.request("rename",E,function(e){var w=!1;if(e){X.mainTabView.getTabModel().each(function(N){if(N.getTag()===M.url){N.setTag(M.$33$);N.getView().url=M.$33$,N.setName(D(q)),N===X.tab&&X.dataView.updateUrl(M.$33$)}}),N();var $=VN(E);$.data=M,X.fireEvent("fileRenamed",$),w=!0}return delete M.$33$,w})},M.prototype.moveFile=function(M,q){if(M&&!1!==M.a("editable")&&q&&!M.$33$&&!q.$33$){var N={data:M,url:M.url,parent:q};if(this.fireEvent("fileMoving",N),!N.preventDefault){if(M.getParent()!==q){M.setParent(q),M.$33$=q.url+"/"+M.getName();var e={old:M.url,new:M.$33$};gM(e.old)&&this.request("rename",{old:KM(e.old),new:KM(e.new)},function(M){}),this.request("rename",e,function(q){delete M.$33$})}}}},M.prototype.removeFiles=function(M){var q=this;M.forEach(function(M){if(!M.$33$&&!1!==M.a("editable")){var N=M.url||M;gM(N)&&q.request("remove",oN.config.vision?{path:KM(N),uuid:M.uuid,root_dir:M.rootDir}:KM(N),function(M){}),q.request("remove",oN.config.vision?{path:N,uuid:M.uuid,root_dir:M.rootDir}:N,function(e){q.fireEvent("fileDeleted",{data:M,url:N})})}})},M.prototype.requestBase64=function(M,q){this.request("source",{url:M,encoding:"base64",prefix:"data:;base64,"},q)},M.prototype.request=function(M,q,N,e){var X=this;N=N||this.emptyFunc,e?setTimeout(function(){X.$39$.request(M,q,N)},e):this.$39$.request(M,q,N)},M.prototype.requestDisplays=function(){var M=this;this._requestingDisplays||(this.request("explore","/displays",function(q){M._requestingDisplays=!1,M.displays.parse(q),M._pendingOpenJSON&&eM(M._pendingOpenJSON)&&(M.displays.findFileNode(M._pendingOpenJSON)?(M.open(M._pendingOpenJSON),M.selectFileNode(M._pendingOpenJSON)):oN.config.newIfFailToOpen&&(M.newDisplayView(),M.save(null,M._pendingOpenJSON)),delete M._pendingOpenJSON),M._pendingSelectURL&&eM(M._pendingSelectURL)&&M.selectFileNode(M._pendingSelectURL)},oN.config.requestDelay),this._requestingDisplays=!0)},M.prototype.requestSymbols=function(){var M=this;this._requestingSymbols||(this.request("explore","/symbols",function(q){M._requestingSymbols=!1,M.symbols.parse(q),M._pendingOpenJSON&&XM(M._pendingOpenJSON)&&(M.symbols.findFileNode(M._pendingOpenJSON)?(M.open(M._pendingOpenJSON),M.selectFileNode(M._pendingOpenJSON)):oN.config.newIfFailToOpen&&(M.newSymbolView(),M.save(null,M._pendingOpenJSON)),delete M._pendingOpenJSON),M._pendingSelectURL&&XM(M._pendingSelectURL)&&M.selectFileNode(M._pendingSelectURL)},oN.config.requestDelay),this._requestingSymbols=!0)},M.prototype.requestComponents=function(){var M=this;this._requestingComponents||(this.request("explore","/components",function(q){M._requestingComponents=!1,M.components.parse(q),M._pendingOpenJSON&&wM(M._pendingOpenJSON)&&(M.components.findFileNode(M._pendingOpenJSON)?M.open(M._pendingOpenJSON):oN.config.newIfFailToOpen&&M.newComponent(),delete M._pendingOpenJSON),M._pendingSelectURL&&wM(M._pendingSelectURL)&&M.selectFileNode(M._pendingSelectURL)},oN.config.requestDelay),this._requestingComponents=!0)},M.prototype.requestScenes=function(){var M=this;oN.config.scenesVisible&&(this._requestingScenes||(this.request("explore","/scenes",function(q){M._requestingScenes=!1,M.scenes.parse(q),M._pendingOpenJSON&&$M(M._pendingOpenJSON)&&(M.scenes.findFileNode(M._pendingOpenJSON)?(M.open(M._pendingOpenJSON),M.selectFileNode(M._pendingOpenJSON)):oN.config.newIfFailToOpen&&(M.newSceneView(),M.save(null,M._pendingOpenJSON)),delete M._pendingOpenJSON),M._pendingSelectURL&&$M(M._pendingSelectURL)&&M.selectFileNode(M._pendingSelectURL)},oN.config.requestDelay),this._requestingScenes=!0))},M.prototype.requestModels=function(){var M=this;this._requestingModels||(this.request("explore","/models",function(q){M._requestingModels=!1,M.models.parse(q),M._pendingOpenJSON&&tM(M._pendingOpenJSON)&&(M.open(M._pendingOpenJSON),delete M._pendingOpenJSON),M._pendingSelectURL&&tM(M._pendingSelectURL)&&M.selectFileNode(M._pendingSelectURL)},oN.config.requestDelay),this._requestingModels=!0)},M.prototype.requestUIs=function(){var M=this;oN.config.uisVisible&&(this._requestingUIs||(this.request("explore","/uis",function(q){M._requestingUIs=!1,M.uis.parse(q),M._pendingOpenJSON&&EM(M._pendingOpenJSON)&&(M.uis.findFileNode(M._pendingOpenJSON)?(M.open(M._pendingOpenJSON),M.selectFileNode(M._pendingOpenJSON)):oN.config.newIfFailToOpen&&(M.newUIView(),M.save(null,M._pendingOpenJSON))),M._pendingSelectURL&&EM(M._pendingSelectURL)&&M.selectFileNode(M._pendingSelectURL)},oN.config.requestDelay),this._requestingUIs=!0))},M.prototype.requestAssets=function(){var M=this;this._requestingAssets||(this.request("explore","/assets",function(q){M._requestingAssets=!1,M.assets.parse(q),M._pendingOpenJSON&&JM(M._pendingOpenJSON)&&(M.open(M._pendingOpenJSON),delete M._pendingOpenJSON),M._pendingSelectURL&&JM(M._pendingSelectURL)&&M.selectFileNode(M._pendingSelectURL)},oN.config.requestDelay),this._requestingAssets=!0)},M.prototype.requestImport=function(M){var q=this;oN.config.importConfirm?eq("",e("editor.importconfirm"),function(){q.request("import",{path:M,move:!0})},function(){q.request("import",{path:M,move:!1})}):this.request("import",{path:M,move:!0})},M.prototype.downloadFile=function(M){try{var q=window.location.hostname,N=window.location.port,e=window.location.protocol+"//"+q+":"+N+"/"+M,X=document.createElement("iframe");X.src=e,X.style.display="none",document.body.appendChild(X);var w=Date.now(),$=setInterval(function(){var M=X.contentDocument||X.contentWindow.document;("complete"===M.readyState||"interactive"===M.readyState||Date.now()-w>3e4)&&(clearInterval($),document.body.removeChild(X))},800)}catch(M){}},M.prototype.$5$=function(M){var q=this,N=this._currentTab,e=this.rightBottomTabView.getTabModel().sm();if(this._currentTab=M,this.inspectorPane.$5$(M),this.listPane.$5$(M),oN.config.overviewEnabled&&this.overview.$5$(M),oN.config.dataViewEnabled&&this.dataView.$5$(M),oN.config.layerEnabled&&this.layerPane.$5$(M),oN.config.symbolStateEnabled&&this.symbolStatePane.$5$(M),oN.config.batchViewEnabled&&oN.BatchView&&this.batchView.$5$(M),this.mainToolbar.$5$(M),this.rightToolbar.$5$(M),this.inspectorTool.$5$(M),oN.config.layerEnabled&&this.layerTab.setVisible(!!this.displayView||!!this.sceneView),oN.config.symbolStateEnabled&&this.symbolStateTab.setVisible(!!this.symbolView),oN.config.batchViewEnabled&&oN.BatchView&&this.batchViewTab.setVisible(!!this.sceneView),(!this.symbolView&&this.symbolStateTab&&e.co(this.symbolStateTab)||this.symbolView&&this.layerTab&&e.co(this.layerTab)||!this.sceneView&&this.batchViewTab&&e.co(this.batchViewTab)||!M&&(this.symbolStateTab&&e.co(this.symbolStateTab)||this.layerTab&&e.co(this.layerTab)||this.batchViewTab&&e.co(this.batchViewTab)||this.problemsTab&&e.co(this.problemsTab)))&&e.ss(this.listPaneTab),M){var X=M.getView();X.gv&&X.gv.invalidateAll(),X.g3d&&X.g3d.invalidateAll(),ht.Default.callLater(function(){X.setFocus&&X.setFocus()})}else ht.Default.callLater(function(){var M=q.$38$;M&&M.focus()});this.fireEvent("tabUpdated",{tab:M,oldTab:N})},M.prototype.updateInspectorPropertiesLater=function(){this.inspector&&this.inspector.$34$()},M.prototype.beginTransaction=function(){this.dm&&this.dm.beginTransaction()},M.prototype.endTransaction=function(){this.dm&&this.dm.endTransaction()},M.prototype.getCurrentEditingPointValue=function(M){var q=this.gv;if(!q)return 0;var N=this.currentEditingPoint;if(!N)return 0;var e=N.world;if(!e){var X=q.getEditInteractor().getSubModule("Curve"),w=X.target;e=new ht.Math.Vector3(N.x,N.e,N.y),w.getPointsMatrix3d&&e.applyMatrix4(w.getPointsMatrix3d()),e=N.world={x:e.x,e:e.y,y:e.z}}return e[M]},M.prototype.setCurrentEditingPointValue=function(M,q){var N=this.gv;if(N){var e=N.getEditInteractor().getSubModule("Curve"),X=e.target,w=void 0;X.getPointsMatrix3d&&(w=X.getPointsMatrix3d(),w=w.getInverse(w));var $=VN(this.currentEditingPoint.world);$[M]=q,$=new ht.Math.Vector3($.x,$.e,$.y),w&&$.applyMatrix4(w),$={x:$.x,e:$.y,y:$.z},e.setCurrentPoint($)}},M.prototype.$99$=function(M){this.mainTabView.$99$(M)},M.prototype.updateUIRefs=function(M){this.mainTabView.updateUIRefs(M)},M.prototype.getDragPoint=function(M){return this.dnd.$94$(M)instanceof ht.graph3d.Graph3dView?this.sceneView.lp(M):this.gv.lp(M)},M.prototype.dropLocalFileOnView=function(M){if(this.currentView){var q={event:M};if(this.fireViewEvent(this.currentView,"OutsideDropping",q),!q.preventDefault)for(var N=M.dataTransfer.files,e=0;e<N.length;e++){var X=N[e],w=X.name;uM(w)?this.insertLocalImageFile(M,X):gM(w)&&this.insertLocalJSONFile(M,X)}}},M.prototype.insertLocalImageFile=function(M,q){var N=this;gq(q,function(e){if(N.sceneView){var X=new ht.Node;X.setAnchor3d(.5,0,.5),X.s({shape3d:"billboard","shape3d.image":e,autorotate:!0}),X.p(N.getDragPoint(M)),X.setDisplayName(W(q.name)),N.sceneView.addData(X,void 0,void 0,void 0,M)}else if(N.displayView){var w=new ht.Node;w.setImage(e),w.p(N.gv.lp(M)),w.setDisplayName(W(q.name)),N.displayView.addData(w,void 0,void 0,void 0,M)}else if(N.symbolView){var $=N.gv.lp(M),t=new be({type:"image",name:e,rect:[$.x,$.y,-1,-1]});t.setDisplayName(W(q.name)),N.symbolView.addData(t,void 0,void 0,void 0,M)}},!0)},M.prototype.insertLocalJSONFile=function(M,q){var N=this;gq(q,function(M){N.$97$(M)})},M.prototype.$97$=function(M){var q=this;if(M){this.beginTransaction(),M=a(M);var N=this.sceneView||this.displayView;if(N&&_N(M.d)){var e=this.gv,X=e.dm().deserialize(M,e.getCurrentSubGraph(),{justDatas:!0});e.sm().ss(X.toList(e.isSelectable,e)),X.each(function(M){N.addData(M,!0,!0)})}else this.symbolView&&_N(M.comps)&&M.comps.forEach(function(M){PN(M,q.symbolView)});this.gv.setFocus(),this.endTransaction()}},M.prototype.dropLocalFileOnDir=function(M,q){for(var N=M.dataTransfer.files,X=q.url,w=0;w<N.length;w++){var $=N[w].name;if(!oN.config.checkFileName($,X+"/"+$))return void eq(e("editor.invalidfilename"),$,function(){})}for(var t=0;t<N.length;t++)this.uploadLocalFile(N[t],X,q.uuid,q.rootDir)},M.prototype.uploadLocalFile=function(M,q,N,e){var X=this,w=oN.config.checkFileName(M.name,q+"/"+M.name);if(w)if("http"===oN.config.uploadFileMode){var $={path:q+"/"+w,file:M,parent_uuid:N,root_dir:e};this.request("uploadLocalFile",$)}else gq(M,function(M){var $={path:q+"/"+w,content:M,parent_uuid:N,root_dir:e};X.request(oN.config.vision?"drag":"upload",$)},!0)},M.prototype.addTab=function(M,q){this.mainTabView.add(M),this.fireEvent("tabCreated",{tab:M}),q&&this.mainTabView.getTabModel().sm().ss(M),this.mainTabView.validate()},M.prototype.openByJSON=function(M,q,N,e,X){this.mainTabView.getTabModel();if("display"===M){var w=this.mainTabView.getTabModel().getDataByTag(q);w||(w=new ht.Tab,w.setTag(q),w.setIcon("editor.display"),w.setClosable(!0),w.setName(N),new TX(this,w,q,e),this.addTab(w)),this.mainTabView.getTabModel().sm().ss(w)}else if("symbol"===M){var $=this.mainTabView.getTabModel().getDataByTag(q);$||($=new ht.Tab,$.setTag(q),$.setIcon("editor.symbol"),$.setClosable(!0),$.setName(N),new Mw(this,$,q,e),this.addTab($)),this.mainTabView.getTabModel().sm().ss($)}else if("component"===M)this.componentView.update(q,X,N,e);else if("ui"===M){var t=this.mainTabView.getTabModel().getDataByTag(q);t||(t=new ht.Tab,t._isUI=!0,t.setTag(q),t.setIcon("editor.ui-tab"),t.setClosable(!0),t.setName(N),new UIView(this,t,q,e),this.addTab(t)),this.mainTabView.getTabModel().sm().ss(t)}},M.prototype.isOpenable=function(M){return!oN.config.isOpenable||oN.config.isOpenable(M)},M.prototype.open=function(M,q,N){kN(M)&&(M=this.getFileNode(M)),M&&!M.$33$&&this.isOpenable(M)&&this.openFileNode(M,q,N)},M.prototype.openFileNode=function(M,q,N){var e=this;if("display"===M.fileType||"symbol"===M.fileType||"scene"===M.fileType||"ui"===M.fileType)this.mainTabView.open(M);else if("component"===M.fileType)this.componentView.open(M);else if("model"===M.fileType)this.openModel&&this.openModel(M);else if("asset"===M.fileType){var X=M.getFileUUID(),w=v(X),$=oN.config.fileOpeners[w];if($&&!$(this,M,q,N))return;if(PM(X))T(X,function(N){e.convertSVG(N,q,function(q,N){var X=q.output,w=X.imageMap;if(w?Object.keys(w).length:0){var $=[],t=M.path+"/"+D(M.getName())+"/";for(var E in w){var J=w[E].src,u=new RegExp("data:(image|img)/(.*?);base64").exec(J);u&&$.push({name:E,params:{path:t+E+"."+u[2],content:J,root_dir:"assets"}})}var g=X.comps.filter(function(M){return"image"===M.type}),S=function(){var M=$.shift();if(!M)return void N();e.request("upload",M.params,function(q){if(!q.error){var N=M.params.path;oN.config.vision&&(N=q.uuid+"."+q.postfix);var e=M.name;g.forEach(function(M){M.name===e&&(M.name=N)})}S()})};S()}else N()})});else if(fM(X))T(X,function(N){e.convertDXF(N,q,function(q,N){var X=q.comps,w=q.blockDef,$=[],t={},E=function(M,q){M.forEach(function(M){if("image"===M.type){var N=M.name;(t[N]||(t[N]=[])).push(M),q.indexOf(N)>=0||q.push(N)}})};E(X,$);for(var J=$;;){if(J=function(M){var q=[];return M.forEach(function(M){var N=w[M];N&&E(N.comps,q)}),q}(J),0===J.length)break;$.unshift.apply($,J)}var u="symbols/"+M.path.substr("assets/".length)+"/"+D(M.getName())+"/",g=function(){var M=$.shift();if(M){var q=u+M+".json";return void e.request("upload",{path:q,content:d(w[M]),root_dir:"symbols"},function(N){oN.config.vision&&(q=N.uuid+"."+N.postfix);var e=t[M];e&&e.forEach(function(M){return M.name=q}),delete t[M],g()})}N()};g()})});else if(RM(X)||GM(X)){if(!oN.FontConverterOptionView||!this.openFont)return;this.openFont(M)}}},M.prototype.convertSVG=function(M,q,N){var e=this,X=ht.Default.svgToShape(M,{segments:oN.config.svgSegments,minimumFontSize:oN.config.svgMinimumFontSize,gatherTextSize:oN.config.svgGatherTextSize});setTimeout(function(){var M=X.output,w=X.converter;w._canvas&&(M.width=w._canvas.width,M.height=w._canvas.height),M.comps.forEach(function(M){delete M.repeatImage});var $=function(){var N=q?e.newSymbolView(null,!1):e.newDisplayView(),X=N.dm;X.beginTransaction();var w=oN.toDatas(M.comps,q);w.forEach(function(M){M&&N.addData(M,!0)}),q&&(M.width&&X.a("width",M.width),M.height&&X.a("height",M.height)),e.fireEvent("svgConverted",{editor:e,toSymbol:q,comps:M.comps,datas:w}),N.gv.fitContent(oN.config.animate,oN.config.fitPadding),X.endTransaction()};N?N(X,$):$()},oN.config.svgWaitingTime)},M.prototype.convertDXF=function(M,q,N){var e=this,X=ht.Default.cadToShape(M,{boundingType:q?oN.config.cadToSymbolBoundingType:oN.config.cadToDisplayBoundingType,defaultColor:16777215}),w=function(){var M=q?e.newSymbolView(null,!1):e.newDisplayView(),N=M.dm;N.beginTransaction();var w=!1,$=[];for(var t in X.layers)$.unshift(X.layers[t]),w=w||"0"===t;w||$.unshift({name:"0"}),N.setLayers($),N.setBackground("#000000");var E=oN.toDatas(X.comps,q);E.forEach(function(q){M.addData(q,!0)}),q?(X.width&&N.a("width",X.width),X.height&&N.a("height",X.height)):E.forEach(function(M,q){var N=X.comps[q];M.a("cadEntity",N),M.setLayer(N.cadLayer||"0")}),e.fireEvent("dxfConverted",{editor:e,toSymbol:q,comps:X.comps,datas:E,result:X}),M.gv.fitContent(oN.config.animate,oN.config.fitPadding),N.endTransaction()};N?N(X,w):w()},M.prototype.$98$=function(M,q,N){var e=this;if(M){if(!this.tab)return void this.open(M);if(this.editable)if("display"!==M.fileType){if(this.url!==M.url)if("component"!==M.fileType)if("symbol"===M.fileType||uM(M.url)){if(this.displayView){var X=new ht.Node;if(X.setImage(M.getFileUUID()),q)X.p(q.x,q.y);else{var w=this.gv.getViewRect();w&&X.p(w.x+w.width/2,w.y+w.height/2)}X.setDisplayName(W(M.url)),this.displayView.addData(X,void 0,void 0,void 0,N)}else if(this.symbolView){var $=ht.Default.getImage(M.getFileUUID()),t=$?$.width:-1,E=$?$.height:-1,J=q?q.x:(this.dm.a("width")||0)/2,u=q?q.y:(this.dm.a("height")||0)/2,g=new be({type:"image",name:M.getFileUUID(),rect:[J-(t>0?t/2:0),u-(E>0?E/2:0),t,E]});g.setDisplayName(W(M.url)),this.symbolView.addData(g,void 0,void 0,void 0,N)}else if(this.sceneView){var S=M.getFileUUID(),b=new ht.Node;if(b.setAnchor3d(.5,0,.5),b.s({shape3d:"billboard","shape3d.image":S,autorotate:!0}),b.a("image2d.url",S),"symbol"===M.fileType&&b.s("alphaTest",.1),q)b.p3(q.x,q.e||0,q.y);else{var h=this.gv.getViewRect();h&&b.p(h.x+h.width/2,h.y+h.height/2)}b.setDisplayName(W(M.url)),this.sceneView.addData(b,void 0,void 0,void 0,N)}}else{if("scene"===M.fileType)return void(this.displayView&&oN.config.handleInsertSceneFileToDisplayView&&oN.config.handleInsertSceneFileToDisplayView(this.displayView,M,q));if("model"===M.fileType||SM(M.url)){if(this.displayView)oN.config.handleInsertModelFileToDisplayView&&oN.config.handleInsertModelFileToDisplayView(this.displayView,M,q);else if(this.sceneView){var y=new ht.Node;if(y.setAnchor3d(.5,0,.5),y.s({shape3d:M.getFileUUID()}),q)y.p3(q.x,q.e||0,q.y);else{var P=this.gv.getViewRect();P&&y.p(P.x+P.width/2,P.y+P.height/2)}y.setDisplayName(W(M.url)),this.sceneView.addData(y,void 0,void 0,void 0,N)}}else;}else if(this.symbolView){var f=new fe({type:M.getFileUUID(),rect:[q?q.x:(this.dm.a("width")||0)/2,q?q.y:(this.dm.a("height")||0)/2,-1,-1]},void 0,void 0,!0);f.setDisplayName(W(M.url)),this.symbolView.addData(f,void 0,void 0,void 0,N)}}else if(this.displayView)if(oN.config.insertDisplayViewAsRefGraph){var x=new ht.RefGraph;x.setRef(M.getFileUUID()),x.onPendingUpdated=function(){x.onPendingUpdated=null,x.p(q)},x.setDisplayName(W(M.url)),
this.displayView.addData(x,void 0,void 0,void 0,N)}else T(M.url,function(M){e.$97$(M,q)})}},M.prototype.newDisplayView=function(M){return this.mainTabView.newDisplayView(M)},M.prototype.newSymbolView=function(M,q){return this.mainTabView.newSymbolView(M,q)},M.prototype.newUIView=function(M){return this.mainTabView.newUIView(M)},M.prototype.newComponent=function(M){this.componentView.open(null,M)},M.prototype.isDebugTipShowing=function(){var M=this.g3d||this.gv;return M&&M.isDebugTipShowing()},M.prototype.toggleDebugTip=function(){var M=this.g3d||this.gv;M&&(M.isDebugTipShowing()?(M.hideDebugTip(),M.disableToolTip(),this.list.disableToolTip()):(M.showDebugTip(),M.enableToolTip(),this.list.enableToolTip()))},M.prototype.save=function(M,q){this.mainTabView.save(M,q)},M.prototype.saveAll=function(M){this.mainTabView.saveAll(M)},M.prototype.reload=function(){this.mainTabView.reload()},M.prototype.preview=function(){this.mainTabView.preview()},M.prototype.closeTab=function(M,q,N){this.mainTabView.closeTab(M,q,N)},M.prototype.closeOtherTabs=function(M,q){this.mainTabView.closeOtherTabs(M,q)},M.prototype.closeTabsToTheRight=function(M,q){this.mainTabView.closeTabsToTheRight(M,q)},M.prototype.closeAllTabs=function(M,q){this.mainTabView.closeAllTabs(M,q)},M.prototype.filterProperties=function(){this.inspector&&this.inspector.filterPropertiesLater()},M.prototype.isRulerEnabled=function(){return!!this.currentView&&this.currentView.isRulerEnabled()},M.prototype.setRulerEnabled=function(M){this.currentView&&this.currentView.setRulerEnabled(M)},M.prototype.toggleRulerEnabled=function(){this.setRulerEnabled(!this.isRulerEnabled())},M.prototype.isGridEnabled=function(){return!!this.currentView&&this.currentView.isGridEnabled()},M.prototype.setGridEnabled=function(M){this.currentView&&this.currentView.setGridEnabled(M)},M.prototype.toggleGridEnabled=function(){this.setGridEnabled(!this.isGridEnabled())},M.prototype.toggleLeft=function(){"normal"===this.leftSplitView.getStatus()?this.leftSplitView.setStatus("cl"):this.leftSplitView.setStatus("normal")},M.prototype.toggleRight=function(){if(this.currentView&&this.currentView.getPreferredSize){var M=this.currentView;M.isRightExpanded()?M.setRightExpanded(!1):M.setRightExpanded(!0)}else"normal"===this.mainSplitView.getStatus()?this.mainSplitView.setStatus("cr"):this.mainSplitView.setStatus("normal")},M.prototype.toggleBoth=function(){if("normal"===this.mainSplitView.getStatus()||"normal"===this.leftSplitView.getStatus())if(this.leftSplitView.setStatus("cl"),this.currentView&&this.currentView.getPreferredSize){var M=this.currentView;M.setRightExpanded(!1)}else this.mainSplitView.setStatus("cr");else if(this.leftSplitView.setStatus("normal"),this.currentView&&this.currentView.getPreferredSize){var M=this.currentView;M.setRightExpanded(!0)}else this.mainSplitView.setStatus("normal")},M.prototype.zoomIn=function(){this.gv&&this.gv.zoomIn(oN.config.animate)},M.prototype.zoomOut=function(){this.gv&&this.gv.zoomOut(oN.config.animate)},M.prototype.zoomReset=function(){this.gv&&this.gv.zoomReset(oN.config.animate)},M.prototype.zoomToFit=function(){this.gv&&this.gv.fitContent(oN.config.animate,oN.config.fitPadding)},M.prototype.fitSelection=function(){this.gv&&this.gv.fitSelection(oN.config.fitPadding,oN.config.animate)},M.prototype.delete=function(){this.gv&&this.gv.removeSelection()},M.prototype.copyFiles=function(){this.explorer.copyFiles()},M.prototype.pasteFiles=function(){this.explorer.pasteFiles()},M.prototype.copy=function(){var M=this;if(this.currentView&&"ui"===this.currentView.type)return this.currentView.copy();if(this.symbol3dView)return this.symbol3dView.copy();if(!this.ld)return!1;var q=this.cloneInfo;if(q.funcArray.length=0,q.jsonArray.length=0,q.offset={x:0,y:0,e:0},q.lastCheck=null,q.lastView=this.gv,q.sourceView=this.gv,this.displayView)q.type="display";else if(this.symbolView)q.type="symbol";else{if(!this.sceneView)return q.type=null,!1;q.type="scene"}var N=0,e=void 0,X={};this.selection.forEach(function(q){if(!q._refGraph){X[q._id]=q,q instanceof ht.Block&&!(q instanceof ht.RefGraph)&&qM(q,X);var w=sq(M.gv.dm(),q);N=Math.max(N,w),N===w&&(e=q)}}),q.lastData=e;var w=[],$=void 0;this.gv.each(function(M){X[M._id]&&(w.push(M),M instanceof ht.Node&&($=$?ht.Default.unionRect($,M.getRect()):M.getRect()))}),q.rect=$,this.gv.copyMap=X,w.forEach(function(N){var e=M.gv.isSelected(N),X=N.$50$(M.gv);if(0!==X.length){q.funcArray.push([N._id,e].concat(X));var w=qN(N);w&&q.jsonArray.push([e,w,q.funcArray.length-1])}}),this.fireEvent("copy",{datas:w,info:q}),this.gv.copyMap=null},M.prototype.hasCopyInfo=function(){return this.cloneInfo.funcArray.length>0},M.prototype.paste=function(M,q){var N=this;if(this.currentView&&"ui"===this.currentView.type)return void this.currentView.paste();if(this.symbol3dView)return this.symbol3dView.paste();if(this.editable){var X=this.gv,w=this.currentView,$=this.cloneInfo;if($.funcArray.length&&X){var t=[],E=[];if(this.beginTransaction(),ht.Default.setIsolating(!0),"display"===$.type&&this.displayView||"display"===$.type&&this.sceneView||"symbol"===$.type&&this.symbolView||"scene"===$.type&&this.sceneView||"scene"===$.type&&this.displayView){var J={},u=[],g=[];$.funcArray.forEach(function(M){var q=M[0],e=M[1],$=M[2],S=M[3],b=void 0;$.clazz===ht.Points&&w!==N.sceneView?($.clazz=ht.Node,b=S($,X),$.clazz=ht.Points):b=S($,X),w.addData(b,!0),J[q]=b,t.push(b),u.push($),g.push(q),e&&E.push(b)});var S=this.ld;S&&(S=J[S.getId()])&&(E.splice(E.indexOf(S),1),E.push(S));for(var b=0;b<t.length;b++)t[b].$49$(u[b],X,J);if(oN.config.pasteToLastSelectedIndex&&$.sourceView===X)for(var h=X.dm(),y=0,P=t.length;y<P;y++){var f=u[y];if(!J[f.parent]){var x=h.getDataById(g[y]);if(x){var n=h.getSiblings(x).indexOf(x)+1;h.moveTo(t[y],n)}}}if("symbol"!==$.type&&w!==this.symbolView&&$.sourceView!==X){var R={},G=X.getLayers();G&&G.forEach(function(M){return R[M.name]=1}),t.forEach(function(M){R[M.getLayer()]||M.setLayer("0")})}}else $.jsonArray.length&&$.jsonArray.forEach(function(M){var q=M[0],w=M[1],J=$.funcArray[M[2]][2],u=void 0;if("symbol"===$.type&&!N.symbolView&&J.clazz===fe){var g=J.s.type;if(!kN(g)||!g.startsWith(cN))return void N.showMessage(e("editor.componentsusederror"),"error");var S=g;"ht.drawing.chart"===S&&(S="ht.drawing.lineChart");var b=Object.assign({},J,{a:{},s:{},image:S,clazz:ht.Node}),h=ht.Default.getCompType(g),y=J.s;if(h){var P=h.properties;for(var f in y)P[f]?b.a[f]=y[f]:b.s[f]=y[f]}u=Hq(b,X)}u||(u=NN(w,!!N.symbolView,J.a)),u&&(u.setParent(X.getCurrentSubGraph()),N.currentView.addData(u,!0),t.push(u),q&&E.push(u))});ht.Default.setIsolating(!1);var j=oN.config.pasteOffset,K=0,p=0,C=0;if(CM(j)?K=p=j:_N(j)?3===j.length?(K=j[0],C=j[1],p=j[2]):2===j.length&&(K=j[0],p=j[1]):j&&("x"in j&&(K=j.x),"y"in j&&(C=j.y),"z"in j&&(p=j.z)),E.length&&this.sm.ss(E),$.lastView!==X&&($.offset.x=-K,$.offset.y=-p,$.offset.e=-C),!M&&t.length){var m=$.rect;if(q&&m?($.offset.x=q.x-m.x-m.width/2,$.offset.y=q.y-m.y-m.height/2):($.offset.x+=K,$.offset.y+=p),$.offset.e+=C,ht.Default.moveDatas(t,$.offset.x,$.offset.e,$.offset.y),!q&&!this.g3d){var O=X.$63$(t);O&&($.offset.x+=O.x,$.offset.y+=O.y,$.lastCheck||(ht.Default.moveDatas(t,-K,-C,-p),$.offset.x-=K,$.offset.y-=p,$.offset.e-=C)),$.lastCheck=O}}$.lastView=X,this.fireEvent("paste",{datas:t,info:$}),X.setFocus(),this.endTransaction()}}},M.prototype.block=function(){if(this.editable){var M=this.displayView||this.sceneView;if(!M)return void((M=this.symbol3dView)&&M.block());var q=this.selection;if(q.length){this.beginTransaction(),ht.Default.setIsolating(!0);var N=new ht.Block;M.addData(N,!0);var e=this.ld;N.setParent(e.getParent());var X=M.dm;X.moveTo(N,X.getSiblings(e).indexOf(e)+1),q.forEach(function(M){M.setHost&&M.setHost(void 0),M.setParent(N)}),ht.Default.setIsolating(!1),N.updateFromChildren(),X.sm().ss(N),this.endTransaction()}}},M.prototype.unblock=function(){if(this.editable){var M=this.displayView||this.sceneView;if(!M)return void((M=this.symbol3dView)&&M.unblock());var q=M.dm;this.beginTransaction();var N=[];this.selection.forEach(function(M){if(M instanceof ht.Block&&!(M instanceof ht.RefGraph)){ht.Default.setIsolating(!0);var e=M.getParent(),X=q.getSiblings(M).indexOf(M),w=M.getChildren().toArray();w.length>0&&w.forEach(function(M){M.setParent(e),q.moveTo(M,X++),N.push(M)}),M.removeFromDataModel(),ht.Default.setIsolating(!1),e instanceof ht.Block&&e.updateFromChildren()}}),N.length&&(this.sm.ss(N),this.gv.setFocus()),this.endTransaction()}},M.prototype.bringForward=function(){this.editable&&this.dm&&(this.dm.isHierarchicalRendering()?this.dm.moveSelectionDown():this.dm.bringSelectionForward())},M.prototype.bringToFront=function(){this.editable&&this.dm&&(this.dm.isHierarchicalRendering()?this.dm.moveSelectionToBottom():this.dm.bringSelectionToFront())},M.prototype.sendBackward=function(){this.editable&&this.dm&&(this.dm.isHierarchicalRendering()?this.dm.moveSelectionUp():this.dm.sendSelectionBackward())},M.prototype.sendToBack=function(){this.editable&&this.dm&&(this.dm.isHierarchicalRendering()?this.dm.moveSelectionToTop():this.dm.sendSelectionToBack())},M.prototype.undo=function(){ht.Default.popup&&ht.Default.popup.close(!0),this.editable&&(this._currentTab&&this._currentTab._isUI?this._currentTab.getView().undo():this.dataModelView&&this.dataModelView.isShowing()?this.dataModelView.dataModel.undo():this.dm.getHistoryManager()&&this.dm.getHistoryManager().canUndo()&&(this.dm.undo(),this.fireEvent("undo",{}),this.filterProperties()))},M.prototype.redo=function(){ht.Default.popup&&ht.Default.popup.close(!0),this.editable&&(this._currentTab&&this._currentTab._isUI?this._currentTab.getView().redo():this.dataModelView&&this.dataModelView.isShowing()?this.dataModelView.dataModel.redo():this.dm.getHistoryManager()&&this.dm.getHistoryManager().canRedo()&&(this.dm.redo(),this.fireEvent("redo",{}),this.filterProperties()))},M.prototype.distributeHorizontal=function(){this.editable&&this.inspectorTool.distributeHorizontal()},M.prototype.distributeVertical=function(){this.editable&&this.inspectorTool.distributeVertical()},M.prototype.alignLeft=function(){this.editable&&this.inspectorTool.alignLeft()},M.prototype.alignHorizontal=function(){this.editable&&this.inspectorTool.alignHorizontal()},M.prototype.alignRight=function(){this.editable&&this.inspectorTool.alignRight()},M.prototype.alignTop=function(){this.editable&&this.inspectorTool.alignTop()},M.prototype.alignVertical=function(){this.editable&&this.inspectorTool.alignVertical()},M.prototype.alignBottom=function(){this.editable&&this.inspectorTool.alignBottom()},M.prototype.folder=function(){if(this.editable&&this.displayView){this.beginTransaction();var M=new ht.Data;M.s("editor.folder",!0),this.dm.add(M);this.list.getTopRowOrderSelection().each(function(q){M.addChild(q)}),this.sm.ss(M),this.endTransaction()}},M.prototype.unfolder=function(){var M=this;if(this.editable&&this.displayView){this.beginTransaction();var q=this.sm.toSelection(function(M){return M.s("editor.folder")});q.forEach(function(M){M.toChildren().forEach(function(q){q.setParent(M.getParent())})}),q.forEach(function(q){M.dm.remove(q)}),this.endTransaction()}},M.prototype.locate=function(M){M&&this.request("locate",M.url||M)},M.prototype.saveImage=function(M,q,N,e,X,w){var $=this,t=function(){var t={uuid:e,path:q,content:Pq(M),parent_uuid:X,root_dir:w};$.request("upload",t,N)};if(kN(M)&&!ht.Default.getImage(M))if(/.json$/.test(M))ht.Default.xhrLoad(M,function(q){q&&(ht.Default.setImage(M,ht.Default.parse(q)),t())});else{var E=new window.Image;E.onload=function(){ht.Default.setImage(M,E),t()},E.src=M}else t()},M.prototype.$48$=function(M){if(iN.length)for(var q=0,N=iN.length;q<N;q++){var e=iN[q];if(e.getView().contains(M.target))return void(e.$48$&&e.$48$())}for(var X=0;X<this.menus.length;X++)if(this.menus[X].isShowing())return void this.menus[X].hide();if(this.funcView&&this.funcView.smartClose&&this.funcView.getView().parentNode)return void this.funcView.$48$();if(this.iconsView&&this.iconsView.getView().parentNode)return void this.iconsView.hide();if(this.inspectorInputFilter)return void(this.inspectorInputFilter="");if(!this.listPane.$48$(M)&&!this.explorer.$48$(M)&&this.tab){var w=this.tab.getView();return void[w.graphView,w.g3d].forEach(function(q){if(q){var N=q.getInteractors();N&&N.each(function(q){!q.disabled&&q.$48$&&q.$48$(M)})}})}},M.prototype.$47$=function(M){if(iN.length){if((M.target._ignore||!Mq(M.target))&&!ht.Default.popup){var q=iN[iN.length-1];q.$47$&&q.$47$()}}else;},M.prototype.handleKeydown=function(M){var q=M.keyCode;if(k(M)&&83===q&&M.preventDefault(),R(M))return void this.$48$(M);if(n(M))return void this.$47$(M);var N={event:M};return this.fireEvent("keydown",N),N.preventDefault?void 0:k(M)&&83===q?void this.save():void(Mq(M.target)||(M.preventDefault(),80===q?this.preview():187===q?this.zoomIn():189===q?this.zoomOut():48===q?this.zoomToFit():57===q?this.zoomReset():k(M)&&67===q?this.copy():k(M)&&86===q?this.paste():k(M)&&_(M)&&90===q?this.redo():k(M)&&90===q?this.undo():M.altKey&&k(M)&&221===q?this.bringToFront():M.altKey&&k(M)&&219===q?this.sendToBack():k(M)&&221===q?this.bringForward():k(M)&&219===q?this.sendBackward():90===q?this.fitSelection():k(M)&&_(M)&&71===q?this.unblock():k(M)&&71===q&&this.block()))},M.prototype.createDisplayItem=function(M,q,N,e,X,w){var $=this,t=function(){return $.displayView&&$.displayView.$3$()===M},E=wq(M,q,N,t);return E.visible=function(){return!!$.displayView&&$.editable},E.action=function(){$.displayView&&$.displayView.$4$(M,e,X,w)},E},M.prototype.createSymbolItem=function(M,q,N,e,X,w){var $=this,t=function(){return $.symbolView&&$.symbolView.$3$()===M},E=wq(M,q,N,t);return E.visible=function(){return!!$.symbolView&&$.editable},E.action=function(){$.symbolView&&$.symbolView.$4$(M,e,X,w)},E},M.prototype.showMessage=function(M,q,N){this.messageView.show(M,q,N)},M.prototype.showConfirm=function(M,q,N,X){var w=N,$=X;OM(w)&&(w=[{label:e("editor.yes"),action:function(){N&&N(this),this.hide()}},{label:e("editor.no"),action:function(){X&&X(this),this.hide()}},{label:e("editor.cancel"),action:function(){this.hide()}}]),Nq(M,q,w,$)},M.prototype.batchConvertSVG=function(M){var q=this,N=[],X=[];M.forEach(function(M){PM(M.url)&&(N.push(M.url),X.push(M))});var w=2*N.length,$=0,t=function(){++$===w&&q.showMessage(nq(e("editor.batchconvertsuccess"),N.length+""))};T(N,function(M){M.forEach(function(M,N){var e=X[N],w=ht.Default.svgToShape(M,{segments:oN.config.svgSegments,minimumFontSize:oN.config.svgMinimumFontSize,gatherTextSize:oN.config.svgGatherTextSize}),$=e.path.replace(/^assets/g,"symbols"),E=e.getName().replace(/svg$/g,"json");setTimeout(function(){var M=w.output,N=w.converter;N._canvas&&(M.width=N._canvas.width,M.height=N._canvas.height),q.request("upload",{path:$+"/"+E,content:d(M)},t),E=e.getName().replace(/svg$/g,"png"),q.request("upload",{path:$+"/"+E,content:Pq(M)},t)},oN.config.svgWaitingTime)})})},M.prototype.$103$=function(M){},M.prototype.addShapeSplitMenuItems=function(M){Cq.call(this,M)},M.prototype.hasInspector=function(M){return M&&!M._isUI},M.prototype.uploadPaletteColors=function(){localStorage.setItem("paletteConfig",JSON.stringify({paletteColors:oN.config.paletteColors,linearPaletteColors:oN.config.linearPaletteColors,radialPaletteColors:oN.config.radialPaletteColors}))},M.prototype.initPaletteColors=function(){var M=localStorage.getItem("paletteConfig");M&&(M=JSON.parse(M),["paletteColors","linearPaletteColors","radialPaletteColors"].forEach(function(q){M[q]&&(oN.config[q]=M[q])}))},IN(M,[{key:"editable",get:function(){return this.componentView.isShowing()?this.componentView.editable:!!this.currentView&&this.currentView.editable},set:function(M){this.currentView&&(this.currentView.editable=M)}},{key:"dm",get:function(){return this.gv?this.gv.dm():null}},{key:"gv",get:function(){var M=this.mainTabView.getTabModel().sm().ld();if(M){return M.getView().graphView}return null}},{key:"editInteractor",get:function(){return this.gv?this.gv.getEditInteractor():null}},{key:"pointsEditingMode",get:function(){var M=this.editInteractor;return!!M&&!!M.getSubModule("Curve").activing},set:function(M){this.editInteractor&&(this.editInteractor.pointsEditingMode=M)}},{key:"anchorVisible",get:function(){return!!this.gv&&this.gv.getEditStyle("anchorVisible")},set:function(M){this.gv&&this.gv.setEditStyle("anchorVisible",M)}},{key:"sm",get:function(){return this.gv?this.gv.sm():this.g3d?this.g3d.sm():null}},{key:"ld",get:function(){return this.sm?this.sm.ld():null}},{key:"selection",get:function(){var M=this,q=[];return this.g3d?this.sm.getSelection().toArray():(this.gv&&this.gv.each(function(N){M.gv.isSelected(N)&&q.push(N)}),q)}},{key:"tabs",get:function(){return this.mainTabView.tabs}},{key:"inspector",get:function(){return this.inspectorPane.inspector}},{key:"list",get:function(){return this.listPane.list}},{key:"tab",get:function(){return this.mainTabView.currentTab}},{key:"url",get:function(){return this.tab?this.tab.getTag():null}},{key:"explorer",get:function(){var M=this.leftTopTabView.getTabModel().sm().ld();return M&&M.getView()}},{key:"dir",get:function(){return this.explorer?this.explorer.tree.getSelectionModel().getLastData():null}},{key:"file",get:function(){return this.explorer?this.explorer.getFileListView().getSelectionModel().getLastData():null}},{key:"currentLayer",get:function(){return this.layerPane.currentLayer}},{key:"currentView",get:function(){var M=this.tab;return M?M.getView():null}},{key:"displayTree",get:function(){return this.displayView?this.displayView.displayTree:null}},{key:"displayView",get:function(){var M=this.currentView;return M instanceof TX?M:null}},{key:"symbolList",get:function(){return this.symbolView?this.symbolView.symbolList:null}},{key:"symbolView",get:function(){var M=this.currentView;return M instanceof Mw?M:null}},{key:"currentEditingPoint",get:function(){var M=this.currentView;return M?M.currentEditingPoint:null}},{key:"inspectorCompact",get:function(){return this._inspectorCompact},set:function(M){this._inspectorCompact=M,this.filterProperties(),this.inspectorTool.iv()}},{key:"inspectorInputFilter",get:function(){return this.inspectorTool.searchField.getValue()},set:function(M){this.inspectorTool.searchField.setValue(M),this.filterProperties()}},{key:"chooseDirectoryDialog",get:function(){return this._chooseDirectoryDialog||(this._chooseDirectoryDialog=new J$(this)),this._chooseDirectoryDialog}}]),M}();MM(u$,{ms_fire:1}),oN.Editor=u$;var g$=function(){function M(q,N){var e=this;YN(this,M),this.editor=N,this.handler=q,this.cookie=0,this.callbacks={},this.cmds={},this.fileChangeVersion=String((new Date).getTime());var X=oN.config.host||window.location.hostname,w=oN.config.port||window.location.port,$=this.url=window.location.protocol+"//"+X+":"+w;setTimeout(function(){e.handler({type:"connected",message:$})},1),oN.config.checkForFileChanges&&oN.config.checkForFileChangesInterval&&this.fileChangedEvent()}return M.prototype.request=function(M,q,N){var e=++this.cookie;this.callbacks[e]=N,this.cmds[e]=M;var X=this.editor.sid;this[M](e,q,X||null,N);var w=M;q&&(kN(q)?w=M+": "+q:q.path&&(w=M+": "+q.path)),this.handler({type:"request",message:w,cmd:M,data:q})},M.prototype.fileChangedEvent=function(){var M=this,q=this.url+"/fileVersion";q+="/"+M.fileChangeVersion,q+="?sid="+this.editor.sid,M.send("GET",q,null,function(q){M.fileChangeVersion=String((new Date).getTime());var N=q.target.response;if(N){N=JSON.parse(N);Object.keys(N).forEach(function(q){M.handler({type:"fileChanged",path:q})})}}),setTimeout(function(){M.fileChangedEvent()},oN.config.checkForFileChangesInterval)},M.prototype.export=function(M,q,N){var e=this,X=new ht.Request,w={},$=new FormData,t=this.url+"/export";t+="?sid="+N,$.append("dir",q),w.url=encodeURI(t),w.method="POST",w.data=$,w.responseType="blob",X.onload=function(q){var N=q.target;if(200===N.status||0===N.status){var X=N.response,w=N.getResponseHeader("Content-Disposition").split(";"),$=w[1].split("=")[1],t=new Blob([X],{type:"application/zip"}),E=document.createElement("a");E.href=window.URL.createObjectURL(t),E.download=decodeURI($),E.click(),e.handleRespone(M,!0)}},X.send(w)},M.prototype.mkdir=function(M,q,N){var e=this,X=new ht.Request,w={},$=new FormData,t=this.url+"/mkdir";t+="?sid="+N,oN.config.vision?($.append("path",q.dir),$.append("parent_uuid",q.parent_uuid)):$.append("path",q),w.url=encodeURI(t),w.method="POST",w.data=$,X.onload=function(q){var N=q.target;if(200===N.status||0===N.status){var X=N.response||N.responseText;e.handleRespone(M,"true"===X),e.handler({type:"fileChanged",path:dir})}},X.send(w)},M.prototype.explore=function(M,q,N){var e=this,X=new ht.Request,w={},$=this.url+"/explore";$+=q,$+="?sid="+N,w.url=encodeURI($),X.onload=function(q){var N=q.target;if(200===N.status||0===N.status){var X=N.response||N.responseText;e.handleRespone(M,JSON.parse(X))}},X.send(w)},M.prototype.upload=function(M,q,N){var e=this,X=new FormData,w=this.url+"/upload",$=q.path;w+="?sid="+N,X.append("path",q.path),X.append("content",q.content),e.send("POST",w,X,function(q){var N=q.target;if(200===N.status||0===N.status){var X=N.response;if(e.handleRespone(M,!0),X){var w=JSON.parse(X);e.handler({type:"confirm",path:w.tempName,datas:w.paths})}else e.handler({type:"fileChanged",path:$})}})},M.prototype.rename=function(M,q,N){var e=this,X=new FormData,w=q.new,$=q.old,t=this.url+"/rename";t+="?sid="+N,X.append("newPath",w),X.append("oldPath",$),e.send("POST",t,X,function(q){var N=q.target;if(200===N.status||0===N.status){var X=N.response||N.responseText;e.handleRespone(M,"true"===X),"true"===X&&(e.handler({type:"fileChanged",path:w}),e.handler({type:"fileChanged",path:$}))}})},M.prototype.remove=function(M,q,N){var e=this,X=new FormData,w=this.url+"/remove";w+="?sid="+N,X.append("path",q),e.send("POST",w,X,function(N){var X=N.target;if(200===X.status||0===X.status){var w=X.response||X.responseText;e.handleRespone(M,"true"===w),"true"===w&&e.handler({type:"fileChanged",path:q})}})},M.prototype.locate=function(M,q,N){var e=this,X=this.url+"/locate";X+="?dir="+q,X+="&sid="+N,e.send("GET",X,null,function(q){var N=q.target;200!==N.status&&0!==N.status||e.handleRespone(M,!0)})},M.prototype.open=function(M,q,N){var e=this,X=this.url+"/open";X+="?url="+q,X+="&sid="+N,e.send("GET",X,null,function(q){var N=q.target;200!==N.status&&0!==N.status||e.handleRespone(M,!0)})},M.prototype.source=function(M,q,N){var e=this,X=new FormData,w=this.url+"/source";w+="?sid="+N,X.append("url",q.url),X.append("encoding",q.encoding),X.append("prefix",q.prefix),e.send("POST",w,X,function(q){var N=q.target;if(200===N.status||0===N.status){var X=N.response||N.responseText;e.handleRespone(M,X)}})},M.prototype.import=function(M,q,N){var e=this,X=new FormData,w=this.url+"/import";w+="?sid="+N,X.append("path",q.path),X.append("move",q.move),e.send("POST",w,X,function(q){var N=q.target;200!==N.status&&0!==N.status||e.handleRespone(M,!0)})},M.prototype.paste=function(M,q,N){var e=this,X=new FormData,w=this.url+"/paste";w+="?sid="+N,X.append("destDir",q.destDir),X.append("fileList",q.fileList),e.send("POST",w,X,function(q){var N=q.target;if(200===N.status||0===N.status){var X=N.response||N.responseText;e.handleRespone(M,X)}})},M.prototype.uploadLocalFile=function(M,q,N){var e=this,X=new FormData,w=this.url+"/uploadFile",$=q.path;w+="?sid="+N,X.append("path",q.path),X.append("file",q.file),e.send("POST",w,X,function(q){var N=q.target;if(200===N.status||0===N.status){var X=N.response;if(e.handleRespone(M,!0),X){var w=JSON.parse(X);e.handler({type:"confirm",path:w.tempName,datas:w.paths})}else e.handler({type:"fileChanged",path:$})}})},M.prototype.send=function(M,q,N,e){var X=new ht.Request,w={};w.url=encodeURI(q),w.method=M,w.data=N,e&&(X.onload=e),X.send(w)},M.prototype.handleRespone=function(M,q){var N=this.callbacks[M],e=this.cmds[M];delete this.callbacks[M],delete this.cmds[M],this.handler({type:"response",message:e,cmd:e,data:q}),N&&N(q)},M}(),S$=new ht.graph.GraphView,b$=S$.getCoreInteractor().getClass();S$=void 0;var h$=b$.prototype,y$=h$.handleClick;h$.handleClick=function(M,q,N){(N.interactiveInfo||N.ui.interactiveInfo)&&y$.call(this,M,q,N)};var P$=h$.handle;return h$.handle=function(M,q,N){if((N=P$.call(this,M,q,N))&&(N.interactiveInfo||N.ui.interactiveInfo))return N},oN.logEditorInfo=function(){oN.config.logEditorInfo&&console.log("HT Editor v5.0.2 powered by HT for Web v"+ht.Default.getVersion()+" from www.hightopo.com")},!window.onbeforeunload&&oN.config.promptBeforeClosing&&(window.onbeforeunload=function(M){return M.returnValue=e("editor.closetip"),M.returnValue}),oN.version="5.0.2",oN.FILE_TYPE_UNKNOWN="unknow",oN.FILE_TYPE_ROOT="root",oN.FILE_TYPE_DIR="dir",oN.FILE_TYPE_ASSET="asset",oN.FILE_TYPE_SYMBOL="symbol",oN.FILE_TYPE_DISPLAY="display",oN.FILE_TYPE_COMPONENT="component",oN.FILE_TYPE_MODEL="model",oN.FILE_TYPE_UI="ui",oN.FILE_TYPE_SCENE="scene",oN.FILE_LAYOUT_LIST="list",oN.MESSAGE_TYPE_NORMAL="normal",oN.MESSAGE_TYPE_ERROR="error",oN.getString=e,oN.stringifyFunction=u,oN.parseFunction=S,oN.createLabel=$q,oN.createButton=Jq,oN.createItem=wq,oN.layoutMainView=Sq,oN.msClass=MM,oN.initContext=F,oN.getInput=qq,oN.trimExtension=D,oN.fileNameToDisplayName=W,oN.isJSON=gM,oN.isHTB=SM,oN.isWexbim=bM,oN.isJS=jM,oN.isDXF=fM,oN.isOBJ=xM,oN.isSVG=PM,oN.isDisplay=eM,oN.isScene=$M,oN.isSymbol=XM,oN.isAsset=JM,oN.isComponent=wM,oN.isUI=EM,oN.isImage=uM,oN.isModel=tM,oN.isMTL=nM,oN.isSound=hM,oN.isVideo=yM,oN.getter=b,oN.setter=h,oN.snapshot=Pq,oN.CodeEditor=vN,oN.createCodeEditor=xq,oN.FunctionEditor=gw,oN.ContextMenu=ne,oN.Dialog=DN,oN.SplitView=Ke,oN.FormPane=WN,oN.TablePane=pe,oN.TabView=Ce,oN.DND=w$,oN.DNDFromOutside=$$,oN.DNDTree=yX,oN.DNDIndexList=kX,oN.EditGraphView=dX,oN.DisplayGraphView=aX,oN.SymbolList=ZX,oN.FileTree=PX,oN.FileList=GX,oN.DisplayTree=xX,oN.DisplayView=TX,oN.MainTabView=qw,oN.MainToolbar=Jw,oN.MainMenu=Ew,oN.MessageView=mw,oN.ObjectView=nw,oN.EditView=vX,oN.FontView=jw,oN.FunctionView=xw,oN.TextView=Rw,oN.ComponentView=bw,oN.SymbolView=Mw,oN.RightToolbar=uw,oN.ListPane=Xw,oN.InspectorTool=Nw,oN.Inspector=JX,oN.HTDataInspector=Yw,oN.HTNodeInspector=rw,oN.HTTextInspector=Uw,oN.HTShapeInspector=vw,oN.HTGroupInspector=Ww,oN.HTBlockInspector=ow,oN.HTRefGraphInspector=Hw,oN.HTEdgeInspector=Dw,oN.DisplayInspector=Qw,oN.SymbolInspector=lw,oN.CompInspector=Vw,oN.BasicInspector=Tw,oN.InspectorPane=X$,oN.Explorer=CX,oN.Scenes=sX,oN.Models=lX,oN.Assets=IX,oN.Components=QX,oN.Displays=mX,oN.Symbols=OX,oN.UIs=YX,oN.FileNode=jX,oN.WebSocketService=hX,oN.HTTPService=g$,oN.CreateNodeInteractor=HX,oN.CreateEdgeInteractor=UX,oN.CreateShapeInteractor=VX,oN.removeItem=E,oN.confirm=Nq,oN.alert=eq,oN.getPElement=Xq,oN.initImageIcon=Oq,oN.initInputDND=Qq,oN.jsonToPNG=KM,oN.htbToPNG=pM,oN.getDataBindingMap=fq,oN.readLocalFile=gq,oN.removeCache=Y,oN.DIRECTORY_TYPE_NORMAL=1,oN.DIRECTORY_TYPE_PROJECT=2,oN.DIRECTORY_TYPE_ROOT=3,oN.DIRECTORY_TYPE_SYSTEM=4,oN.DIRECTORY_TYPE_DRAWING=5,oN.DRAWING_KEY=cN,oN.showingDialogs=iN,oN.matchString=lq,oN.convertGradientPack=Yq,oN.formatString=nq,oN.getFilePostfix=o,oN.toGradientByPackData=Iq,oN.symbol={Image:be},oN.toSymbolData=eN,oN.GradientDropDown=$X,oN.stringToObject=M,oN.createEditor=function(M){oN.logEditorInfo(),M&&(ht.Default.isString(M)?M={container:M}:M.tagName&&M.appendChild&&(M={container:M})),M=M||{};var q=void 0,N=void 0===M.container?oN.config.container:M.container;return null===N?q=null:N?ht.Default.isString(N)?q=document.getElementById(N):N.length?(q=ht.Default.createDiv(),q.style.left=N[0]+"px",q.style.top=N[1]+"px",q.style.width=N[2]+"px",q.style.height=N[3]+"px",document.body.appendChild(q)):q=N:q=document.body,M.$38$=q,new u$(M)},oN.init=function(){if(!oN.consts){var M=e("MAX_INDENT_TEST_STRING",!0);M&&(oN.config.indent=ht.Default.getTextSize(void 0,M).width+4-ht.Default.textExtraWidth),M=e("MAX_INDENT2_TEST_STRING",!0),M&&(oN.config.indent2=ht.Default.getTextSize(void 0,M).width+4-ht.Default.textExtraWidth),jN(),GN(),RN(),oN.config.initStudio&&oN.config.initStudio()}},oN}();