!function(Q,L,y){"use strict";var q="ht",A=Q[q],F=A.Default,Y=A.graph,b=F.getInternal(),I=b.ui(),D=I.NodeUI.prototype,s=I.ShapeUI.prototype,P=Y.GraphView,K=P.prototype,$=I.EdgeUI.prototype,T=A.Node,u=A.Shape,n=A.Edge,J=A.Group,d=F.isTouchable,S=F.isTouchEvent,g=F.preventDefault,B=Q.setTimeout,U=F.grow,a=F.isDragging,R=F.getDistance,e=null,r=A.List,W="undefined"!=typeof Float32Array?Float32Array:Array,_=Math,f=_.PI,h="Crossing",l="No Crossing",z=f/2,E=2*f,G=_.atan2,w=_.sqrt,m=_.pow,j=_.sin,C=_.cos,V=_.min,M=_.max,H=_.abs,t=_.ceil,Z=_.round,N=F.unionPoint,i=F.unionRect,O=F.containsPoint,v=F.clone,p="rgb(52, 152, 219)",o="red",k={northwest:0,north:1,northeast:2,west:7,east:3,southwest:6,south:5,southeast:4},x={width:400,height:100,comps:[{type:"shape",points:{func:function(){for(var v=[10,8,162,36,314,37,269,2,398,49,268,98,314,58,161,60,9,91,103,49,10,8],$=0;$<v.length;$++){var G=v[$];G=0===$%2?G/400*x.width:G/100*x.height,v[$]=G}return x.width>120&&(v[4]=x.width-26,v[6]=x.width-40,v[10]=x.width-40,v[12]=x.width-26,v[18]=33),v}},segments:[1,3,2,2,2,2,3,2,2],background:"white",gradient:"linear.east",gradientColor:"red"}]},X={width:300,height:300,comps:[{type:"circle",rect:[20,0,120,120],background:p,rotation:.61},{type:"circle",rect:[200,120,70,70],background:p,rotation:.61},{type:"circle",rect:[200,220,70,70],background:p,rotation:.61},{type:"shape",points:[80,60,80,155,200,155],borderWidth:20,borderColor:p},{type:"shape",points:[80,60,80,255,200,255],borderWidth:20,borderColor:p}]},c={width:300,height:300,comps:[{type:"shape",points:[114,239,115,106,112,73,149,73,149,73,175,73,177,105,179,261,178,302,147,307,98,308,83,307,72,276,73,260,72,81,74,29,115,21,191,21,221,22,224,53,223,238],segments:[1,2,3,2,3,2,3,2,4,2,3,2,3,2],borderWidth:20,borderColor:o,rotation:.61}]},lf={width:300,height:300,comps:[{type:"circle",rect:[210,0,90,90],background:p},{type:"circle",rect:[0,210,90,90],background:p},{type:"shape",points:[255,45,45,255],borderWidth:20,borderColor:p}]},Nf={width:300,height:300,comps:[{type:"shape",points:[20,20,280,280],borderWidth:30,borderColor:o},{type:"shape",points:[280,20,20,280],borderWidth:30,borderColor:o}]},hp={width:300,height:300,comps:[{type:"shape",points:[270,30,30,150,270,270],borderWidth:40,borderColor:p}]},Qm={width:300,height:300,comps:[{type:"shape",points:[30,30,270,150,30,270],borderWidth:40,borderColor:o}]},yo={width:300,height:300,comps:[{type:"rect",rect:[125.58,52.76,40,231.96],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000"},{type:"rect",rect:[27.87,61.06,150,30],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000",rotation:5.5},{type:"rect",rect:[113.36,61,150,30],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000",rotation:.79}]},ic={width:300,height:300,author:"",note:"",comps:[{type:"rect",rect:[135.15,38.76,28.63,82.84],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000"},{type:"triangle",rect:[94.69,2.35,110,44.77],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000"},{type:"rect",rect:[31.71,115.72,240,15],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000"},{type:"rect",rect:[31.71,167.62,240,15],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000"},{type:"rect",rect:[135.15,177.33,28.63,82.84],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000"},{type:"triangle",rect:[94.69,251.39,110,44.77],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000",rotation:3.14}]},jq=function(s){var z=s.touches[0];return z?z:s.changedTouches[0]},wk=function(U,u,e,p){return G(p-u,e-U)},Cb=function(q,A){return{x:q.x*A,y:q.y*A}},Zi=function(J,S){J.each(function(i){return J.isSelected(i)?S(i):void 0})},_i=function(o,Q){o.reverseEach(function(t){return o.isSelected(t)?Q(t):void 0})},Gp=function(v,h,g){var d,t,G,C,O,c=this,L=h,l=c.gv;if(v instanceof u){G=v.getSegments();var U=l.getDataUI(v);O=U._55O.$15l,G&&G.size()||(G=Rb(O)),v.isClosePath()&&G.indexOf(5)<0&&(G=new r(G._as),G.add(5)),d=cp(v,U,L),t=O[d]}else{var j=l.getDataUI(v);O=So(j,v.s("edge.points")),G=v.s("edge.segments"),G&&G.size()||(G=Rb(O)),O=O._as,d=cp(v,j,L),t=O[d]}if(G&&(C=G.get(L)),2===C||1===C||5===C){var n=O[d+1];5===C&&(n=O[0]);var f=Gl(t,g,n);return f}return g},lp=function(J,A,B,r){var b=A/2,v=B/2,a=fc(J,-b,-v,r),R=fc(J,b,-v,r),i=fc(J,-b,v,r),H=fc(J,b,v,r),U=fc(J,0,-v,r),X=fc(J,b,0,r),T=fc(J,0,v,r),P=fc(J,-b,0,r);return[a,R,i,H,U,X,T,P]},Gl=function(E,B,F){var u={x:B.x-E.x,y:B.y-E.y},Y={x:F.x-E.x,y:F.y-E.y},s=w(m(F.x-E.x,2)+m(F.y-E.y,2)),M={x:Y.x/s,y:Y.y/s},Q=u.x*M.x+u.y*M.y,y={x:M.x*Q,y:M.y*Q};return{x:E.x+y.x,y:E.y+y.y}},fc=function(B,M,k,n){var p=C(n)*M-j(n)*k,R=j(n)*M+C(n)*k;return B?{x:B.x+p,y:B.y+R}:{x:p,y:R}},Yk=function(Q,b){return b>2*Q?Q:b/2},er=function(m,l,t,e){var u=R(m,l);return t=e?V(t,u):Yk(t,u),u?t/=u:t=0,{x:m.x+(l.x-m.x)*t,y:m.y+(l.y-m.y)*t}},wi=function(N,q){var B,P,j=N.gv,z=N._data,_=z._40I,x=z._41I,Z=z.s("edge.offset"),y=z.s("edge.source.position"),d=z.s("edge.target.position"),h=z.s("edge.source.offset.x"),X=z.s("edge.source.offset.y"),c=z.s("edge.target.offset.x"),e=z.s("edge.target.offset.y"),t=z.s("edge.source.anchor.x"),E=z.s("edge.source.anchor.y"),H=z.s("edge.target.anchor.x"),w=z.s("edge.target.anchor.y");if(q?(B=b.getEdgeAgentPosition(j,_,y,h,X,t,E),P=b.getEdgeAgentPosition(j,x,d,c,e,H,w)):(B=b.getEdgeAgentPosition(j,_,y,0,0,t,E),P=b.getEdgeAgentPosition(j,x,d,0,0,H,w)),"points"===z.s("edge.type")&&Z&&!z.s("edge.center")&&B){var i=z.s("edge.points")||new r,p=i.size(),v=er(B,p?i.get(0):P,Z,p),I=er(P,p?i.get(p-1):B,Z,p);B=v,P=I}return[B,P]},So=function(C,D,X){var l=C._78o,i=C._data,h=i.s("edge.type"),J=[l.sourcePoint,l.targetPoint];return"points"===h?X&&(J=wi(C)):J=l.center?h?X?wi(C):wi(C,!0):X?wi(C):[l.c1,l.c2]:X?wi(C):wi(C,!0),D=new r(D?D._as:e),D.add(J[0],0),D.add(J[1]),D},sc=function(h){return h=new r(h._as),h.removeAt(0),h.removeAt(h.size()-1),h},Rb=function($){$._as||($=new r($));var u=new r;u.add(1);for(var K=1;K<$.size();K++)u.add(2);return u},$c=function(D,v){return{x:(D.x+v.x)/2,y:(D.y+v.y)/2}},vb=function(m,W){return{x:m.x+1*(W.x-m.x)/4,y:m.y+1*(W.y-m.y)/4}},Og=function(D,W){return{x:D.x+3*(W.x-D.x)/4,y:D.y+3*(W.y-D.y)/4}},vf=function(v,N,K,p){var q=N.x+N.width/2,z=N.y+N.height/2,V=w(q*q+z*z),t=G(z,q)+K;return{x:p.x+V*C(t),y:p.y+V*j(t)}},Ld=K.validateImpl,Lk=K.isRectEditable,Fp=K.isPointEditable,_f=K._42,Xb=s._79o,no=$._79o,Mo=s._48O,nk=s._47O,yi=D._48O,Wk=D._80o,nm=s._80o,je=D.getSelectWidth,Le=D._47O,Bo=$._47O,Eb=K.isEditable,cb=["northwest","north","northeast","east","southeast","south","southwest","west"],hn=function(c,Q,L,R,d,M,P,q,_,g){var E=c.x,t=c.y,Y=c.width,W=c.height,j={x:E+Y/2,y:t+W/2};R=R||0,Q=fc(j,Q.x-j.x,Q.y-j.y,-R),P&&!q&&(Q.x+=_,Q.y+=g);var J=.01;if("northwest"===L?(Q.x+d>E+Y-J&&(Q.x=E+Y-d-J),Q.y+d>t+W-J&&(Q.y=t+W-d-J),c=N(Q,{x:E+Y,y:t+W})):"north"===L?(Q.y+d>t+W-J&&(Q.y=t+W-d-J),c=N({x:E,y:Q.y},{x:E+Y,y:t+W})):"northeast"===L?(Q.x<E+d+J&&(Q.x=E+d+J),Q.y+d>t+W-J&&(Q.y=t+W-d-J),c=N({x:E,y:Q.y},{x:Q.x,y:t+W})):"west"===L?(Q.x+d>E+Y-J&&(Q.x=E+Y-d-J),c=N({x:Q.x,y:t},{x:E+Y,y:t+W})):"east"===L?(Q.x<E+d+J&&(Q.x=E+d+J),c=N({x:E,y:t},{x:Q.x,y:t+W})):"southwest"===L?(Q.x+d>E+Y-J&&(Q.x=E+Y-d-J),Q.y<t+d+J&&(Q.y=t+d+J),c=N({x:Q.x,y:t},{x:E+Y,y:Q.y})):"south"===L?(Q.y<t+d+J&&(Q.y=t+d+J),c=N({x:E,y:t},{x:E+Y,y:Q.y})):"southeast"===L&&(Q.x<E+d+J&&(Q.x=E+d+J),Q.y<t+d+J&&(Q.y=t+d+J),c=N({x:E,y:t},Q)),"keepRatio"===M&&(!P&&q||P&&!q)&&("northeast"===L||"southeast"===L||"northwest"===L||"southwest"===L)){var C=c.width,F=c.height,l=C/Y,G=F/W,m=V(l,G);c.width=Y*m,c.height=W*m,"northeast"===L?c.y=t+(W-c.height):"northwest"===L?(c.y=t+(W-c.height),c.x=E+(Y-c.width)):"southwest"===L&&(c.x=E+(Y-c.width))}c.x-=j.x,c.y-=j.y;var x=vf(e,c,R,j);return c.x=x.x-c.width/2,c.y=x.y-c.height/2,c},gj=function(c,R,C,f){var D=c.getRotation(),k=R,Z=k.x,T=k.y,O=k.width,n=k.height,Y={x:Z+k.width/2,y:T+k.height/2};f=fc(Y,f.x-Y.x,f.y-Y.y,-D),"northwest"===C?k=N(f,{x:Z+O,y:T+n}):"north"===C?k=N({x:Z,y:f.y},{x:Z+O,y:T+n}):"northeast"===C?k=N({x:Z,y:f.y},{x:f.x,y:T+n}):"west"===C?k=N({x:f.x,y:T},{x:Z+O,y:T+n}):"east"===C?k=N({x:Z,y:T},{x:f.x,y:T+n}):"southwest"===C?k=N({x:f.x,y:T},{x:Z+O,y:f.y}):"south"===C?k=N({x:Z,y:T},{x:Z+O,y:f.y}):"southeast"===C&&(k=N({x:Z,y:T},f)),c.setRect(k),k.x-=Y.x,k.y-=Y.y;var K=vf(c,k,D,Y);c.p(K.x,K.y)},op=function(Y,M,J,b,X,C,L,z){var h=e;C?(h=fc(e,X.x-M.x,X.y-M.y,-J),h.x-=L.x,h.y-=L.y):h=fc(e,X.x-M.x,X.y-M.y,0);var N={x:M.x+h.x,y:M.y+h.y};z&&(N=z(N.x,N.y)),N.e=Y.getPoints().get(b).e,Y.setPoint(b,N);var l=Y.getWidth(),B=Y.getHeight(),t=Y.p().x-l/2,f=Y.p().y-B/2;t-=M.x,f-=M.y;var S=vf(Y,{x:t,y:f,width:l,height:B},J,M);Y.p(S.x,S.y)},cp=function($,m,U){var s,R;if($ instanceof u?(s=$.getPoints(),R=$.getSegments()):$ instanceof n&&"points"===$.s("edge.type")&&(s=$.s("edge.points"),R=$.s("edge.segments"),s=So(m,s)),R&&R.size()||(R=Rb(s)),$ instanceof u&&$.isClosePath()&&R.indexOf(5)<0&&(R=new r(R._as),R.add(5)),R)for(var k=-1,I=0;I<R.size();I++){if(I===U)return k;var Q=R.get(I);1===Q?k+=1:2===Q?k+=1:3===Q?k+=2:4===Q&&(k+=3)}},Yh=function(a,F,T){var G,W;if(a instanceof u?(G=a.getPoints(),W=a.getSegments()):a instanceof n&&"points"===a.s("edge.type")&&(G=a.s("edge.points"),W=a.s("edge.segments"),G=So(F,G)),W&&W.size()||(W=Rb(G)),W)for(var E=-1,K=0;K<W.size();K++){var v=W.get(K);if(1===v?E+=1:2===v?E+=1:3===v?E+=2:4===v&&(E+=3),E===T)return K}},Mk=function(r,n){var D=[r[0]-n[0],r[1]-n[1],r[2]-n[2]];return D},bi=function(){var h=new W(16);return h[0]=1,h[1]=0,h[2]=0,h[3]=0,h[4]=0,h[5]=1,h[6]=0,h[7]=0,h[8]=0,h[9]=0,h[10]=1,h[11]=0,h[12]=0,h[13]=0,h[14]=0,h[15]=1,h},Xn=function(_,v){var e=_[0],B=_[1],C=_[2];return _[0]=v[0]*e+v[4]*B+v[8]*C+v[12],_[1]=v[1]*e+v[5]*B+v[9]*C+v[13],_[2]=v[2]*e+v[6]*B+v[10]*C+v[14],_},bl=function(h,k){if(k){var v=j(k),d=C(k),E=h[0],X=h[1],m=h[2],N=h[3],R=h[8],T=h[9],g=h[10],B=h[11];h[0]=E*d-R*v,h[1]=X*d-T*v,h[2]=m*d-g*v,h[3]=N*d-B*v,h[8]=E*v+R*d,h[9]=X*v+T*d,h[10]=m*v+g*d,h[11]=N*v+B*d}},iq=function(f,W){for(var t=f.s("grid.row.count"),y=f.s("grid.column.count"),F=0;t>F;F++)for(var Y=0;y>Y;Y++){var r=f.getCellRect(F,Y);if(O(r,W))return{rowIndex:F,columnIndex:Y,rect:r,grid:f}}return null},Tj=function(E,U,Y,D,P,S){var u={},c=Y-E,o=D-U,i=_.sqrt(c*c+o*o),v=c/i,q=o/i,h=(-E+P)*v+(-U+S)*q;return 0>=h?(u.x=E,u.y=U):h>=i?(u.x=Y,u.y=D):(u.x=E+h*v,u.y=U+h*q),c=P-u.x,o=S-u.y,u.z=_.sqrt(c*c+o*o),u},Yq=function(_,L){var C,W,q,E,B,X,V,u,D=_.getPoints(),k=_.getSegments(),i=_.p(),o=_.getRotation();if(!k||!(k.indexOf(3)>0||k.indexOf(4)>0)){for(u=0;u<=D.size()-1;u++)if(u===D.size()-1?(B=D.get(0),E=D.get(u)):(E=D.get(u),B=D.get(u+1)),E=fc(i,E.x-i.x,E.y-i.y,o),B=fc(i,B.x-i.x,B.y-i.y,o),X=Tj(E.x,E.y,B.x,B.y,L.x,L.y),V=X.z,V<(_.s("shape.border.width")||10)){W=E,q=B,C=u;break}if(C!=e){var j=Tj(W.x,W.y,q.x,q.y,L.x,L.y),H=R(W,j);return{attachIndex:C,attachOffset:H}}}},Xg=function(z){for(var o=z._data,r=o.p(),G=o.getRotation(),t=o.getPoints(),q=e,N=[],K=0;K<t.size();K++)q=t.get(K),N.push(fc(r,q.x-r.x,q.y-r.y,G));z._55O.$15l=N};F.setImage("xeditinteractor_parentIcon",X),F.setImage("xeditinteractor_hostIcon",c),F.setImage("xeditinteractor_edgeIcon",lf),F.setImage("xeditinteractor_removeIcon",Nf),F.setImage("xeditinteractor_sourceIcon",hp),F.setImage("xeditinteractor_targetIcon",Qm),F.setImage("xeditinteractor_elevationIcon",yo),F.setImage("xeditinteractor_tallIcon",ic),K._editPointSize=d?24:9,K._edgeHelpers=["parent","remove","source","target"],K._leftTopHelpers=["parent"],K._rightTopHelpers=["host"],K._leftBottomHelpers=["edge"],K._rightBottomHelpers=["remove"],cb=cb.concat(cb).concat(cb),$._79o=function(){var z=this,w=z.gv,b=w.getZoom(),f=w._editInteractor,_=no.call(z);if(!_)return null;var C=wi(z,!0),S=C[0],x=C[1],R={x:_.x,y:_.y,width:_.width,height:_.height},I=N(S,x);if(f instanceof Y.XEditInteractor){R=i(R,I);var P=z._55O,B=w.getEditPointSize()/b+2,h=0;P&&P._43O&&(h+=B/2,U(R,h))}return R},$._47O=function(C){var j=this,w=j.gv,d=w._editInteractor;d instanceof Y.XEditInteractor||Bo.call(j,C)},$.rectIntersects=function(v){var n=this,l=n._data,O=n.gv,q=O.getZoom(),V=n._55O,K=O._editInteractor;if(K instanceof Y.XEditInteractor&&O.isEditable(l)&&V&&V._43O&&"points"===l.s("edge.type")){var w=l.s("edge.points"),G=l.s("edge.segments");w=So(n,w),G&&G.size()||(G=Rb(w)),w=w._as;var i=!1,I=d?5:1,m=v.x+I,Z=v.y+I,p={x:m,y:Z};if(K._edge===l&&K._hoverSegmentIndex>=0){var R=O._editInteractor._hoverSegmentIndex,c=G.get(R),P=cp(l,n,R),u=e;if(P!=e&&P>=0){var t=w[P],A=O.getSegmentHoverWidth()/q;if(2===c||1===c){var M=w[P+1];u=Jq(new Sf(t.x,t.y),new Sf(M.x,M.y),new Sf(p.x-A,p.y-A),new Sf(p.x+2*A,p.y+2*A)),u.$62l===h&&(i=!0)}else if(3===c){var Q=w[P+1],M=w[P+2];u=un(new Sf(t.x,t.y),new Sf(Q.x,Q.y),new Sf(M.x,M.y),new Sf(p.x-A,p.y-A),new Sf(p.x+2*A,p.y+2*A)),u.$62l===h&&(i=!0)}else if(4===c){var W=w[P+1],S=w[P+2];M=w[P+3],u=Pq(new Sf(t.x,t.y),new Sf(W.x,W.y),new Sf(S.x,S.y),new Sf(M.x,M.y),new Sf(p.x-A,p.y-A),new Sf(p.x+2*A,p.y+2*A)),u.$62l===h&&(i=!0)}}}if(i)return!0}return e},s._47O=function(q){var U=this,c=U.gv,u=c._editInteractor;u instanceof Y.XEditInteractor||nk.call(U,q)},s.rectIntersects=function(l){var v=this,x=v._data,_=v.gv,P=_.getZoom(),D=v._55O,B=_._editInteractor;if(B instanceof Y.XEditInteractor&&_.isEditable(x)&&D&&D._43O){var m=D.$15l,o=!1,W=d?5:1,O=l.x+W,g=l.y+W,N={x:O,y:g};if(m&&m.length===x.getPoints().size()||(Xg(v),m=D.$15l),B._shape===x&&B._hoverSegmentIndex>=0){var A=x.getSegments();A&&A.size()||(A=Rb(m));var t=_._editInteractor._hoverSegmentIndex,i=A.get(t),w=cp(x,v,t),M=e;if(w!=e&&w>=0){var I=m[w],J=_.getSegmentHoverWidth()/P;if(2===i||1===i){var p=m[w+1];M=Jq(new Sf(I.x,I.y),new Sf(p.x,p.y),new Sf(N.x-J,N.y-J),new Sf(N.x+2*J,N.y+2*J)),M.$62l===h&&(o=!0)}else if(3===i){var K=m[w+1],p=m[w+2];M=un(new Sf(I.x,I.y),new Sf(K.x,K.y),new Sf(p.x,p.y),new Sf(N.x-J,N.y-J),new Sf(N.x+2*J,N.y+2*J)),M.$62l===h&&(o=!0)}else if(4===i){var z=m[w+1],U=m[w+2];p=m[w+3],M=Pq(new Sf(I.x,I.y),new Sf(z.x,z.y),new Sf(U.x,U.y),new Sf(p.x,p.y),new Sf(N.x-J,N.y-J),new Sf(N.x+2*J,N.y+2*J)),M.$62l===h&&(o=!0)}}}if(o)return!0}return e},s._48O=function(){var k=this,$=k.gv,E=$._editInteractor;E instanceof Y.XEditInteractor?(D._48O.call(k),k._55O._43O&&Xg(k)):Mo.call(k)},s._79o=function(){var $=this,s=$.gv,W=s.getZoom(),X=s._editInteractor,q=Xb.call($);if(q){var M={x:q.x,y:q.y,width:q.width,height:q.height};if(X instanceof Y.XEditInteractor){var e=$._55O,H=s.getEditPointSize()/W+2,S=0;e&&e._43O&&(S+=H/2,U(M,S))}return M}},D._47O=function(F){var e=this,u=e.gv,L=u._editInteractor;if(L instanceof Y.XEditInteractor);else{var A=e._55O;A&&A._98o&&Le.call(e,F)}},D.getSelectWidth=function(){var J=this,X=J.gv,S=X._editInteractor,E=J._data;return X.isEditable(E)&&S instanceof Y.XEditInteractor?0:je.call(J)},D._80o=function(F){var K=this,q=K.gv._editInteractor;if(Wk.call(K,F),q&&q._debug){F.save(),F.beginPath(),F.lineWidth=1,F.strokeStyle="green";var z=K._79o();z&&(F.rect(z.x,z.y,z.width,z.height),F.stroke()),F.restore()}},s._80o=function(c){var V=this,A=V.gv._editInteractor;if(nm.call(V,c),A&&A._debug){c.save(),c.beginPath(),c.lineWidth=1,c.strokeStyle="green";var k=V._79o();c.rect(k.x,k.y,k.width,k.height),c.stroke(),c.restore()}},D._48O=function(){var i=this,X=i.gv,e=i._data,R=X._editInteractor,A=i._55O,d=e.p(),v=e.getRotation();if(R instanceof Y.XEditInteractor){if(A._42O){var z=lp(d,e.getWidth(),e.getHeight(),v),E=z[0],p=z[1],Z=z[2],h=z[3],C=z[4],_=z[5],k=z[6],c=z[7];A.$45l=[E,C,p,_,h,k,Z,c]}}else yi.call(i)},K.getResizeMode=function(){return this.$25l||"normal"},K.setResizeMode=function(Y){var C=this.$25l;this.$25l=Y,this.fp("resizeMode",C,Y)},K.getSnapAngle=function(){return this.$26l||Math.PI/36},K.setSnapAngle=function(Y){var U=this.$26l;this.$26l=Y,this.fp("snapAngle",U,Y)},K.getSnapSpacing=function(){return this.$27l},K.setSnapSpacing=function(l){var s=this.$27l;this.$27l=l,this.fp("snapSpacing",s,l)},K.getPointSnapSpacing=function(){return this._pointSnapSpacing},K.setPointSnapSpacing=function(z){var N=this._pointSnapSpacing;this._pointSnapSpacing=z,this.fp("pointSnapSpacing",N,z)},K.setHelperEditableFunc=function(q){var Q=this._helperEditableFunc;this._helperEditableFunc=q,this.fp("helperEditableFunc",Q,q)},K.getHelperEditableFunc=function(){return this._helperEditableFunc},K.setLeftTopHelpers=function(x){var S=this._leftTopHelpers;this._leftTopHelpers=x,this.fp("leftTopHelpers",S,x)},K.getLeftTopHelpers=function(){return this._leftTopHelpers},K.setLeftTopHelpersAlign=function($){var E=this._leftTopHelpersAlign;this._leftTopHelpersAlign=$,this.fp("leftTopHelpersAlign",E,$)},K.getLeftTopHelpersAlign=function(){return this._leftTopHelpersAlign},K.setRightTopHelpers=function(S){var l=this._rightTopHelpers;this._rightTopHelpers=S,this.fp("rightTopHelpers",l,S)},K.getRightTopHelpers=function(){return this._rightTopHelpers},K.setRightTopHelpersAlign=function(U){var E=this._rightTopHelpersAlign;this._rightTopHelpersAlign=U,this.fp("rightTopHelpersAlign",E,U)},K.getRightTopHelpersAlign=function(){return this._rightTopHelpersAlign},K.setLeftBottomHelpers=function(u){var l=this._leftBottomHelpers;this._leftBottomHelpers=u,this.fp("leftBottomHelpers",l,u)},K.getLeftBottomHelpers=function(){return this._leftBottomHelpers},K.setLeftBottomHelpersAlign=function(t){var x=this._leftBottomHelpersAlign;this._leftBottomHelpersAlign=t,this.fp("leftBottomHelpersAlign",x,t)},K.getLeftBottomHelpersAlign=function(){return this._leftBottomHelpersAlign},K.setRightBottomHelpers=function(M){var Y=this._rightBottomHelpers;this._rightBottomHelpers=M,this.fp("rightBottomHelpers",Y,M)},K.getRightBottomHelpers=function(){return this._rightBottomHelpers},K.setRightBottomHelpersAlign=function(P){var c=this._rightBottomHelpersAlign;this._rightBottomHelpersAlign=P,this.fp("rightBottomHelpersAlign",c,P)},K.getRightBottomHelpersAlign=function(){return this._rightBottomHelpersAlign},K.setEdgeHelpers=function(D){var H=this._edgeHelpers;this._edgeHelpers=D,this.fp("edgeHelpers",H,D)},K.getEdgeHelpers=function(){return this._edgeHelpers},K.isHelperEditable=function(H,F){return H instanceof n&&("host"===F||"edge"===F||"elevation"===F||"tall"===F)?!1:H instanceof T&&("source"===F||"target"===F)?!1:"pointElevation"===F?this._helperEditableFunc?this._helperEditableFunc(H,F):!1:this._helperEditableFunc?this._helperEditableFunc(H,F):!0},K.getEditHelperSize=function(){return this._editHelperSize||(d?28:16)},K.setEditHelperSize=function(C){var d=this._editHelperSize;this._editHelperSize=C,this.fp("editHelperSize",d,C)},K.getEditRectBorderColor=function(){return this.$28l||"rgb(0, 168, 255)"},K.setEditRectBorderColor=function(F){var d=this.$28l;this.$28l=F,this.fp("editRectBorderColor",d,F)},K.getNodeBorderColor=function(){return this.$29l||"#1ABC9C"},K.setNodeBorderColor=function(Z){var x=this.$29l;this.$29l=Z,this.fp("nodeBorderColor",x,Z)},K.getEditRectBorderStyle=function(){return this.$30l||"dashed"},K.setEditRectBorderStyle=function(Q){var k=this.$30l;this.$30l=Q,this.fp("editRectBorderStyle",k,Q)},K.getControlPointBackground=function(){return this.$31l||"#ff0"},K.setControlPointBackground=function(_){var I=this.$31l;this.$31l=_,this.fp("controlPointBackground",I,_)},K.getControlPointBorderColor=function(){return this.$32l||this._editPointBorderColor},K.setControlPointBorderColor=function(D){var i=this.$32l;this.$32l=D,this.fp("controlPointBorderColor",i,D)},K.getJoinPointBackground=function(){return this.$33l||this._editPointBackground},K.setJoinPointBackground=function(e){var F=this.$33l;this.$33l=e,this.fp("joinPointBackground",F,e)},K.getJoinPointBorderColor=function(){return this.$34l||this._editPointBorderColor},K.setJoinPointBorderColor=function(V){var q=this.$34l;this.$34l=V,this.fp("joinPointBorderColor",q,V)},K.getDirectionLineColor=function(){return this.$35l||"#888"},K.setDirectionLineColor=function(o){var m=this.$35l;this.$35l=o,this.fp("directionLineColor",m,o)},K.getSegmentHoverColor=function(){return this.$36l||"rgba(255, 0, 0, 0.3)"},K.setSegmentHoverColor=function(E){var k=this.$36l;this.$36l=E,this.fp("segmentHoverColor",k,E)},K.getSegmentHoverWidth=function(){return this.$22l||(d?16:8)},K.setSegmentHoverWidth=function(A){var j=this.$22l;this.$22l=A,this.fp("segmentHoverWidth",j,A)},K.getSnapPointBorderColor=function(){return this.$38l||"#f00"},K.setSnapPointBorderColor=function(m){var j=this.$38l;this.$38l=m,this.fp("snapPointBorderColor",j,m)},K.getEditRectPadding=function(){return this.$39l!=e?this.$39l:6},K.setEditRectPadding=function(i){var u=this.$39l;this.$39l=i,this.fp("editRectPading",u,i)},K.isRectEditable=function(P){var d=this,M=d._editInteractor;return M instanceof Y.XEditInteractor?d._rectEditableFunc?d._rectEditableFunc(P):!0:Lk.call(d,P)},K.isPointEditable=function(e){var y=this,q=y._editInteractor;return q instanceof Y.XEditInteractor?y._pointEditableFunc?y._pointEditableFunc(e):!0:Fp.call(y,e)},K.validateImpl=function(){var g=this,v=g.$14l,E=g._editInteractor;if(v){var S=g.getWidth(),m=g.getHeight();(S!==v.clientWidth||m!==v.clientHeight)&&(E&&(E._68I=1),b.setCanvas(v,S,m),g._32I=1)}Ld.call(this)},K.isEditable=function(c){var R=Eb.call(this,c),l=this._editInteractor;if(l instanceof Y.XEditInteractor&&c instanceof n){if(!c.s("2d.editable"))return!1;var h=this.getEditableFunc();R=h?h(c):!0}return R},K._42=function(R,$){var k=this,p=k._editInteractor;_f.call(k,R,$),p instanceof Y.XEditInteractor&&p._68I&&p._42()},K.isSnapPoint=function(){return!0};var Nc=function(s){arguments.length>0&&this.$58l(s)},Op=Nc.prototype;Op.$58l=function(m){this.$62l=m,this.points=new Array},Op.$56l=function(L){this.points.push(L)},Op.$57l=function(M){this.points=this.points.concat(M)};var Sf=function(U,I){arguments.length>0&&this.$58l(U,I)},_d=Sf.prototype;_d.$58l=function(G,p){this.x=G,this.y=p},_d.add=function(m){return new Sf(this.x+m.x,this.y+m.y)},_d.addEquals=function(B){return this.x+=B.x,this.y+=B.y,this},_d.$55l=function(K){return new Sf(this.x*K,this.y*K)},_d.eq=function(p){return this.x==p.x&&this.y==p.y},_d.lt=function(b){return this.x<b.x&&this.y<b.y},_d.lte=function(_){return this.x<=_.x&&this.y<=_.y},_d.gt=function(M){return this.x>M.x&&this.y>M.y},_d.gte=function(l){return this.x>=l.x&&this.y>=l.y},_d.lerp=function(N,x){return new Sf(this.x+(N.x-this.x)*x,this.y+(N.y-this.y)*x)},_d.distanceFrom=function(T){var U=this.x-T.x,q=this.y-T.y;return w(U*U+q*q)},_d.min=function(h){return new Sf(V(this.x,h.x),V(this.y,h.y))},_d.max=function(s){return new Sf(M(this.x,s.x),M(this.y,s.y))},_d.toString=function(){return this.x+","+this.y};var Bj=function(){this.$58l(arguments)},_n=Bj.prototype;Bj.TO=1e-6,Bj.AC=6,_n.$58l=function(e){this.co=new Array;for(var R=e.length-1;R>=0;R--)this.co.push(e[R])},_n.$55l=function(i){for(var o=new Bj,c=0;c<=this.$50l()+i.$50l();c++)o.co.push(0);for(var c=0;c<=this.$50l();c++)for(var M=0;M<=i.$50l();M++)o.co[c+M]+=this.co[c]*i.co[M];return o},_n.$59l=function(){for(var p=this.$50l();p>=0&&H(this.co[p])<=Bj.TO;p--)this.co.pop()},_n.$50l=function(){return this.co.length-1},_n.$51l=function(){var r;switch(this.$59l(),this.$50l()){case 0:r=new Array;break;case 1:r=this.$52l();break;case 2:r=this.$53l();break;case 3:r=this.$54l();break;case 4:r=this.$63l();break;default:r=new Array}return r},_n.$52l=function(){var Q=new Array,u=this.co[1];return 0!=u&&Q.push(-this.co[0]/u),Q},_n.$53l=function(){var b=new Array;if(2==this.$50l()){var K=this.co[2],T=this.co[1]/K,f=this.co[0]/K,u=T*T-4*f;if(u>0){var V=w(u);b.push(.5*(-T+V)),b.push(.5*(-T-V))}else 0==u&&b.push(.5*-T)}return b},_n.$63l=function(){var n=new Array;if(4==this.$50l()){var y=this.co[4],W=this.co[3]/y,A=this.co[2]/y,D=this.co[1]/y,Q=this.co[0]/y,I=new Bj(1,-A,W*D-4*Q,-W*W*Q+4*A*Q-D*D).$54l(),b=I[0],r=W*W/4-A+b;if(H(r)<=Bj.TO&&(r=0),r>0){var V=w(r),E=3*W*W/4-V*V-2*A,t=(4*W*A-8*D-W*W*W)/(4*V),_=E+t,O=E-t;if(H(_)<=Bj.TO&&(_=0),H(O)<=Bj.TO&&(O=0),_>=0){var m=w(_);n.push(-W/4+(V+m)/2),n.push(-W/4+(V-m)/2)}if(O>=0){var m=w(O);n.push(-W/4+(m-V)/2),n.push(-W/4-(m+V)/2)}}else if(0>r);else{var t=b*b-4*Q;if(t>=-Bj.TO){if(0>t&&(t=0),t=2*w(t),E=3*W*W/4-2*A,E+t>=Bj.TO){var e=w(E+t);n.push(-W/4+e/2),n.push(-W/4-e/2)}if(E-t>=Bj.TO){var e=w(E-t);n.push(-W/4+e/2),n.push(-W/4-e/2)}}}}return n},_n.$54l=function(){var I=new Array;if(3==this.$50l()){var y=this.co[3],V=this.co[2]/y,e=this.co[1]/y,A=this.co[0]/y,t=(3*e-V*V)/3,o=(2*V*V*V-9*e*V+27*A)/27,x=V/3,J=o*o/4+t*t*t/27,X=o/2;if(H(J)<=Bj.TO&&(J=0),J>0){var D,r,S=w(J);D=-X+S,r=D>=0?m(D,1/3):-m(-D,1/3),D=-X-S,D>=0?r+=m(D,1/3):r-=m(-D,1/3),I.push(r-x)}else if(0>J){var K=w(-t/3),T=G(w(-J),-X)/3,z=C(T),s=j(T),W=w(3);I.push(2*K*z-x),I.push(-K*(z+W*s)-x),I.push(-K*(z-W*s)-x)}else{var D;D=X>=0?-m(X,1/3):m(-X,1/3),I.push(2*D-x),I.push(-D-x)}}return I};var Zb=function(Z,C){arguments.length>0&&this.$58l(Z,C)},Vd=Zb.prototype;Vd.$58l=function(c,R){this.x=c,this.y=R},Vd.length=function(){return w(this.x*this.x+this.y*this.y)},Vd.$60l=function(L){return this.x*L.x+this.y*L.y};var ue=function(W,Z,t,X){var B,L=(X.x-t.x)*(W.y-t.y)-(X.y-t.y)*(W.x-t.x),A=(Z.x-W.x)*(W.y-t.y)-(Z.y-W.y)*(W.x-t.x),M=(X.y-t.y)*(Z.x-W.x)-(X.x-t.x)*(Z.y-W.y);if(0!=M){var k=L/M,S=A/M;k>=0&&1>=k&&S>=0&&1>=S?(B=new Nc(h),B.points.push(new Sf(W.x+k*(Z.x-W.x),W.y+k*(Z.y-W.y)))):B=new Nc(l)}else B=0==L||0==A?new Nc("C"):new Nc("P");return B},mh=function(y,P,S,U,Y){var T,K,t,g,e,k,X,O=U.min(Y),j=U.max(Y),p=new Nc(l);T=P.$55l(-2),t=y.add(T.add(S)),T=y.$55l(-2),K=P.$55l(2),g=T.add(K),e=new Sf(y.x,y.y),X=new Zb(U.y-Y.y,Y.x-U.x),k=U.x*Y.y-Y.x*U.y;for(var H=new Bj(X.$60l(t),X.$60l(g),X.$60l(e)+k).$51l(),s=0;s<H.length;s++){var Q=H[s];if(Q>=0&&1>=Q){var D=y.lerp(P,Q),B=P.lerp(S,Q),G=D.lerp(B,Q);U.x==Y.x?O.y<=G.y&&G.y<=j.y&&(p.$62l=h,p.$56l(G)):U.y==Y.y?O.x<=G.x&&G.x<=j.x&&(p.$62l=h,p.$56l(G)):G.gte(O)&&G.lte(j)&&(p.$62l=h,p.$56l(G))}}return p},un=function(E,N,R,M,e){var t=M.min(e),g=M.max(e),V=new Sf(g.x,t.y),C=new Sf(t.x,g.y),q=mh(E,N,R,t,V),J=mh(E,N,R,V,g),L=mh(E,N,R,g,C),p=mh(E,N,R,C,t),H=new Nc(l);return H.$57l(q.points),H.$57l(J.points),H.$57l(L.points),H.$57l(p.points),H.points.length>0&&(H.$62l=h),H},gc=function(E,U,g,f,B,w){var C,i,H,A,Y,F,u,L,e,q,K=B.min(w),$=B.max(w),k=new Nc(l);C=E.$55l(-1),i=U.$55l(3),H=g.$55l(-3),A=C.add(i.add(H.add(f))),Y=new Zb(A.x,A.y),C=E.$55l(3),i=U.$55l(-6),H=g.$55l(3),A=C.add(i.add(H)),F=new Zb(A.x,A.y),C=E.$55l(-3),i=U.$55l(3),H=C.add(i),u=new Zb(H.x,H.y),L=new Zb(E.x,E.y),q=new Zb(B.y-w.y,w.x-B.x),e=B.x*w.y-w.x*B.y;for(var j=new Bj(q.$60l(Y),q.$60l(F),q.$60l(u),q.$60l(L)+e).$51l(),V=0;V<j.length;V++){var I=j[V];if(I>=0&&1>=I){var J=E.lerp(U,I),m=U.lerp(g,I),Q=g.lerp(f,I),Z=J.lerp(m,I),v=m.lerp(Q,I),D=Z.lerp(v,I);B.x==w.x?K.y<=D.y&&D.y<=$.y&&(k.$62l=h,k.$56l(D)):B.y==w.y?K.x<=D.x&&D.x<=$.x&&(k.$62l=h,k.$56l(D)):D.gte(K)&&D.lte($)&&(k.$62l=h,k.$56l(D))}}return k},Pq=function(x,K,o,w,m,d){var e=m.min(d),c=m.max(d),V=new Sf(c.x,e.y),T=new Sf(e.x,c.y),W=gc(x,K,o,w,e,V),E=gc(x,K,o,w,V,c),g=gc(x,K,o,w,c,T),p=gc(x,K,o,w,T,e),n=new Nc(l);return n.$57l(W.points),n.$57l(E.points),n.$57l(g.points),n.$57l(p.points),n.points.length>0&&(n.$62l=h),n},Jq=function(Z,P,R,t){var j=R.min(t),L=R.max(t),T=new Sf(L.x,j.y),_=new Sf(j.x,L.y),A=ue(j,T,Z,P),f=ue(T,L,Z,P),e=ue(L,_,Z,P),c=ue(_,j,Z,P),z=new Nc(l);return z.$57l(A.points),z.$57l(f.points),z.$57l(e.points),z.$57l(c.points),z.points.length>0&&(z.$62l=h),z},Fd=Y.XEditInteractor=function(Y){var b=this,a=b._view=document.createElement("canvas");a.className="editCanvas",a.style.position="absolute",Fd.superClass.constructor.call(b,Y)};F.def(Fd,Y.Interactor,{ms_edit:1,setUp:function(){var I=this,K=I.gv,W=K.getView(),x=I._view;Fd.superClass.setUp.call(I),K.setEditInteractor(I),K.$14l=x,K._79O?W.insertBefore(x,K._79O):W.appendChild(x);var G=I.$49l=I.$11l.bind(I);K.dm().md(G),K.sm().ms(G),K.mp(G)},tearDown:function(){var x=this,Z=x.gv,n=Z.getView(),u=x.$49l;Fd.superClass.tearDown.call(x),Z.setEditInteractor(e),Z.$14l=e,n.removeChild(x._view),Z.dm().umd(u),Z.sm().ums(u),Z.ump(u)},clear:function(){var u=this,z=u.gv;delete u._hoverSegmentIndex,delete u._edge,delete u._shape,delete z._editing,delete u.$10l,delete u.$13l,delete u.$9l,delete u._removePointIndex,delete u._lp,u.$12l="",delete u.$40l,delete u.$67l,delete u.$72l,delete u.$73l,delete u.$75l,delete u.$1l,delete u.$3l,delete u.$2l,delete u.$92l,delete u.$93l,delete u.$94l,u.clearDragging()},handle_keydown:function(l){this.$48l!==l.shiftKey&&(this.$48l=l.shiftKey,this.handle_mousemove(l,y,!0))},handle_keyup:function(U){this.$48l!==U.shiftKey&&(this.$48l=U.shiftKey,this.handle_mousemove(U,y,!0))},handle_touchstart:function(W){this.handle_mousemove(W),this.handle_mousedown(W)},handle_mousedown:function($){g($);var p=this,O=p.$13l,H=p.gv,D=H.dm(),W=H.sm(),P=H.getZoom(),e=H.lp($),E=F.isDoubleClick($),X=F.isLeftButton($),Z=p.$7l,K=p._shape,w=p._hoverSegmentIndex,G=p._edge,N=p.$87l,t=p.$88l,V=function(){p._68I||N===p.$87l&&t===p.$88l||p.$43l()};if(7!==p.$67l&&(delete p.$87l,delete p.$88l),X&&(K||G)&&w>=0&&E&&(K&&W.contains(K)||G&&W.contains(G))){var r=Gp.call(p,K||G,w,e);return p.addShapePoint(K||G,w,r),B(function(){p.handle_mousemove($)},40),void 0}if(X&&(K||G)&&p._removePointIndex>=0&&E)return p.removeShapePoint(),p.$5l=1,B(function(){p.handle_mousemove($)},40),void 0;if(!X||!H._editing)return V(),void 0;if(K&&O>=0){var j=K.getPoints().get(O),I=K.p(),C=fc(I,j.x-I.x,j.y-I.y,-Z+K.getRotation());y=fc(I,e.x-I.x,e.y-I.y,-Z),p.$24l={x:y.x-C.x,y:y.y-C.y},p.startDragging($),D.beginTransaction(),p.fi({kind:"beginEditPoint",event:$,data:K,index:O}),p.$88l=O,p.$87l=K}else if(p.$10l){var h=H.sm().getSelection(),m=p.$6l,S=p.$1l={},o=p.$3l={},b=p.$16l[k[p.$10l]],d={x:m.x,y:m.y},u={x:m.x+m.width/2,y:m.y+m.height/2};p.$24l={x:e.x-b.x/P,y:e.y-b.y/P},p.$2l=v(p.$8l),p.$4l=v(m),h.each(function(C){if(C instanceof T){var v=C.p(),Q=C.getWidth(),U=C.getHeight(),n=fc(u,v.x-u.x,v.y-u.y,-Z);S[C.getId()]={x:v.x-Q/2,y:v.y-U/2,width:Q,height:U},o[C.getId()]={x:(n.x-d.x)/m.width,y:(n.y-d.y)/m.height}}}),p.startDragging($),D.beginTransaction(),p.fi({kind:"beginEditRect",event:$,direction:p.$10l})}else if(G&&O>=0){var z=So(H.getDataUI(G),G.s("edge.points")),j=z.get(O);p.$24l={x:e.x-j.x,y:e.y-j.y},p.startDragging($),D.beginTransaction(),p.fi({kind:"beginEditPoint",event:$,data:G,index:O}),p.$88l=O,p.$87l=G}else if(p.$40l){var m=p.$6l,u={x:m.x+m.width/2,y:m.y+m.height/2},x=v(p.$23l);x.x/=P,x.y/=P;var U=fc(u,x.x-u.x,x.y-u.y,-Z),y=fc(u,e.x-u.x,e.y-u.y,-Z);p.$24l={x:y.x-U.x,y:y.y-U.y},p.startDragging($),D.beginTransaction(),p.fi({kind:"beginEditRotation",event:$,data:p._rotationNode})}else if([1,2,3,5,6,7,8,9].indexOf(p.$67l)>=0){var L=p.$67l;(7===L||8===L||9===L)&&D.beginTransaction(),p.startDragging($)}else if(p.$71l&&E&&p.$79l(p.$71l,e)){var M=W.toSelection();D.beginTransaction(),M.each(function(N){D.remove(N)}),D.endTransaction()}V()},$11l:function(){var M=this,f=M.gv;f._editing&&(M.$13l==e||M._shape==e&&M._edge==e)&&(M.$73l==e||1!==M.$67l&&5!==M.$67l&&6!==M.$67l)||(M.$5l=1),M._68I=1},$46l:function(Y){var f=this,q=f.gv,$=q.lp(Y),S=[];return _i(q,function(t){var N=q.getDataUI(t);if(N){var m=N._79o();O(m,$)&&S.push(t)}}),S},$47l:function(Y){var w=this,z=w.$13l,d=w.gv.dm();w.$10l?(w.fi({kind:"endEditRect",event:Y,direction:w.$10l}),d.endTransaction()):w._shape&&z>=0?(w.fi({kind:"endEditPoint",event:Y,data:w._shape,index:z}),d.endTransaction()):w._edge&&z>=0?(w.fi({kind:"endEditPoint",event:Y,data:w._edge,index:z}),d.endTransaction()):w.$23l&&w.$40l&&(w.fi({kind:"endEditRotation",event:Y}),d.endTransaction())},handleWindowTouchEnd:function(X){this.handleWindowMouseUp(X)},handleWindowMouseUp:function(I){var b=this,w=b.gv,h=w.dm(),p=b._shape,O=b._edge,f=b.$13l,g=b.$40l,q=b.$9l,_=b.$10l,W=b.$67l;if((p||O)&&f>=0&&q>=0){var s,i;if(p){var R=p.p(),k=p.getRotation();s=p.getPoints(),i=s.get(q),op(p,R,k,f,i,!1)}else if(s=So(w.getDataUI(O),O.s("edge.points"),!0),i=s.get(q),0===f){var P=s.get(0);O.s("edge.source.offset.x",i.x-P.x),O.s("edge.source.offset.y",i.y-P.y)}else if(f===s.size()-1){var J=s.get(s.size()-1);O.s("edge.target.offset.x",i.x-J.x),O.s("edge.target.offset.y",i.y-J.y)}else"points"===O.s("edge.type")&&(s.set(f,i),O.s("edge.points",sc(s)))}b.$47l(I);var d=b.$73l;1===W?(h.beginTransaction(),d?w.sm().each(function(G){if(G.setHost&&w.isHelperEditable(G,"host")){G.setHost(d);
var Y=b.$75l,V=b.$74l;Y&&(G.s("attach.row.index",Y.rowIndex),G.s("attach.column.index",Y.columnIndex)),V&&(G.s("attach.index",V.attachIndex),G.s("attach.offset",V.attachOffset),G.s("attach.offset.relative",!1),G.s("attach.offset.opposite",!1))}}):w.sm().each(function(G){G.setHost&&w.isHelperEditable(G,"host")&&(G.setHost(e),G.s("attach.row.index",y),G.s("attach.column.index",y),G.s("attach.index",y),G.s("attach.offset",y),G.s("attach.offset.relative",!1),G.s("attach.offset.opposite",!1))}),h.endTransaction()):2===W?(h.beginTransaction(),d?w.sm().each(function(I){I.setParent&&w.isHelperEditable(I,"parent")&&I.setParent(d)}):w.sm().each(function(o){o.setParent&&w.isHelperEditable(o,"parent")&&o.setParent(e)}),h.endTransaction()):3===W?d&&(h.beginTransaction(),w.sm().each(function(f){if(w.isHelperEditable(f,"edge")&&f instanceof T&&d instanceof T){var E=new A.Edge;h.add(E),E.setSource(f),E.setTarget(d),b.onEdgeCreated&&b.onEdgeCreated(I,E)}}),h.endTransaction()):5===W||6===W?d&&(h.beginTransaction(),w.sm().each(function(U){U instanceof n&&d instanceof T&&(5===W&&w.isHelperEditable(U,"source")?U.setSource(d):6===W&&w.isHelperEditable(U,"source")&&U.setTarget(d))}),h.endTransaction()):(7===W||8===W||9===W)&&h.endTransaction(),(_||g)&&b.$43l(!0),S(I)?(b.clear(),delete b.$64l,b._68I||b.$43l()):(b.handle_mousemove(I,!0),W&&!b._68I&&b.$43l())},handleWindowTouchMove:function(N){this.handleWindowMouseMove(N)},handleWindowMouseMove:function(Q){this._78I(Q)},handle_mousemove:function(q,$,w){if(!this._pause){if(!w){var H=S(q)?jq(q):q;this.$61l={clientX:H.clientX,clientY:H.clientY}}if($===!0||!a()){var k=this,x=k.gv,b=!1,d=e;k.clear(),x.sm().size()>0&&(d=x.lp(w?k.$61l:q),b=k._79I(q,d)),b&&(x._editing=1),k.$12l!==k.$65l&&(k.$65l=k.$12l,k.setCursor(k.$12l)),k.$40l!==k.$64l&&(k.$64l=k.$40l,k._68I||k.$43l()),k._hoverSegmentIndex!==k.$66l&&(k.$66l=k._hoverSegmentIndex,k._68I||k.$43l())}}},_78I:function(k){this.autoScroll(k);var S=this,O=S.gv,V=O.lp(k),K=O.getZoom(),c=S.$13l;if((S._shape||S._edge)&&c>=0){var l,x,h,i=S._shape,$=S._edge,A=S.$24l,M=O.getPointSnapSpacing(),L=function(s,U){return M==e||isNaN(M)?{x:s,y:U}:{x:Z(s/M)*M,y:Z(U/M)*M}};if(i){l=i.getPoints();var C=i.p(),t=i.getRotation(),q=0;x=fc(C,V.x-C.x,V.y-C.y,-t),op(i,C,t,c,V,!0,A,L),S.fi({kind:"betweenEditPoint",event:k,data:i,index:c})}else if($){l=So(O.getDataUI($),$.s("edge.points"),!0),V.x-=A.x,V.y-=A.y,x=V;var y,W,_=$.s("edge.offset"),d=l.size(),P=d>2;if(0===c){var m=l.get(0);_&&(m=er(m,l.get(1),-_,P),V=er(V,l.get(1),-_,P)),y=V.x-m.x,W=V.y-m.y,h=L(y,W),$.s("edge.source.offset.x",h.x),$.s("edge.source.offset.y",h.y)}else if(c===d-1){var j=l.get(d-1);_&&(j=er(j,l.get(d-2),-_,P),V=er(V,l.get(d-2),-_,P)),y=V.x-j.x,W=V.y-j.y,h=L(y,W),$.s("edge.target.offset.x",h.x),$.s("edge.target.offset.y",h.y)}else"points"===$.s("edge.type")&&(h=L(V.x,V.y),h.e=l.get(c).e,l.set(c,h),$.s("edge.points",sc(l)));S.fi({kind:"betweenEditPoint",event:k,data:$,index:c})}if(delete S.$9l,O.isSnapPoint(i)||O.isSnapPoint($))for(q=0;q<l.size();q++)if(q!==c){var Y=l.get(q);if(R(Y,x)<O.getEditPointSize()/K){S.$9l=q;break}}}else if(S.$10l){var A=S.$24l;V.x-=A.x,V.y-=A.y;var N=O.sm().getSelection(),X=S.$1l,b=S.$7l,p=S.$10l,r=S.$4l,v=S.$2l,J=O.getEditRectPadding()/K,U=2*J,D=O.getSnapSpacing(),I=D!=e&&!isNaN(D),Q=hn(v,V,p,b,2*J,O.getResizeMode(),I,!0),o=S.$6l;if(I){var s=Q.width-U,g=Q.height-U,a=Z(s/D)*D,Qi=Z(g/D)*D,br=a-s,bs=Qi-g;("west"===p||"northwest"===p||"southwest"===p)&&(br=-br),("north"===p||"northwest"===p||"northeast"===p)&&(bs=-bs),Q=hn(v,V,p,b,2*J,O.getResizeMode(),I,!1,br,bs)}S.$8l=Q,o.x=Q.x+J,o.y=Q.y+J,o.width=Q.width-U,o.height=Q.height-U;var ol=Q.x+Q.width/2,ln=Q.y+Q.height/2,ei=o.x,Zn=o.y,wr=o.width/r.width,yh=o.height/r.height;N.each(function(M){if(M instanceof T&&O.isEditable(M)&&O.isRectEditable(M)){var B=X[M.getId()],_=S.$3l[M.getId()],Y={x:B.x+B.width/2,y:B.y+B.height/2},W=0,q=0,m=p,e=180*H(b-M.getRotation())/f;"northeast"===p?e>=315||45>e?(W=B.width*wr+B.x,q=B.height*(1-yh)+B.y,m="northeast"):e>=45&&135>e?(W=B.width*(1-yh)+B.x,q=B.height*(1-wr)+B.y,m="northwest"):e>=135&&225>e?(W=B.width*(1-wr)+B.x,q=B.height*yh+B.y,m="southwest"):(W=B.width*yh+B.x,q=B.height*wr+B.y,m="southeast"):"north"===p?e>=315||45>e?(q=B.height*(1-yh)+B.y,m="north"):e>=45&&135>e?(W=B.width*(1-yh)+B.x,m="west"):e>=135&&225>e?(q=B.height*yh+B.y,m="south"):(W=B.width*yh+B.x,m="east"):"northwest"===p?e>=315||45>e?(W=B.width*(1-wr)+B.x,q=B.height*(1-yh)+B.y,m="northwest"):e>=45&&135>e?(W=B.width*(1-yh)+B.x,q=B.height*wr+B.y,m="southwest"):e>=135&&225>e?(W=B.width*wr+B.x,q=B.height*yh+B.y,m="southeast"):(W=B.width*yh+B.x,q=B.height*(1-wr)+B.y,m="northeast"):"west"===p?e>=315||45>e?(W=B.width*(1-wr)+B.x,m="west"):e>=45&&135>e?(q=B.height*wr+B.y,m="south"):e>=135&&225>e?(W=B.width*wr+B.x,m="east"):(q=B.height*(1-wr)+B.y,m="north"):"southwest"===p?e>=315||45>e?(W=B.width*(1-wr)+B.x,q=B.height*yh+B.y,m="southwest"):e>=45&&135>e?(W=B.width*yh+B.x,q=B.height*wr+B.y,m="southeast"):e>=135&&225>e?(W=B.width*wr+B.x,q=B.height*(1-yh)+B.y,m="northeast"):(W=B.width*(1-yh)+B.x,q=B.height*(1-wr)+B.y,m="northwest"):"east"===p?e>=315||45>e?(W=B.width*wr+B.x,m="east"):e>=45&&135>e?(q=B.height*(1-wr)+B.y,m="north"):e>=135&&225>e?(W=B.width*(1-wr)+B.x,m="west"):(q=B.height*wr+B.y,m="south"):"south"===p?e>=315||45>e?(q=B.height*yh+B.y,m="south"):e>=45&&135>e?(W=B.width*yh+B.x,m="east"):e>=135&&225>e?(q=B.height*(1-yh)+B.y,m="north"):(W=B.width*(1-yh)+B.x,m="west"):"southeast"===p&&(e>=315||45>e?(W=B.width*wr+B.x,q=B.height*yh+B.y,m="southeast"):e>=45&&135>e?(W=B.width*yh+B.x,q=B.height*(1-wr)+B.y,m="northeast"):e>=135&&225>e?(W=B.width*(1-wr)+B.x,q=B.height*(1-yh)+B.y,m="northwest"):(W=B.width*(1-yh)+B.x,q=B.height*wr+B.y,m="southwest"));var E=fc(Y,W-Y.x,q-Y.y,M.getRotation());gj(M,B,m,{x:E.x,y:E.y});var l=ei+o.width*_.x,r=Zn+o.height*_.y,I={x:l,y:r};I=fc({x:ol,y:ln},I.x-ol,I.y-ln,b),M.p(I.x,I.y)}}),S.fi({kind:"betweenEditRect",event:k,direction:p})}else if(S.$23l&&S.$40l){var gs=S.$8l,Po=gs.width,zh=gs.height,C={x:gs.x+Po/2,y:gs.y+zh/2},A=S.$24l,zm=S.$23l,Qq=zm.x/K-C.x,wk=zm.y/K-C.y,Hg=w(Qq*Qq+wk*wk),bm=Math.asin(A.x/Hg),gq=O.sm().getSelection(),qg=z+G(V.y-C.y,V.x-C.x)-bm,If=O.getSnapAngle(),qg=Z(qg/If)*If;0>qg&&(qg+=E);var Fi=qg-S.$7l,kd=[C.x,0,C.y];gq.each(function(v){if(O.isEditable(v)&&O.isRotationEditable(v)&&O.isVisible(v)){var X=Mk(v.p3(),kd),n=bi();bl(n,-Fi),v.setRotation(v.getRotation()+Fi),Xn(X,n),v.p3(kd[0]+X[0],kd[1]+X[1],kd[2]+X[2])}}),S.$7l=qg,S.fi({kind:"betweenEditRotation",event:k})}else if([1,2,3,5,6].indexOf(S.$67l)>=0)S.$72l=k,S.$78l||(S.$78l=1,B(function(){F.isDragging()&&S.$43l(),delete S.$78l},12));else if(7===S.$67l){if(S.$87l instanceof u){var i=S.$87l,jo=S.$88l,Fq=F.clone(i.getPoints().get(jo)),ni=V.y-Fq.y;Fq.e||(Fq.e=0),S.$92l||(S.$92l=Fq.e),Fq.e=S.$92l-ni,i.setPoint(jo,Fq)}else if(S.$87l instanceof n){var $=S.$87l,jo=S.$88l,l=So(O.getDataUI($),$.s("edge.points")),Fq=l.get(jo),ni=V.y-Fq.y;Fq.e||(Fq.e=0),S.$92l||(S.$92l=Fq.e),Fq.e=S.$92l-ni,l.set(jo,Fq),$.s("edge.points",sc(l))}}else if(8===S.$67l){var gq=O.sm().getSelection(),Vd=S.$93l;Vd||(Vd=S.$93l={}),gq.each(function(X){if(X.p3){var D=X.p3(),t=Vd[X.getId()];t==e&&(t=Vd[X.getId()]=D[1]),X.p3([D[0],t-(V.y-S.$90l.y/K),D[2]])}})}else if(9===S.$67l){var gq=O.sm().getSelection(),no=S.$94l;no||(no=S.$94l={}),gq.each(function(R){if(R.s3){var B=R.s3(),u=no[R.getId()];u==e&&(u=no[R.getId()]=B[1]);var x=u-(V.y-S.$91l.y/K);0>x&&(x=.01),R.s3([B[0],x,B[2]])}})}},$79l:function(P,A){var o=this,j=o.gv,D=j.getZoom(),w=j.getEditHelperSize(),u=P.x/D,s=P.y/D,a=w/D,U=a/2;return O({x:u-U,y:s-U,width:a,height:a},A)?!0:void 0},getHelperCursor:function(){return"crosshair"},_79I:function(j,b){for(var L=this,t=L.gv,Z=t.getZoom(),G=t.getEditPointSize(),H=G/Z,F=H/2,a=L.$46l(j),s=0;s<a.length;s++){var h,P,_=a[s],T=t.getDataUI(_);if(T&&T._55O){var M=T._55O;if(M._43O&&_ instanceof n){if(h=_.s("edge.points"),h=So(T,h),P=_.s("edge.segments"),P&&P.size()||(P=Rb(h)),L.$42l(_,b,h._as,P,"edge"))return!0;if("points"===_.s("edge.type")&&L.$41l(_,b,h._as,P,"edge"))return}if(M._43O&&_ instanceof u&&M.$15l&&M.$15l.length===_.getPoints().size()){if(h=M.$15l,P=_.getSegments(),P&&P.size()||(P=Rb(h)),L.$42l(_,b,h,P,"shape"))return!0;if(L.$41l(_,b,h,P,"shape"))return}}}if(L.$16l){var h,I=L.$16l,C=I[3].x-I[7].x,r=I[3].y-I[7].y,f=w(C*C+r*r),x=I[1].x-I[5].x,m=I[1].y-I[5].y,g=w(x*x+m*m),J={x:b.x*Z,y:b.y*Z};if(L._80I(J,0,I[0],"northwest",f,g)||L._80I(J,1,I[1],"north",f,g)||L._80I(J,2,I[2],"northeast",f,g)||L._80I(J,7,I[7],"west",f,g)||L._80I(J,3,I[3],"east",f,g)||L._80I(J,6,I[6],"southwest",f,g)||L._80I(J,5,I[5],"south",f,g)||L._80I(J,4,I[4],"southeast",f,g))return!0}if(L.$23l){var E=L.$23l,q=E.x/Z,y=E.y/Z;if(O({x:q-F,y:y-F,width:H,height:H},b))return L.$40l=1,L.$12l=L.getHelperCursor("rotation")||"crosshair",!0}return L.$68l&&L.$79l(L.$68l,b)?(L.$67l=1,L.$12l=L.getHelperCursor("host")||"crosshair",!0):L.$69l&&L.$79l(L.$69l,b)?(L.$67l=2,L.$12l=L.getHelperCursor("parent")||"crosshair",!0):L.$70l&&L.$79l(L.$70l,b)?(L.$67l=3,L.$12l=L.getHelperCursor("edge")||"crosshair",!0):L.$71l&&L.$79l(L.$71l,b)?(L.$67l=4,L.$12l=L.getHelperCursor("remove")||"crosshair",!0):L.$82l&&L.$79l(L.$82l,b)?(L.$67l=5,L.$12l=L.getHelperCursor("source")||"crosshair",!0):L.$83l&&L.$79l(L.$83l,b)?(L.$67l=6,L.$12l=L.getHelperCursor("target")||"crosshair",!0):L._pointElevationHelperPoint&&L.$79l(L._pointElevationHelperPoint,b)?(L.$67l=7,L.$12l=L.getHelperCursor("pointElevation")||"crosshair",!0):L.$90l&&L.$79l(L.$90l,b)?(L.$67l=8,L.$12l=L.getHelperCursor("elevation")||"crosshair",!0):L.$91l&&L.$79l(L.$91l,b)?(L.$67l=9,L.$12l=L.getHelperCursor("tall")||"crosshair",!0):!1},_80I:function(i,h,M,B,p,U){var R=this,D=R.gv,n=D.getEditPointSize(),V=n/2,o=D.sm(),k=D.isDirectionEditable;if(k&&1===o.size()){var E=o.ld();if(k=k.bind(D),E instanceof T){if(!k(E,B))return!1;if("east"===B){if(k(E,"northeast")&&k(E,"southeast")&&2*n>=U)return!1}else if("west"===B){if(k(E,"northwest")&&k(E,"southwest")&&2*n>=U)return!1}else if("north"===B){if(k(E,"northwest")&&k(E,"northeast")&&2*n>=p)return!1}else if("south"===B&&k(E,"southwest")&&k(E,"southeast")&&2*n>=p)return!1}}else{if(2*n>=p&&("north"===B||"south"===B))return!1;if(2*n>=U&&("east"===B||"west"===B))return!1}if(O({x:M.x-V,y:M.y-V,width:n,height:n},i)){if(R.$10l!==B){var Z=180*R.$7l/f,G="";Z>=337.5||22.5>Z?G="north":Z>=22.5&&67.5>Z?G="northeast":Z>=67.5&&112.5>Z?G="east":Z>=112.5&&157.5>Z?G="southeast":Z>=157.5&&202.5>Z?G="south":Z>=202.5&&247.5>Z?G="southwest":Z>=247.5&&292.5>Z?G="west":Z>=292.5&&337.5>Z&&(G="northwest");var r=cb.indexOf(G),G=cb[h-(1-r)+8];switch(G){case"northwest":R.$12l="nwse-resize";break;case"northeast":R.$12l="nesw-resize";break;case"southwest":R.$12l="nesw-resize";break;case"southeast":R.$12l="nwse-resize";break;case"north":R.$12l="ns-resize";break;case"east":R.$12l="ew-resize";break;case"south":R.$12l="ns-resize";break;case"west":R.$12l="ew-resize"}R.$10l=B}return!0}return!1},$42l:function(Z,q,N,b,s){var K,P=this,h=P.gv,i=h.getEditPointSize(),H=i/h.getZoom(),z=-1,d={x:q.x,y:q.y,width:0,height:0},C=function(d){"shape"===s?P._shape=Z:P._edge=Z,P._removePointIndex=d},k=function(j){"shape"===s?P._shape=Z:P._edge=Z,P.$13l=j,P.$12l="crosshair"};for(U(d,H/2),z=N.length-1,K=b.size()-1;K>=0;K--){var x=b.get(K);if(1===x||2===x)z-=1;else if(3===x){var Q=N[z-1];if(O(d,Q))return k(z-1),!0;z-=2}else if(4===x){var L=N[z-1],t=N[z-2];if(O(d,L))return k(z-1),!0;if(O(d,t))return k(z-2),!0;z-=3}}for(z=N.length-1,K=b.size()-1;K>=0;K--){var x=b.get(K),W=N[z];if(O(d,W))return C(z),k(z),!0;1===x||2===x?z-=1:3===x?z-=2:4===x&&(z-=3)}return!1},$41l:function(y,Z,a,D,T){var M=this,n=M.gv,f=-1,F=0,s={x:Z.x,y:Z.y,width:0,height:0},m=function(H,n){M._hoverSegmentIndex=n,M._lp=Z,"shape"===T?M._shape=y:M._edge=y};for(U(s,n.getSegmentHoverWidth()/2/n.getZoom()),y instanceof u&&y.isClosePath()&&D.indexOf(5)<0&&(D=new r(D._as),D.add(5));F<D.size();F++){var I=D.get(F);if(1===I){var q=a[f],j=a[f+1];if(q){var $=Jq(new Sf(q.x,q.y),new Sf(j.x,j.y),new Sf(s.x,s.y),new Sf(s.x+s.width,s.y+s.height));if($.$62l===h&&$.points.length>0)return m($,F),!0}f+=1}else if(2===I){var q=a[f],j=a[f+1],$=Jq(new Sf(q.x,q.y),new Sf(j.x,j.y),new Sf(s.x,s.y),new Sf(s.x+s.width,s.y+s.height));if($.$62l===h&&$.points.length>0)return m($,F),!0;f+=1}else if(3===I){var q=a[f],A=a[f+1],i=a[f+2],$=un(new Sf(q.x,q.y),new Sf(A.x,A.y),new Sf(i.x,i.y),new Sf(s.x,s.y),new Sf(s.x+s.width,s.y+s.height));if($.$62l===h)return m($,F),!0;f+=2}else if(4===I){var q=a[f],J=a[f+1],o=a[f+2],i=a[f+3],$=Pq(new Sf(q.x,q.y),new Sf(J.x,J.y),new Sf(o.x,o.y),new Sf(i.x,i.y),new Sf(s.x,s.y),new Sf(s.x+s.width,s.y+s.height));if($.$62l===h)return m($,F),!0;f+=3}else if(5===I){var q=a[f],j=a[0];if(q){var $=Jq(new Sf(q.x,q.y),new Sf(j.x,j.y),new Sf(s.x,s.y),new Sf(s.x+s.width,s.y+s.height));if($.$62l===h&&$.points.length>0)return m($,F),!0}}}return!1},addShapePoint:function(i,q,D){var k=this,f=k.gv,m=f.dm();if(m.beginTransaction(),0===arguments.length&&(i=k._shape||k._edge,q=k._hoverSegmentIndex,D=k._lp),i instanceof u||i instanceof n){var $=cp(i,f.getDataUI(i),q);if(!isNaN(q)&&D&&!isNaN($)){var _=D;if(i instanceof u){var G=i.p(),B=i.getRotation(),c=i.toSegments();c&&c.size()||(c=Rb(i.getPoints())),i.isClosePath()&&c.indexOf(5)<0&&(c=new r(c._as),c.add(5));var T=c.get(q),J="addPoint",R="removePointAt";if(2===T||1===T){var Y={x:_.x,y:_.y};c.add(T,q),Y=fc(G,Y.x-G.x,Y.y-G.y,-B),i[J](Y,$+1)}else if(3===T){var X=i.getPoints(),o=X.get($),U=X.get($+2),Y={x:_.x,y:_.y};Y=fc(G,Y.x-G.x,Y.y-G.y,-B);var v=$c(o,Y),e=$c(Y,U);c.removeAt(q),c.add(3,q),c.add(3,q),i.setPoint($+1,Y),i[J](e,$+2),i[J](v,$+1)}else if(4===T){var X=i.getPoints(),o=X.get($),U=X.get($+3),Y={x:_.x,y:_.y};Y=fc(G,Y.x-G.x,Y.y-G.y,-B);var v=vb(o,Y),e=Og(o,Y),I=vb(Y,U),A=Og(Y,U);c.removeAt(q),c.add(4,q),c.add(4,q),i[R]($+1),i[R]($+1),i[J](Y,$+1),i[J](A,$+2),i[J](I,$+2),i[J](e,$+1),i[J](v,$+1)}else if(5===T){var Y={x:_.x,y:_.y};c.add(2,q),Y=fc(G,Y.x-G.x,Y.y-G.y,-B),i[J](Y,$+1)}i.isClosePath()&&c.remove(5),i.setSegments(c);var N=i.getWidth(),l=i.getHeight(),h=i.p().x-N/2,d=i.p().y-l/2;h-=G.x,d-=G.y;var t=vf(i,{x:h,y:d,width:N,height:l},B,G);i.p(t.x,t.y)}else if(i instanceof n){if("points"!==i.s("edge.type"))return m.endTransaction(),void 0;var X=i.s("edge.points");c=i.s("edge.segments"),X=So(f.getDataUI(i),X),c&&c.size()||(c=Rb(X)),c=new r(c._as.slice(0)),X=new r(X._as.slice(0));var T=c.get(q);if(2===T||1===T){var Y={x:_.x,y:_.y};c.add(T,q),X.add(Y,$+1)}else if(3===T){var o=X.get($),U=X.get($+2),Y={x:_.x,y:_.y},v=$c(o,Y),e=$c(Y,U);c.removeAt(q),c.add(3,q),c.add(3,q),X.set($+1,Y),X.add(e,$+2),X.add(v,$+1)}else if(4===T){var o=X.get($),U=X.get($+3),Y={x:_.x,y:_.y},v=vb(o,Y),e=Og(o,Y),I=vb(Y,U),A=Og(Y,U);c.removeAt(q),c.add(4,q),c.add(4,q),X.removeAt($+1),X.removeAt($+1),X.add(Y,$+1),X.add(A,$+2),X.add(I,$+2),X.add(e,$+1),X.add(v,$+1)}i.s("edge.points",sc(X)),i.s("edge.segments",c)}}}m.endTransaction()},removeShapePoint:function(H,h){var Y=this,W="removeAt",z=Y.gv,w=z.dm();if(w.beginTransaction(),0===arguments.length&&(H=Y._shape||Y._edge,h=Y._removePointIndex),h>=0&&(H instanceof u||H instanceof n)){var I=Yh(H,Y.gv.getDataUI(H),h),K=h;if(H instanceof u){var c=H.p(),a=H.toSegments();a&&a.size()||(a=Rb(H.getPoints()));var b=a.get(I),P="removePointAt";if(1===b&&0===K)if(H.getPoints().size()>1){var J=a.get(I+1);a[W](I+1),3===J?H[P](K+1):4===J&&(H[P](K+2),H[P](K+1)),H[P](K)}else H.dm().remove(H);else 2===b||1===b?(a[W](I),H[P](K)):3===b?(a[W](I),H[P](K),H[P](K-1)):4===b&&(a[W](I),H[P](K),H[P](K-1),H[P](K-2));H.setSegments(a);var m=H.getWidth(),g=H.getHeight(),B=H.p().x-m/2,_=H.p().y-g/2;B-=c.x,_-=c.y;var S=vf(H,{x:B,y:_,width:m,height:g},H.getRotation(),c);H.p(S.x,S.y)}else if(H instanceof n){if("points"!==H.s("edge.type"))return w.endTransaction(),void 0;var Z=H.s("edge.points");if(a=H.s("edge.segments"),Z&&(Z=So(Y.gv.getDataUI(H),Z),a&&a.size()||(a=Rb(Z))),0===h||h===Z.size()-1)return w.endTransaction(),void 0;a=new r(a._as.slice(0)),Z=new r(Z._as.slice(0));var b=a.get(I);2===b||1===b?(a[W](I),Z[W](K)):3===b?(a[W](I),Z[W](K),Z[W](K-1)):4===b&&(a[W](I),Z[W](K),Z[W](K-1),Z[W](K-2)),H.s("edge.segments",a),H.s("edge.points",sc(Z))}}w.endTransaction()},changeShapeSegment:function(Q,C,H){var m=this,D=m.gv,P=D.dm();if(P.beginTransaction(),1!==arguments.length||isNaN(Q)||(H=Q,Q=m._shape||m._edge,C=m._hoverSegmentIndex),Q instanceof u||Q instanceof n){var k=cp(Q,m.gv.getDataUI(Q),C);if(!isNaN(C)&&!isNaN(k))if(Q instanceof u){var s=Q.p(),$=Q.toSegments();$&&$.size()||($=Rb(Q.getPoints()));var _=$.get(C),g=Q.toPoints();if(1===H||2===H)1===_||2===_?$.set(C,H):3===_?($.set(C,H),g.removeAt(k+1)):4===_&&($.set(C,H),g.removeAt(k+1),g.removeAt(k+1));else if(3===H){var W=function(){var M=g.get(k),Z=g.get(k+1),B=$c(M,Z);$.set(C,3),g.add(B,k+1)};2===_||1===_?W():4===_&&(g.removeAt(k+1),g.removeAt(k+1),W())}else if(4===H){var w=function(){var Z=g.get(k),W=g.get(k+1),y=vb(Z,W),h=Og(Z,W);$.set(C,4),g.add(y,k+1),g.add(h,k+2)};2===_||1===_?w():3===_&&(g.removeAt(k+1),w())}Q.setSegments($),Q.setPoints(g);var T=Q.getWidth(),L=Q.getHeight(),z=Q.p().x-T/2,p=Q.p().y-L/2;z-=s.x,p-=s.y;var i=new vf(Q,{x:z,y:p,width:T,height:L},Q.getRotation(),s);Q.p(i.x,i.y)}else if(Q instanceof n){if("points"!==Q.s("edge.type"))return P.endTransaction(),void 0;var g=Q.s("edge.points");$=Q.s("edge.segments"),g&&(g=So(m.gv.getDataUI(Q),g),$&&$.size()||($=Rb(g))),$=new r($._as.slice(0)),g=new r(g._as.slice(0));var _=$.get(C);if(1===H||2===H)1===_||2===_?$.set(C,H):3===_?($.set(C,H),g.removeAt(k+1)):4===_&&($.set(C,H),g.removeAt(k+1),g.removeAt(k+1));else if(3===H){var W=function(){var i=g.get(k),d=g.get(k+1),q=$c(i,d);$.set(C,3),g.add(q,k+1)};2===_||1===_?W():4===_&&(g.removeAt(k+1),g.removeAt(k+1),W())}else if(4===H){var w=function(){var l=g.get(k),w=g.get(k+1),x=vb(l,w),m=Og(l,w);$.set(C,4),g.add(x,k+1),g.add(m,k+2)};2===_||1===_?w():3===_&&(g.removeAt(k+1),w())}Q.s("edge.points",sc(g)),Q.s("edge.segments",$)}}P.endTransaction()},getDefaultSegments:function(C){var l=this.gv,Q=l.getDataUI(C);if(C instanceof n){var w=C.s("edge.points");return w=So(Q,w),Rb(w)}if(C instanceof u){var w=C.getPoints(),z=C.getSegments();return z&&z.size()>0?z:Rb(w)}},$43l:function(f){var I=this;f&&(I.$5l=1),I._68I=1,I._42()},_42:function(){var s=this;if(s._68I){delete s._68I;var G=s.gv,m=s.$5l,q=G.getZoom(),z=G.getEditPointSize(),R=z/2,D=new r,I=s._view,V=s._edge,k=s._shape,H=I.getContext("2d"),l=G.tx(),O=G.ty(),d=e,K=G.getEditPointBackground(),c=G.getControlPointBackground(),X=G.getControlPointBorderColor(),M=G.getEditPointBorderColor(),Y=G.getEditRectBorderColor(),P=G.getDirectionLineColor(),S=G.getSegmentHoverColor(),C=G.getSnapPointBorderColor(),Z=G.getJoinPointBackground(),W=G.getJoinPointBorderColor(),B=G.getSegmentHoverWidth(),Q=[5,5],$=G.getEditRectBorderStyle();Zi(G,function(B){G.isSelected(B)&&G.isVisible(B)&&D.add(B)}),H.clearRect(0,0,t(I.width),t(I.height)),H.save(),b.translateAndScale(H,l,O,1);var _=e,h={x:0,y:0,width:0,height:0},y=0,f=0,j=0,a=0,g=0,L=0,Ef=0,vh=0,dg=0,Xn=0,ur=[];if(m?(delete s.$6l,delete s.$8l,delete s.$7l,delete s.$16l,delete s.$23l):(_=s.$6l,d=s.$7l),delete s.$68l,delete s.$69l,delete s.$71l,delete s.$70l,delete s.$82l,delete s.$83l,delete s._pointElevationHelperPoint,delete s.$90l,delete s.$91l,delete s.$75l,delete s.$74l,D.each(function(m){var D=G.getDataUI(m);if(D){var b=D._55O;if(G.isEditable(m))b._56O&&m instanceof T&&f++,ur.push(m),b._42O&&m instanceof T&&y++,G.isHelperEditable(m,"host")&&a++,G.isHelperEditable(m,"parent")&&j++,G.isHelperEditable(m,"remove")&&g++,G.isHelperEditable(m,"edge")&&L++,G.isHelperEditable(m,"source")&&Ef++,G.isHelperEditable(m,"target")&&vh++,G.isHelperEditable(m,"elevation")&&dg++,G.isHelperEditable(m,"tall")&&Xn++;else if(m instanceof J&&m.isExpanded()){var i=!0,z=G.getEditableFunc();z&&(i=z(m)),i&&(G.isHelperEditable(m,"host")&&a++,G.isHelperEditable(m,"parent")&&j++,G.isHelperEditable(m,"remove")&&g++,G.isHelperEditable(m,"edge")&&L++,G.isHelperEditable(m,"source")&&Ef++,G.isHelperEditable(m,"target")&&vh++,G.isHelperEditable(m,"elevation")&&dg++,G.isHelperEditable(m,"tall")&&Xn++,ur.push(m))}}}),H.beginPath(),H.lineWidth=1,H.strokeStyle=G.getNodeBorderColor(),ur.forEach(function(r){var V=G.getDataUI(r),A=V._55O;if(m)if(d==e&&(d=r instanceof n?0:r instanceof J&&r.isExpanded()?0:r.getRotation(),s.$7l=d),_==e){var p,M,k;if(r instanceof J&&r.isExpanded()||r instanceof n){var g=G.getDataUIBounds(r);M=g.width,k=g.height,p={x:g.x+M/2,y:g.y+k/2}}else p=r.p(),M=r.getWidth(),k=r.getHeight();_={x:p.x,y:p.y,width:0,height:0},h.x=p.x-M/2,h.y=p.y-k/2,h.width=M,h.height=k,_=i(_,h)}else{var p,M,k,$,P=_.x+_.width/2,Y=_.y+_.height/2,Z={x:P,y:Y};if(r instanceof J&&r.isExpanded()||r instanceof n){$=0;var g=G.getDataUIBounds(r);M=g.width,k=g.height,p={x:g.x+M/2,y:g.y+k/2}}else p=r.p(),M=r.getWidth(),k=r.getHeight(),$=r.getRotation();var f={x:p.x-M/2,y:p.y-k/2,width:M,height:k},b={x:f.x,y:f.y},L={x:f.x+f.width,y:f.y},B={x:f.x,y:f.y+f.height},c={x:f.x+f.width,y:f.y+f.height},b=fc(p,b.x-p.x,b.y-p.y,$),B=fc(p,B.x-p.x,B.y-p.y,$),c=fc(p,c.x-p.x,c.y-p.y,$),L=fc(p,L.x-p.x,L.y-p.y,$),w=-d,S=fc(Z,b.x-Z.x,b.y-Z.y,w),U=fc(Z,L.x-Z.x,L.y-Z.y,w),I=fc(Z,B.x-Z.x,B.y-Z.y,w),X=fc(Z,c.x-Z.x,c.y-Z.y,w),a=N([S,U,I,X]);_=i(_,a),_.x-=P,_.y-=Y;var u=vf(e,_,d,Z);_.x=u.x-_.width/2,_.y=u.y-_.height/2}if(y>1&&G.isEditable(r)&&G.isRectEditable(r)&&r instanceof T){var O=r.getRect(),o=A.$45l,x=Cb(o[0],q),t=Cb(o[2],q),z=Cb(o[4],q),E=Cb(o[6],q);r.getRotation()?(H.moveTo(x.x,x.y),H.lineTo(t.x,t.y),H.lineTo(z.x,z.y),H.lineTo(E.x,E.y),H.lineTo(x.x,x.y)):H.rect(O.x*q,O.y*q,O.width*q,O.height*q)}}),H.stroke(),_){s.$6l=v(_),U(_,G.getEditRectPadding()/q);var um={x:_.x+_.width/2,y:_.y+_.height/2},Gq=lp(um,_.width,_.height,d),Tj=Gq[0],sg=Gq[1],ok=Gq[2],Kf=Gq[3],Sk=Gq[4],Lg=Gq[5],rd=Gq[6],oh=Gq[7];if(Tj=Cb(Gq[0],q),sg=Cb(Gq[1],q),ok=Cb(Gq[2],q),Kf=Cb(Gq[3],q),Sk=Cb(Gq[4],q),Lg=Cb(Gq[5],q),rd=Cb(Gq[6],q),oh=Cb(Gq[7],q),s.$8l=_,y>0&&(s.$16l=[Tj,Sk,sg,Lg,Kf,rd,ok,oh],H.beginPath(),H.lineWidth=1,H.strokeStyle=Y,"dashed"===$&&H.setLineDash&&H.setLineDash(Q),H.moveTo(Tj.x,Tj.y),H.lineTo(sg.x,sg.y),H.lineTo(Kf.x,Kf.y),H.lineTo(ok.x,ok.y),H.lineTo(Tj.x,Tj.y),H.stroke(),"dashed"===$&&H.setLineDash&&H.setLineDash([])),H.beginPath(),H.lineWidth=1,H.fillStyle=K,H.strokeStyle=M,y>0){var Ie=Lg.x-oh.x,gk=Lg.y-oh.y,om=w(Ie*Ie+gk*gk),ac=Sk.x-rd.x,Kp=Sk.y-rd.y,Wj=w(ac*ac+Kp*Kp),Bg=2*z;if(G.isDirectionEditable&&1===ur.length){var ao=ur[0],kl=G.getDataUI(ao),$q=kl._55O,qk=G.isDirectionEditable.bind(G);if($q._42O){var Be,Rj,bb,Mo;qk(ao,"northwest")&&(Be=!0,H.rect(Tj.x-R,Tj.y-R,z,z)),qk(ao,"northeast")&&(Rj=!0,H.rect(sg.x-R,sg.y-R,z,z)),qk(ao,"southwest")&&(bb=!0,H.rect(ok.x-R,ok.y-R,z,z)),qk(ao,"southeast")&&(Mo=!0,H.rect(Kf.x-R,Kf.y-R,z,z)),qk(ao,"north")&&(Be&&Rj?om>Bg&&H.rect(Sk.x-R,Sk.y-R,z,z):H.rect(Sk.x-R,Sk.y-R,z,z)),qk(ao,"south")&&(Mo&&bb?om>Bg&&H.rect(rd.x-R,rd.y-R,z,z):H.rect(rd.x-R,rd.y-R,z,z)),qk(ao,"west")&&(bb&&Be?Wj>Bg&&H.rect(oh.x-R,oh.y-R,z,z):H.rect(oh.x-R,oh.y-R,z,z)),qk(ao,"east")&&(Mo&&Rj?Wj>Bg&&H.rect(Lg.x-R,Lg.y-R,z,z):H.rect(Lg.x-R,Lg.y-R,z,z))}}else om>Bg&&(H.rect(Sk.x-R,Sk.y-R,z,z),H.rect(rd.x-R,rd.y-R,z,z)),Wj>Bg&&(H.rect(Lg.x-R,Lg.y-R,z,z),H.rect(oh.x-R,oh.y-R,z,z)),H.rect(Tj.x-R,Tj.y-R,z,z),H.rect(sg.x-R,sg.y-R,z,z),H.rect(ok.x-R,ok.y-R,z,z),H.rect(Kf.x-R,Kf.y-R,z,z)}if(f>0){var Ud=s.$23l=fc(Sk,0,2*-z,d);H.moveTo(Ud.x+R,Ud.y),H.arc(Ud.x,Ud.y,R,0,E,!1)}H.fill(),H.stroke(),s.$40l&&s.$44l(H,_,d);var Qp,qe,Em=G.getLeftTopHelpers(),an=G.getRightTopHelpers(),fi=G.getLeftBottomHelpers(),rc=G.getRightBottomHelpers(),ah=G.getEdgeHelpers(),nd=G.getEditHelperSize(),zk=nd/2,Wf=function(k,h,t,N){"leftTop"===h?(Qp=_.x*q-nd-R-("h"===N?t*(nd+R):0)-1,qe=_.y*q-nd-R-("v"===N?t*(nd+R):0)-1):"rightTop"===h?(Qp=(_.x+_.width)*q+R+("h"===N?t*(nd+R):0)+1,qe=_.y*q-nd-R-("v"===N?t*(nd+R):0)-1):"leftBottom"===h?(Qp=_.x*q-nd-R-("h"===N?t*(nd+R):0)-1,qe=(_.y+_.height)*q+R+("v"===N?t*(nd+R):0)+1):"rightBottom"===h&&(Qp=(_.x+_.width)*q+R+("h"===N?t*(nd+R):0)+1,qe=(_.y+_.height)*q+R+("v"===N?t*(nd+R):0)+1);var J=Qp+zk,E=qe+zk,Q=(_.x+_.width/2)*q,u=(_.y+_.height/2)*q,Z=fc({x:Q,y:u},J-Q,E-u,d);if("host"===k){if(a>0)return s.$77l(H,d,Z),!0}else if("edge"===k){if(L>0)return s.$80l(H,d,Z),!0}else if("remove"===k){if(g>0)return ur&&1===ur.length&&ur[0]instanceof n?s.$81l(H,d,{x:Q+nd/2+5,y:u}):s.$81l(H,d,Z),!0}else if("parent"===k){if(j>0)return ur&&1===ur.length&&ur[0]instanceof n?s.$76l(H,d,{x:Q-nd/2-5,y:u}):s.$76l(H,d,Z),!0}else if("elevation"===k){if(dg>0)return s.$85l(H,d,Z),!0}else if("tall"===k){if(Xn>0)return s.$86l(H,d,Z),!0}else if("source"===k||"target"===k){var X=ur[0],c=G.getDataUI(X),S=wi(c,!0),m=S[0],$=S[1];if(Ef&&"source"===k)return s.$84l(H,_,m,!0,X.isLooped(),h,t,N),!0;if(vh&&"target"===k)return s.$84l(H,_,$,!1,X.isLooped(),h,t,N),!0}};if(Em&&Em.length>0){var fp=0;Em.forEach(function(p){Wf(p,"leftTop",fp,G.getLeftTopHelpersAlign()||"h")&&fp++})}if(an&&an.length>0){var fp=0;an.forEach(function(U){Wf(U,"rightTop",fp,G.getRightTopHelpersAlign()||"h")&&fp++})}if(fi&&fi.length>0){var fp=0;fi.forEach(function(j){Wf(j,"leftBottom",fp,G.getLeftBottomHelpersAlign()||"h")&&fp++})}if(rc&&rc.length>0){var fp=0;rc.forEach(function(b){Wf(b,"rightBottom",fp,G.getRightBottomHelpersAlign()||"h")&&fp++})}if(ah&&ah.length>0&&((Ef||vh)&&ur&&1===ur.length&&ur[0]instanceof n?!0:!1)){var fp=0;ah.forEach(function(W){Wf(W,"edge",fp,"h")&&fp++})}if(s.$72l){var jq,Sp=s.$67l,ic=s.$68l,Ed=s.$69l,Qc=(s.$71l,s.$70l),zd=s.$82l,xp=s.$83l;if(1===Sp?jq=ic:2===Sp?jq=Ed:3===Sp?jq=Qc:5===Sp?jq=zd:6===Sp&&(jq=xp),jq){var zs=G.lp(s.$72l),yp=G.getDataAt(s.$72l);if(yp&&yp instanceof T){var Zn,de,Se;if(s.$73l=yp,1===Sp)if(yp instanceof A.Grid)Zn=s.$75l=iq(yp,zs);else if(yp instanceof A.Shape){Se=s.$74l=Yq(yp,zs);var uq=yp.getPoints();if(Se){var Ii=Se.attachIndex,Ui=cp(yp,G.getDataUI(yp),Ii)+1,fh=Ui+1>=uq.size()?0:Ui+1,Fk=uq.get(Ui),ng=uq.get(fh),_c=yp.p(),Tq=yp.getRotation();Fk=fc(_c,Fk.x-_c.x,Fk.y-_c.y,Tq),ng=fc(_c,ng.x-_c.x,ng.y-_c.y,Tq),H.beginPath(),H.strokeStyle=S,H.lineWidth=B,H.moveTo(Fk.x*q,Fk.y*q),H.lineTo(ng.x*q,ng.y*q),H.stroke()}}Zn?de=Zn.rect:(de=F.clone(G.getDataUIBounds(yp)),F.grow(de,2)),H.beginPath(),H.rect(de.x*q,de.y*q,de.width*q,de.height*q),H.strokeStyle=1===Sp||4===Sp||6===Sp?o:p,H.lineWidth=2,H.setLineDash&&H.setLineDash([8,8]),H.stroke()}else delete s.$73l;zs.x=zs.x*q,zs.y=zs.y*q;var Pf=wk(jq.x,jq.y,zs.x,zs.y),gh=fc(jq,zs.x-jq.x,zs.y-jq.y,-Pf),tf=gh.x-jq.x;H.save(),H.translate(jq.x,jq.y),H.rotate(Pf),x.width=tf,x.height=40;var Dl=p;(1===Sp||4===Sp||6===Sp)&&(Dl=o),x.comps[0].gradientColor=Dl,F.drawImage(H,x,0,-20,tf,40),H.restore()}}}if(D.each(function(L){var m=G.getDataUI(L);if(m){var A,y,Q=m._55O,n=m._78o;if(Q&&Q._43O&&L instanceof u?(A=Q.$15l,y=L.getSegments(),y&&y.size()||(y=Rb(A)),L.isClosePath()&&y.indexOf(5)<0&&(y=new r(y._as),y.add(5))):Q&&n&&Q._43O&&(A=L.s("edge.points"),y=L.s("edge.segments"),A=So(m,A),y&&y.size()||(y=Rb(A)),A&&(A=A._as)),A&&y){var t=0,Y=y.size(),w=s._hoverSegmentIndex;A=A.slice(0);for(var J=0;J<A.length;J++)A[J]=Cb(A[J],q);H.beginPath(),H.strokeStyle=P,H.lineWidth=1,t=0;for(var J=0;Y>J;J++){var g=y.get(J);if(1===g||2===g)t++;else if(3===g){var $=A[t-1],i=A[t],o=A[t+1];H.moveTo($.x,$.y),H.lineTo(i.x,i.y),H.lineTo(o.x,o.y),t+=2}else if(4===g){var $=A[t-1],F=A[t],T=A[t+1],o=A[t+2];H.moveTo($.x,$.y),H.lineTo(F.x,F.y),H.moveTo(T.x,T.y),H.lineTo(o.x,o.y),t+=3}}if(H.stroke(),k===L||V===L&&"points"===V.s("edge.type")){H.beginPath(),t=0,H.strokeStyle=S,H.lineWidth=B;for(var J=0;Y>J;J++){var g=y.get(J);if(1===g||2===g){if(w===J){var $=A[t-1],o=A[t];H.moveTo($.x,$.y),H.lineTo(o.x,o.y);break}t++}else if(3===g){if(w===J){var $=A[t-1],i=A[t],o=A[t+1];H.moveTo($.x,$.y),H.quadraticCurveTo(i.x,i.y,o.x,o.y);break}t+=2}else if(4===g){if(w===J){var $=A[t-1],F=A[t],T=A[t+1],o=A[t+2];H.moveTo($.x,$.y),H.bezierCurveTo(F.x,F.y,T.x,T.y,o.x,o.y);break}t+=3}else if(5===g&&w===J){var $=A[t-1],o=A[0];H.moveTo($.x,$.y),H.lineTo(o.x,o.y);break}}H.stroke()}H.beginPath(),t=0,H.strokeStyle=W,H.lineWidth=1,H.fillStyle=Z;for(var J=0;Y>J;J++){var g=y.get(J);if(1===g||2===g){var o=A[t];H.moveTo(o.x+R,o.y),H.arc(o.x,o.y,R,0,E,!0),t++}else if(3===g){var o=A[t+1];H.moveTo(o.x+R,o.y),H.arc(o.x,o.y,R,0,E,!0),t+=2}else if(4===g){var o=A[t+2];H.moveTo(o.x+R,o.y),H.arc(o.x,o.y,R,0,E,!0),t+=3}}H.fill(),H.stroke(),H.beginPath(),t=0,H.strokeStyle=X,H.lineWidth=1,H.fillStyle=c;for(var J=0;Y>J;J++){var g=y.get(J);if(1===g||2===g)t++;else if(3===g){var i=A[t];H.moveTo(i.x+R,i.y),H.arc(i.x,i.y,R,0,E,!0),t+=2}else if(4===g){var F=A[t],T=A[t+1];H.moveTo(F.x+R,F.y),H.arc(F.x,F.y,R,0,E,!0),H.moveTo(T.x+R,T.y),H.arc(T.x,T.y,R,0,E,!0),t+=3}}if(H.fill(),H.stroke(),H.beginPath(),t=0,H.strokeStyle=C,H.lineWidth=2,(k===L||V===L)&&s.$9l!=e){var o=A[s.$9l];H.moveTo(o.x+R,o.y),H.arc(o.x,o.y,R,0,E,!0),H.stroke()}}}}),s.$87l&&G.sm().contains(s.$87l)){var mr,$e=s.$87l,nl=s.$88l,nd=G.getEditHelperSize(),zk=nd/2;if(G.isHelperEditable($e,"pointElevation"))if($e instanceof u){var us=$e.getPosition();mr=F.clone($e.getPoints().get(nl)),mr=fc({x:us.x,y:us.y},mr.x-us.x,mr.y-us.y,$e.getRotation()),mr.x*=q,mr.y*=q,H.translate(mr.x,mr.y),F.drawImage(H,F.getImage("xeditinteractor_elevationIcon"),zk,-zk,nd,nd),H.translate(-mr.x,-mr.y),s._pointElevationHelperPoint={x:mr.x+nd,y:mr.y}}else if($e instanceof n){var Rr=So(G.getDataUI($e),$e.s("edge.points")),mr=F.clone(Rr.get(nl));mr.x*=q,mr.y*=q,H.translate(mr.x,mr.y),F.drawImage(H,F.getImage("xeditinteractor_elevationIcon"),zk,-zk,nd,nd),H.translate(-mr.x,-mr.y),s._pointElevationHelperPoint={x:mr.x+nd,y:mr.y}}}H.restore(),s.$5l=0}},$89l:function(d,j,n,k){d.save();var i=this,M=i.gv,v=M.getEditHelperSize(),Z=v/2;d.beginPath(),d.translate(n.x,n.y),d.rotate(j),F.drawImage(d,k,-Z,-Z,v,v),d.restore()},$85l:function(r,s,L){var d=this;d.$90l=L,d.$89l(r,s,L,F.getImage("xeditinteractor_elevationIcon"))},$86l:function(C,j,R){var g=this;g.$91l=R,g.$89l(C,j,R,F.getImage("xeditinteractor_tallIcon"))},$77l:function(s,w,p){var c=this;c.$68l=p,c.$89l(s,w,p,F.getImage("xeditinteractor_hostIcon"))},$80l:function($,X,E){var m=this;m.$70l=E,m.$89l($,X,E,F.getImage("xeditinteractor_edgeIcon"))},$81l:function(n,o,P){var G=this;G.$71l=P,G.$89l(n,o,P,F.getImage("xeditinteractor_removeIcon"))},$76l:function(X,Y,$){var T=this;T.$69l=$,T.$89l(X,Y,$,F.getImage("xeditinteractor_parentIcon"))},$84l:function(Z,r,j,n,Y){var q,D=this,I=D.gv,p=I.getZoom(),V=I.getEditHelperSize(),S=V/2;j.x*=p,j.y*=p,Y&&(n?j.x-=S+5:j.x+=S+5),j.y-=V-2,n?(D.$82l=j,q=F.getImage("xeditinteractor_sourceIcon")):(D.$83l=j,q=F.getImage("xeditinteractor_targetIcon")),Z.beginPath(),Z.translate(j.x,j.y),F.drawImage(Z,q,-S,-S,V,V),Z.translate(-j.x,-j.y)},$44l:function(g,W,M){g.save();var d=this.gv.getZoom(),l=w(m(W.width,2)+m(W.height,2))/2*d+10,P=l,y=P+8,v=P+18,c=M,a=W.x+W.width/2,X=W.y+W.height/2;g.translate(a*d,X*d),g.beginPath(),g.strokeStyle="rgb(150, 150, 150)";for(var Q=0,D=0,B=0,I=0,J=0,U=0;360>U;U++)Q=U*f/180,0===U%5&&(D=C(Q)*P,B=j(Q)*P,I=C(Q)*y,J=j(Q)*y,g.moveTo(D,B),g.lineTo(I,J)),0===U%45&&(D=C(Q)*P,B=j(Q)*P,I=C(Q)*v,J=j(Q)*v,g.moveTo(D,B),g.lineTo(I,J));g.stroke(),g.beginPath(),g.rotate(-z),g.beginPath(),g.fillStyle="rgba(255, 0, 0, 0.1)",g.strokeStyle="rgb(157, 157, 157)",g.moveTo(0,0),g.arc(0,0,v,0,M,!1),g.fill(),g.beginPath(),g.moveTo(0+v,0),g.arc(0,0,v,0,M,!1),g.stroke(),g.rotate(z),g.font="bold 12px Verdana, Arial";var t=20*j(c),O=20*C(c),K=Z(180*c/f)+"°";g.textAlign="center",g.textBaseline="middle",g.beginPath();var A=g.measureText("365.°").width;g.fillStyle="white",g.rect(t-A/2,-O-10,A,20),g.fill(),g.beginPath(),g.fillStyle="rgb(79,79,79)",g.fillText(K,t,-O),g.restore()}})}("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:(0,eval)("this"),Object);