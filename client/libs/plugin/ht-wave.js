!function(){"use strict";var t=ht.Default;t.clone,t.isArray,t.isObject,new ht.Notifier;function e(t,e,a){for(var i,n,r,s,h,o="",w=a||0;w<t.length;)i=e.indexOf(t.charAt(w++))<<2|(r=e.indexOf(t.charAt(w++)))>>4,n=(15&r)<<4|(s=e.indexOf(t.charAt(w++)))>>2,r=(3&s)<<6|(h=e.indexOf(t.charAt(w++))),o+=String.fromCharCode(i),64!=s&&(o+=String.fromCharCode(n)),64!=h&&(o+=String.fromCharCode(r));return o=decodeURIComponent(escape(o))}var a="/48x0TIYUWJaNdR1bijQGXP7A+Ecnmqkw=Mv5yZrStpB62LOhCgVosDH3lfKeF9zu",i="waveSimBaseShader",s="waveSimHShader",h="waveSimVShader",n="waveSimInitShader",r="waveSimPhaseShader",o="waveSimSpectrumShader",w="waveSimNormalShader",U=e("8r+OEPbwcPTtcM=DcDy5Jj4K8M/w+DCkirW=+odOcIFgUxowUY+yAVbSN83hJQ6Jkbuu",a),c=e("mPlt+ZFgcj42A7boUYXbnZFp+PdoQPTonZy3RhtscZyZcHW2UIs=mxbwmGsO+IX6XZyymos=mYWtqx6JA7ionZyMm7iyUY+yAVNwmrNK8r+OEPbwcPTtcM=DcDy5Jj4K8M/w+DCkGIFtcriQE7tyUxowN83hNx0K8M/w+DCkGIFVE7itcD3w1j4D+PNoJx/LN85K8rou",a),m=e("A7ionZyMm7iyUY+yAVUwAX4OnDyoEPFLRhtDA7WlEPlrUY+yAVUwmyFvcDFg+IyLA7iynV6JmZFt+842APyLU8=DcDy5Jj4K8M/wmyFvcDFg+IyLA7iyng/FUITbcHdtmIyOcM/pUx/Ldj/BUx/LdQ6JU84rcTFbcHdtmIyOcM/FUY+yAVbSAX4OnDyoEPFLa8/hav/6Ux0LN85K8rou",a),g=e("nYWyADyVEPFLUI=t+D=hUI+6cDToRhtvcDlVm84ZcIF=m84bjj/FUxNLNQbCdQ5gdvGVdQ5K8rXLEP+OnZownDT2nICynvW0UYXkEPlhm7bK8rXLEP+OnZow+ZCOA7bwmXFonZTLnD+OnZsQE7tyRhtscZyZcHW2UI+6cDToUYXknHXMmYW=crdZcHW2GDyf+Q6JmZTgqPyL+g4D+PNgUY+kADFOnZitcZTo+7NK8r+yAVUwc7X6mIyhcYyxcDshcIX3U8=D+PNgUI06UY+yAVUwAM5wqhSwUYWymYXgcM4D+PNgJITcNTowJM4MPV4mU8owAX6C7j/pUIWcNXo6UITcNXowJM4MPV4mU86wAX6h7j/pUIWcNXotRhtF8MeOUYXLEP+OnZow+ZCOA7bwmXFoEPsyRhtDcDy5UIs=EP3wJY+OEPbtUY6JagewU84rcTFInZTrbDF6cHUw1j4D+PNoJx/LN8hwnDyLJYXkmIy2+j/OUx0hNx/LN856Ux/LN8hwNj3hJQ6JagewUYWymYXgcv6JUDyZ+IXZU0=1G5yEQolGbGhJU84ZcIF=m84tcZiyq8/FUY+kADFOnZitcZTo+7NLq8/pUYXkmYW=crdZcHW2GDyf+j/2Ux/LdQ6JUDX6nDGJU84ZcIF=m84tcZiyq8/FUY+kADFOnZitcZTo+7NLqj/pUYXkmYW=crdZcHW2GDyf+j/2Ux/LdQ6JUDXL+IyZ8M/w+ZCOA7bw+7+yc5yL+IX3Uxow+ZCOcHUSEPl5+7wwag4s7HdsArigAPlV+ZFgcXdtqZGtU8SwJYXknHXMmYW=crdZcHW2GDyf+j/pUx/Ldj5wJg42cDbSEPl5+7w6UYXknHXMmYW=crdZcHW2GDyf+j/pUx/Ldj5K8Mdt+Ziy+M4UQsWWP5FRX0TN8M/wmZXvd84ymZXLUxowmIX3mYXg+QW0JYXkEPlhm7b6UY+yAVUS+7+yc5yL+IX3U86wN83sa84rcTFInZTrbDFOnZbLqj5wag4s7HigAPlV+ZFgcXdtqZGtarWrAZ0K8M/wmZXvd84O+Ibw1j4o+7=om7WyN5bSmXFtcr4sm8hwmZXvNM=ymZXLjPl5+7wwJg4s7HigAPlV+ZFgcXdtqZGwJM/havGwJg/havG6UIm67o+gAPmxcDFg+8llJj/OUYXkmYW=crdZcHW2GDyf+j5LnZmMAQ6JUDX6nDGJU84D+PNoUIXD+P3w1j4o+7=om7WyN5bSmXFtcr4sm8hwmZXvNM=rcTFInZTrbDFOnZbLq8hw+7+yc5yL+IX3U86wN83sJj/OUYXkmYW=crdZcHW2GDyf+j5LnZmMAQ6JU84D+PNoUIF5+8/FUYiyqYisnZGgi8=s7DyLnYXoa84D+PNgJIm67o+gAPmxcDFg+8l3a84ymZXLjPl5+7wwJg4s7HigAPlV+ZFgcXdtqZGwJM/havGwJg/havGtU8ewmXFonZTLnD+OnZsQE7tyJjlg+DW=RhSv+Pl5EPAJU84ZcIF=m84omDy5+ICyb7WrmPsycrbw1j/2NM3hU8SwG05wJM/SEPl5+7wwag4s7HdsArigAPlV+ZFgcXdtqZGtRhSwUY+yAVUwmYmt+Ii6+j/FUY+yAVUSADFVJYiHEPi5cIX4nZmscPXLm856UYdtcM=omDy5+ICyb7WrmPsycrbtJQ6JU84D+PNgUIFsmY4sm00w1j4ymZXLar=lU86wc7X6mIyhcYyxcDshcIX3JYiHEPi5cIG6UIF5+8l3qj5K8M/wmZXvNM4Om7ihm7i8Uxow+7+ycMlfmg/BUIsscYitnIClbDF2nICyq8=omDy5+ICya84O+IbLqrntRhSwUIm67o+gAPmxcDCOnM/FUY+yAVbScHXonYXobjhwcHXonYXobM5K8rou",a),d=e("nYWyADyVEPFLUI=t+D=hUI+6cDToRhtvcDlVm84ZcIF=m84bjj/FUxNLNQbCdQ5gdvGVdQ5K8ZdOcrdoUI+6cDToU0nw1j/lavwCRhtvcDlVm84ZcIF=m84aQj/FUxNHN83hRhtvcDlVm84ZcIF=m84xQj/FUx/LNvNK8rXLEP+OnZowmZXvNM4s7HmtcZbK8rXLEP+OnZow+ZCOA7bwmXFg+7dOcYXoEPFLRhtscZyZcHW2UI+6cDToUYXknDyf+Q6J+ZCOA7bwnHTsA7WyU8=ZcIF=m843Jj4K8M/wU84g+7isnZ3wq8/pUYwK8roJ+ZCOA7bwcDsy+D0wJI+6cDToUI6tUY6JU8/wUI+6cDToUYbw1j4BU8ewjooK8M/wU84g+7isnZ3wnHTgm8=YU8SwEg/pU8wCav/wJg4oU8Swm85tRhtF8Z+6cDToUYi=cZwwJI+6cDToUYwtUY6JU8/wUYWymYXgcM/SNj3hU8ow+7=hJ8ogav/wJM43Jj5wag/SNj3hU86w+7=hJ8ogav/wJM43Jj5K8roJmZFt+842APyLU8=DcDy5Jj4K8M/wU8/wU8/wmZXvNM4vcDFg+IyLA7iyng/FUIm67o+gAPmxcDFg+8l3qj/2Ux/LdQ6JU8/wUI+6cDToUI3w1j/SADFOnZitcZTo+7NLq8/eUYXknZXVcDCsmIyOcM/pUx/Ldj5w1g4vcDFg+IyLA7iyngl3UxSwADFOnZitcZTo+7NLq8/2UYXknZXVcDCsmIyOcv6JU8/wUI+6cDToUIow1j/SADFOnZitcZTo+7NLqj/eUYXknZXVcDCsmIyOcM/pUx/Ldj5w1g4vcDFg+IyLA7iyngllUxSwADFOnZitcZTo+7NLqj/2UYXknZXVcDCsmIyOcv6JU8/wUY+yAVUwmDTD+X+yAHiOnM/FU8wgav/wJM4bjj/pUY+yAVUScMhwcj5tU8ewmXFVE7tyRhSwU8/w+ZCOA7bwEg/FUICycZmoE8=HA7+yXZXvmIFgJQ6JU8/wUI+6cDToUTGCN8/FUICycZmoE8=s7HmtcZbtRhSwU8/w+ZCOA7bwQDsy+D0w1j/havwoRhSwU8/w+ZCOA7bwEH/w1j4YU8SwnHTsA7WyJ0F2+Pm=U8ewXQ0hJQ6JU8/wUI+6cDToUINw1j4OcPXrAj=BJj/OUI6K8M/wU84ZcIF=m84vn8/FUIF2+Pm=JI2hJj/OUI2hRhSwU8/w+ZCOA7bwQY42Uxow+7=hJ8oCavUsU8SwnHTsA7WyJI2hU8ewEg5tRhSwU8/w+ZCOA7bw+DT2cP0w1j/CavnK8M/wU84ZcIF=m84VEPm2Aj/FUx/LNxwwJM/SNj3hU86wd83hU8SwnIFHJ0F2+Pm=a8/2Ng3hJj5K8M/wU84ZcIF=m84YAPs2Aj/FUIX3n8w2nHTsA7WyJYdCnrbSEg/OUI2hJj/2Ux0LN85wag/gav/wJM4Vn7X=nZGSnDyrcP0tJQ6JU8/wUI+6cDToU0thUxownIFHJIm=cPs=a84YAPs2Aj5K8M/wU84ZcIF=m84In8/FU0Chcj/pU0thU8Sw+7=hJ8s1cPXrAj/OUYdCnrbSNQ/LN85wJM/SnHTgm8=BU8ewEH/tU8owNj3hJj5K8M/wU84ZcIF=m84=cY4SA7/w1j/hav/hdM/pUYdCnrbSQDsy+D0tRhSwU8/w+ZCOA7bwbZhw1j/havGwJM4=cY4SA7/wJM4vn8/OUINwJM4Inx6JU8/wUI+6cDToUYShUxowN83hNx/hNVnwJM4Vn7X=nZGSXQ0hJj/OU0nwJM4hcHnSXQ0hU8ewAH/6Ux/LRj5K8M/wU84ZcIF=m84sGHi=nM/FUx/Ldx0wJM4XNQ/wag46cDnSNQ/LN8/OUYShJQ6JU8/wUI+6cDToUIT6nI==cj/FUx/LNx0wJM/SJYXQmITgUxhwbootUxewJx0LN8/BUICO+g=sGHi=nM/OU0ddJj5wRM/SNj3hU86wNg3hU8SwcIFrJYXQmITgU8ewbootJj5K8M/wU84ZcIF=m84Icj/FUIX3n8w2N83gdj/pUYdCmPTg+j=BU8ewjoowaj/Cav/tJQ6JU8/wUI+6cDToU0WSUxowN83sU8SwAPChEIT2U8Swboowag4vU8SwiZowJM4NnIoK8M/wU84ZcIF=m84=N8/FUICO+gwgav/tU8ewd83hRhSwU8/w+ZCOA7bwAPow1j/hav0VU8SwmXdoA7Uwag4xQQ6JU8/wUI+6cDToU0iycYi=UxowmITLE8==N8/BUxbLN8/pUY4Omg=vU8ewAH/6UxULdj5wJg4=cj/pUY4Omg=xQj/OUIN6UxULdj5tRhSwU8/w+ZCOA7bwADFVGI=tUxow+IFoJIlOnZs=cIyf+j=s7HmtcZbta84LcHW2APCtqZGSmDTD+X+yAHiOnM5tRhSwU8/w+ZCOA7bwGg/FU8wCav/wag/SNM3hU8SwG05tJj/pUY4Omg=Ba8/2d83hJj/pU8=8c8/BU0WSJj/pU8wCav/wJg40+PCoAj/pU8wgav/wJM4vcHdbEI5wJM4vcHdbEI5waj/Cav/tJQ6JU8/wUI+6cDToUIiBUxowNM3hU8SwG05wag4s7HdtqZGK8M/wU84ZcIF=m84SUxownHTgm8=QU8ewNM3hJj/pUIiBRhSwU8/wEPAwJYm=mZXP+PdocHULq8/F1j/hav/wWMAwmDTD+X+yAHiOnMllUxoFUx/LN85wqhSwU8/wU8/wUIww1j/hav/K8M/wU84F8M/wU84rcTFInZTrbDF6cHUw1j4D+PNoJIw6Ux/LN8hwN83ha8/hav/tRhtF",a),y=e("nYWyADyVEPFLUI=t+D=hUI+6cDToRhtvcDlVm84ZcIF=m84bjj/FUxNLNQbCdQ5gdvGVdQ5K8ZdOcrdoUI+6cDToU0nw1j/lavwCRhtvcDlVm84ZcIF=m84aQj/FUxNHN83hRhtDA7WlEPlrUY+yAVUwmyFvcDFg+IyLA7iynV6JmPlt+ZFgcj4VAPshcIXgN5bwmXFhEITV+7NK8rXLEP+OnZow+ZCOA7bwmXF5+PCoAXitcPGK8rXLEP+OnZow+ZCOA7bwmXFg+7dOcYXoEPFLRhtscZyZcHW2UI+6cDToUYXknDyf+Q6J+ZCOA7bwcDsy+D0wJI+6cDToUI6tUY6JU8/wUI+6cDToUYbw1j4BU8ewjooK8M/wU84g+7isnZ3wnHTgm8=YU8SwEg/pU8wCav/wJg4oU8Swm85tRhtF8r+OEPbwcPTtcM/SmZFt+85wqhSwU8/wmZXvNM4vcDFg+IyLA7iyng/FUIm67o+gAPmxcDFg+8l3qj/2Ux/LdQ6JU8/wUI+6cDToUI3w1j/SADFOnZitcZTo+7NLq8/eUYXknZXVcDCsmIyOcM/pUx/Ldj5w1g4vcDFg+IyLA7iyngl3UxSwADFOnZitcZTo+7NLq8/2UYXknZXVcDCsmIyOcv6JU8/wUI+6cDToUIow1j/SADFOnZitcZTo+7NLqj/eUYXknZXVcDCsmIyOcM/pUx/Ldj5w1g4vcDFg+IyLA7iyngllUxSwADFOnZitcZTo+7NLqj/2UYXknZXVcDCsmIyOcv6JU8/wUY+yAVUwmDTD+X+yAHiOnM/FU8wgav/wJM4bjj/pUY+yAVUScMhwcj5tU8ewmXFVE7tyRhSwU8/w+ZCOA7bwnI==nDGw1j4o+7=om7WyN5bSmXFhEITV+7N6UY+kADFOnZitcZTo+7NtarUK8M/wU84ZcIF=m845+PCoAX4SA7dyUxowcDsy+D0ScIXL+HiSJYm=mZXP+PdocHUtJj/pUYXk+IX6mITGEPsyRhSwU8/wnI==nDGw1j42cDbSnI==nDGwJg45+PCoAX4SA7dya8/gav/wJM4bjj5K8M/wU84rcTFInZTrbDF6cHUw1j4D+PNoJY4SA7dya8/hav/6Ux/LN8hwN83hJQ6Jkbuu",a),t=e("nYWyADyVEPFLUI=t+D=hUI+6cDToRhtvcDlVm84ZcIF=m84bjj/FUxNLNQbCdQ5gdvGVdQ5K8ZdOcrdoUI+6cDToU0nw1j/lavwCRhtvcDlVm84ZcIF=m84aQj/FUxNHN83hRhtDA7WlEPlrUY+yAVUwmyFvcDFg+IyLA7iynV6JmPlt+ZFgcj4ZcIF=m84s7HdtqZGK8rXLEP+OnZow+ZCOA7bwmXFg+7dOcYXoEPFLRhtscZyZcHW2UYd=c746+7Ugi84s7H4SA7dynV6JmPlt+ZFgcj4VAPshcIXgN5bwmXFtcZyoEPT6GH4yAHigmPoK8rXLEP+OnZow+ZCOA7bwmXFvEIFhnIyL+7dVRhtD+PNgUIsscYitnIClbDF2nICyq8/SmZXvNM4=a84D+PNgUIUtUY6JU8/wUYWymYXgcM4D+PNgJITcNTowJM4MPV4mU8owAX6C7j/pUIWcNXo6UITcNXowJM4MPV4mU86wAX6h7j/pUIWcNXotRhtF8r+yAVUwc7X6mIyhcYy8qG5wJY+yAVUwqM5wqhSwU8/wnZXom7WLUY+yAVUSa7tcNXo6UYtcNTotRhtF8wtDcDy5UIs=EP3wJY+OEPbtUY6JU8/wUY+yAVUwADFOnZitcZTo+7Nw1j4rcTFInZTrbDFOnZbLqY5waj/havGK8M/wU84ZcIF=m84LUxowJIdOcHW5EPl=mIXVarww184s7HWynDF6m7itcD3wJM/havGtUxewADFOnZitcZTo+7NLq8/fUIdOcHW5EPl=mIXVarwwaj4s7HWynDF6m7itcD3K8M/wU84ZcIF=m842UxowJIdOcHW5EPl=mIXVar5w184s7HWynDF6m7itcD3wJM/havGtUxewADFOnZitcZTo+7NLqj/fUIdOcHW5EPl=mIXVar5waj4s7HWynDF6m7itcD3K8M/wU84D+PNgUYm=mZXP+PdocHUw1j/SNM3hU8SwG05wJM4D+PNgJI36UIotJj/OUYXknDyf+Q6JU8/wUI+6cDToUY4SA7dyUxowmIX3mYXg+QW0JYXknI==nDXVa84D7DdOcHW5EPl=mIXVJjlgRhSwU8/wmZXvNM4hEITV+X+yAHiOnM/FUY+yAVUSADFVJY4SA7dyJjhwnDyLJY4SA7dyJj5K8M/wU84D+PNgUIwhUxowmIX3mYXg+QW0JYXkEPltmIy=cTdh+PdonrX2a84D7DdOcHW5EPl=mIXVJjlg+V6JU8/wUY+yAVUwEx4QmITgUxowmIX3mYXg+QW0JYXkEPltmIy=cTdh+PdonrX2a84D+PNgJx0LN8/2UY+kADFOnZitcZTo+7NwJg/Cav/wag4s7HWynDF6m7itcD3tJjlg+V6JU8/wUIwhGHi=nMllU8SFU8oCav/K8M/wU84D+PNgUIww1j42mPCoE746qGdOc746+7wSEx/6UY4SA7dyXZXvmIFgJj/BUIsscYitnIClbDF2nICyq8=SNTdoA7U6UY+yAVUSnI==nDXP+PdocHULq8hwa74SA7dyXZXvmIFgar5tJQ6JU8/wUY+yAVUwETww1j/2c7X6mIyhcYy8qG5SE8/pU8=HA7+yXZXvmIFgarwwag46+PlrmIwSmDTD+X+yAHiOnM5tJj/pUYXkAD=OnY4tcZXVnV6JU8/wUY+yAVUwETSw1j/2c7X6mIyhcYy8qG5SE8/pU8=HA7+yXZXvmIFgar5wag46+PlrmIwSmDTD+X+yAHiOnM5tJj/pUYXkAD=OnY4tcZXVnV6JU8/wUIyZU8=HA7+yXZXvmIFgarww1QowN83hU8AZUYm=mZXP+PdocHULqj/F1j/hav/tUY6JU8/wU8/wU84SUxowmZXvNMwhav/tRhSwU8/wU8/wUI=AUxowmZXvNMwhav/tRhSwU8/wU8/wUI=EUxowmZXvNMwhav/tRhSwU8/wkbSwU8/w+DCkirW=+odOcIFgUxowmZXvd8=SP8/BUIsscYitnIClbryWJIwta84SPM5K8rou",a),a=e("nYWyADyVEPFLUI=t+D=hUI+6cDToRhtDA7WlEPlrUY+yAVUwmyFvcDFg+IyLA7iynV6JmPlt+ZFgcj4VAPshcIXgN5bwmXF5E7dhcITv+PsycridA7/K8rXLEP+OnZow+ZCOA7bwmXFg+7dOcYXoEPFLRhtscZyZcHW2UI+6cDToUYXknDyf+Q6JmZFt+842APyLU8=DcDy5Jj4K8M/wU84ZcIF=m84o+7=yc8/FUx0LN8/OUYXknZXVcDCsmIyOcv6JU8/wUI+6cDToUYiyqIX6GDyf+j/FUYXknDyf+j/OUYXknZXVcDCsmIyOcv6JU8/wUY+yAVNwADXLmIXgUxowmIX3mYXg+QW0JYXk+IyVnIC=ADX2+PloQPTha84D7DdOcHW5EPl=mIXVJjlg+DUK8M/wU84D+PNVUYWt+D=oUxowmZXvNg=o+7=ycTdtqZG6Ux/LN8hwN83hJj/BUYiyqYisnZGgi8=s7DitnH46APdycPXLm0s=n8hwmyFvcDFg+IyLA7iyng/BUY+yAVUSmIX3+Ph6Ux/LN85tarWrAM/2UIdycriynv6JU8/wUY+yAVNwcIXZm8/FUY+yAVNSa7iyqIX6GDyf+jhwN83ha8/hav/tU86wmIX3mYXg+QW0JYXk+IyVnIC=ADX2+PloQPTha84D7DdOcHW5EPl=mIXVU86wmZXvNMw2mIX3+Ph6Ux/LN85tarWrAM/2UIdycriynv6JU8/wUY+yAVNwmIFhUxowmZXvNgwhav/6Ux/LN8hwa7iyqIX6GDyf+j5wJg4o+7=om7WyN5bSmXF5E7dhcITv+PsycridA7/6UY+kADFOnZitcZTo+7NwJg4D+PNgJx/LN8hwa7iyqIX6Jj5LnZmMU8owADXLmIXgRhSwU8/wmZXvNg4McHiocDow1j4D+PNVJx/LN8hwN83ha84o+7=ycTdtqZGtU86wmIX3mYXg+QW0JYXk+IyVnIC=ADX2+PloQPTha84D7DdOcHW5EPl=mIXVU86wmZXvNMwhav/6UYiyqIX6Jj5LnZmMU8owADXLmIXgRhSwU8/wmZXvNg4ocH4jEPmSm8/FUIdgcHdVJYWt+D=oa84ocH/tRhSwU8/wmZXvNg4ocH4N+P+oUxowAHWOnHNSmIFha846+P+oJQ6JU8/wUY+yAVNwAZFomIF2QIXZm8/FUIdgcHdVJICy+rb6UIWOmYiOcj5K8M/wU84D+PNVUIWOmYiOcXWt+D=oUxowAHWOnHNSAZFomIF2a84gEPmSm85K8M/wU84rcTFInZTrbDF6cHUw1j4D+PNoJIlOnZs=cIyf+j=ocH4jEPmSm8/BUYiOn0Cy+rbwJg4McHiocDsN+P+oU86wAZFomIF2GZyrEYbta8/Cav/tRhtF",a);ht.Default.setShader(i,c,U),ht.Default.setShader(s,m,"#define HORIZONTAL \n"+g),ht.Default.setShader(h,m,g),ht.Default.setShader(n,m,d),ht.Default.setShader(r,m,y),ht.Default.setShader(o,m,t),ht.Default.setShader(w,m,a);var l="waveSimModelName";ht.Default.setShape3dModel(l,{model3d:!0,mesh:{vs:[0,0,0]},mat:{type:i,renderMode:"points"}});var I={vs:[-1,-1,-1,1,1,-1,1,1]},D=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},m=function(t,e,a){return e&&T(t.prototype,e),a&&T(t,a),t};function T(t,e){for(var a=0;a<e.length;a++){var i=e[a];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function p(t,e,a){null===t&&(t=Function.prototype);var i=Object.getOwnPropertyDescriptor(t,e);return void 0!==i?"value"in i?i.value:void 0!==(i=i.get)?i.call(a):void 0:null===(t=Object.getPrototypeOf(t))?void 0:p(t,e,a)}var a=function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)},v=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e},_=(i=ht.graph3d.Node3dUI,a(u,i),m(u,[{key:"validate",value:function(t,e){var a=this;p(u.prototype.__proto__||Object.getPrototypeOf(u.prototype),"validate",this).call(this,t,e);var i,n=this.data;n._initDone||((i=this.gv.getGL()).getExtension("OES_texture_float"),i.getExtension("OES_texture_float_linear"),i.getExtension("EXT_color_buffer_float"),n.initTarget(this.gv),n._initDone=!0,n._resolutionChanged=!1,n.initMaterialUniforms(),this.gv.addOnPreFrameFunc(this.data.getId(),function(){var t=a.gv.getGLState();t.depth.enabled=!1,t.blend.enabled=!1,n.draw(a.gv),n.iv()})),n._resolutionChanged&&(n._resolutionChanged=!1,n.updateResolution(this.gv.getGL())),n._tagDirty&&((e=n.getTag())&&(i=e+"Normal",this.gv.setTexture(e,n._displaceTexture),ht.Default.setImage(e,null),this.gv.setTexture(i,n._normalTexture),ht.Default.setImage(i,null)),n._tagDirty=!1)}},{key:"drawBody",value:function(t,e,a){p(u.prototype.__proto__||Object.getPrototypeOf(u.prototype),"drawBody",this).call(this,t,e,a)}}]),u);function u(t,e){return D(this,u),v(this,(u.__proto__||Object.getPrototypeOf(u)).call(this,t,e))}var P=(i=ht.Node,a(X,i),m(X,[{key:"_myInit",value:function(){this.s("shape3d",l),this._scrMesh=I,this.a({waveWindDir:45,waveWindStrength:14,waveSize:500,waveChoppiness:2.88,waveDeltaTime:16.7,waveResolution:512,waveStart:!0,waveNormal:!0}),this._pingPhase=!0,this._changed=!0,this._initDone=!1,this._resolutionChanged=!0,this._tagDirty=!0,this.s({"shadow.cast":!1,"shadow.receive":!1}),this.setDisplayName("Wave Sim")}},{key:"initTarget",value:function(t){var e=this.a("waveResolution"),a=t.getGL();this._initRenderTarget=new ht.graph3d.RenderTarget(t,a,e,e,{wrapS:a.REPEAT,wrapT:a.REPEAT,minFilter:a.NEAREST,magFilter:a.NEAREST,textureType:ht.WebGLConstants.FLOAT}),this._pongPhaseRenderTarget=new ht.graph3d.RenderTarget(t,a,e,e,{wrapS:a.CLAMP_TO_EDGE,wrapT:a.CLAMP_TO_EDGE,minFilter:a.NEAREST,magFilter:a.NEAREST,textureType:ht.WebGLConstants.FLOAT}),this._spectrumRenderTarget=new ht.graph3d.RenderTarget(t,a,e,e,{wrapS:a.CLAMP_TO_EDGE,wrapT:a.CLAMP_TO_EDGE,minFilter:a.NEAREST,magFilter:a.NEAREST,textureType:ht.WebGLConstants.FLOAT}),this._displaceRenderTarget=new ht.graph3d.RenderTarget(t,a,e,e,{wrapS:a.GL_REPEAT,wrapT:a.GL_REPEAT,minFilter:a.LINEAR,magFilter:a.LINEAR,textureType:ht.WebGLConstants.FLOAT}),this._normalRenderTarget=new ht.graph3d.RenderTarget(t,a,e,e,{wrapS:a.CLAMP_TO_EDGE,wrapT:a.CLAMP_TO_EDGE,minFilter:a.LINEAR,magFilter:a.LINEAR,textureType:ht.WebGLConstants.FLOAT}),this._pingTransRenderTarget=new ht.graph3d.RenderTarget(t,a,e,e,{wrapS:a.CLAMP_TO_EDGE,wrapT:a.CLAMP_TO_EDGE,minFilter:a.NEAREST,magFilter:a.NEAREST,textureType:ht.WebGLConstants.FLOAT}),this._pongTransRenderTarget=new ht.graph3d.RenderTarget(t,a,e,e,{wrapS:a.CLAMP_TO_EDGE,wrapT:a.CLAMP_TO_EDGE,minFilter:a.NEAREST,magFilter:a.NEAREST,textureType:ht.WebGLConstants.FLOAT});for(var i=new Float32Array(e*e*4),n=0;n<e;n+=1)for(var r=0;r<e;r+=1)i[n*e*4+4*r]=2*Math.random()*Math.PI,i[n*e*4+4*r+1]=0,i[n*e*4+4*r+2]=0,i[n*e*4+4*r+3]=0;this._pingPhaseRenderTarget=new ht.graph3d.RenderTarget(t,a,e,e,{wrapS:a.CLAMP_TO_EDGE,wrapT:a.CLAMP_TO_EDGE,minFilter:a.NEAREST,magFilter:a.NEAREST,textureType:ht.WebGLConstants.FLOAT,width:e,height:e,data:i}),this._pongPhaseTexture=this._pongPhaseRenderTarget.texture,this._spectrumTexture=this._spectrumRenderTarget.texture,this._displaceTexture=this._displaceRenderTarget.texture,this._normalTexture=this._normalRenderTarget.texture,this._pingTransTexture=this._pingTransRenderTarget.texture,this._pongTransTexture=this._pongTransRenderTarget.texture,this._pingPhaseTexture=this._pingPhaseRenderTarget.texture,this._initSpectrumTexture=this._initRenderTarget.texture,this._iterations=Math.log(e)/Math.log(2)*2,this._initMaterials()}},{key:"initMaterialUniforms",value:function(){this._setSize(),this._setChoppiness(),this._setSpeed(),this._setResolution(),this._setWind()}},{key:"_initMaterials",value:function(){this._initMaterial={model3d:!0,mesh:this._scrMesh,mat:{type:n,renderMode:"triangleStrip"}},this._normalMaterial={model3d:!0,mesh:this._scrMesh,mat:{type:w,renderMode:"triangleStrip",u_displacementMap:this._displaceTexture}},this._spectrumMaterial={model3d:!0,mesh:this._scrMesh,mat:{type:o,renderMode:"triangleStrip",u_initialSpectrum:this._initSpectrumTexture,u_phases:this._pingPhase?this._pingPhaseTexture:this._pongPhaseTexture}},this._phaseMaterial={model3d:!0,mesh:this._scrMesh,mat:{type:r,renderMode:"triangleStrip",u_phases:this._pingPhase?this._pingPhaseTexture:this._pongPhaseTexture}},this._pingPongMaterial={model3d:!0,mesh:this._scrMesh,mat:{type:s,renderMode:"triangleStrip",u_subtransformSize:16,u_input:this._pingTransTexture}}}},{key:"start",value:function(){this.a("waveStart",!0)}},{key:"stop",value:function(){this.a("waveStart",void 0)}},{key:"isStarted",value:function(){return this.a("waveStart")}},{key:"draw",value:function(t){if(this.a("waveStart")){this._changed&&(t.renderModel(this._initRenderTarget,this._initMaterial),this._changed=!1),this._pingPhase?this._phaseMaterial.mat.u_phases=this._pingPhaseTexture:this._phaseMaterial.mat.u_phases=this._pongPhaseTexture,t.renderModel(this._pingPhase?this._pongPhaseRenderTarget:this._pingPhaseRenderTarget,this._phaseMaterial),this._pingPhase=!this._pingPhase,this._pingPhase?this._spectrumMaterial.mat.u_phases=this._pingPhaseTexture:this._spectrumMaterial.mat.u_phases=this._pongPhaseTexture,t.renderModel(this._spectrumRenderTarget,this._spectrumMaterial);for(var e=s,a=void 0,i=void 0,n=this._iterations,r=0;r<n;r+=1)i=0===r?(a=this._pingTransRenderTarget,this._spectrumTexture):r===n-1?(a=this._displaceRenderTarget,n%2==0?this._pingTransTexture:this._pongTransTexture):r%2==1?(a=this._pongTransRenderTarget,this._pingTransTexture):(a=this._pingTransRenderTarget,this._pongTransTexture),r===n/2&&(e=h),this._pingPongMaterial.mat.type=e,this._pingPongMaterial.mat.u_subtransformSize=Math.pow(2,r%(n/2)+1),this._pingPongMaterial.mat.u_input=i,t.renderModel(a,this._pingPongMaterial);this.a("waveNormal")&&t.renderModel(this._normalRenderTarget,this._normalMaterial)}}},{key:"get3dUIClass",value:function(){return _}},{key:"getClass",value:function(){return X}},{key:"getSuperClass",value:function(){return ht.Node}},{key:"getClassName",value:function(){return"ht.plugin.Wave"}},{key:"_setWind",value:function(){var t,e;this._initDone&&(e=this.a("waveWindDir"),t=this.a("waveWindStrength"),e=e*Math.PI/180,e=[t*Math.cos(e),t*Math.sin(e)],this._initMaterial.mat.u_wind=e,this._changed=!0)}},{key:"_setSize",value:function(){var t;this._initDone&&(t=this.a("waveSize"),this._initMaterial.mat.u_size=t,this._normalMaterial.mat.u_size=t,this._spectrumMaterial.mat.u_size=t,this._phaseMaterial.mat.u_size=t,this._changed=!0)}},{key:"_setResolution",value:function(){var t;this._initDone&&(t=this.a("waveResolution"),this._resolutionChanged=!0,this._initMaterial.mat.u_resolution=t,this._normalMaterial.mat.u_resolution=t,this._spectrumMaterial.mat.u_resolution=t,this._phaseMaterial.mat.u_resolution=t,this._pingPongMaterial.mat.u_transformSize=t,this._iterations=Math.log(t)/Math.log(2)*2,this._changed=!0)}},{key:"_setChoppiness",value:function(){var t;this._initDone&&(t=this.a("waveChoppiness"),this._spectrumMaterial.mat.u_choppiness=t,this._changed=!0)}},{key:"_setSpeed",value:function(){this._initDone&&(this._phaseMaterial.mat.u_deltaTime=this.a("waveDeltaTime")/1e3,this._changed=!0)}},{key:"onPropertyChanged",value:function(t){p(X.prototype.__proto__||Object.getPrototypeOf(X.prototype),"onPropertyChanged",this).call(this,t);t=t.property;if("*"!=t)return"a:waveSize"==t?(this._setSize(),void this.iv()):"a:waveWindDir"==t||"a:waveWindStrength"==t?(this._setWind(),void this.iv()):"a:waveResolution"==t?(this._setResolution(),void this.iv()):"a:waveChoppiness"==t?(this._setChoppiness(),void this.iv()):"a:waveDeltaTime"==t?(this._setSpeed(),void this.iv()):"tag"==t?(this._tagDirty=!0,void this.iv()):"s:shadow.cast"==t?(this.s("shadow.cast")&&(this.getStyleMap()["shadow.cast"]=!1),void this.iv()):"s:shadow.receive"==t?(this.s("shadow.receive")&&(this.getStyleMap()["shadow.receive"]=!1),void this.iv()):void 0}},{key:"getWaveTexture",value:function(){return this._displaceRenderTarget.getUUID()}},{key:"getNormalTexture",value:function(){return this._normalRenderTarget.getUUID()}},{key:"updateResolution",value:function(t){for(var e=this.a("waveResolution"),a=new Float32Array(e*e*4),i=0;i<e;i+=1)for(var n=0;n<e;n+=1)a[i*e*4+4*n]=2*Math.random()*Math.PI,a[i*e*4+4*n+1]=0,a[i*e*4+4*n+2]=0,a[i*e*4+4*n+3]=0;this._changed=!0,this._pingPhaseRenderTarget.options.data=a,this._initRenderTarget.setSize(t,e,e),this._pongPhaseRenderTarget.setSize(t,e,e),this._spectrumRenderTarget.setSize(t,e,e),this._displaceRenderTarget.setSize(t,e,e),this._normalRenderTarget.setSize(t,e,e),this._pingTransRenderTarget.setSize(t,e,e),this._pongTransRenderTarget.setSize(t,e,e),this._pingPhaseRenderTarget.setSize(t,e,e),this._pingPhase=!0,this._spectrumMaterial.mat.u_phases=this._pingPhase?this._pingPhaseTexture:this._pongPhaseTexture,this._phaseMaterial.mat.u_phases=this._pingPhase?this._pingPhaseTexture:this._pongPhaseTexture,this._pingPongMaterial.mat.u_input=this._pingTransTexture}},{key:"setReadPos",value:function(t,e){var a=this.a("waveResolution");this._readInfo.u=t,this._readInfo.v=e,this._readInfo.x=Math.floor(this._readInfo.u*a),this._readInfo.y=Math.floor(this._readInfo.v*a)}},{key:"readWaveAsync",value:function(t,e,a,i,n,r){var s;this._displaceRenderTarget&&(s=this.a("waveResolution"),t=Math.floor(t*s),s=Math.floor(e*s),this._displaceRenderTarget.readPixelsAsync(t,s,a,i,n,function(t){r(t)}))}}]),X);function X(){D(this,X);var t=v(this,(X.__proto__||Object.getPrototypeOf(X)).call(this));return t._myInit(),t}var m=ht.graph3d.Graph3dView.prototype,Z=m.handleDataModelChange;m.handleDataModelChange=function(t){Z.call(this,t),"remove"==t.kind&&t.data instanceof P&&t.data.stop()},(ht.plugin||(ht.plugin={})).Wave=P}();
