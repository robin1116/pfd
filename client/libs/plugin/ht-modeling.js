!function(a,G){"use strict";function u(a,u,c){w("ht."+a,u,c)}function v(a,u,c){c?a.push(u.x,u.y):a.push(u.x,u.y,u.z)}function R(W,a,u){var c,y=W.data.getAttaches();if(y&&y.each(function(a){a instanceof S&&a.s("attach.operation")&&(c=c||[]).push(a)}),c){M.forEach(function(a){a=function(a,u,c,y){var Y,$,E,I,d=0,G=[];if(y)for(Y=y.length;d<Y;d+=3)$=y[d],E=y[d+1],I=y[d+2],s(G,new l([u[3*$],u[3*$+1],u[3*$+2]],null,c?[c[2*$],c[2*$+1],0]:b),new l([u[3*E],u[3*E+1],u[3*E+2]],null,c?[c[2*E],c[2*E+1],0]:b),new l([u[3*I],u[3*I+1],u[3*I+2]],null,c?[c[2*I],c[2*I+1],0]:b),a);else for(Y=u.length/3;d<Y;d+=3)E=($=d)+1,I=d+2,s(G,new l([u[3*$],u[3*$+1],u[3*$+2]],null,c?[c[2*$],c[2*$+1],0]:b),new l([u[3*E],u[3*E+1],u[3*E+2]],null,c?[c[2*E],c[2*E+1],0]:b),new l([u[3*I],u[3*I+1],u[3*I+2]],null,c?[c[2*I],c[2*I+1],0]:b),a);return G}(a,W[a].vs,W[a].tuv);Y=Y?Y.concat(a):a}),Y=i.$15n(Y),c.forEach(function(a){var u=a.s("attach.operation");Y[u]&&(Y=Y[u](function(a,u,c){var y,Y=Z(a),$=[],E=(a.appendAnchorMatrix3d(Y),u?u.getData3dUI(a):null);if(E&&E.s("shape3d")&&!E.s("csg.cull.box")&&(y=E.shapeModel,y=E.shapeModel?y:P.getShapeModel(E,E.s("shape3d"))))for(var I=P.createNormalMatrix(Y),d=0,G=d2.length;d<G;d++){var W=(k=d2[d]).length?k+"_":k,q=y[W+"vs"],v=y[W+"uv"],g=y[W+"is"],p=y[W+"ns"];if(q&&q.length)for(var N,n,V,T=0,z=g?g.length:q.length/3;T<z;T+=3)V=g?(N=g[T],n=g[T+1],g[T+2]):(n=(N=T)+1,T+2),s($,new l(X([q[3*N],q[3*N+1],q[3*N+2]],Y),p?X([p[3*N],p[3*N+1],p[3*N+2]],I):null,[v[2*N],v[2*N+1],0]),new l(X([q[3*n],q[3*n+1],q[3*n+2]],Y),p?X([p[3*n],p[3*n+1],p[3*n+2]],I):null,[v[2*n],v[2*n+1],0]),new l(X([q[3*V],q[3*V+1],q[3*V+2]],Y),p?X([p[3*V],p[3*V+1],p[3*V+2]],I):null,[v[2*V],v[2*V+1],0]),a)}if(!y)for(d=0;d<6;d++)for(var k=M[d],F=W2[d],v=c?u.getFaceUv(a,k):b,m=c?u.getFaceUvScale(a,k):b,B=c?u.getFaceUvOffset(a,k):b,S=0;S<2;S++){var h,R,e,Q=C[F+3*S],U=C[F+3*S+1],f=C[F+3*S+2];c&&(e=v?(h=[v[2*Q-(e=8*d)],v[2*Q+1-e],0],R=[v[2*U-e],v[2*U+1-e],0],[v[2*f-e],v[2*f+1-e],0]):(h=[L[2*Q],L[2*Q+1],0],R=[L[2*U],L[2*U+1],0],[L[2*f],L[2*f+1],0]),m&&(h[0]*=m[0],h[1]*=m[1],R[0]*=m[0],R[1]*=m[1],e[0]*=m[0],e[1]*=m[1]),B&&(h[0]+=B[0],h[1]+=B[1],R[0]+=B[0],R[1]+=B[1],e[0]+=B[0],e[1]+=B[1])),s($,new l(X([H[3*Q],H[3*Q+1],H[3*Q+2]],Y),null,h),new l(X([H[3*U],H[3*U+1],H[3*U+2]],Y),null,R),new l(X([H[3*f],H[3*f+1],H[3*f+2]],Y),null,e),a)}return i.$15n($)}(a,W.gv,W.csg.tuv)))}),M.forEach(function(a){(a=W[a]).vs=[],a.ns=[],a.tuv&&(a.tuv=[])}),W.csg&&!W.csg.ns&&(W.csg.ns=[]);var Y,q=[];if(Y.$19n().forEach(function(a){var u,c=a.$10n;if(c instanceof S){if(c.s("attach.cull"))return;u=(u=c.s("csg.cull.color"))&&P.toColorArray(u),c="csg"}for(var c=W[c],y=c.vs,Y=c.ns,$=c.tuv,E=a.$9n,I=2;I<E.length;I++)if(v(y,E[0].$24n),v(y,E[I-1].$24n),v(y,E[I].$24n),Y&&(v(Y,E[0].$22n),v(Y,E[I-1].$22n),v(Y,E[I].$22n)),$&&(v($,E[0].uv,!0),v($,E[I-1].uv,!0),v($,E[I].uv,!0)),u)for(var d=y.length/3*4,G=0;G<3;G++)q[--d]=u[3],q[--d]=u[2],q[--d]=u[1],q[--d]=u[0]}),q.length){for(var $=P.toColorArray(W.csg.color),E=0,I=W.csg.vs.length/3*4;E<I;E+=4)q[E]==G&&(q[E]=$[0],q[E+1]=$[1],q[E+2]=$[2],q[E+3]=$[3]);W.csg.cs=q}}G2.forEach(function(a){var u=W[a];u.visible&&u.vs.length?(u.ns&&u.ns.length?g(u,"ns"):u.ns=j(u.vs),g(u,"vs"),g(u,"tuv"),u.cs&&g(u,"cs")):delete W[a]}),a&&(K(W,b,a,b,u),W.clear())}function y(a,u){this.$22n=a,this.w=u}function e(a,u,c,y,v){var Y=[],$=[],E=[],I=new z;if((a=a.getData3dUI(u)).mat){var d,W=(new k).fromArray(a.mat),u=new k,q=(u.makeRotationFromEuler(y),u.setPosition(c),(new k).getInverse(u)),G=(new k).scale({x:1/v.x,y:1/v.y,z:1/v.z}),g=[],p=new z,N=new z;for(a.eachShapeModel(function(a,u,c,y,Y){for(var $,E,I,d=0,G=u?u.length:a.length/3;d<G;d++)u?(p.fromArray(a,3*u[d]),N.fromArray(c,3*u[d])):(p.fromArray(a,3*d),N.fromArray(c,3*d)),Y&&(p.applyMatrix4(Y),N.transformDirection(Y)),$=g,I=N,(E=p).applyMatrix4(W),E.applyMatrix4(q),I.transformDirection(W),I.transformDirection(q),$.push(new V2(E.clone(),I.clone()))}),g=V(g,I.set(1,0,0)),g=V(g,I.set(-1,0,0)),g=V(g,I.set(0,1,0)),g=V(g,I.set(0,-1,0)),g=V(g,I.set(0,0,1)),g=V(g,I.set(0,0,-1)),d=0;d<g.length;d++){var n=g[d];E.push(.5+n.position.x/v.x,.5-n.position.y/v.y),n.position.applyMatrix4(G),Y.push(n.position.x,n.position.y,n.position.z),$.push(n.$22n.x,n.$22n.y,n.$22n.z)}return{vs:Y,ns:$,uv:E}}function V(a,u){for(var c=[],y=.5*Math.abs(v.dot(u)),Y=0;Y<a.length;Y+=3){var $,E,I,d,G=0<a[Y+0].position.dot(u)-y,W=0<a[Y+1].position.dot(u)-y,q=0<a[Y+2].position.dot(u)-y;switch((G?1:0)+(W?1:0)+(q?1:0)){case 0:c.push(a[Y]),c.push(a[Y+1]),c.push(a[Y+2]);break;case 1:if(G&&($=a[Y+1],E=a[Y+2],I=T(a[Y],$,u,y),d=T(a[Y],E,u,y)),W){$=a[Y],E=a[Y+2],I=T(a[Y+1],$,u,y),d=T(a[Y+1],E,u,y),c.push(I),c.push(E.clone()),c.push($.clone()),c.push(E.clone()),c.push(I.clone()),c.push(d);break}q&&($=a[Y],E=a[Y+1],I=T(a[Y+2],$,u,y),d=T(a[Y+2],E,u,y)),c.push($.clone()),c.push(E.clone()),c.push(I),c.push(d),c.push(I.clone()),c.push(E.clone());break;case 2:G||(E=T($=a[Y].clone(),a[Y+1],u,y),I=T($,a[Y+2],u,y),c.push($),c.push(E),c.push(I)),W||(E=T($=a[Y+1].clone(),a[Y+2],u,y),I=T($,a[Y],u,y),c.push($),c.push(E),c.push(I)),q||(E=T($=a[Y+2].clone(),a[Y],u,y),I=T($,a[Y+1],u,y),c.push($),c.push(E),c.push(I))}}return c}function T(a,u,c,y){var Y=a.position.dot(c)-y,Y=Y/(Y-(u.position.dot(c)-y));return new V2(new z(a.position.x+Y*(u.position.x-a.position.x),a.position.y+Y*(u.position.y-a.position.y),a.position.z+Y*(u.position.z-a.position.z)),new z(a.$22n.x+Y*(u.$22n.x-a.$22n.x),a.$22n.y+Y*(u.$22n.y-a.$22n.y),a.$22n.z+Y*(u.$22n.z-a.$22n.z)))}}var E,I,d,W=a.ht,b=null,a=Math,n=a.PI,Q=a.cos,V=a.sin,U=a.abs,f=a.max,t=a.sqrt,A=1e-5,$=W.Default,w=$.def,J=$.startAnim,r=$.createMatrix,X=$.transformVec,P=$.getInternal(),c=P.addMethod,Y=P.superCall,o=P.toPointsArray,j=P.createNormals,g=P.toFloatArray,O=P.glMV,a=(P.glPop,W.graph3d.Graph3dView,W.Math),z=a.Vector3,k=a.Matrix4,_=a.Euler,K=(a.Quaternion,P.batchShape),Z=P.createNodeMatrix,D=P.getFaceInfo,x=P.transformAppend,a2=P.drawFaceInfo,u2=P.createAnim,a=P.cube(),C=a.is,H=a.vs,L=a.uv,a=P.ui(),c2=W.Node,y2=W.Shape,Y2="left",$2="right",E2="top",I2="bottom",q="dw.expanded",p=".expanded",N="dw.angle",T=".angle",s=(E=new W.Math.Vector3,I=new W.Math.Vector3,d=new W.Math.Vector3,function(a,u,c,y,Y){var $;E.copy(u.$24n),I.copy(c.$24n),d.copy(y.$24n),d.equals(E)||I.equals(E)||I.equals(d)||(u.$22n&&c.$22n&&y.$22n||($=I.sub(E).cross(d.sub(E)).normalize().multiplyScalar(1).toArray(),u.$22n||(u.$22n=new F($)),c.$22n||(c.$22n=new F($)),y.$22n||(y.$22n=new F($))),a.push(new m([u,c,y],Y)))}),M=[Y2,"front",$2,"back",E2,I2],d2=["",E2,I2],G2=M.concat("csg"),W2=[0,6,12,18,24,30],i=(c($,{createFrameModel:function(a,u,c,y){a=a==b?.07:a,u=u==b?a:u,c=c==b?a:c;var Y=(y=y||{}).top,$=y.bottom,E=y.left,I=y.right,d=y.front,y=y.back,G=[],W=[];return!0===d?(G.push(-.5,.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,-.5,.5,.5,.5,.5,-.5,.5,.5),W.push(0,0,0,1,1,1,1,1,1,0,0,0)):!1!==d&&(G.push(-.5,.5,.5,-.5,-.5,.5,-.5+a,-.5,.5,-.5+a,-.5,.5,-.5+a,.5,.5,-.5,.5,.5,.5-a,.5,.5,.5-a,-.5,.5,.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5-a,.5,.5,-.5+a,.5,.5,-.5+a,.5-u,.5,.5-a,.5-u,.5,.5-a,.5-u,.5,.5-a,.5,.5,-.5+a,.5,.5,-.5+a,-.5+u,.5,-.5+a,-.5,.5,.5-a,-.5,.5,.5-a,-.5,.5,.5-a,-.5+u,.5,-.5+a,-.5+u,.5),W.push(0,0,0,1,a,1,a,1,a,0,0,0,1-a,0,1-a,1,1,1,1,1,1,0,1-a,0,a,0,a,u,1-a,u,1-a,u,1-a,0,a,0,a,1-u,a,1,1-a,1,1-a,1,1-a,1-u,a,1-u)),!0===y?(G.push(-.5,.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,-.5,-.5,.5,-.5,.5,.5,-.5),W.push(1,0,0,1,1,1,0,1,1,0,0,0)):!1!==y&&(G.push(-.5,.5,-.5,-.5+a,-.5,-.5,-.5,-.5,-.5,-.5+a,-.5,-.5,-.5,.5,-.5,-.5+a,.5,-.5,.5-a,.5,-.5,.5,-.5,-.5,.5-a,-.5,-.5,.5,-.5,-.5,.5-a,.5,-.5,.5,.5,-.5,-.5+a,.5,-.5,.5-a,.5-u,-.5,-.5+a,.5-u,-.5,.5-a,.5-u,-.5,-.5+a,.5,-.5,.5-a,.5,-.5,-.5+a,-.5+u,-.5,.5-a,-.5,-.5,-.5+a,-.5,-.5,.5-a,-.5,-.5,-.5+a,-.5+u,-.5,.5-a,-.5+u,-.5),W.push(1,0,1-a,1,1,1,1-a,1,1,0,1-a,0,a,0,0,1,a,1,0,1,a,0,0,0,1-a,0,a,u,1-a,u,a,u,1-a,0,a,0,1-a,1-u,a,1,1-a,1,a,1,1-a,1-u,a,1-u)),!0===E?(G.push(-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,.5,.5,-.5,.5,-.5),W.push(0,0,0,1,1,1,1,1,1,0,0,0)):!1!==E&&(G.push(-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5+c,-.5,-.5,-.5+c,-.5,.5,-.5+c,-.5,.5,-.5,-.5,.5,.5-c,-.5,-.5,.5-c,-.5,-.5,.5,-.5,-.5,.5,-.5,.5,.5,-.5,.5,.5-c,-.5,.5,-.5+c,-.5,.5-u,-.5+c,-.5,.5-u,.5-c,-.5,.5-u,.5-c,-.5,.5,.5-c,-.5,.5,-.5+c,-.5,-.5+u,-.5+c,-.5,-.5,-.5+c,-.5,-.5,.5-c,-.5,-.5,.5-c,-.5,-.5+u,.5-c,-.5,-.5+u,-.5+c),W.push(0,0,0,1,c,1,c,1,c,0,0,0,1-c,0,1-c,1,1,1,1,1,1,0,1-c,0,c,0,c,u,1-c,u,1-c,u,1-c,0,c,0,c,1-u,c,1,1-c,1,1-c,1,1-c,1-u,c,1-u)),!0===I?(G.push(.5,.5,-.5,.5,-.5,.5,.5,-.5,-.5,.5,-.5,.5,.5,.5,-.5,.5,.5,.5),W.push(1,0,0,1,1,1,0,1,1,0,0,0)):!1!==I&&(G.push(.5,.5,-.5,.5,-.5,-.5+c,.5,-.5,-.5,.5,-.5,-.5+c,.5,.5,-.5,.5,.5,-.5+c,.5,.5,.5-c,.5,-.5,.5,.5,-.5,.5-c,.5,-.5,.5,.5,.5,.5-c,.5,.5,.5,.5,.5,-.5+c,.5,.5-u,.5-c,.5,.5-u,-.5+c,.5,.5-u,.5-c,.5,.5,-.5+c,.5,.5,.5-c,.5,-.5+u,-.5+c,.5,-.5,.5-c,.5,-.5,-.5+c,.5,-.5,.5-c,.5,-.5+u,-.5+c,.5,-.5+u,.5-c),W.push(1,0,1-c,1,1,1,1-c,1,1,0,1-c,0,c,0,0,1,c,1,0,1,c,0,0,0,1-c,0,c,u,1-c,u,c,u,1-c,0,c,0,1-c,1-u,c,1,1-c,1,c,1,1-c,1-u,c,1-u)),!0===Y?(G.push(.5,.5,.5,.5,.5,-.5,-.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,.5,.5,.5),W.push(1,1,1,0,0,0,0,0,0,1,1,1)):!1!==Y&&(G.push(.5,.5,.5,.5,.5,-.5,.5-a,.5,-.5,.5-a,.5,-.5,.5-a,.5,.5,.5,.5,.5,-.5+a,.5,.5,-.5+a,.5,-.5,-.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5+a,.5,.5,.5-a,.5,.5,.5-a,.5,.5-c,-.5+a,.5,.5-c,-.5+a,.5,.5-c,-.5+a,.5,.5,.5-a,.5,.5,.5-a,.5,-.5+c,.5-a,.5,-.5,-.5+a,.5,-.5,-.5+a,.5,-.5,-.5+a,.5,-.5+c,.5-a,.5,-.5+c),W.push(1,1,1,0,1-a,0,1-a,0,1-a,1,1,1,a,1,a,0,0,0,0,0,0,1,a,1,1-a,1,1-a,1-c,a,1-c,a,1-c,a,1,1-a,1,1-a,c,1-a,0,a,0,a,0,a,c,1-a,c)),!0===$?(G.push(.5,-.5,.5,-.5,-.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,.5,-.5,-.5,.5),W.push(1,0,0,1,1,1,0,1,1,0,0,0)):!1!==$&&(G.push(.5,-.5,.5,.5-a,-.5,-.5,.5,-.5,-.5,.5-a,-.5,-.5,.5,-.5,.5,.5-a,-.5,.5,-.5+a,-.5,.5,-.5,-.5,-.5,-.5+a,-.5,-.5,-.5,-.5,-.5,-.5+a,-.5,.5,-.5,-.5,.5,.5-a,-.5,.5,-.5+a,-.5,.5-c,.5-a,-.5,.5-c,-.5+a,-.5,.5-c,.5-a,-.5,.5,-.5+a,-.5,.5,.5-a,-.5,-.5+c,-.5+a,-.5,-.5,.5-a,-.5,-.5,-.5+a,-.5,-.5,.5-a,-.5,-.5+c,-.5+a,-.5,-.5+c),W.push(1,0,1-a,1,1,1,1-a,1,1,0,1-a,0,a,0,0,1,a,1,0,1,a,0,0,0,1-a,0,a,c,1-a,c,a,c,1-a,0,a,0,1-a,1-c,a,1,1-a,1,a,1,1-a,1-c,a,1-c)),{vs:G,uv:W}}}),c(W.Style,{"csg.cull.color":G,"csg.cull.box":!0,"dw.flip":!1,"dw.s3":[.999,.999,.5],"dw.t3":G,"dw.expanded":!1,"dw.toggleable":!0,"dw.axis":"left","dw.start":0,"dw.end":n/2,"dw.angle":0,"attach.cull":!1,"attach.operation":"subtract"},!0),M.forEach(function(a){var u={};u[a+p]=!1,u[a+".toggleable"]=!1,u[a+".axis"]=Y2,u[a+".start"]=0,u[a+".end"]=n/2,u[a+T]=0,c(W.Style,u,!0)}),function(){this.$4n=[]}),F=(i.$15n=function(a){var u=new i;return u.$4n=a,u},i.prototype={clone:function(){var a=new i;return a.$4n=this.$4n.map(function(a){return a.clone()}),a},$19n:function(){return this.$4n},union:function(a){var u=new B(this.clone().$4n),a=new B(a.clone().$4n);return u.$3n(a),a.$3n(u),a.$6n(),a.$3n(u),a.$6n(),u.$7n(a.$2n()),i.$15n(u.$2n())},subtract:function(a){var u=new B(this.clone().$4n),a=new B(a.clone().$4n);return u.$6n(),u.$3n(a),a.$3n(u),a.$6n(),a.$3n(u),a.$6n(),u.$7n(a.$2n()),u.$6n(),i.$15n(u.$2n())},intersect:function(a){var u=new B(this.clone().$4n),a=new B(a.clone().$4n);return u.$6n(),a.$3n(u),a.$6n(),u.$3n(a),a.$3n(u),u.$7n(a.$2n()),u.$6n(),i.$15n(u.$2n())},inverse:function(){var a=this.clone();return a.$4n.map(function(a){a.flip()}),a}},i.cube=function(a){var c=new F((a=a||{}).center||[0,0,0]),y=a.radius?a.radius.length?a.radius:[a.radius,a.radius,a.radius]:[1,1,1];return i.$15n([[[0,4,6,2],[-1,0,0]],[[1,3,7,5],[1,0,0]],[[0,1,5,4],[0,-1,0]],[[2,6,7,3],[0,1,0]],[[0,2,3,1],[0,0,-1]],[[4,5,7,6],[0,0,1]]].map(function(u){return new m(u[0].map(function(a){a=new F(c.x+y[0]*(2*!!(1&a)-1),c.y+y[1]*(2*!!(2&a)-1),c.z+y[2]*(2*!!(4&a)-1));return new l(a,new F(u[1]))}))}))},i.sphere=function(a){var c,y=new F((a=a||{}).center||[0,0,0]),Y=a.radius||1,u=a.slices||16,$=a.stacks||8,E=[];function I(a,u){u*=n;a=new F(Q(a*=2*n)*V(u),Q(u),V(a)*V(u));c.push(new l(y.$20n(a.$21n(Y)),a))}for(var d=0;d<u;d++)for(var G=0;G<$;G++)c=[],I(d/u,G/$),0<G&&I((d+1)/u,G/$),G<$-1&&I((d+1)/u,(G+1)/$),I(d/u,(G+1)/$),E.push(new m(c));return i.$15n(E)},i.cylinder=function(a){var y=new F((a=a||{}).start||[0,-1,0]),u=new F(a.end||[0,1,0]),Y=u.$13n(y),$=a.radius||1,c=a.slices||16,E=Y.$14n(),a=.5<U(E.y),I=new F(a,!a,0).cross(E).$14n(),d=I.cross(E).$14n(),G=new l(y,E.$11n()),W=new l(u,E.$14n()),q=[];function v(a,u,c){u=u*n*2,u=I.$21n(Q(u)).$20n(d.$21n(V(u))),a=y.$20n(Y.$21n(a)).$20n(u.$21n($)),u=u.$21n(1-U(c)).$20n(E.$21n(c));return new l(a,u)}for(var g=0;g<c;g++){var p=g/c,N=(g+1)/c;q.push(new m([G,v(0,p,-1),v(0,N,-1)])),q.push(new m([v(0,N,0),v(0,p,0),v(1,p,0),v(1,N,0)])),q.push(new m([W,v(1,N,1),v(1,p,1)]))}return i.$15n(q)},function(a,u,c){var y=this;3==arguments.length?(y.x=a,y.y=u,y.z=c):"x"in a?(y.x=a.x,y.y=a.y,y.z=a.z):(y.x=a[0],y.y=a[1],y.z=a[2])}),l=(F.prototype={clone:function(){return new F(this.x,this.y,this.z)},$11n:function(){return new F(-this.x,-this.y,-this.z)},$20n:function(a){return new F(this.x+a.x,this.y+a.y,this.z+a.z)},$13n:function(a){return new F(this.x-a.x,this.y-a.y,this.z-a.z)},$21n:function(a){return new F(this.x*a,this.y*a,this.z*a)},$16n:function(a){return new F(this.x/a,this.y/a,this.z/a)},dot:function(a){return this.x*a.x+this.y*a.y+this.z*a.z},lerp:function(a,u){return this.$20n(a.$13n(this).$21n(u))},length:function(){return t(this.dot(this))},$14n:function(){return this.$16n(this.length())},cross:function(a){var u=this;return new F(u.y*a.z-u.z*a.y,u.z*a.x-u.x*a.z,u.x*a.y-u.y*a.x)}},function(a,u,c){this.$24n=new F(a),this.$22n=u?new F(u):null,this.uv=c?new F(c):null}),m=(l.prototype={clone:function(){return new l(this.$24n.clone(),this.$22n.clone(),this.uv?this.uv.clone():null)},flip:function(){this.$22n=this.$22n.$11n()},$18n:function(a,u){return new l(this.$24n.lerp(a.$24n,u),this.$22n.lerp(a.$22n,u),this.uv?this.uv.lerp(a.uv,u):null)}},y.$17n=function(a,u,c){u=u.$13n(a).cross(c.$13n(a)).$14n();return new y(u,u.dot(a))},y.prototype={clone:function(){return new y(this.$22n.clone(),this.w)},flip:function(){this.$22n=this.$22n.$11n(),this.w=-this.w},$5n:function(a,u,c,y,Y){for(var $=this,E=0,I=[],d=0;d<a.$9n.length;d++){var G=(v=$.$22n.dot(a.$9n[d].$24n)-$.w)<-A?2:A<v?1:0;E|=G,I.push(G)}switch(E){case 0:(0<$.$22n.dot(a.$8n.$22n)?u:c).push(a);break;case 1:y.push(a);break;case 2:Y.push(a);break;case 3:for(var W=[],q=[],d=0;d<a.$9n.length;d++){var v,g=(d+1)%a.$9n.length,p=I[d],N=I[g],n=a.$9n[d],g=a.$9n[g];2!=p&&W.push(n),1!=p&&q.push(2!=p?n.clone():n),3==(p|N)&&(v=($.w-this.$22n.dot(n.$24n))/$.$22n.dot(g.$24n.$13n(n.$24n)),p=n.$18n(g,v),W.push(p),q.push(p.clone()))}3<=W.length&&y.push(new m(W,a.$10n)),3<=q.length&&Y.push(new m(q,a.$10n))}}},function(a,u){this.$9n=a,this.$10n=u,this.$8n=y.$17n(a[0].$24n,a[1].$24n,a[2].$24n)}),B=(m.prototype={clone:function(){var a=this.$9n.map(function(a){return a.clone()});return new m(a,this.$10n)},flip:function(){this.$9n.reverse().map(function(a){a.flip()}),this.$8n.flip()}},function(a){var u=this;u.$8n=null,u.front=null,u.back=null,u.$4n=[],a&&u.$7n(a)}),q2=(B.prototype={clone:function(){var a=this,u=new B;return u.$8n=a.$8n&&a.$8n.clone(),u.front=a.front&&a.front.clone(),u.back=a.back&&a.back.clone(),u.$4n=a.$4n.map(function(a){return a.clone()}),u},$6n:function(){for(var a=this,u=0;u<a.$4n.length;u++)a.$4n[u].flip();a.$8n&&a.$8n.flip(),a.front&&a.front.$6n(),a.back&&a.back.$6n();var c=a.front;a.front=a.back,a.back=c},$1n:function(a){var u=this;if(!u.$8n)return a.slice();for(var c=[],y=[],Y=0;Y<a.length;Y++)u.$8n.$5n(a[Y],c,y,c,y);return u.front&&(c=u.front.$1n(c)),y=u.back?u.back.$1n(y):[],c.concat(y)},$3n:function(a){var u=this;u.$4n=a.$1n(u.$4n),u.front&&u.front.$3n(a),u.back&&u.back.$3n(a)},$2n:function(){var a=this,u=a.$4n.slice();return a.front&&(u=u.concat(a.front.$2n())),u=a.back?u.concat(a.back.$2n()):u},$7n:function(a){var u=this;if(a.length){u.$8n||(u.$8n=a[0].$8n.clone());for(var c=[],y=[],Y=0;Y<a.length;Y++)this.$8n.$5n(a[Y],u.$4n,u.$4n,c,y);c.length&&(u.front||(u.front=new B),this.front.$7n(c)),y.length&&(u.back||(u.back=new B),u.back.$7n(y))}}},W.Symbol=function(a,u,c){Y(q2,this),this.s3(20,20,20),this.s({"all.visible":!1,shape:"rect"}),this.setIcon(a,u,c)}),S=(u("Symbol",c2,{setIcon:function(a,u,c){var y,Y=this;return q2.superClass.setIcon.call(Y,a),a?(y={for3d:!0,face:"center",position:44,names:[a]},c&&(y.transaprent=!0),u&&(y.autorotate=u),Y.addStyleIcon("symbol",y)):Y.removeStyleIcon("symbol"),Y.setWidth(P.getImageWidth($.getImage(a),Y)||20),y}}),W.CSGNode=function(){Y(S,this),this.s({shape:"rect","attach.thickness":1.001,"2d.attachable":!0})}),v2={position:1,width:1,height:1,rotation:1,rotationX:1,rotationZ:1,rotationMode:1,tall:1,elevation:1,anchor:1,anchorElevation:1,"s:attach.cull":1,"s:attach.operation":1},h=(u("CSGNode",c2,{get3dUIClass:function(){return h},onPropertyChanged:function(a){var u=this.getHost();S.superClass.onPropertyChanged.call(this,a),v2[a.property]&&(u instanceof g2||u instanceof S)&&u.fp("csgNodeChange",!0,!1)}}),function(a,u){Y(h,this,[a,u])}),g2=(w(h,a.Node3dUI,{drawBody:function(u,c,y){var Y=this;Y._shape3d?h.superClass.drawBody.call(Y,u,c,y):(O(Y.gv),G2.forEach(function(a){a2(Y,u,c,a,y)}))},validate:function(a,u){var c=this,y=c.gv,Y=c.data;if(Y.s("shape3d"))return h.superClass.validate.call(c,a,u),void(c._shape3d=!0);c._shape3d=!1;var $=Z(Y,y.getMat(Y)),E=(Y.appendAnchorMatrix3d($),a&&a.uv);c.vf2("csg",E);for(var I=0;I<6;I++)for(var d=M[I],G=W2[I],d=c.vf2(d,E,u),W=d.mat||$,q=d.vs,v=d.uv,g=d.tuv,p=0;p<2;p++){var N,n=C[G+3*p],V=C[G+3*p+1],T=C[G+3*p+2];x(q,W,[H[3*n],H[3*n+1],H[3*n+2]]),x(q,W,[H[3*V],H[3*V+1],H[3*V+2]]),x(q,W,[H[3*T],H[3*T+1],H[3*T+2]]),g&&(v?g.push(v[2*n-(N=8*I)],v[2*n+1-N],v[2*V-N],v[2*V+1-N],v[2*T-N],v[2*T+1-N]):g.push(L[2*n],L[2*n+1],L[2*V],L[2*V+1],L[2*T],L[2*T+1]))}R(c,a,u)},vf2:function(a,u,c){var y=this.gv.getFaceVisible(this.data,a),a=D(this,a,c);return a.vs=[],a.tuv=y&&(a.texture||u)?[]:b,a.visible=y,a}}),W.CSGShape=function(){var a=this;Y(g2,a),a.s({"shape.background":b,"2d.hostable":!0,"shape.border.width":8}),a.setTall(240),a.setElevation(120),a.setThickness(14)}),p2=(u("CSGShape",y2,{IRotatable:!1,get3dUIClass:function(){return p2},setRotationX:function(a){},setRotation:function(a){},setRotationZ:function(a){},setSegments:function(a){}}),function(a,u){Y(p2,this,[a,u])}),N2=(w(p2,a.Shape3dUI,{drawBody:function(u,c,y){var Y=this;Y.undrawable||(O(Y.gv),G2.forEach(function(a){a2(Y,u,c,a,y)}))},validate:function(u,c){var a,y,Y,$,E=this,I=E.data,d=I.getPoints();(E.undrawable=d.size()<2)?E.clear():(a=I.isClosePath(),y=f(I._thickness/2,A),d=o(d,b,b,a),G2.forEach(function(a){E.vf(a,u&&u.uv,!0,c)}),a&&(E.left.visible=!1,E.right.visible=!1),E._12O(d,y),E._20Q(d),Y=I.getPointsMatrix3d(),$=W.Math.requestVector3(),M.forEach(function(a){if(E[a])for(var u=E[a].vs,c=0,y=u.length;c<y;c+=3)$.set(u[c],u[c+1],u[c+2]).applyMatrix4(Y),u[c]=$.x,u[c+1]=$.y,u[c+2]=$.z}),W.Math.releaseVector3($),R(E,u,c))}}),W.DoorWindow=function(){Y(N2,this),this.setElevation(100),this.s3(100,200,14)}),n2=(u("DoorWindow",S,{IDoorWindow:!0,toggle:function(a){this.setExpanded(!this.s(q),a)},isExpanded:function(){return this.s(q)},setExpanded:function(a,u){var c,y=this,Y=y.$25n,$=y.s(q);Y&&(Y.stop(!0),delete y.$25n),$!==a&&(y.beginTransaction(),c=a?y.s("dw.end"):y.s("dw.start"),y.s(q,a),(u=u2(u))?($=y.s(N),u.action=function(a){y.s(N,$+(c-$)*a)},u.finishFunc=function(){y.endTransaction()},y.$25n=J(u)):(y.s(N,c),y.endTransaction()))},getMat:function(){var a,u,c=this,y=c.s("dw.s3"),Y=c.s("dw.t3"),$=c.s("dw.flip"),E=c.s(N);return y||E||Y||$?(a=[],$&&a.push({r3:[0,n,0]}),y&&a.push({s3:y}),E&&(y=c.getFinalScale3d(),$=c.s("dw.axis"),c=y[0]/2,u=y[1]/2,y[2],$===Y2?a.push({t3:[c,0,0]},{r3:[0,-E,0]},{t3:[-c,0,0]}):$===$2?a.push({t3:[-c,0,0]},{r3:[0,E,0]},{t3:[c,0,0]}):$===E2?a.push({t3:[0,-u,0]},{r3:[-E,0,0]},{t3:[0,u,0]}):$===I2?a.push({t3:[0,u,0]},{r3:[E,0,0]},{t3:[0,-u,0]}):"v"===$?a.push({r3:[0,E,0]}):"h"===$&&a.push({r3:[E,0,0]})),Y&&a.push({t3:Y}),r(a)):b}}),W.CSGBox=function(){Y(n2,this),this.setElevation(100),this.s3(100,200,100)});u("CSGBox",S,{ICSGBox:!0,toggleFace:function(a,u){this.setFaceExpanded(a,!this.s(a+p),u)},isFaceExpanded:function(a){return this.s(a+p)},setFaceExpanded:function(u,a,c){var y,Y=this,$=Y.$25n,E=Y.s(u+p);$&&($.stop(!0),delete Y.$25n),E!==a&&(y=a?Y.s(u+".end"):Y.s(u+".start"),Y.s(u+p,a),(c=u2(c))?(E=Y.s(u+T),c.action=function(a){Y.s(u+T,E+(y-E)*a)},Y.$25n=J(c)):Y.s(u+T,y))},getFaceMat:function(a){var u=this.s(a+T);if(!u)return b;var c,y,Y,$,E,I,d=this.s(a+".axis"),G=this.getFinalScale3d(),W=this.getAnchor3d(),q=G[0]*W.x,v=G[1]*W.y,g=G[2]*W.z,p=G[0]-q,N=G[1]-v,n=G[2]-g;switch(a+"_"+d){case"front_left":c=-q,Y=n,E=-u,I=$=y=0;break;case"front_right":c=p,Y=n,E=u,I=$=y=0;break;case"front_top":y=N,Y=n,$=-u,I=E=c=0;break;case"front_bottom":y=-v,Y=n,$=u,I=E=c=0;break;case"front_h":Y=n,$=u,I=E=y=c=0;break;case"front_v":Y=n,E=u,I=$=y=c=0;break;case"back_left":c=p,Y=-g,E=-u,I=$=y=0;break;case"back_right":c=-q,Y=-g,E=u,I=$=y=0;break;case"back_top":y=N,Y=-g,$=u,I=E=c=0;break;case"back_bottom":y=-v,Y=-g,$=-u,I=E=c=0;break;case"back_h":Y=-g,$=u,I=E=y=c=0;break;case"back_v":Y=-g,E=u,I=$=y=c=0;break;case"left_left":c=-q,Y=-g,E=-u,I=$=y=0;break;case"left_right":c=-q,Y=n,E=u,I=$=y=0;break;case"left_top":c=-q,y=N,E=$=Y=0,I=-u;break;case"left_bottom":c=-q,y=-v,E=$=Y=0,I=u;break;case"left_h":c=-q,E=$=Y=y=0,I=u;break;case"left_v":c=-q,E=u,I=$=Y=y=0;break;case"right_left":c=p,Y=n,E=-u,I=$=y=0;break;case"right_right":c=p,Y=-g,E=u,I=$=y=0;break;case"right_top":c=p,y=N,E=$=Y=0,I=u;break;case"right_bottom":c=p,y=-v,E=$=Y=0,I=-u;break;case"right_h":c=p,E=$=Y=y=0,I=u;break;case"right_v":c=p,E=u,I=$=Y=y=0;break;case"top_left":c=-q,y=N,E=$=Y=0,I=u;break;case"top_right":c=p,y=N,E=$=Y=0,I=-u;break;case"top_top":y=N,Y=-g,$=-u,I=E=c=0;break;case"top_bottom":y=N,Y=n,$=u,I=E=c=0;break;case"top_h":y=N,$=u,I=E=Y=c=0;break;case"top_v":y=N,E=$=Y=c=0,I=u;break;case"bottom_left":c=-q,y=-v,E=$=Y=0,I=-u;break;case"bottom_right":c=p,y=-v,E=$=Y=0,I=u;break;case"bottom_top":y=-v,Y=n,$=-u,I=E=c=0;break;case"bottom_bottom":y=-v,Y=-g,$=u,I=E=c=0;break;case"bottom_h":y=-v,$=u,I=E=Y=c=0;break;case"bottom_v":y=-v,E=$=Y=c=0,I=u}return r([{t3:[-c,-y,-Y]},{r3:[$,E,I]},{t3:[c,y,Y]}])}});function V2(a,u){this.position=a,this.$22n=u}V2.prototype.clone=function(){return new V2(this.position.clone(),this.$22n.clone())};c(W.graph3d.Graph3dView,{createDecal:function(a,u,c,y){var Y=this,$=Y.getDataAt(a);if($){var E,I,d,a=Y.intersectObject(a,$);if(a)return u="object"==typeof u?u.x?new z(u.x,u.y,u.z):new z(u[0],u[1],u[2]):new z(u=u||20,u,u),c=c===G?.1:c,d=new z(Y.getUp()),E=(I=new z(Y.getCenter()).sub(new z(Y.getEye())).normalize()).clone().cross(d).normalize(),d.copy(E).cross(I).normalize(),y&&d.applyAxisAngle(a.worldNormal,-y),E=new W.Node,I=a.worldNormal.clone().setLength(c).add(a.world),y=(new k).lookAt(a.worldNormal.clone(),new z(0,0,0),d),c=(new _).setFromRotationMatrix(y),d=e(Y,$,a.world.clone(),c,u),E.p3(I.x,I.y,I.z),E.setEuler(c),E.s3(u.x,u.y,u.z),E.s({shape3d:d,"shape3d.reverse.flip":!0}),E}}})}("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:(0,eval)("this"),void Object);